import{g as d,c as n,a as i,i as s,t as _,S as h}from"./web.CdH0hsdh.js";import{e as U,I as x,B as u,a as O}from"./utils.B5ZwglE2.js";import{c as V}from"./store.Dt9OeaDn.js";import{B as G}from"./Button.C-i3301K.js";import{o as R,s as b,n as q}from"./index.BmTnCDYh.js";var z=_("<form novalidate><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),M=_("<br>"),F=_("<a href=/kontakt>kontaktiere uns direkt");function X(){const[e,r]=V({form:{name:"",email:"",tel:""},showErrors:{nameMissing:!1,emailMissing:!1,emailInvalid:!1,general:!1},state:"IDLE"});let f;async function D(t){t.preventDefault();const p=e.form.name.trim().length===0;r("showErrors","nameMissing",p);const m=e.form.email.trim().length===0;r("showErrors","emailMissing",m);const $=f.validity.typeMismatch;if(r("showErrors","emailInvalid",$),!(e.showErrors.nameMissing||e.showErrors.emailMissing||e.showErrors.emailInvalid)){r("state","LOADING");try{const g={name:e.form.name,email:e.form.email,handynummer:e.form.tel},l=await fetch(U("/rst25/start"),{method:"post",body:JSON.stringify(g),headers:{"Content-Type":"application/json"}});if(!l.ok)r("showErrors","general",!0);else{const w=await l.json(),c=R({name:b(),email:b(),registrationId:q(),secret:b()}).parse(w),o=new URL(location.origin+"/meine-anmeldung");o.searchParams.append("secret",c.secret),o.searchParams.append("showCreateMessage","true"),window.location.replace(o)}}catch{r("showErrors","general",!0)}finally{r("state","IDLE")}}}return[(()=>{var t=d(z),p=t.firstChild,[m,$]=i(p.nextSibling),g=m.nextSibling,[l,w]=i(g.nextSibling),E=l.nextSibling,[c,o]=i(E.nextSibling),k=c.nextSibling,[y,L]=i(k.nextSibling),A=y.nextSibling,[I,N]=i(A.nextSibling),B=I.nextSibling,[S,P]=i(B.nextSibling),j=S.nextSibling,[C,T]=i(j.nextSibling);return t.addEventListener("submit",D),s(t,n(x,{label:"Name",name:"name",get value(){return e.form.name},onValueUpdate:a=>{r("form","name",a),r("showErrors","nameMissing",!1)}}),m,$),s(t,n(h,{get when(){return e.showErrors.nameMissing},get children(){return n(u,{type:"danger",children:"Dies ist ein Pflichtfeld."})}}),l,w),s(t,n(O,{label:"E-Mail",name:"email",type:"email",get value(){return e.form.email},onValueUpdate:a=>{r("form","email",a),r("showErrors","emailMissing",!1),r("showErrors","emailInvalid",!1)},ref(a){var v=f;typeof v=="function"?v(a):f=a}}),c,o),s(t,n(h,{get when(){return e.showErrors.emailMissing},get children(){return n(u,{type:"danger",children:"Dies ist ein Pflichtfeld."})}}),y,L),s(t,n(h,{get when(){return e.showErrors.emailInvalid},get children(){return n(u,{type:"danger",children:"Die Eingabe scheint keine gÃ¼ltige E-Mail-Adresse zu sein."})}}),I,N),s(t,n(x,{label:"Handynummer",name:"tel",type:"tel",get value(){return e.form.tel},required:!1,onValueUpdate:a=>r("form","tel",a)}),S,P),s(t,n(G,{type:"submit",get kind(){return e.state==="IDLE"?"success":"gray"},get label(){return e.state==="IDLE"?"Anmeldung starten":"Anmeldung wird gestartet"},get disabled(){return e.state==="LOADING"}}),C,T),t})(),d(M),n(h,{get when(){return e.showErrors.general},get children(){return[n(u,{type:"danger",get children(){return["Es gab ein Problem, das wir nicht erwartet haben. Bitte versuche es erneut oder ",d(F),"."]}}),d(M)]}})]}export{X as Anmeldung};
