import{c as Je,I as wn,B as C,d as Rn,f as ie,g as vt,h as H,b as j,s as An,i as Qt,S as Mt,j as yt,k as Dn,e as Fe,l as Un,m as Xt,n as Tn,u as On}from"./utils.D4lVKdag.js";import{b as en,g as d,t as g,a as u,u as Nn,i as s,c as r,S as E,d as me,e as Te,F as W,M as R,f as Se,s as kt,h as it,j as at,k as st,m as O,r as ot,l as Dt,n as lt,o as dt,p as rt,q as tn,E as Mn}from"./web.BCh8zNxO.js";/* empty css                                 */import{c as D,u as Ze}from"./store.BK-5lGMP.js";import{T as Pn}from"./Textarea.BaP5nL_S.js";import{s as f,n as J,e as ut,T as x,o as v,a as le,C as Ut,d as nn,b as je,l as T,c as Le,u as Tt,f as In}from"./texts.CWjYF-lE.js";var Ln=g("<dialog><!$><!/><!$><!/><!$><!/>"),Fn=g("<h4>");function ke(e=!1){return{open:e}}function pe(e){let t;const[n,l]=D(e.store);en(()=>{n.open?t.showModal():t.close()});function a(){l({open:!1}),e.onClose?.()}const i=()=>{const o=[];return e.type!==void 0&&o.push(e.type),e.size!==void 0&&o.push(e.size),e.onClose!==void 0&&o.push("dialog-with-close"),o};return(()=>{var o=d(Ln),c=o.firstChild,[m,h]=u(c.nextSibling),S=m.nextSibling,[_,$]=u(S.nextSibling),b=_.nextSibling,[y,k]=u(b.nextSibling);o.addEventListener("close",a);var p=t;return typeof p=="function"?Nn(p,o):t=o,s(o,r(E,{get when(){return e.onClose},get children(){return r(Je,{onClick:a,icon:"circle-xmark",kind:"gray"})}}),m,h),s(o,r(E,{get when(){return e.title},children:w=>(()=>{var N=d(Fn);return s(N,w),N})()}),_,$),s(o,()=>e.children,y,k),me(()=>Te(o,i().join(" "))),o})()}var Ot=g("<p>");function qe(e){const[t,n]=D(e.store),l=e.showErrors==="ALWAYS",a=()=>l||t.isDirty?e.errors??[]:[];return[r(wn,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:i=>n("value",i),onBlur:()=>n("isDirty",!0),get type(){return e.type},get required(){return e.required},get isHoneypot(){return e.isHoneypot},get disabled(){return e.disabled}}),r(E,{get when(){return a().length>0},get children(){return r(C,{type:"danger",get children(){return r(W,{get each(){return a()},children:i=>(()=>{var o=d(Ot);return s(o,i),o})()})}})}})]}function Pt(e){const[t,n]=D(e.store),l=e.showErrors==="ALWAYS",a=()=>l||t.isDirty?e.errors??[]:[];return[r(Rn,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:i=>n("value",i),onBlur:()=>n("isDirty",!0),get required(){return e.required},get isHoneypot(){return e.isHoneypot},get min(){return e.min},get max(){return e.max},get disabled(){return e.disabled}}),r(E,{get when(){return a().length>0},get children(){return r(C,{type:"danger",get children(){return r(W,{get each(){return a()},children:i=>(()=>{var o=d(Ot);return s(o,i),o})()})}})}})]}function Rt(e){const[t,n]=D(e.store),l=e.showErrors==="ALWAYS",a=()=>l||t.isDirty?e.errors??[]:[];return[r(Pn,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:i=>n("value",i),onBlur:()=>n("isDirty",!0),get required(){return e.required},get size(){return e.size},get disabled(){return e.disabled}}),r(E,{get when(){return a().length>0},get children(){return r(C,{type:"danger",get children(){return r(W,{get each(){return a()},children:i=>(()=>{var o=d(Ot);return s(o,i),o})()})}})}})]}const et=f().transform(e=>({value:e,isDirty:!1}));function xt(e){return{value:e,isDirty:!1}}const It=J().transform(e=>({value:e,isDirty:!1})),Ue={SATURDAY:{open:{from:10,to:24},breaks:[{from:13,to:14},{from:18,to:19}]},SUNDAY:{open:{from:10,to:18},breaks:[{from:13,to:14}]}};ut(["SATURDAY","SUNDAY"]);function tt(e,t){const{from:n,to:l}=t;return n<e&&e<l}function Gn(e,t){const{from:n,to:l}=e,{from:a,to:i}=t;return tt(n,t)||tt(l,t)||tt(a,e)||tt(i,e)||n===a&&l===i}function Ve(e,t=!1){const{from:n,to:l}=e;if(n>l)return[];const a=l-n;return rn(t?a+1:a,n)}function rn(e,t=0){return[...Array(e)].map((n,l)=>l+t)}function Hn(e,t){return e===null?-1:t===null?1:e.day==="SATURDAY"&&t.day==="SUNDAY"?-1:e.day==="SUNDAY"&&t.day==="SATURDAY"?1:e.from===t.from?e.to-t.to:e.from-t.from}var Yn=g("<div class=dynamic-columns style=gap:1rem;--min-width:30rem;><!$><!/><!$><!/>"),Bn=g("<div><h4 style=margin-block-end:1.5rem;></h4><!$><!/>"),zn=g("<p>Konflikte gefunden! Bitte stelle sicher, dass du nicht zeitlich Ã¼berlappende Spielrunden eingetragen hast:"),jn=g('<div style="display:grid;grid-template-columns:1fr max-content 1fr;gap:1rem;margin-block:0.5rem;"><!$><!/><span style=color:var(--clr-warning-10);align-self:center;font-size:2rem;></span><!$><!/>'),Wn=g("<div class=timetable><!$><!/><div class=entries></div><div class=after-hour><div class=annotation>"),Kn=g("<div><div class=annotation></div><div class=background>"),Zn=g("<div class=entry>");function qn(e){return(()=>{var t=d(Yn),n=t.firstChild,[l,a]=u(n.nextSibling),i=l.nextSibling,[o,c]=u(i.nextSibling);return s(t,r(Lt,{get programEntries(){return e.programEntries.SATURDAY},get openingHours(){return Ue.SATURDAY},day:"SATURDAY"}),l,a),s(t,r(Lt,{get programEntries(){return e.programEntries.SUNDAY},get openingHours(){return Ue.SUNDAY},day:"SUNDAY"}),o,c),t})()}function Lt(e){const t=Vn(e.programEntries);return(()=>{var n=d(Bn),l=n.firstChild,a=l.nextSibling,[i,o]=u(a.nextSibling);return s(l,()=>x.days[e.day]),s(n,r(Se,{get fallback(){return[r(C,{type:"danger",get children(){return d(zn)}}),r(W,{each:t,children:([c,m])=>(()=>{var h=d(jn),S=h.firstChild,[_,$]=u(S.nextSibling),b=_.nextSibling,y=b.nextSibling,[k,p]=u(y.nextSibling);return s(h,()=>c.component(),_,$),s(b,r(ie,{icon:"triangle-exclamation"})),s(h,()=>m.component(),k,p),h})()})]},get children(){return r(R,{get when(){return t.length===0},get children(){return r(Jn,{get programEntries(){return e.programEntries},get openingHours(){return e.openingHours},get day(){return e.day}})}})}}),i,o),n})()}function Jn(e){const t=Ve(e.openingHours.open),n=e.openingHours.breaks.map(({from:i})=>i),l=(t[0]??0)-1,a=t.at(-1)??0;return(()=>{var i=d(Wn),o=i.firstChild,[c,m]=u(o.nextSibling),h=c.nextSibling,S=h.nextSibling,_=S.firstChild;return s(i,r(W,{each:t,children:$=>{const b=n.includes($);return(()=>{var y=d(Kn),k=y.firstChild;return Te(y,`hour ${b?"break":""}`),s(k,$),me(p=>kt(y,Ft({from:$,to:$},l,e.day),p)),y})()}}),c,m),s(h,r(W,{get each(){return e.programEntries},children:$=>(()=>{var b=d(Zn);return s(b,()=>$.component()),me(y=>kt(b,Ft($.range,l,e.day),y)),b})()})),s(_,a+1),me($=>kt(h,`grid-row: 1 / ${a-l+1};`,$)),i})()}function Ft(e,t,n){const{from:l,to:a}=e,i=l-t,o=a-t,c=Ue[n].open.to;return vt(i>0,`Entry can't start at ${l}.`),vt(o>0,`Entry can't end at ${a}.`),vt(a<=c,`Entry can't end at ${a}.`),`grid-row: ${i} / ${o};`}function Vn(e){const t=[];return e.forEach((n,l)=>{e.slice(l+1).forEach(a=>{Gn(n.range,a.range)&&t.push([n,a])})}),t}var Qn=g("<span>");function ln(e){const t=()=>{const n=["chip"];return n.push(e.kind??"gray"),e.inverted&&n.push("inverted"),e.size==="small"&&n.push("small"),n.join(" ")};return(()=>{var n=d(Qn);return s(n,()=>e.children),me(l=>{var a=t(),i=e.title;return a!==l.e&&Te(n,l.e=a),i!==l.t&&it(n,"title",l.t=i),l},{e:void 0,t:void 0}),n})()}var an=g("<br>"),Xn=g("<div>"),er=g("<div style=display:grid;gap:1rem;><h3>Meine Kontaktdaten</h3><p><strong>Name:</strong> <!$><!/></p><p><strong>E-Mail:</strong> <!$><!/></p><p><strong>Handynummer:</strong> <!$><!/></p><!$><!/>"),tr=g("<form novalidate><!$><!/><!$><!/><!$><!/><!$><!/>"),nr=g("<h3>Mein Programm"),rr=g("<div><!$><!/><!$><!/><h5></h5><p class=duration>von <!$><!/> bis <!$><!/> Uhr <em><small>(<!$><!/> <!$><!/>)");function ir(e){const t=e.store.master.games.flatMap(i=>i.slots.map(o=>({status:i.kind,uuid:i.uuid,title:i.title.value,dateTime:o}))),n=()=>{const i=e.program();return i?.kind==="SUCCESS"?i.data:[]},l=()=>{const i=e.store.playing.reservations.map(o=>o.gameRound);return new Set(i)},a=()=>n().filter(i=>l().has(i.uuid)).map(i=>({uuid:i.uuid,title:i.title,dateTime:i.slot}));return[r(lr,{get store(){return e.store.init},get isEditable(){return e.isEditable}}),d(an),r(sr,{get entries(){return{play:a(),master:t,help:[]}},get changePage(){return e.changePage},get isEditable(){return e.isEditable}})]}function lr(e){const[t,n]=D(e.store),[l,a]=D(ke());return r(C,{get children(){return[r(E,{get when(){return l.open},get children(){return r(ar,{dialogStore:l,get currentState(){return e.store},updateCurrentState:n})}}),(()=>{var i=d(er),o=i.firstChild,c=o.nextSibling,m=c.firstChild,h=m.nextSibling,S=h.nextSibling,[_,$]=u(S.nextSibling),b=c.nextSibling,y=b.firstChild,k=y.nextSibling,p=k.nextSibling,[w,N]=u(p.nextSibling),P=b.nextSibling,L=P.firstChild,Y=L.nextSibling,te=Y.nextSibling,[U,V]=u(te.nextSibling),ne=P.nextSibling,[K,B]=u(ne.nextSibling);return s(c,()=>e.store.name,_,$),s(b,()=>e.store.email,w,N),s(P,()=>e.store.mobile,U,V),s(i,r(E,{get when(){return e.isEditable},get children(){var Z=d(Xn);return s(Z,r(H,{icon:"pencil",label:"Kontaktdaten editieren",onClick:()=>a("open",!0)})),Z}}),K,B),i})()]}})}function ar(e){const[t]=D({name:xt(e.currentState.name),email:xt(e.currentState.email),mobile:xt(e.currentState.mobile)}),n=at(()=>{const i={name:[],email:[]};return t.name.value.trim().length===0&&i.name.push(x.mandatoryField),t.email.value.trim().length===0?i.email.push(x.mandatoryField):t.email.value.includes("@")||i.email.push(x.invalidEmail),{...i,hasErrors:i.name.length+i.email.length>0}}),[l,a]=D(e.dialogStore);return r(pe,{get store(){return e.dialogStore},title:"Kontaktdaten editieren",onClose:()=>{},size:"medium",get children(){var i=d(tr),o=i.firstChild,[c,m]=u(o.nextSibling),h=c.nextSibling,[S,_]=u(h.nextSibling),$=S.nextSibling,[b,y]=u($.nextSibling),k=b.nextSibling,[p,w]=u(k.nextSibling);return s(i,r(qe,{get store(){return t.name},label:"Name",name:"name",showErrors:"ON_BLUR",get errors(){return n().name}}),c,m),s(i,r(qe,{get store(){return t.email},label:"E-Mail",name:"email",showErrors:"ON_BLUR",get errors(){return n().email}}),S,_),s(i,r(qe,{get store(){return t.mobile},label:"Handynummer",name:"mobile"}),b,y),s(i,r(j,{label:"Speichern",get disabled(){return n().hasErrors},onClick:()=>{n().hasErrors||(e.updateCurrentState({name:t.name.value,email:t.email.value,mobile:t.mobile.value}),a("open",!1))}}),p,w),i}})}function sr(e){const t=or(e.entries,e.changePage,e.isEditable);return[d(nr),d(an),r(qn,{programEntries:t})]}function pt(e){const t=e.range.to-e.range.from,n={"master-draft":{label:"SL",help:"Spielleitung",link:{icon:"pencil",label:"Spielrunde bearbeiten"}},master:{label:"SL",help:"Spielleitung",link:{icon:"pencil",label:"Spielrunde bearbeiten"}},play:{label:"TN",help:"Teilnehmer:in",link:{icon:"link",label:"Zur Spielrunde"}},help:{label:"HL",help:"Helfen",link:{icon:"link",label:""}}}[e.kind],l=()=>{const a=["timeview-entry","box-simple"];return e.kind==="master-draft"&&a.push("gray"),e.kind==="master"&&a.push("special"),e.kind==="play"&&a.push("danger"),a.join(" ")};return(()=>{var a=d(rr),i=a.firstChild,[o,c]=u(i.nextSibling),m=o.nextSibling,[h,S]=u(m.nextSibling),_=h.nextSibling,$=_.nextSibling,b=$.firstChild,y=b.nextSibling,[k,p]=u(y.nextSibling),w=k.nextSibling,N=w.nextSibling,[P,L]=u(N.nextSibling),Y=P.nextSibling,te=Y.nextSibling,U=te.firstChild,V=U.firstChild,ne=V.nextSibling,[K,B]=u(ne.nextSibling),Z=K.nextSibling,z=Z.nextSibling,[ae,oe]=u(z.nextSibling);return ae.nextSibling,s(a,r(ln,{get title(){return n.help},inverted:!0,size:"small",get children(){return n.label}}),o,c),s(a,r(E,{get when(){return e.onClick},children:I=>r(Je,{get icon(){return n.link.icon},kind:"ghost",get onClick(){return I()},get title(){return n.link.label}})}),h,S),s(_,()=>e.title),s($,()=>e.range.from,k,p),s($,()=>e.range.to,P,L),s(U,t,K,B),s(U,t===1?"Stunde":"Stunden",ae,oe),me(I=>{var re=l(),q=e.title;return re!==I.e&&Te(a,I.e=re),q!==I.t&&it(_,"title",I.t=q),I},{e:void 0,t:void 0}),a})()}function or(e,t,n){const l={SATURDAY:[],SUNDAY:[]};return n&&(e.play.forEach(a=>{l[a.dateTime.day].push({range:a.dateTime,component:()=>r(pt,{get title(){return a.title},get range(){return a.dateTime},kind:"play",onClick:()=>t({kind:"GAME",uuid:a.uuid})})})}),e.master.forEach(a=>{if(a.status==="archived")return;const i=[a.title];a.status==="draft"&&i.unshift("(noch nicht verÃ¶ffentlicht)"),l[a.dateTime.day].push({range:a.dateTime,component:()=>r(pt,{get title(){return i.join(" ")},get range(){return a.dateTime},get kind(){return a.status==="published"?"master":"master-draft"},onClick:()=>t({kind:"EDIT_GAMEROUND",uuid:a.uuid})})})}),e.help.forEach(a=>{l[a.dateTime.day].push({range:a.dateTime,component:()=>r(pt,{get title(){return a.title},get range(){return a.dateTime},kind:"help"})})})),l}var dr=g("<p>Diese Seite ist leider noch nicht bereit. Komm bitte spÃ¤ter nochmal zurÃ¼ck.");function ur(){return r(C,{type:"danger",get children(){return d(dr)}})}var cr=g("<div class=grid><!$><!/><div>"),gr=g("<div class=boxLink>");function Ie(e){const t=e.type??"special";return(()=>{var n=d(gr);return s(n,r(C,{type:t,get onClick(){return e.onClick},get children(){var l=d(cr),a=l.firstChild,[i,o]=u(a.nextSibling),c=i.nextSibling;return s(l,r(ie,{get icon(){return e.icon}}),i,o),s(c,()=>e.children),l}})),n})()}const Nt=ut(["SATURDAY","SUNDAY"]),sn=v({uuid:f().uuid(),day:Nt,from:J(),to:J()}).refine(e=>e.from<e.to,{message:"A TimeSlot can't end before it starts."});v({name:f(),label:f(),description:f()});const ct=ut(["draft","published","archived"]),mr=v({uuid:f().uuid(),kind:ct,title:f(),system:f(),description:v({short:f(),long:f()}),slots:le(sn),playerCount:v({min:J().min(1),max:J()}).transform(e=>{const[t,n]=An([e.min,e.max]);return{min:t,max:n}}),tagNames:le(f())}),on=v({uuid:f().uuid(),kind:ct,title:et,system:et,description:v({short:et,long:et}),slots:le(sn),playerCount:v({min:It,max:It}),tagNames:le(f())});function hr(){const e={uuid:crypto.randomUUID(),kind:"draft",title:"",system:"",description:{short:"",long:""},slots:[],playerCount:{min:2,max:4},tagNames:["deutsch"]},t=$r(e);if(t.success)return t.data;throw console.error(t),Error("should not happen")}function $r(e){return on.safeParse(e)}function Sr(e){return{...e,title:e.title.value,system:e.system.value,description:{short:e.description.short.value,long:e.description.long.value},playerCount:{min:e.playerCount.min.value,max:e.playerCount.max.value}}}const Ge=[{name:"ab6jahren",label:"Ab 6 Jahren",description:"Spannungs- und Bedrohungsmomente werden kurz gehalten. In Begleitung oder nach Absprache mit einem Elternteil. Beispiele: My Little Pony, ..."},{name:"ab12jahren",label:"Ab 12 Jahren",description:"Antisoziales und destruktives wird auf ein Minimum begrenzt. Keine Diskriminierung, keine Radikalisierung, SexualitÃ¤t wird nicht explizit dargestellt."},{name:"ab18jahren",label:"Ab 18 Jahren",description:"Keinerlei Richtlinien bezÃ¼glich Inhalt, in der Gruppe sollte aber diskutiert werden, was akzeptabel ist und was nicht. Beispiele: Vampire the Masquerade, ..."},{name:"fantasy",label:"Fantasy",description:"Spielt in einer alternativen Vergangenheit, in welcher Elemente wie: Ritterinnen, Hexenmeister, RÃ¼stungen, Magie, Goblins, Turniere usw. vorkommen kÃ¶nnen. Beispiele: Das Schwarze Auge, Dungeons & Dragons, ..."},{name:"sciencefiction",label:"Science Fiction",description:"Spielt in einer alternativen Zukunft, in welcher Elemente wie: Raumschiffe, Sternenportale, KÃ¼nstliche Intelligenzen, Laserkanonen usw. vorkommen kÃ¶nnen. Beispiele: Shadowrun, Alien, ..."},{name:"postapokalyptisch",label:"Postapokalyptisch",description:"Spielt in einer Welt mitten oder nach einem Kollaps, wo die Mehrheit ums Ãberleben kÃ¤mpft. Beispiele: Mutant Year Zero, Apocalypse World"},{name:"horror",label:"Horror",description:"Eine gruselige AtmosphÃ¤re, psychologischer Druck oder unvorhersehbare Schreckensmomente. Beispiele: Cthulhu, ..."},{name:"offenewelt",label:"Offene Welt",description:"Es gibt nur einen losen Handlungsfaden, die Rollenspiel-Gruppe muss sich ihre Ziele selber festlegen. Beispiele: Ironsworn, Blades in the Dark, ..."},{name:"gemeinsamespielleitung",label:"Gemeinsame Spielleitung",description:"Die Regeln und die Umwelt werden gemeinsam von allen Spielenden umgesetzt. Beispiele: Microscope, The Quiet Year, ..."},{name:"regelleicht",label:"Regelleicht",description:"Die kompletten Regeln haben alle auf einer Seite Platz. Beispiele: Fiasco, Everyone is John, ..."},{name:"deutsch",label:"Deutsch",description:"Bei der Spielrunde reden die Spielenden miteinander Deutsch."},{name:"englisch",label:"Englisch",description:"Bei der Spielrunde reden die Spielenden miteinander Englisch."},{name:"workshop",label:"Workshop",description:"Unter Anleitung, gemeinsam ein Rollenspiel-Thema vertiefen. Kreative Techniken stehen im Vordergrund. Beispiele: Gemeinsam einen Dungeon erschaffen, gemeinsam eine Hintergrundgeschichte schreiben, ..."}],gt=200,dn=500,un=200;function _r(e){const t=e.title.value.trim().length===0,n=e.description.short.value.trim().length===0,l=e.description.short.value.length>gt,a=e.description.long.value.length>dn,i=e.slots.length===0;return{titleMissing:t,descriptionShortMissing:n,descriptionShortTooLong:l,descriptionLongTooLong:a,slotMissing:i,hasErrors:t||n||l||a||i}}function br(e){const t=e.updateText.value.trim().length===0,n=e.updateText.value.length>un;return{missing:t,tooLong:n,hasErrors:t||n}}var fr=g("<h3>"),vr=g("<br>"),yr=g("<div style=margin-top:2rem;><h3 style=margin-bottom:1rem;></h3><ul class=event-list role=list>"),kr=g('<li><h3 class=event-title></h3><div class=event-details><div class=event-tags><strong>Status:</strong><!$><!/></div><div class=event-tags><strong>System:</strong><!$><!/></div><div class=event-tags><strong>Tag, Zeit:</strong><!$><!/></div><div class=event-tags><strong>Spielende:</strong> <!$><!/> - <!$><!/></div> <div class=event-tags><strong>Kategorien:</strong> <!$><!/></div></div><div class="event-description content"><p><strong>Kurzbeschreibung:</strong><br><!$><!/></p></div><ul role=list class=event-links><li><button class=event-link><span>Bearbeiten'),We=g("<em>"),xr=g("<span><!$><!/>, <!$><!/> - <!$><!/> Uhr");function pr(e){const[t,n]=D(e.store);function l(){const i=hr();n("games",t.games.length,i),e.changePage({kind:"EDIT_GAMEROUND",uuid:i.uuid})}const a=()=>e.store.games.flatMap(i=>i.slots.length===0?[{slot:null,game:i}]:i.slots.map(c=>({slot:c,game:i}))).toSorted((i,o)=>Hn(i.slot,o.slot));return[r(E,{get when(){return e.isEditable},get children(){return r(Ie,{icon:"grid-2-plus",type:"success",onClick:l,get children(){var i=d(fr);return s(i,()=>x.createNewGameRound),i}})}}),d(vr),r(Ut,{label:"Ich habe wenig bis keine Spielleitung-Erfahrung und mÃ¶chte gerne in der Vorbereitung und/oder wÃ¤hrend der Spielrunde unterstÃ¼tzt werden.",get checked(){return t.wantsHelp},name:"wantsHelp",value:"wantsHelp",onValueUpdate:i=>{n("wantsHelp",i)},get disabled(){return!e.isEditable}}),r(E,{get when(){return a()},children:i=>(()=>{var o=d(yr),c=o.firstChild,m=c.nextSibling;return s(c,()=>x.myGameRounds),s(m,r(W,{get each(){return i().filter(({game:h})=>h.kind!=="archived")},children:({game:h,slot:S})=>{const _=h.tagNames.map($=>Ge.find(({name:b})=>b===$)).filter($=>$!==void 0).map(({label:$})=>$);return r(Er,{game:h,slot:S,tags:_,get changePage(){return e.changePage}})}})),o})()})]}function Er(e){const{game:t,slot:n,tags:l,changePage:a}=e;return(()=>{var i=d(kr),o=i.firstChild,c=o.nextSibling,m=c.firstChild,h=m.firstChild,S=h.nextSibling,[_,$]=u(S.nextSibling),b=m.nextSibling,y=b.firstChild,k=y.nextSibling,[p,w]=u(k.nextSibling),N=b.nextSibling,P=N.firstChild,L=P.nextSibling,[Y,te]=u(L.nextSibling),U=N.nextSibling,V=U.firstChild,ne=V.nextSibling,K=ne.nextSibling,[B,Z]=u(K.nextSibling),z=B.nextSibling,ae=z.nextSibling,[oe,I]=u(ae.nextSibling),re=U.nextSibling,q=re.nextSibling,Q=q.firstChild,de=Q.nextSibling,M=de.nextSibling,[X,ue]=u(M.nextSibling),ce=c.nextSibling,ee=ce.firstChild,he=ee.firstChild,fe=he.nextSibling,Ee=fe.nextSibling,[Ce,$e]=u(Ee.nextSibling),ve=ce.nextSibling,_e=ve.firstChild,we=_e.firstChild;return s(o,(()=>{var A=O(()=>t.title.value.length>0);return()=>A()?t.title.value:(()=>{var ge=d(We);return s(ge,()=>x.missingTitle),ge})()})()),s(m,()=>x.publishingSteps[t.kind],_,$),s(b,()=>t.system.value||(()=>{var A=d(We);return s(A,()=>x.missingSystem),A})(),p,w),s(N,n!==null?(()=>{var A=d(xr),ge=A.firstChild,[Oe,He]=u(ge.nextSibling),Re=Oe.nextSibling,Ye=Re.nextSibling,[ye,mt]=u(Ye.nextSibling),ht=ye.nextSibling,$t=ht.nextSibling,[Be,St]=u($t.nextSibling);return Be.nextSibling,s(A,()=>x.days[n.day],Oe,He),s(A,()=>n.from,ye,mt),s(A,()=>n.to,Be,St),A})():(()=>{var A=d(We);return s(A,()=>x.missingSlot),A})(),Y,te),s(U,()=>t.playerCount.min.value,B,Z),s(U,()=>t.playerCount.max.value,oe,I),s(q,()=>l.join(", ")||(()=>{var A=d(We);return s(A,()=>x.missingTags),A})(),X,ue),s(ee,(()=>{var A=O(()=>t.description.short.value.length===0);return()=>A()?(()=>{var ge=d(We);return s(ge,()=>x.missingShortDescription),ge})():Qt(t.description.short.value,gt)})(),Ce,$e),we.$$click=()=>a({kind:"EDIT_GAMEROUND",uuid:t.uuid}),me(()=>Te(i,["event-entry",t.kind==="draft"?"gray":""].join(" "))),ot(),i})()}st(["click"]);var Cr=g("<div class=game-dialog><ul role=list style=display:grid;gap:0.5rem;><li><strong style=color:var(--clr-accent-1);>Spielleitung:</strong><br> <!$><!/></li><li><strong style=color:var(--clr-accent-1);>System:</strong><br><!$><!/></li><li><strong style=color:var(--clr-accent-1);>Tag, Zeit:</strong> <br><!$><!/>, <!$><!/> - <!$><!/> Uhr</li><li><strong style=color:var(--clr-accent-1);>Freie PlÃ¤tze:</strong><br><!$><!/> (von <!$><!/>)</li><li><strong style=color:var(--clr-accent-1);>Kategorien:</strong><br><!$><!/></li><li><strong style=color:var(--clr-accent-1);>Kurze Beschreibung:</strong><br><!$><!/></li><li><strong style=color:var(--clr-accent-1);>Lange Beschreibung:</strong><br><!$><!/></li></ul><div class=reservations><h5 style=margin-block-start:0>PlÃ¤tze reservieren</h5><div class=reservation-table>"),wr=g("<em>kein System angegeben"),Rr=g("<em>keine Kategorien"),Ar=g("<em>Keine lange Beschreibung angegeben."),Dr=g("<div class=count>"),Ur=g("<div class=reservation-table-entry><p>Reserviert fÃ¼r mich </p><!$><!/>"),Tr=g('<div class=reservation-table-entry><p>Reserviert fÃ¼r "<!$><!/>"</p><!$><!/>'),Or=g('<div style="display:grid;gap:1rem;grid-template-columns:max-content 1fr;"><!$><!/><!$><!/>'),Nr=g('<form style="display:grid;gap:0rem;grid-template-columns:1fr max-content"class=input-button><input type=text style=border-color:var(--clr-special-9);><!$><!/>');function Mr(e){const t=()=>e.reservations.filter(m=>m.gameRound===e.entry.uuid),n=Math.max(e.entry.playerCount.reserved+1-t.length,1),l=e.entry.tags.map(m=>Ge.find(({name:h})=>h===m)).filter(m=>m!==void 0).map(({label:m})=>m),a=e.entry.playerCount.max,i=()=>rn(a).map(m=>{const h=t()[m];return h!==void 0?h:m+1===a?{kind:"RESERVED_SPONTANIOUS"}:a-n<=m?{kind:"RESERVED_OTHER"}:{kind:"FREE"}}),o=()=>t().find(m=>m.kind==="SELF")!==void 0,c=()=>{const m=i().filter(S=>S.kind==="SELF"||S.kind==="FRIEND").length,h=e.entry.playerCount.max-1-e.entry.playerCount.reserved-m;return Math.max(h,0)};return(()=>{var m=d(Cr),h=m.firstChild,S=h.firstChild,_=S.firstChild,$=_.nextSibling,b=$.nextSibling,y=b.nextSibling,[k,p]=u(y.nextSibling),w=S.nextSibling,N=w.firstChild,P=N.nextSibling,L=P.nextSibling,[Y,te]=u(L.nextSibling),U=w.nextSibling,V=U.firstChild,ne=V.nextSibling,K=ne.nextSibling,B=K.nextSibling,[Z,z]=u(B.nextSibling),ae=Z.nextSibling,oe=ae.nextSibling,[I,re]=u(oe.nextSibling),q=I.nextSibling,Q=q.nextSibling,[de,M]=u(Q.nextSibling);de.nextSibling;var X=U.nextSibling,ue=X.firstChild,ce=ue.nextSibling,ee=ce.nextSibling,[he,fe]=u(ee.nextSibling),Ee=he.nextSibling,Ce=Ee.nextSibling,[$e,ve]=u(Ce.nextSibling);$e.nextSibling;var _e=X.nextSibling,we=_e.firstChild,A=we.nextSibling,ge=A.nextSibling,[Oe,He]=u(ge.nextSibling),Re=_e.nextSibling,Ye=Re.firstChild,ye=Ye.nextSibling,mt=ye.nextSibling,[ht,$t]=u(mt.nextSibling),Be=Re.nextSibling,St=Be.firstChild,bn=St.nextSibling,fn=bn.nextSibling,[vn,yn]=u(fn.nextSibling),kn=h.nextSibling,xn=kn.firstChild,pn=xn.nextSibling;return s(S,()=>e.entry.gamemaster,k,p),s(w,(()=>{var F=O(()=>e.entry.system.trim().length>0);return()=>F()?e.entry.system:d(wr)})(),Y,te),s(U,()=>x.days[e.entry.slot.day],Z,z),s(U,()=>e.entry.slot.from,I,re),s(U,()=>e.entry.slot.to,de,M),s(X,c,he,fe),s(X,()=>e.entry.playerCount.max-1,$e,ve),s(_e,(()=>{var F=O(()=>l.length>0);return()=>F()?l.join(", "):d(Rr)})(),Oe,He),s(Re,()=>e.entry.description.short,ht,$t),s(Be,(()=>{var F=O(()=>e.entry.description.long.trim().length>0);return()=>F()?O(()=>e.entry.description.long):d(Ar)})(),vn,yn),s(pn,r(W,{get each(){return i()},children:(F,En)=>[(()=>{var G=d(Dr);return s(G,()=>En()+1),G})(),r(Se,{get children(){return[r(R,{get when(){return F.kind==="RESERVED_OTHER"},get children(){return r(C,{children:"Bereits reserviert"})}}),r(R,{get when(){return F.kind==="RESERVED_SPONTANIOUS"},get children(){return r(C,{children:"Reserviert fÃ¼r spontane Spieler:innen"})}}),r(R,{get when(){return!e.isEditable},get children(){return r(C,{children:"Freier Platz"})}}),r(R,{get when(){return F.kind==="SELF"},get children(){return r(Mt,{type:"success",get children(){var G=d(Ur),Ae=G.firstChild,Ne=Ae.nextSibling,[ze,Me]=u(Ne.nextSibling);return s(G,r(Je,{icon:"trash",onClick:()=>e.removeReservation(F.kind==="SELF"?F.uuid:"should not happen")}),ze,Me),G}})}}),r(R,{get when(){return F.kind==="FRIEND"},get children(){return r(Mt,{type:"success",get children(){var G=d(Tr),Ae=G.firstChild,Ne=Ae.firstChild,ze=Ne.nextSibling,[Me,_t]=u(ze.nextSibling);Me.nextSibling;var bt=Ae.nextSibling,[ft,Cn]=u(bt.nextSibling);return s(Ae,()=>F.kind==="FRIEND"?F.name:"[Fehler beim Laden]",Me,_t),s(G,r(Je,{icon:"trash",onClick:()=>e.removeReservation(F.kind==="FRIEND"?F.uuid:"should not happen")}),ft,Cn),G}})}}),r(R,{get when(){return F.kind==="FREE"},get children(){return r(E,{get when(){return o()},get fallback(){return(()=>{var G=d(Or),Ae=G.firstChild,[Ne,ze]=u(Ae.nextSibling),Me=Ne.nextSibling,[_t,bt]=u(Me.nextSibling);return s(G,r(H,{icon:"person-to-portal",label:"Mich anmelden",kind:"success",onClick:()=>e.addReservation({kind:"SELF",gameRound:e.entry.uuid})}),Ne,ze),s(G,r(Gt,{addFriend:ft=>e.addReservation({kind:"FRIEND",gameRound:e.entry.uuid,name:ft})}),_t,bt),G})()},get children(){return r(Gt,{addFriend:G=>e.addReservation({kind:"FRIEND",gameRound:e.entry.uuid,name:G})})}})}})]}})]})),m})()}function Gt(e){const[t,n]=Dt("");return(()=>{var l=d(Nr),a=l.firstChild,i=a.nextSibling,[o,c]=u(i.nextSibling);return l.addEventListener("submit",m=>{m.preventDefault();const h=t();h.trim().length>0&&e.addFriend(h)}),lt(l,"novalidate",!0),a.$$input=m=>n(m.target.value),s(l,r(H,{icon:"arrow-right",type:"submit",label:"Begleitperson anmelden",kind:"special"}),o,c),me(()=>lt(a,"value",t())),ot(),l})()}st(["input"]);var Pr=g("<div style=display:flex;flex-wrap:wrap;gap:1rem;justify-content:space-between;><h5 style=margin:0;>Filter</h5><!$><!/>"),Ir=g("<h6 style=margin-block:0.5rem;>Tage"),Lr=g("<div style=display:flex;flex-wrap:wrap;gap:0.5rem;><!$><!/><!$><!/>"),Fr=g("<h6 style=margin-block:0.5rem;>Kategorien <span>"),Gr=g("<div style=display:flex;flex-wrap:wrap;gap:0.5rem;>");const se={day:"fDay",tags:"fTags",options:"fOpts"};function Hr(){const e=new URL(location.href),t=e.searchParams.get(se.day),n=t==="SATURDAY"||t==="SUNDAY"?t:null,l=e.searchParams.getAll(se.tags),a=e.searchParams.getAll(se.options);return{day:n,tags:l,withOpenSeats:a.includes("withOpenSeats"),iHaveTime:a.includes("iHaveTime")}}function Yr(e,t){return{toggleDay:n=>{const l=e.day===n,a=new URL(location.href);l?(a.searchParams.delete(se.day),t("day",null)):(a.searchParams.set(se.day,n),t("day",n)),history.pushState(Ze(e),"",a)},toggleTag:n=>{const l=e.tags.includes(n),a=new URL(location.href);l?(a.searchParams.delete(se.tags),t("tags",e.tags.filter(i=>i!==n)),e.tags.forEach(i=>{a.searchParams.append(se.tags,i)})):(a.searchParams.append(se.tags,n),t("tags",e.tags.length,n)),history.pushState(Ze(e),"",a)},toggleOption:n=>{const l=e[n],a=new URL(location.href);t(n,!l),["withOpenSeats","iHaveTime"].forEach(i=>{e[i]&&a.searchParams.append(se.options,i)}),history.pushState(Ze(e),"",a)},reset:()=>{t({day:null,tags:[],withOpenSeats:!1,iHaveTime:!1});const n=new URL(location.href);n.searchParams.delete(se.day),n.searchParams.delete(se.tags),n.searchParams.delete(se.options),history.pushState(Ze(e),"",n)}}}function Br(e){const[t,n]=D(e.activeFilter),l=Yr(t,n);return r(C,{get children(){return[(()=>{var a=d(Pr),i=a.firstChild,o=i.nextSibling,[c,m]=u(o.nextSibling);return s(a,r(H,{label:"Filter zurÃ¼cksetzen",icon:"circle-xmark",kind:"ghost-danger",onClick:()=>l.reset()}),c,m),a})(),d(Ir),(()=>{var a=d(Lr),i=a.firstChild,[o,c]=u(i.nextSibling),m=o.nextSibling,[h,S]=u(m.nextSibling);return s(a,r(j,{label:"Samstag",get kind(){return t.day!=="SUNDAY"?"success":"gray"},onClick:()=>l.toggleDay("SATURDAY")}),o,c),s(a,r(j,{label:"Sonntag",get kind(){return t.day!=="SATURDAY"?"success":"gray"},onClick:()=>l.toggleDay("SUNDAY")}),h,S),a})(),(()=>{var a=d(Fr),i=a.firstChild,o=i.nextSibling;return s(o,r(Je,{icon:"circle-question",kind:"ghost",title:"ErklÃ¤rungen der Kategorien",get onClick(){return e.showExplanationOfCategories}})),a})(),(()=>{var a=d(Gr);return s(a,r(W,{each:Ge,children:i=>r(j,{get label(){return i.label},get kind(){return t.tags.length===0||t.tags.includes(i.name)?"success":"gray"},onClick:()=>l.toggleTag(i.name)})})),a})()]}})}function zr(e,t){return e.filter(n=>!(t.day!==n.slot.day&&t.day!==null||!jr(n.tags,t.tags)))}function jr(e,t){return t.length===0?!0:t.filter(l=>!e.includes(l)).length===0}var Wr=g("<p>WIP"),De=g("<br>"),Kr=g("<ul style=padding:0;padding-block-start:1rem;margin:0;max-inline-size:100%;display:grid;gap:0.5rem;>"),Zr=g("<p>Diese Seite ist leider noch nicht bereit. Komm bitte spÃ¤ter nochmal zurÃ¼ck."),qr=g("<li><strong></strong><br><p>"),Jr=g("<p>Programm konnte nicht geladen werden."),Vr=g("<em><!$><!/> von <!$><!/> Runden gefunden."),Qr=g("<h3>"),Xr=g("<h4 style=margin-block-start:2rem;margin-block-end:1rem;>Start: <!$><!/> Uhr"),ei=g('<ul class="event-list max"role=list>'),ti=g("<small><!$><!/> - <!$><!/> Uhr"),ni=g("<h4 style=margin-block-end:0.5rem;>"),ri=g("<em>Das MenÃ¼ wird zu einem spÃ¤teren Zeitpunkt kommuniziert."),ii=g("<div style=margin-block-start:2rem;>"),li=g('<li><h3 class=event-title></h3><div class=event-details><div class=event-tags><strong>Spielleitung:</strong><!$><!/></div><div class=event-tags><strong>System:</strong><!$><!/></div><div class=event-tags><strong>Tag, Zeit:</strong><span><!$><!/>, <!$><!/> - <!$><!/> Uhr</span></div><div class=event-tags><strong>Freie PlÃ¤tze:</strong> <!$><!/> (von <!$><!/>)</div> <div class=event-tags><strong>Kategorien:</strong> <!$><!/></div></div><div class="event-description content"><p><strong>Kurzbeschreibung:</strong><br><!$><!/></p></div><ul role=list class=event-links><li><button class=event-link><span>Details & Teilnahme'),ai=g("<em>kein System angegeben"),si=g("<em>keine Kategorien");function oi(e){const[t,n]=D({playing:e.store,activeFilter:Hr(),categoryDialog:ke()});return r(Se,{get fallback(){return r(C,{type:"danger",get children(){return d(Zr)}})},get children(){return r(R,{get when(){return e.isDebugging},get children(){return[r(C,{type:"danger",get children(){return d(Wr)}}),d(De),r(Ut,{label:"Schickt mir bitte E-Mails, wenn neue Spielrunden verÃ¶ffentlicht werden.",get checked(){return t.playing.wantsUpdates},name:"wantsUpdates",value:"wantsUpdates",onValueUpdate:l=>{n("playing","wantsUpdates",l)}}),d(De),r(Br,{get activeFilter(){return t.activeFilter},showExplanationOfCategories:()=>n("categoryDialog","open",!0)}),r(pe,{get store(){return t.categoryDialog},title:"ErklÃ¤rungen der Kategorien",onClose:()=>{},size:"medium",get children(){var l=d(Kr);return s(l,()=>Ge.map(a=>(()=>{var i=d(qr),o=i.firstChild,c=o.nextSibling,m=c.nextSibling;return s(o,()=>a.label),s(m,()=>a.description),i})())),l}}),d(De),r(dt,{get fallback(){return r(C,{get children(){return x.loading.program}})},get children(){return r(E,{get when(){return e.program()},get fallback(){return r(C,{type:"danger",get children(){return x.error.program}})},children:l=>r(E,{get when(){return l().kind==="SUCCESS"},get fallback(){return r(C,{type:"danger",get children(){return d(Jr)}})},get children(){return r(di,{get program(){return l().data},get filter(){return t.activeFilter},get reservations(){return t.playing.reservations},get isEditable(){return e.isEditable},addReservation:a=>n("playing","reservations",t.playing.reservations.length,{...a,uuid:crypto.randomUUID()}),removeReservation:a=>{n("playing","reservations",t.playing.reservations.filter(i=>i.uuid!==a))},get uuid(){return e.uuid},get changePage(){return e.changePage}})}})})}})]}})}})}function di(e){const[t,n]=D(ke(e.uuid!==void 0));en(()=>{n("open",e.uuid!==null)});const l=()=>e.program.find(o=>o.uuid===e.uuid),a=()=>zr(e.program,e.filter),i=()=>gi(ci(a()));return[(()=>{var o=d(Vr),c=o.firstChild,[m,h]=u(c.nextSibling),S=m.nextSibling,_=S.nextSibling,[$,b]=u(_.nextSibling);return $.nextSibling,s(o,()=>a().length,m,h),s(o,()=>e.program.length,$,b),o})(),d(De),r(E,{get when(){return l()},children:o=>r(pe,{store:t,get title(){return o().title},onClose:()=>e.changePage({kind:"PLAYER"},{disableScroll:!0}),size:"large",get children(){return r(Mr,{get entry(){return o()},get reservations(){return e.reservations},get isEditable(){return e.isEditable},get addReservation(){return e.addReservation},get removeReservation(){return e.removeReservation}})}})}),d(De),r(Ht,{day:"SATURDAY",get programOfDay(){return i().SATURDAY},get changePage(){return e.changePage}}),d(De),d(De),r(Ht,{day:"SUNDAY",get programOfDay(){return i().SUNDAY},get changePage(){return e.changePage}})]}function Ht(e){const t=()=>Object.values(e.programOfDay).flat().length>0,l=Ue[e.day].breaks.map(i=>i.from),a=i=>l.indexOf(i)===0?"LUNCH":"DINNER";return[(()=>{var i=d(Qr);return s(i,()=>x.days[e.day]),i})(),r(E,{get when(){return t()},get fallback(){return r(C,{get children(){return["Keine Spielrunden mit den ausgewÃ¤hlten Filtern am"," ",O(()=>x.days[e.day])," gefunden."]}})},get children(){return r(W,{get each(){return Object.entries(e.programOfDay)},children:([i,o])=>l.includes(Number(i))?r(ui,{get type(){return a(Number(i))},get range(){return{from:Number(i),to:Number(i)-1}}}):o.length===0?null:[(()=>{var c=d(Xr),m=c.firstChild,h=m.nextSibling,[S,_]=u(h.nextSibling);return S.nextSibling,s(c,i,S,_),c})(),(()=>{var c=d(ei);return s(c,r(W,{each:o,children:m=>r(mi,{entry:m,get changePage(){return e.changePage}})})),c})()]})}})]}function ui(e){const t=e.type==="LUNCH"?"Mittagessen":"Nachtessen";return(()=>{var n=d(ii);return s(n,r(C,{get children(){return[(()=>{var l=d(ti),a=l.firstChild,[i,o]=u(a.nextSibling),c=i.nextSibling,m=c.nextSibling,[h,S]=u(m.nextSibling);return h.nextSibling,s(l,()=>e.range.from,i,o),s(l,()=>e.range.to,h,S),l})(),(()=>{var l=d(ni);return s(l,t),l})(),d(ri)]}})),n})()}function ci(e){const t=Object.groupBy(e,n=>n.slot.day);return{SATURDAY:t.SATURDAY??[],SUNDAY:t.SUNDAY??[]}}function gi(e){function t(o,c){const{from:m,to:h}=o.slot,{from:S,to:_}=c.slot;return m===S?h-_:m-S}const n=e.SATURDAY.toSorted(t),l=e.SUNDAY.toSorted(t),a=Ve(Ue.SATURDAY.open).reduce((o,c)=>(o[c]=n.filter(m=>m.slot.from===c),o),{}),i=Ve(Ue.SUNDAY.open).reduce((o,c)=>(o[c]=l.filter(m=>m.slot.from===c),o),{});return{SATURDAY:a,SUNDAY:i}}function mi(e){const t=Ge.filter(n=>e.entry.tags.includes(n.name)).map(({label:n})=>n);return(()=>{var n=d(li),l=n.firstChild,a=l.nextSibling,i=a.firstChild,o=i.firstChild,c=o.nextSibling,[m,h]=u(c.nextSibling),S=i.nextSibling,_=S.firstChild,$=_.nextSibling,[b,y]=u($.nextSibling),k=S.nextSibling,p=k.firstChild,w=p.nextSibling,N=w.firstChild,[P,L]=u(N.nextSibling),Y=P.nextSibling,te=Y.nextSibling,[U,V]=u(te.nextSibling),ne=U.nextSibling,K=ne.nextSibling,[B,Z]=u(K.nextSibling);B.nextSibling;var z=k.nextSibling,ae=z.firstChild,oe=ae.nextSibling,I=oe.nextSibling,[re,q]=u(I.nextSibling),Q=re.nextSibling,de=Q.nextSibling,[M,X]=u(de.nextSibling);M.nextSibling;var ue=z.nextSibling,ce=ue.nextSibling,ee=ce.firstChild,he=ee.nextSibling,fe=he.nextSibling,[Ee,Ce]=u(fe.nextSibling),$e=a.nextSibling,ve=$e.firstChild,_e=ve.firstChild,we=_e.nextSibling,A=we.nextSibling,[ge,Oe]=u(A.nextSibling),He=$e.nextSibling,Re=He.firstChild,Ye=Re.firstChild;return s(l,()=>e.entry.title),s(i,()=>e.entry.gamemaster,m,h),s(S,(()=>{var ye=O(()=>e.entry.system.trim().length>0);return()=>ye()?e.entry.system:d(ai)})(),b,y),s(w,()=>x.days[e.entry.slot.day],P,L),s(w,()=>e.entry.slot.from,U,V),s(w,()=>e.entry.slot.to,B,Z),s(z,()=>Math.max(e.entry.playerCount.max-1-e.entry.playerCount.reserved,0),re,q),s(z,()=>e.entry.playerCount.max-1,M,X),s(ce,(()=>{var ye=O(()=>t.length>0);return()=>ye()?t.join(", "):d(si)})(),Ee,Ce),s(ve,()=>Qt(e.entry.description.short,gt),ge,Oe),Ye.$$click=()=>e.changePage({kind:"GAME",uuid:e.entry.uuid},{disableScroll:!0}),me(()=>Te(n,["event-entry"].join(" "))),ot(),n})()}st(["click"]);var Yt=g("<h3>Spielrunden ansehen"),Bt=g("<p>Melde dich (und deine Freunde) fÃ¼r diverse Spielrunden an."),Et=g("<br>"),hi=g("<h3>Spielrunden erstellen"),$i=g("<p>Falls du wenig oder gar keine Erfahrung als Spielleiter:in hast, werden wir dich vor und wÃ¤hrend dem Anlass unterstÃ¼tzen."),Si=g("<h3>Helfen"),_i=g("<p>Beim Kiosk und der Essensausgabe kÃ¶nnen wir immer ein paar helfende HÃ¤nde gebrauchen."),zt=g("<p><strong>Noch nicht verfÃ¼gbar."),bi=g("<h3>Zusammenfassung"),fi=g("<p>Erhalte einen Ãberblick Ã¼ber dein gesamtes Programm.");function vi(e){return[r(Se,{get fallback(){return r(Ie,{type:"gray",icon:"dice-d20",onClick:()=>e.changePage({kind:"PLAYER"}),get children(){return[d(Yt),d(Bt),d(zt)]}})},get children(){return r(R,{get when(){return e.isDebugging},get children(){return r(Ie,{icon:"dice-d20",onClick:()=>e.changePage({kind:"PLAYER"}),get children(){return[d(Yt),d(Bt)]}})}})}}),d(Et),r(Ie,{icon:"grid-2-plus",onClick:()=>e.changePage({kind:"GAMEMASTER"}),get children(){return[d(hi),d($i)]}}),d(Et),r(Ie,{type:"gray",icon:"hand-heart",onClick:()=>e.changePage({kind:"HELPING"}),get children(){return[d(Si),d(_i),d(zt)]}}),d(Et),r(Ie,{icon:"list",onClick:()=>e.changePage({kind:"SUMMARY"}),get children(){return[d(bi),d(fi)]}})]}var yi=g("<fieldset><legend>Zeitslots</legend><!$><!/><!$><!/>"),jt=g("<br>"),ki=g("<div style=margin-block-end:0.5rem;>Zeitslot: <!$><!/>, <!$><!/> -<!$><!/> Uhr"),xi=g("<ul class=event-list role=list>"),pi=g("<em>werden geladen..."),Ei=g("<li class=event-entry><h3 class=event-title><!$><!/>, <!$><!/> - <!$><!/> Uhr</h3><div class=event-details><div class=event-tags><strong>Dauer:</strong><!$><!/> <!$><!/></div><div class=event-tags><strong>Spielende:</strong> <!$><!/></div></div><div></div><ul role=list class=event-links>"),Ci=g("<em>Fehler beim Laden."),wi=g("<em>noch keine Anmeldungen"),Ri=g("<li><em style=font-size:smaller;>Aktionen werden geladen..."),Wt=g("<li><em style=font-size:smaller;>kann nicht gelÃ¶scht werden"),Ai=g("<li><button type=button class=event-link><div style=display:flex;gap:0.25rem;align-items:center;><!$><!/><span>LÃ¶schen"),Di=g("<div style=display:grid;gap:0.5rem;>"),Ui=g("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/>"),Ti=g("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/><!$><!/>"),Oi=g("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/><!$><!/><div style=margin-block-start:1rem;>"),Ni=g("<div style=display:flex;flex-wrap:wrap;gap:0.5rem;align-items:center;><!$><!/> <span>Neuen Slot erfassen"),Mi=g("<em>WÃ¤hle eine Tag:"),Pi=g("<div style=display:flex;flex-wrap:wrap;gap:.5rem;><!$><!/><!$><!/>"),Ii=g("<em>WÃ¤hle eine Startzeit:"),cn=g("<div style=display:flex;flex-wrap:wrap;gap:.5rem;>"),gn=g("<span style=white-space:nowrap;><!$><!/> Uhr"),Li=g("<em>WÃ¤hle eine Endzeit:");function Fi(e){return(()=>{var t=d(yi),n=t.firstChild,l=n.nextSibling,[a,i]=u(l.nextSibling),o=a.nextSibling,[c,m]=u(o.nextSibling);return s(t,r(Hi,{get store(){return e.store},get registrations(){return e.registrations},get isEditable(){return e.isEditable}}),a,i),s(t,r(E,{get when(){return e.slotMissing},get children(){return r(C,{type:"danger",children:"WÃ¤hle mindestens einen Zeitslot aus."})}}),c,m),t})()}const Kt=1;function Gi(e){function t(n){const l=Ve(n.open,!0);return n.breaks.map(i=>Ve(i,!0)).reduce((i,o)=>{const c=o.at(0),m=o.at(-1);if(c===void 0||m===void 0)return i;const h=[];return i.forEach(S=>{const _=[],$=[];S.forEach(b=>{b<=c&&_.push(b),m<=b&&$.push(b)}),_.length>0&&h.push(_),$.length>0&&h.push($)}),h},[l]).map(i=>{const o=i.slice(0,Kt*-1);return Dn(o.map(c=>{const m=i.filter(h=>h>=c+Kt);return[c,m]}))}).reduce((i,o)=>({...i,...o}),{})}return{SATURDAY:t(e.SATURDAY),SUNDAY:t(e.SUNDAY)}}function Hi(e){const[t,n]=D(e.store),[l,a]=D({dialog:ke()}),i=at(()=>Gi(Ue));function o(h){n(t.concat(h))}function c(h){a("dialog","open",!1),a("slot",void 0),n(t.filter(S=>S.uuid!==h))}function m(h){a("dialog","open",!0),a("slot",t.find(S=>S.uuid===h))}return[r(Bi,{get daySections(){return i()},chooseTimeSlot:o,get isEditable(){return e.isEditable}}),d(jt),d(jt),r(pe,{get store(){return l.dialog},title:"Zeitslot lÃ¶schen",onClose:()=>a("slot",void 0),get children(){return[(()=>{var h=d(ki),S=h.firstChild,_=S.nextSibling,[$,b]=u(_.nextSibling),y=$.nextSibling,k=y.nextSibling,[p,w]=u(k.nextSibling),N=p.nextSibling,P=N.nextSibling,[L,Y]=u(P.nextSibling);return L.nextSibling,s(h,()=>x.days[l.slot?.day],$,b),s(h,()=>l.slot?.from,p,w),s(h,()=>l.slot?.to,L,Y),h})(),r(H,{kind:"danger",icon:"trash",label:"LÃ¶schen",onClick:()=>c(l.slot?.uuid)})]}}),r(Yi,{slots:t,get registrations(){return e.registrations},confirmRemoval:m,get isEditable(){return e.isEditable}})]}function Yi(e){return(()=>{var t=d(xi);return s(t,r(W,{get each(){return zi(e.slots)},children:n=>(()=>{var l=d(Ei),a=l.firstChild,i=a.firstChild,[o,c]=u(i.nextSibling),m=o.nextSibling,h=m.nextSibling,[S,_]=u(h.nextSibling),$=S.nextSibling,b=$.nextSibling,[y,k]=u(b.nextSibling);y.nextSibling;var p=a.nextSibling,w=p.firstChild,N=w.firstChild,P=N.nextSibling,[L,Y]=u(P.nextSibling),te=L.nextSibling,U=te.nextSibling,[V,ne]=u(U.nextSibling),K=w.nextSibling,B=K.firstChild,Z=B.nextSibling,z=Z.nextSibling,[ae,oe]=u(z.nextSibling),I=p.nextSibling,re=I.nextSibling;return s(a,()=>x.days[n.day],o,c),s(a,()=>n.from,S,_),s(a,()=>n.to,y,k),s(w,()=>n.to-n.from,L,Y),s(w,()=>n.to-n.from>1?"Stunden":"Stunde",V,ne),s(K,r(Se,{get children(){return[r(R,{get when(){return e.registrations.loading},get children(){return d(pi)}}),r(R,{get when(){return e.registrations()},children:q=>{const Q=q();if(Q.kind==="FAILURE")return d(Ci);const de=Q.data.filter(M=>M.uuid===n.uuid).map(M=>M.name);return O(()=>de.join(", ")||d(wi))}})]}}),ae,oe),s(re,r(dt,{get fallback(){return d(Ri)},get children(){return r(E,{get when(){return e.registrations()},children:q=>{const Q=q();return Q.kind==="FAILURE"?d(Wt):Q.data.filter(M=>M.uuid===n.uuid).map(M=>M.name).length>0?d(Wt):(()=>{var M=d(Ai),X=M.firstChild,ue=X.firstChild,ce=ue.firstChild,[ee,he]=u(ce.nextSibling);return ee.nextSibling,X.$$click=()=>e.confirmRemoval(n.uuid),s(ue,r(ie,{icon:"trash"}),ee,he),me(()=>lt(X,"disabled",!e.isEditable)),ot(),M})()}})}})),l})()})),t})()}function Bi(e){const[t,n]=D({slot:{kind:"CHOOSE_DAY"},dialog:ke()});function l(){n("slot",{kind:"CHOOSE_DAY"}),n("dialog","open",!1)}function a(i){e.chooseTimeSlot(i),l()}return[r(j,{kind:"success",get label(){return(()=>{var i=d(Ni),o=i.firstChild,[c,m]=u(o.nextSibling);return c.nextSibling,s(i,r(ie,{icon:"circle-plus"}),c,m),i})()},onClick:()=>n("dialog","open",!0),get disabled(){return!e.isEditable}}),r(pe,{title:"Zeitslot erfassen",get store(){return t.dialog},size:"medium",onClose:l,get children(){return r(Se,{get children(){return[r(R,{get when(){return t.slot.kind==="CHOOSE_DAY"},get children(){var i=d(Di);return s(i,r(nt,{changeDay:o=>n("slot",{kind:"CHOOSE_START",day:o})})),i}}),r(R,{get when(){return t.slot.kind==="CHOOSE_START"},get children(){var i=d(Ui),o=i.firstChild,[c,m]=u(o.nextSibling),h=c.nextSibling,[S,_]=u(h.nextSibling);return s(i,r(nt,{get chosenDay(){return t.slot.kind==="CHOOSE_START"?t.slot.day:void 0},changeDay:$=>n("slot",{kind:"CHOOSE_START",day:$})}),c,m),s(i,r(Ct,{get startTimes(){return O(()=>t.slot.kind==="CHOOSE_START")()?yt(e.daySections[t.slot.day]):[]},changeStart:$=>n("slot",{kind:"CHOOSE_END",start:$})}),S,_),i}}),r(R,{get when(){return t.slot.kind==="CHOOSE_END"},get children(){var i=d(Ti),o=i.firstChild,[c,m]=u(o.nextSibling),h=c.nextSibling,[S,_]=u(h.nextSibling),$=S.nextSibling,[b,y]=u($.nextSibling);return s(i,r(nt,{get chosenDay(){return t.slot.kind==="CHOOSE_END"?t.slot.day:void 0},changeDay:k=>n("slot",{kind:"CHOOSE_START",day:k})}),c,m),s(i,r(Ct,{get chosenStart(){return t.slot.kind==="CHOOSE_END"?t.slot.start:void 0},get startTimes(){return O(()=>t.slot.kind==="CHOOSE_END")()?yt(e.daySections[t.slot.day]):[]},changeStart:k=>n("slot",{kind:"CHOOSE_END",start:k})}),S,_),s(i,r(Zt,{get endTimes(){return t.slot.kind==="CHOOSE_END"?e.daySections[t.slot.day][t.slot.start]??[]:[]},changeEnd:k=>{t.slot.kind==="CHOOSE_END"&&n("slot",{kind:"WAIT_FOR_CONFIRMATION",day:t.slot.day,start:t.slot.start,end:k})}}),b,y),i}}),r(R,{get when(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"},get children(){var i=d(Oi),o=i.firstChild,[c,m]=u(o.nextSibling),h=c.nextSibling,[S,_]=u(h.nextSibling),$=S.nextSibling,[b,y]=u($.nextSibling),k=b.nextSibling;return s(i,r(nt,{get chosenDay(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?t.slot.day:void 0},changeDay:p=>n("slot",{kind:"CHOOSE_START",day:p})}),c,m),s(i,r(Ct,{get chosenStart(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?t.slot.start:void 0},get startTimes(){return O(()=>t.slot.kind==="WAIT_FOR_CONFIRMATION")()?yt(e.daySections[t.slot.day]):[]},changeStart:p=>n("slot",{kind:"CHOOSE_END",start:p})}),S,_),s(i,r(Zt,{get chosenEnd(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?t.slot.end:void 0},get endTimes(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?e.daySections[t.slot.day][t.slot.start]??[]:[]},changeEnd:p=>{t.slot.kind==="WAIT_FOR_CONFIRMATION"&&n("slot",{kind:"WAIT_FOR_CONFIRMATION",day:t.slot.day,start:t.slot.start,end:p})}}),b,y),s(k,r(j,{get label(){return`Slot "${t.slot.kind==="WAIT_FOR_CONFIRMATION"?`${x.days[t.slot.day]}, von ${t.slot.start} bis ${t.slot.end} Uhr`:""}" erstellen`},kind:"success",onClick:()=>{t.slot.kind==="WAIT_FOR_CONFIRMATION"&&a({uuid:crypto.randomUUID(),day:t.slot.day,from:t.slot.start,to:t.slot.end})}})),i}})]}})}})]}function nt(e){return[d(Mi),(()=>{var t=d(Pi),n=t.firstChild,[l,a]=u(n.nextSibling),i=l.nextSibling,[o,c]=u(i.nextSibling);return s(t,r(j,{get kind(){return e.chosenDay==="SATURDAY"?"success":"gray"},label:"Samstag",onClick:()=>e.changeDay("SATURDAY")}),l,a),s(t,r(j,{get kind(){return e.chosenDay==="SUNDAY"?"success":"gray"},label:"Sonntag",onClick:()=>e.changeDay("SUNDAY")}),o,c),t})()]}function Ct(e){return[d(Ii),(()=>{var t=d(cn);return s(t,r(W,{get each(){return e.startTimes},children:n=>r(j,{get kind(){return e.chosenStart===n?"success":"gray"},get label(){return(()=>{var l=d(gn),a=l.firstChild,[i,o]=u(a.nextSibling);return i.nextSibling,s(l,n,i,o),l})()},onClick:()=>e.changeStart(n)})})),t})()]}function Zt(e){return[d(Li),(()=>{var t=d(cn);return s(t,r(W,{get each(){return e.endTimes},children:n=>r(j,{get kind(){return e.chosenEnd===n?"success":"gray"},get label(){return(()=>{var l=d(gn),a=l.firstChild,[i,o]=u(a.nextSibling);return i.nextSibling,s(l,n,i,o),l})()},onClick:()=>e.changeEnd(n)})})),t})()]}function zi(e){return e.toSorted((t,n)=>t.day!==n.day?t.day==="SATURDAY"?-1:1:t.from-n.from)}st(["click"]);const ji={version:1,init:{name:"",email:"",mobile:""},lastSaved:new Date().toISOString(),playing:{wantsUpdates:!0,reservations:[]},master:{games:[],wantsHelp:!1},helping:{},publishState:"draft"};async function Wi(e){const t=new URL(Fe("/rst25/load"));t.searchParams.append("secret",e);const n=await fetch(t);if(!n.ok)return{kind:"FAILURE"};const l=await n.json();return typeof l=="object"&&l!==null?{kind:"SUCCESS",data:Object.assign(ji,l)}:(console.error("`last_save` not found on ",l),{kind:"FAILURE"})}async function Ki(e,t){try{const n=await fetch(Fe("/rst25/save"),{method:"post",body:JSON.stringify({secret:t,save:e}),headers:{"Content-Type":"application/json"}});return n.ok?{kind:"SUCCESS",data:t}:(console.error(await n.text()),{kind:"FAILURE"})}catch(n){return console.error(n),{kind:"FAILURE"}}}async function Zi(e){try{const t=new URL(Fe("/rst25/program"));t.searchParams.append("secret",e);const n=await fetch(t,{headers:{"Content-Type":"application/json"}});return n.ok?{kind:"SUCCESS",data:await n.json()}:(console.error(await n.text()),{kind:"FAILURE"})}catch(t){return console.error(t),{kind:"FAILURE"}}}async function qi(e){try{const t=new URL(Fe("/rst25/reservations"));t.searchParams.append("secret",e);const n=await fetch(t);return n.ok?{kind:"SUCCESS",data:await n.json()}:(console.error(await n.text()),{kind:"FAILURE"})}catch(t){return console.error(t),{kind:"FAILURE"}}}async function Ji(e){try{const t=await fetch(Fe("/rst25/publishGameround"),{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});return t.ok?{kind:"SUCCESS",data:e.gameroundUuid}:(console.error(await t.text()),{kind:"FAILURE"})}catch(t){return console.error(t),{kind:"FAILURE"}}}async function Vi(e){try{const t=await fetch(Fe("/rst25/sendGameroundUpdate"),{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});return t.ok?{kind:"SUCCESS",data:e.gameroundUuid}:(console.error(await t.text()),{kind:"FAILURE"})}catch(t){return console.error(t),{kind:"FAILURE"}}}function Qi(e){return async()=>{await Ji(e)}}function Xi(e){return async()=>{await Vi(e)}}var Qe=g("<br>"),el=g("<div class=content><p>MÃ¶chtest du diese Spielrunde gerne verÃ¶ffentlichen?</p><!$><!/>"),tl=g("<em>Informationen zu den Anmeldungen mÃ¼ssen geladen werden..."),nl=g("<em>Du kannst kein Update versenden, da sich noch niemand fÃ¼r diese Spielrunde angemeldet hat."),rl=g("<p>An: <!$><!/>"),il=g("<em>Du kannst die Spielrunde nur lÃ¶schen, wenn du zuerst alle Zeitslots entfernt hast."),ll=g("<div class=content><p>Bist du sicher, dass du die Spielrunde lÃ¶schen mÃ¶chtest?</p><!$><!/>"),al=g('<form novalidate><!$><!/><!$><!/><!$><!/><div style="display:grid;grid-template-columns:repeat(2, 1fr);gap:1rem;"><!$><!/><!$><!/></div><!$><!/><!$><!/><!$><!/><fieldset><legend>Kategorien (optional)</legend><!$><!/></fieldset><!$><!/><div style=display:flex;flex-wrap:wrap;gap:1rem;justify-content:space-between;><!$><!/><div style=display:flex;flex-wrap:wrap;gap:1rem;><!$><!/><!$><!/><!$><!/>'),sl=g("<h4>Spielrunde inkomplett"),ol=g("<p>Du hast noch einen oder mehre Fehler/fehlende Informationen in dieser Spielrunde:"),dl=g("<li>Â«TitelÂ» ist ein Pflichtfeld."),ul=g("<li>Â«kurz BeschreibungÂ» ist ein Pflichtfeld."),cl=g("<li>Â«kurz BeschreibungÂ» ist zu lang."),gl=g("<li>Â«lange BeschreibungÂ» ist zu lang."),ml=g("<li>Mindest einen Zeitslot muss ausgewÃ¤hlt werden."),hl=g("<ul><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),$l=g("<p><strong>ErklÃ¤rung:</strong> Hast du eine wichtige Ãnderung an dieser Spielrunde durchgefÃ¼hrt, wÃ¤hrend bereits Spielende angemeldet waren? Lass hiermit die Angemeldeten wissen, was du geÃ¤ndert hast. Wichtige Ãnderungen kÃ¶nnen sein: System geÃ¤ndert, Kategorien geÃ¤ndert. FÃ¼r kleine Ãnderungen, wie z.B. Rechtschreibfehler, sollte dies nicht genutzt werden."),Sl=g("<p><em>Halte dich kurz und am besten Stichwortartig."),_l=g("<form><!$><!/><!$><!/>"),bl=g("<div style=display:grid;gap:0.5rem;margin-block-end:1rem;>");function fl(e){const t=e.allRounds.find(n=>n.uuid===e.uuid);return r(E,{get fallback(){return e.fallback},when:t,children:n=>e.children(n())})}function vl(e){const[t,n]=D(e.store),[l,a]=D({delete:ke(),publish:ke(),sendUpdate:ke()});function i(c){c.preventDefault(),a("publish","open",!0)}function o(){e.changePage({kind:"GAMEMASTER"})}return[r(ln,{kind:"special",get children(){return["Status: ",O(()=>x.publishingSteps[t.kind])]}}),d(Qe),d(Qe),r(pl,{store:t,get registrations(){return e.registrations},onSubmit:i,onCancel:()=>a("delete","open",!0),onSendUpdate:()=>a("sendUpdate","open",!0),goBack:o,get isEditable(){return e.isEditable}}),r(yl,{get store(){return l.publish},get title(){return t.title.value},onPublish:()=>{n("kind","published"),a("publish","open",!1),e.queue.enqueue(Qi({secret:e.secret,gameroundUuid:t.uuid}))}}),r(kl,{get store(){return l.sendUpdate},get players(){return wl(e.registrations,t.slots.map(c=>c.uuid))},onSend:c=>{e.queue.enqueue(Xi({update:c,slotUuids:t.slots.map(m=>m.uuid),gameroundUuid:t.uuid}))}}),r(xl,{get store(){return l.delete},get hasSlots(){return t.slots.length!==0},get title(){return t.title.value},onDelete:()=>{n("kind","archived"),e.changePage({kind:"GAMEMASTER"})}})]}function yl(e){return r(pe,{get store(){return e.store},title:"Spielrunde verÃ¶ffentlichen",onClose:()=>{},get children(){var t=d(el),n=t.firstChild,l=n.nextSibling,[a,i]=u(l.nextSibling);return s(t,r(H,{kind:"success",icon:"circle-plus",get label(){return`Ja, bitte "${e.title||"["+x.missingTitle+"]"}" verÃ¶ffentlichen.`},get onClick(){return e.onPublish}}),a,i),t}})}function kl(e){return r(pe,{get store(){return e.store},title:"Update senden",onClose:()=>{},size:"medium",get children(){return()=>e.players.kind==="LOADING"?d(tl):e.players.kind==="ERROR"?O(()=>x.error.general):e.players.data.length===0?d(nl):[(()=>{var t=d(rl),n=t.firstChild,l=n.nextSibling,[a,i]=u(l.nextSibling);return s(t,()=>e.players.data.map(o=>o.name).join(", "),a,i),t})(),d(Qe),r(El,{get onSend(){return e.onSend}})]}})}function xl(e){return r(pe,{get store(){return e.store},title:"Spielrunde lÃ¶schen",onClose:()=>{},get children(){return[r(E,{get when(){return e.hasSlots},get children(){return d(il)}}),r(E,{get when(){return!e.hasSlots},get children(){var t=d(ll),n=t.firstChild,l=n.nextSibling,[a,i]=u(l.nextSibling);return s(t,r(H,{kind:"danger",icon:"trash",get label(){return`Ja, bitte "${e.title||"["+x.missingTitle+"]"}" lÃ¶schen.`},get onClick(){return e.onDelete}}),a,i),t}})]}})}function pl(e){const[t]=D(e.store),n=at(()=>_r(t));return(()=>{var l=d(al),a=l.firstChild,[i,o]=u(a.nextSibling),c=i.nextSibling,[m,h]=u(c.nextSibling),S=m.nextSibling,[_,$]=u(S.nextSibling),b=_.nextSibling,y=b.firstChild,[k,p]=u(y.nextSibling),w=k.nextSibling,[N,P]=u(w.nextSibling),L=b.nextSibling,[Y,te]=u(L.nextSibling),U=Y.nextSibling,[V,ne]=u(U.nextSibling),K=V.nextSibling,[B,Z]=u(K.nextSibling),z=B.nextSibling,ae=z.firstChild,oe=ae.nextSibling,[I,re]=u(oe.nextSibling),q=z.nextSibling,[Q,de]=u(q.nextSibling),M=Q.nextSibling,X=M.firstChild,[ue,ce]=u(X.nextSibling),ee=ue.nextSibling,he=ee.firstChild,[fe,Ee]=u(he.nextSibling),Ce=fe.nextSibling,[$e,ve]=u(Ce.nextSibling),_e=$e.nextSibling,[we,A]=u(_e.nextSibling);return s(l,r(E,{get when(){return t.kind==="published"},get children(){return r(qt,{get errors(){return n()}})}}),i,o),s(l,r(qe,{get store(){return t.title},label:"Titel",name:"title",get showErrors(){return t.kind==="published"?"ALWAYS":"ON_BLUR"},get errors(){return n().titleMissing?[x.mandatoryField]:[]},get disabled(){return!e.isEditable}}),m,h),s(l,r(qe,{get store(){return t.system},label:"System (optional)",name:"System",get disabled(){return!e.isEditable}}),_,$),s(b,r(Pt,{get store(){return t.playerCount.min},label:"Anzahl Mitspielende (Minimum)",name:"playerCountMin",min:1,get max(){return t.playerCount.max.value},get disabled(){return!e.isEditable}}),k,p),s(b,r(Pt,{get store(){return t.playerCount.max},label:"Anzahl Mitspielende (Maximum)",name:"playerCountMax",get min(){return t.playerCount.min.value},get disabled(){return!e.isEditable}}),N,P),s(l,r(Rt,{get store(){return t.description.short},label:"kurze Beschreibung",name:"descriptionShort",size:"small",get showErrors(){return t.kind==="published"?"ALWAYS":"ON_BLUR"},get errors(){return O(()=>!!n().descriptionShortMissing)()?[x.mandatoryField]:O(()=>!!n().descriptionShortTooLong)()?[x.charLimitBy.replace("{}",String(gt))]:[]},get disabled(){return!e.isEditable}}),Y,te),s(l,r(Rt,{get store(){return t.description.long},label:"lange Beschreibung (optional)",name:"descriptionLong",get showErrors(){return t.kind==="published"?"ALWAYS":"ON_BLUR"},get errors(){return O(()=>!!n().descriptionLongTooLong)()?[x.charLimitBy.replace("{}",String(dn))]:[]},get disabled(){return!e.isEditable}}),V,ne),s(l,r(Fi,{get store(){return e.store.slots},get registrations(){return e.registrations},get slotMissing(){return n().slotMissing},get isEditable(){return e.isEditable}}),B,Z),s(z,r(Cl,{get store(){return t.tagNames},get isEditable(){return e.isEditable}}),I,re),s(l,r(qt,{get errors(){return n()}}),Q,de),s(M,r(H,{icon:"backward",label:"ZurÃ¼ck zu deinen Spielrunden",get onClick(){return e.goBack}}),ue,ce),s(ee,r(E,{get when(){return t.kind!=="archived"},get children(){return r(H,{icon:"trash",kind:"danger",label:"LÃ¶schen",onClick:()=>e.onCancel(),get disabled(){return!e.isEditable}})}}),fe,Ee),s(ee,r(E,{get when(){return t.kind==="draft"},get children(){return r(H,{icon:"circle-plus",get kind(){return n().hasErrors?"gray":"success"},get disabled(){return n().hasErrors||!e.isEditable},label:"Spielrunde verÃ¶ffentlichen",get onClick(){return n().hasErrors?void 0:e.onSubmit}})}}),$e,ve),s(ee,r(E,{get when(){return t.kind==="published"},get children(){return r(H,{icon:"circle-plus",kind:"success",label:"Update an Spielende schicken",get onClick(){return e.onSendUpdate},get disabled(){return!e.isEditable}})}}),we,A),l})()}function qt(e){return r(E,{get when(){return e.errors.hasErrors},get children(){return r(C,{type:"danger",get children(){return[d(sl),d(ol),(()=>{var t=d(hl),n=t.firstChild,[l,a]=u(n.nextSibling),i=l.nextSibling,[o,c]=u(i.nextSibling),m=o.nextSibling,[h,S]=u(m.nextSibling),_=h.nextSibling,[$,b]=u(_.nextSibling),y=$.nextSibling,[k,p]=u(y.nextSibling);return s(t,r(E,{get when(){return e.errors.titleMissing},get children(){return d(dl)}}),l,a),s(t,r(E,{get when(){return e.errors.descriptionShortMissing},get children(){return d(ul)}}),o,c),s(t,r(E,{get when(){return e.errors.descriptionShortTooLong},get children(){return d(cl)}}),h,S),s(t,r(E,{get when(){return e.errors.descriptionLongTooLong},get children(){return d(gl)}}),$,b),s(t,r(E,{get when(){return e.errors.slotMissing},get children(){return d(ml)}}),k,p),t})()]}})}})}function El(e){const[t,n]=D({updateText:{value:"",isDirty:!1},hasBeenSent:!1}),l=at(()=>br(t));return r(Se,{get fallback(){return r(C,{type:"success",children:"Nachricht wurde registriert und wird in den nÃ¤chsten 24 Stunden an die Spielenden verschickt."})},get children(){return r(R,{get when(){return!t.hasBeenSent},get children(){return[d($l),d(Qe),d(Sl),d(Qe),(()=>{var a=d(_l),i=a.firstChild,[o,c]=u(i.nextSibling),m=o.nextSibling,[h,S]=u(m.nextSibling);return lt(a,"novalidate",!0),s(a,r(Rt,{get store(){return t.updateText},label:"Zusammenfassung der Ãnderung",name:"updateText",size:"small",showErrors:"ALWAYS",get errors(){return O(()=>!!l().missing)()?[x.mandatoryField]:O(()=>!!l().tooLong)()?[x.charLimitBy.replace("{}",String(un))]:[]}}),o,c),s(a,r(H,{icon:"paper-plane",label:"Spielende informieren",get kind(){return l().hasErrors?"gray":"success"},get disabled(){return l().hasErrors},get onClick(){return l().hasErrors?void 0:()=>{e.onSend(t.updateText.value),n("hasBeenSent",!0)}}}),h,S),a})()]}})}})}function Cl(e){const[t,n]=D(e.store);return[(()=>{var l=d(bl);return s(l,r(W,{each:Ge,children:a=>r(Ut,{get label(){return a.label},get description(){return a.description},get checked(){return t.includes(a.name)},get name(){return a.name},get value(){return a.name},onValueUpdate:i=>{n(i?t.concat([a.name]):t.filter(o=>o!==a.name))},get disabled(){return!e.isEditable}})})),l})(),r(C,{get children(){return x.tagIdeas}})]}const wl=(e,t)=>{if(e.loading)return{kind:"LOADING"};if(e.error)return{kind:"ERROR"};const n=e();return n===void 0||n.kind==="FAILURE"?{kind:"ERROR"}:{kind:"SUCCESS",data:n.data.filter(l=>t.includes(l.uuid))}},Rl=nn("kind",[v({kind:T("CHOOSE"),uuid:je()}),v({kind:T("PLAYER"),uuid:je()}),v({kind:T("GAME"),uuid:f().uuid()}),v({kind:T("GAMEMASTER"),uuid:je()}),v({kind:T("HELPING"),uuid:je()}),v({kind:T("SUMMARY"),uuid:je()}),v({kind:T("EDIT_GAMEROUND"),uuid:f().uuid()})]);nn("kind",[v({kind:T("CHOOSE")}),v({kind:T("PLAYER")}),v({kind:T("GAME"),uuid:f().uuid()}),v({kind:T("GAMEMASTER")}),v({kind:T("HELPING")}),v({kind:T("SUMMARY")}),v({kind:T("EDIT_GAMEROUND"),uuid:f().uuid()})]);const Al=ut(["SAVING","IDLE","ERROR"]),Dl=v({saveState:Al,page:Rl,secret:f(),showCreateMessage:Le(),isDebugging:Le()});function mn(e){const t=e.searchParams.get("page")??"",n=e.searchParams.get("uuid")??null,l=e.searchParams.get("secret")??"",a=e.searchParams.get("showCreateMessage")==="true",i=e.searchParams.get("debug")==="true",o=Dl.safeParse({saveState:"IDLE",page:{kind:t.toUpperCase(),uuid:n},secret:l,showCreateMessage:a,isDebugging:i});return o.success?o.data:{saveState:"IDLE",page:{kind:"CHOOSE",uuid:null},secret:l,showCreateMessage:a,isDebugging:i}}function Ul(e,t){return e.kind!==t.kind?!1:e.kind==="EDIT_GAMEROUND"&&t.kind==="EDIT_GAMEROUND"||e.kind==="GAME"&&t.kind==="GAME"?e.uuid===t.uuid:!0}const Tl="2024-08-15T07:45:21.335Z",be={game:"37831e19-29d6-40bd-b99d-fb91b78aa7f9",slot:"bfcbd156-b703-4664-9944-8936aede8476",slot2:"f58e7242-e1ff-4cfc-a992-ca18dd5207c3",program:"16f387ab-0adf-406b-ba5c-2e4eb200fda8",program2:"11b6b38a-a4d3-40ed-9d4a-d2abcab661a5",program3:"5294bc63-4857-404e-b72d-53ecbd87a27b",program4:"6e9477f1-6dd5-4cd7-b3c3-03085022d967"};function Ol(e,t){const n=localStorage.getItem(e);return n===null?t:n}function Nl(e,t){localStorage.setItem(e,t)}const hn="SAVE",Ml={version:1,init:{name:"John Doe",email:"john@doe.ch",mobile:"+41 66 123 45 67"},lastSaved:Tl,playing:{wantsUpdates:!1,reservations:[]},master:{games:[{uuid:be.game,kind:"published",title:"Grolle in der Dunkelheit",system:"Warhammer Fantasy Rollenspiel",description:{short:"Ein kurzes Abenteuer bei dem es um Fantasy, Action und einfaches Rollenspiel geht.",long:"Eine kleine Gruppe wagt sich in die dunklen SchÃ¤chten einer Mine und weiter hinab, um einen mÃ¤chtigen Gegenstand wieder zu erlangen. Wie werden die GefÃ¤hrten auf die Gefahren des Untergrundes reagieren und welche Gefahren lauern in der Finsternis?"},slots:[{uuid:be.slot,day:"SATURDAY",from:10,to:12},{uuid:be.slot2,day:"SUNDAY",from:14,to:17}],playerCount:{min:1,max:3},tagNames:["deutsch"]}],wantsHelp:!1},helping:{},publishState:"published"};async function Pl(){return new Promise(e=>setTimeout(()=>e({kind:"SUCCESS",data:JSON.parse(Ol(hn,JSON.stringify(Ml)))}),1e3))}async function Il(e,t){return new Promise(n=>setTimeout(()=>(Nl(hn,JSON.stringify(e)),n({kind:"SUCCESS",data:t})),1e3))}const Ll=[{uuid:be.program,gamemaster:"Game Master",title:"Grolle in der Dunkelheit",system:"Warhammer Fantasy Rollenspiel",description:{short:"Ein kurzes Abenteuer bei dem es um Fantasy, Action und einfaches Rollenspiel geht.",long:"Eine kleine Gruppe wagt sich in die dunklen SchÃ¤chten einer Mine und weiter hinab, um einen mÃ¤chtigen Gegenstand wieder zu erlangen. Wie werden die GefÃ¤hrten auf die Gefahren des Untergrundes reagieren und welche Gefahren lauern in der Finsternis?"},slot:{day:"SATURDAY",from:10,to:13},playerCount:{min:1,max:3,reserved:0},tags:["ab12jahren"]},{uuid:be.program2,gamemaster:"Other Game Master",title:"Acrimony",system:"D&D",description:{short:"Ein Lo-Fi Space Western Abenteuer",long:'Ein Lo-Fi Space Western Abenteuer: "Eine frisch formierte Gruppe von KopfgeldjÃ¤gern wird mit einer riskanten Mission betraut: Sie mÃ¼ssen den berÃ¼chtigten Outlaw Jeb "Rusty" Rourke in der abgeschiedenen Grenzstadt aufspÃ¼ren. Bei dieser unbarmherzigen Jagd lernen die Spieler die harte RealitÃ¤t der Kopfgeldjagd kennen, wo jeder Schuss und jede Entscheidung Ã¼ber ihr Schicksal entscheidet.'},slot:{day:"SATURDAY",from:10,to:13},playerCount:{min:2,max:8,reserved:3},tags:["ab12jahren","horror"]},{uuid:be.program3,gamemaster:"Other Game Master",title:"Acrimony",system:"D&D",description:{short:"Ein Lo-Fi Space Western Abenteuer",long:'Ein Lo-Fi Space Western Abenteuer: "Eine frisch formierte Gruppe von KopfgeldjÃ¤gern wird mit einer riskanten Mission betraut: Sie mÃ¼ssen den berÃ¼chtigten Outlaw Jeb "Rusty" Rourke in der abgeschiedenen Grenzstadt aufspÃ¼ren. Bei dieser unbarmherzigen Jagd lernen die Spieler die harte RealitÃ¤t der Kopfgeldjagd kennen, wo jeder Schuss und jede Entscheidung Ã¼ber ihr Schicksal entscheidet.'},slot:{day:"SATURDAY",from:14,to:18},playerCount:{min:2,max:8,reserved:3},tags:["ab12jahren","horror"]},{uuid:be.program4,gamemaster:"Some Other Game Master",title:"Solo RPGs",system:"",description:{short:"Wir spielen primÃ¤r das Solo Rollenspiel NoteQuest, werden aber kurz auch noch ein paar andere Solo Rollenspiele miteinander anschauen.",long:""},slot:{day:"SATURDAY",from:14,to:18},playerCount:{min:2,max:4,reserved:3},tags:[]}];async function Fl(){return new Promise(e=>setTimeout(()=>e({kind:"SUCCESS",data:Ll}),5e3))}const Gl=[{uuid:be.slot,name:"Alice"},{uuid:be.slot,name:"Bob"}];async function Hl(e){return new Promise(t=>setTimeout(()=>t({kind:"SUCCESS",data:Gl.filter(n=>e.includes(n.uuid))}),5e3))}var Yl=g("<div aria-atomic=true><!$><!/><!$><!/>"),Bl=g("<div class=toast-container aria-live=polite aria-atomic=true>");const[xe,Xe]=D([]);function zl(e){const t=()=>{const n=["toast"];return e.options.kind!==void 0&&n.push(`toast-${e.options.kind}`),n.join(" ")};return(()=>{var n=d(Yl),l=n.firstChild,[a,i]=u(l.nextSibling),o=a.nextSibling,[c,m]=u(o.nextSibling);return s(n,()=>e.options.message,a,i),s(n,r(E,{get when(){return e.options.dismissable},get children(){return r(j,{kind:"ghost",get label(){return r(ie,{icon:"xmark",classes:["toast-dismiss"]})},get onClick(){return e.dismiss}})}}),c,m),me(h=>{var S=t(),_=e.options.kind==="danger"?"alert":"status",$=e.options.kind==="danger"?"assertive":"polite";return S!==h.e&&Te(n,h.e=S),_!==h.t&&it(n,"role",h.t=_),$!==h.a&&it(n,"aria-live",h.a=$),h},{e:void 0,t:void 0,a:void 0}),n})()}function jl(){function e(t){xe.find(n=>n.uuid===t)?.cleanup(),Xe(xe.filter(n=>n.uuid!==t))}return(()=>{var t=d(Bl);return s(t,r(W,{each:xe,children:n=>r(zl,{options:n,dismiss:()=>e(n.uuid)})})),t})()}function $n(e,t){if(t?.uuid!==void 0&&xe.find(c=>c.uuid===t.uuid)!==void 0)return At(t.uuid,e,t);const n=t?.uuid??crypto.randomUUID(),l=t?.duration??5e3,a=t?.kind??"gray",i=t?.dismissable??!0,o=setTimeout(()=>{Xe(xe.filter(c=>c.uuid!==n))},l);return Xe(xe.length,{uuid:n,kind:a,message:e,duration:l,dismissable:i,cleanup:()=>clearTimeout(o)}),n}function At(e,t,n){const l=xe.find(m=>m.uuid===e);if(l===void 0)return e;l.cleanup();const a=n.duration??l.duration,i=n.kind??l.kind,o=n?.dismissable??l.dismissable,c=setTimeout(()=>{Xe(xe.filter(m=>m.uuid!==e))},a);return Xe(m=>m.uuid===e,{uuid:e,kind:i,message:t,duration:a,dismissable:o,cleanup:()=>clearTimeout(c)}),e}const Wl=v({name:f(),email:f(),mobile:f()}),Kl=v({name:f(),email:f(),mobile:f()}),Zl=Tt([v({kind:T("SELF"),gameRound:f().uuid(),uuid:f().uuid()}),v({kind:T("FRIEND"),gameRound:f().uuid(),name:f(),uuid:f().uuid()})]),ql=v({wantsUpdates:Le(),reservations:le(Zl)}),Jl=Tt([v({kind:T("SELF"),gameRound:f().uuid(),uuid:f().uuid()}),v({kind:T("FRIEND"),gameRound:f().uuid(),name:f(),uuid:f().uuid()})]);Tt([v({kind:T("SELF"),gameRound:f().uuid()}),v({kind:T("FRIEND"),gameRound:f().uuid(),name:f()})]);const Vl=v({wantsUpdates:Le(),reservations:le(Jl)}),Ql=v({games:le(mr),wantsHelp:Le()}),Xl=v({games:le(on),wantsHelp:Le()}),ea=v({}),ta=v({}),na=v({version:T(1),init:Wl,lastSaved:f(),playing:ql,master:Ql,helping:ea,publishState:ct}),ra=v({version:T(1),init:Kl,lastSaved:In.date(),playing:Vl,master:Xl,helping:ta,publishState:ct});async function ia(e){const t=e==="demo"?await Pl():await Wi(e);if(t.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE"};const n=na.safeParse(t.data);if(!n.success)return console.error(n.error),{kind:"FAILURE"};const l=la(n.data);return l.success?{kind:"SUCCESS",data:l.data}:{kind:"FAILURE"}}function la(e){return ra.safeParse(e)}const wt=crypto.randomUUID();async function aa(e,t,n){const[l,a]=D(e);a("saveState","SAVING"),$n("Am Speichern...",{uuid:wt,dismissable:!1});const i=new Date;t.lastSaved=i;const o=sa(t);try{if((n==="demo"?await Il(o,n):await Ki(o,n)).kind==="FAILURE")throw Error("")}catch(c){return a("saveState","ERROR"),console.error(c),At(wt,"Speichern war nicht mÃ¶glich!",{kind:"danger",duration:1e4,dismissable:!0}),{kind:"FAILURE"}}return At(wt,`Zuletzt gespeichert um: ${Xt(i)} Uhr`,{kind:"success",dismissable:!0}),a("saveState","IDLE"),{kind:"SUCCESS",data:i}}function sa(e){return{...e,lastSaved:String(e.lastSaved),master:{...e.master,games:e.master.games.map(Sr)}}}const oa=Un(aa,1e3);var da=g("<div class=tooltip-wrapper><div class=tooltip></div><!$><!/>");function Ke(e){return(()=>{var t=d(da),n=t.firstChild,l=n.nextSibling,[a,i]=u(l.nextSibling);return s(n,()=>e.tooltip),s(t,()=>e.children,a,i),t})()}var ua=g("<div class=quickmenu-wrapper><div class=quickmenu><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),ca=g('<div class="quickmenu extended"><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>'),ga=g("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center;><!$><!/><em>Zuletzt gespeichert um: <!$><!/> Uhr"),ma=g("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center;><!$><!/><em>Am Speichern..."),ha=g("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center;><!$><!/><em>Speichern war nicht mÃ¶glich!");function $a(e){return(()=>{var t=d(ua),n=t.firstChild,l=n.firstChild,[a,i]=u(l.nextSibling),o=a.nextSibling,[c,m]=u(o.nextSibling),h=c.nextSibling,[S,_]=u(h.nextSibling),$=S.nextSibling,[b,y]=u($.nextSibling),k=b.nextSibling,[p,w]=u(k.nextSibling);return s(n,r(Ke,{tooltip:"Zur Ãbersicht",get children(){return r(j,{get label(){return r(ie,{icon:"backward"})},onClick:()=>e.changePage({kind:"CHOOSE"})})}}),a,i),s(n,r(Ke,{tooltip:"Zu den Spielrunden",get children(){return r(j,{get label(){return r(ie,{icon:"dice-d20"})},onClick:()=>e.changePage({kind:"PLAYER"})})}}),c,m),s(n,r(Ke,{tooltip:"Zu deinen Spielrunden",get children(){return r(j,{get label(){return r(ie,{icon:"grid-2-plus"})},onClick:()=>e.changePage({kind:"GAMEMASTER"})})}}),S,_),s(n,r(Ke,{tooltip:"Zum Helferplan",get children(){return r(j,{get label(){return r(ie,{icon:"hand-heart"})},onClick:()=>e.changePage({kind:"HELPING"})})}}),b,y),s(n,r(Ke,{tooltip:"Zur Zusammenfassung",get children(){return r(j,{get label(){return r(ie,{icon:"list"})},onClick:()=>e.changePage({kind:"SUMMARY"})})}}),p,w),t})()}function Sa(e){return[r(C,{type:"gray",get children(){var t=d(ca),n=t.firstChild,[l,a]=u(n.nextSibling),i=l.nextSibling,[o,c]=u(i.nextSibling),m=o.nextSibling,[h,S]=u(m.nextSibling),_=h.nextSibling,[$,b]=u(_.nextSibling),y=$.nextSibling,[k,p]=u(y.nextSibling);return s(t,r(H,{icon:"backward",label:"Zur Ãbersicht",onClick:()=>e.changePage({kind:"CHOOSE"})}),l,a),s(t,r(H,{icon:"dice-d20",label:"Zu den Spielrunden",onClick:()=>e.changePage({kind:"PLAYER"})}),o,c),s(t,r(H,{icon:"grid-2-plus",label:"Zu deinen Spielrunden",onClick:()=>e.changePage({kind:"GAMEMASTER"})}),h,S),s(t,r(H,{icon:"hand-heart",label:"Zum Helferplan",onClick:()=>e.changePage({kind:"HELPING"})}),$,b),s(t,r(H,{icon:"list",label:"Zur Zusammenfassung",onClick:()=>e.changePage({kind:"SUMMARY"})}),k,p),t}}),r(_a,{get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}})]}function _a(e){return r(Se,{get children(){return[r(R,{get when(){return e.saveState==="IDLE"},get children(){var t=d(ga),n=t.firstChild,[l,a]=u(n.nextSibling),i=l.nextSibling,o=i.firstChild,c=o.nextSibling,[m,h]=u(c.nextSibling);return m.nextSibling,s(t,r(ie,{icon:"circle-check"}),l,a),s(i,()=>Xt(e.lastSaved),m,h),t}}),r(R,{get when(){return e.saveState==="SAVING"},get children(){var t=d(ma),n=t.firstChild,[l,a]=u(n.nextSibling);return l.nextSibling,s(t,r(ie,{icon:"floppy-disk-circle-arrow-right"}),l,a),t}}),r(R,{get when(){return e.saveState==="ERROR"},get children(){var t=d(ha),n=t.firstChild,[l,a]=u(n.nextSibling);return l.nextSibling,s(t,r(ie,{icon:"triangle-exclamation"}),l,a),t}})]}})}var ba=g("<div class=page><!$><!/><div class=page-content><h2></h2><br><!$><!/></div><!$><!/>"),fa=g("<div class=extended-wrapper style=margin-block-start:1rem;>");function Pe(e){return(()=>{var t=d(ba),n=t.firstChild,[l,a]=u(n.nextSibling),i=l.nextSibling,o=i.firstChild,c=o.nextSibling,m=c.nextSibling,[h,S]=u(m.nextSibling),_=i.nextSibling,[$,b]=u(_.nextSibling);return s(t,(()=>{var y=O(()=>e.showQuickmenu!==!1);return()=>y()?r($a,{get changePage(){return e.changePage},get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}}):null})(),l,a),s(o,()=>e.title),s(i,()=>e.children,h,S),s(t,(()=>{var y=O(()=>e.showQuickmenu!==!1);return()=>y()?(()=>{var k=d(fa);return s(k,r(Sa,{get changePage(){return e.changePage},get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}})),k})():null})(),$,b),t})()}const va=v({uuid:f().uuid(),name:f()}),Sn=le(va),ya=Sn;async function ka(e,t){const n=e==="demo"?await Hl(t):await qi(e);if(n.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE"};const l=Sn.safeParse(n.data);if(!l.success)return{kind:"FAILURE"};const a=xa(l.data);return a.success?{kind:"SUCCESS",data:a.data}:{kind:"FAILURE"}}function xa(e){return ya.safeParse(e)}const pa=v({uuid:f().uuid(),title:f(),system:f(),gamemaster:f(),description:v({short:f(),long:f()}),slot:v({day:Nt,from:J(),to:J()}),playerCount:v({min:J(),max:J(),reserved:J()}),tags:le(f())}),Ea=le(pa),Ca=v({uuid:f().uuid(),title:f(),system:f(),gamemaster:f(),description:v({short:f(),long:f()}),slot:v({day:Nt,from:J(),to:J()}),playerCount:v({min:J(),max:J(),reserved:J()}),tags:le(f())}),wa=le(Ca);async function Ra(e){const t=e==="demo"?await Fl():await Zi(e);if(t.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE"};const n=Ea.safeParse(t.data);if(!n.success)return{kind:"FAILURE"};const l=Aa(n.data);return l.success?{kind:"SUCCESS",data:l.data}:{kind:"FAILURE"}}function Aa(e){return wa.safeParse(e)}var Jt=g("<br>"),Vt=g("<pre>"),Da=g("<hr>"),Ua=g("<div><code>Reservations (read-only)"),Ta=g("<em>loading...");function Oa(e){const t=new URL(location.href);t.searchParams.set("page",e.page.kind.toLowerCase()),e.page.kind==="EDIT_GAMEROUND"&&t.searchParams.set("uuid",e.page.uuid),t.searchParams.delete("showCreateMessage"),history.replaceState({page:e},"",t);const n=x.pageTitle[e.page.kind];document.title=x.metaTitle.replace("{}",n)}function Na(e){const[t,n]=D(e.page);return(l,a)=>{if(Ul(l,t))return;const i=a?.backButton??!1,o=a?.disableScroll??!1,c=new URL(location.href);c.searchParams.set("page",l.kind.toLowerCase()),l.kind==="EDIT_GAMEROUND"||l.kind==="GAME"?(c.searchParams.set("uuid",l.uuid),n(l)):(c.searchParams.delete("uuid"),n({...l,uuid:null})),i||history.pushState({page:l},"",c);const m=x.pageTitle[l.kind];document.title=x.metaTitle.replace("{}",m),o||window.scrollTo({top:0})}}function Ma(e){Oa(e.meta);const[t,n]=D({meta:e.meta,save:e.save}),l=()=>t.save.master.games.flatMap(_=>_.slots.map($=>$.uuid)),[a]=rt(l(),_=>ka(t.meta.secret,_)),[i]=rt(()=>Ra(t.meta.secret)),o=crypto.randomUUID(),[c,m]=Dt(!1);rt(()=>JSON.stringify(t.save),async()=>{if(!c()){m(!0);return}if(t.save.publishState!=="published"){$n("Diese Anmeldung wurde deaktiviert und kann nicht editiert werden.",{kind:"danger",uuid:o});return}const _=Ze(t.save);try{const $=await oa(t.meta,_,t.meta.secret);$.kind==="FAILURE"?console.error($):n("save","lastSaved",$.data)}catch($){console.error($),n("meta","saveState","ERROR")}});const h=Na(t.meta),S=Tn();return tn(()=>{window.addEventListener("popstate",_=>{if(typeof _=="object"&&_!==null&&"state"in _){const $=new URL(location.href),b=mn($);h(b.page,{backButton:!0})}}),setInterval(async()=>{const _=S.dequeue();_.kind==="NEXT_ELEMENT"&&await _.data()},1e3)}),[r(E,{get when(){return t.meta.showCreateMessage},get children(){return[r(C,{type:"success",get children(){return x.registrationStarted}}),d(Jt)]}}),r(E,{get when(){return t.save.publishState!=="published"},get children(){return[r(C,{type:"danger",children:"Diese Anmeldung wurde deaktiviert. Sollte dies ein Fehler sein, kontaktiere uns bitte."}),d(Jt)]}}),r(Se,{get fallback(){return r(Pe,{title:"Wo mÃ¶chtest du starten?",showQuickmenu:!1,changePage:h,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(vi,{changePage:h,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get isDebugging(){return t.meta.isDebugging}})}})},get children(){return[r(R,{get when(){return t.meta.page.kind==="PLAYER"||t.meta.page.kind==="GAME"},get children(){return r(Pe,{title:"SpielrundenÃ¼bersicht",changePage:h,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(oi,{get store(){return t.save.playing},program:i,get uuid(){return t.meta.page.kind==="GAME"?t.meta.page.uuid:null},get isEditable(){return t.save.publishState==="published"},changePage:h,get isDebugging(){return t.meta.isDebugging}})}})}}),r(R,{get when(){return t.meta.page.kind==="GAMEMASTER"},get children(){return r(Pe,{title:"Meine Spielrunden",changePage:h,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(pr,{get store(){return t.save.master},get isEditable(){return t.save.publishState==="published"},changePage:h})}})}}),r(R,{get when(){return t.meta.page.kind==="EDIT_GAMEROUND"},get children(){return r(Pe,{title:"Spielrunde editieren",changePage:h,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(fl,{get allRounds(){return t.save.master.games},get uuid(){return t.meta.page.kind==="EDIT_GAMEROUND"?t.meta.page.uuid:"should never happen"},get fallback(){return r(C,{type:"danger",get children(){return x.error.gameroundUuidError}})},children:_=>r(vl,{store:_,registrations:a,queue:S,get isEditable(){return t.save.publishState==="published"},changePage:h,get secret(){return t.meta.secret}})})}})}}),r(R,{get when(){return t.meta.page.kind==="HELPING"},get children(){return r(Pe,{title:"Helfen",changePage:h,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(ur,{})}})}}),r(R,{get when(){return t.meta.page.kind==="SUMMARY"},get children(){return r(Pe,{title:"Zusammenfassung",changePage:h,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(ir,{get store(){return t.save},program:i,get isEditable(){return t.save.publishState==="published"},changePage:h})}})}})]}}),r(E,{get when(){return t.meta.isDebugging},get children(){return[(()=>{var _=d(Vt);return s(_,()=>JSON.stringify(t,null,2)),_})(),d(Da),d(Ua),r(dt,{get fallback(){return d(Ta)},get children(){return r(E,{get when(){return a()},children:_=>(()=>{var $=d(Vt);return s($,()=>JSON.stringify(_(),null,2)),$})()})}})]}}),r(jl,{})]}function _n(){return r(C,{get children(){return x.loading.registration}})}function Ba(){const[e,t]=Dt(null);return tn(()=>{const n=new URL(location.href);t(mn(n))}),r(E,{get fallback(){return r(_n,{})},get when(){return e()},children:n=>r(Pa,{get page(){return n()}})})}function Pa(e){const[t]=rt(()=>ia(e.page.secret));return r(Mn,{fallback:n=>(console.error(n),r(C,{type:"danger",get children(){return x.error.general}})),get children(){return r(dt,{get fallback(){return r(_n,{})},get children(){return r(Se,{get children(){return r(R,{get when(){return t()},children:n=>{const{kind:l,value:a}=On(n());return l==="SECRET_INVALID"?r(C,{type:"danger",get children(){return x.error.secretError}}):l==="FAILURE"?(console.error(a),r(C,{type:"danger",get children(){return x.error.ourMistake}})):r(Ma,{get meta(){return e.page},get save(){return a.data}})}})}})}})}})}export{Ba as MeineAnmeldungWrapper};
