import{c as qe,I as pn,B as w,d as En,f as ie,g as vt,h as H,b as j,s as Cn,i as Vt,S as Mt,j as yt,k as wn,e as Le,l as Rn,m as qt,n as An,u as Tn}from"./utils.D4lVKdag.js";import{b as Jt,g as d,t as g,a as u,u as Un,i as s,c as r,S as E,d as me,e as Ue,F as W,M as U,f as xe,s as kt,h as it,j as at,k as st,m as O,r as ot,l as Tt,n as lt,o as dt,p as rt,q as Qt,E as Dn}from"./web.BCh8zNxO.js";/* empty css                                 */import{c as A,u as Ze}from"./store.BK-5lGMP.js";import{T as On}from"./Textarea.BaP5nL_S.js";import{s as f,n as q,e as ut,T as x,o as v,a as le,C as Ut,d as Xt,b as ze,l as D,c as Pe,u as Dt,f as Nn}from"./texts.CWjYF-lE.js";var Mn=g("<dialog><!$><!/><!$><!/><!$><!/>"),In=g("<h4>");function ye(e=!1){return{open:e}}function pe(e){let t;const[n,l]=A(e.store);Jt(()=>{n.open?t.showModal():t.close()});function a(){l({open:!1}),e.onClose?.()}const i=()=>{const o=[];return e.type!==void 0&&o.push(e.type),e.size!==void 0&&o.push(e.size),e.onClose!==void 0&&o.push("dialog-with-close"),o};return(()=>{var o=d(Mn),c=o.firstChild,[m,h]=u(c.nextSibling),S=m.nextSibling,[_,$]=u(S.nextSibling),b=_.nextSibling,[y,k]=u(b.nextSibling);o.addEventListener("close",a);var p=t;return typeof p=="function"?Un(p,o):t=o,s(o,r(E,{get when(){return e.onClose},get children(){return r(qe,{onClick:a,icon:"circle-xmark",kind:"gray"})}}),m,h),s(o,r(E,{get when(){return e.title},children:C=>(()=>{var N=d(In);return s(N,C),N})()}),_,$),s(o,()=>e.children,y,k),me(()=>Ue(o,i().join(" "))),o})()}var Ot=g("<p>");function Ve(e){const[t,n]=A(e.store),l=e.showErrors==="ALWAYS",a=()=>l||t.isDirty?e.errors??[]:[];return[r(pn,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:i=>n("value",i),onBlur:()=>n("isDirty",!0),get type(){return e.type},get required(){return e.required},get isHoneypot(){return e.isHoneypot},get disabled(){return e.disabled}}),r(E,{get when(){return a().length>0},get children(){return r(w,{type:"danger",get children(){return r(W,{get each(){return a()},children:i=>(()=>{var o=d(Ot);return s(o,i),o})()})}})}})]}function It(e){const[t,n]=A(e.store),l=e.showErrors==="ALWAYS",a=()=>l||t.isDirty?e.errors??[]:[];return[r(En,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:i=>n("value",i),onBlur:()=>n("isDirty",!0),get required(){return e.required},get isHoneypot(){return e.isHoneypot},get min(){return e.min},get max(){return e.max},get disabled(){return e.disabled}}),r(E,{get when(){return a().length>0},get children(){return r(w,{type:"danger",get children(){return r(W,{get each(){return a()},children:i=>(()=>{var o=d(Ot);return s(o,i),o})()})}})}})]}function Rt(e){const[t,n]=A(e.store),l=e.showErrors==="ALWAYS",a=()=>l||t.isDirty?e.errors??[]:[];return[r(On,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:i=>n("value",i),onBlur:()=>n("isDirty",!0),get required(){return e.required},get size(){return e.size},get disabled(){return e.disabled}}),r(E,{get when(){return a().length>0},get children(){return r(w,{type:"danger",get children(){return r(W,{get each(){return a()},children:i=>(()=>{var o=d(Ot);return s(o,i),o})()})}})}})]}const et=f().transform(e=>({value:e,isDirty:!1}));function xt(e){return{value:e,isDirty:!1}}const Pt=q().transform(e=>({value:e,isDirty:!1})),Te={SATURDAY:{open:{from:10,to:24},breaks:[{from:13,to:14},{from:18,to:19}]},SUNDAY:{open:{from:10,to:18},breaks:[{from:13,to:14}]}};ut(["SATURDAY","SUNDAY"]);function tt(e,t){const{from:n,to:l}=t;return n<e&&e<l}function Pn(e,t){const{from:n,to:l}=e,{from:a,to:i}=t;return tt(n,t)||tt(l,t)||tt(a,e)||tt(i,e)||n===a&&l===i}function Je(e,t=!1){const{from:n,to:l}=e;if(n>l)return[];const a=l-n;return en(t?a+1:a,n)}function en(e,t=0){return[...Array(e)].map((n,l)=>l+t)}function Ln(e,t){return e===null?-1:t===null?1:e.day==="SATURDAY"&&t.day==="SUNDAY"?-1:e.day==="SUNDAY"&&t.day==="SATURDAY"?1:e.from===t.from?e.to-t.to:e.from-t.from}var Fn=g("<div class=dynamic-columns style=gap:1rem;--min-width:30rem;><!$><!/><!$><!/>"),Gn=g("<div><h4 style=margin-block-end:1.5rem;></h4><!$><!/>"),Hn=g("<p>Konflikte gefunden! Bitte stelle sicher, dass du nicht zeitlich Ã¼berlappende Spielrunden eingetragen hast:"),Yn=g('<div style="display:grid;grid-template-columns:1fr max-content 1fr;gap:1rem;margin-block:0.5rem;"><!$><!/><span style=color:var(--clr-warning-10);align-self:center;font-size:2rem;></span><!$><!/>'),Bn=g("<div class=timetable><!$><!/><div class=entries></div><div class=after-hour><div class=annotation>"),zn=g("<div><div class=annotation></div><div class=background>"),jn=g("<div class=entry>");function Wn(e){return(()=>{var t=d(Fn),n=t.firstChild,[l,a]=u(n.nextSibling),i=l.nextSibling,[o,c]=u(i.nextSibling);return s(t,r(Lt,{get programEntries(){return e.programEntries.SATURDAY},get openingHours(){return Te.SATURDAY},day:"SATURDAY"}),l,a),s(t,r(Lt,{get programEntries(){return e.programEntries.SUNDAY},get openingHours(){return Te.SUNDAY},day:"SUNDAY"}),o,c),t})()}function Lt(e){const t=Kn(e.programEntries);return(()=>{var n=d(Gn),l=n.firstChild,a=l.nextSibling,[i,o]=u(a.nextSibling);return s(l,()=>x.days[e.day]),s(n,r(xe,{get fallback(){return[r(w,{type:"danger",get children(){return d(Hn)}}),r(W,{each:t,children:([c,m])=>(()=>{var h=d(Yn),S=h.firstChild,[_,$]=u(S.nextSibling),b=_.nextSibling,y=b.nextSibling,[k,p]=u(y.nextSibling);return s(h,()=>c.component(),_,$),s(b,r(ie,{icon:"triangle-exclamation"})),s(h,()=>m.component(),k,p),h})()})]},get children(){return r(U,{get when(){return t.length===0},get children(){return r(Zn,{get programEntries(){return e.programEntries},get openingHours(){return e.openingHours},get day(){return e.day}})}})}}),i,o),n})()}function Zn(e){const t=Je(e.openingHours.open),n=e.openingHours.breaks.map(({from:i})=>i),l=(t[0]??0)-1,a=t.at(-1)??0;return(()=>{var i=d(Bn),o=i.firstChild,[c,m]=u(o.nextSibling),h=c.nextSibling,S=h.nextSibling,_=S.firstChild;return s(i,r(W,{each:t,children:$=>{const b=n.includes($);return(()=>{var y=d(zn),k=y.firstChild;return Ue(y,`hour ${b?"break":""}`),s(k,$),me(p=>kt(y,Ft({from:$,to:$},l,e.day),p)),y})()}}),c,m),s(h,r(W,{get each(){return e.programEntries},children:$=>(()=>{var b=d(jn);return s(b,()=>$.component()),me(y=>kt(b,Ft($.range,l,e.day),y)),b})()})),s(_,a+1),me($=>kt(h,`grid-row: 1 / ${a-l+1};`,$)),i})()}function Ft(e,t,n){const{from:l,to:a}=e,i=l-t,o=a-t,c=Te[n].open.to;return vt(i>0,`Entry can't start at ${l}.`),vt(o>0,`Entry can't end at ${a}.`),vt(a<=c,`Entry can't end at ${a}.`),`grid-row: ${i} / ${o};`}function Kn(e){const t=[];return e.forEach((n,l)=>{e.slice(l+1).forEach(a=>{Pn(n.range,a.range)&&t.push([n,a])})}),t}var Vn=g("<span>");function tn(e){const t=()=>{const n=["chip"];return n.push(e.kind??"gray"),e.inverted&&n.push("inverted"),e.size==="small"&&n.push("small"),n.join(" ")};return(()=>{var n=d(Vn);return s(n,()=>e.children),me(l=>{var a=t(),i=e.title;return a!==l.e&&Ue(n,l.e=a),i!==l.t&&it(n,"title",l.t=i),l},{e:void 0,t:void 0}),n})()}var nn=g("<br>"),qn=g("<div>"),Jn=g("<div style=display:grid;gap:1rem;><h3>Meine Kontaktdaten</h3><p><strong>Name:</strong> <!$><!/></p><p><strong>E-Mail:</strong> <!$><!/></p><p><strong>Handynummer:</strong> <!$><!/></p><!$><!/>"),Qn=g("<form novalidate><!$><!/><!$><!/><!$><!/><!$><!/>"),Xn=g("<h3>Mein Programm"),er=g("<div><!$><!/><!$><!/><h5></h5><p class=duration>von <!$><!/> bis <!$><!/> Uhr <em><small>(<!$><!/> <!$><!/>)");function tr(e){const t=e.store.master.games.flatMap(i=>i.slots.map(o=>({status:i.kind,uuid:i.uuid,title:i.title.value,dateTime:o}))),n=()=>{const i=e.program();return i?.kind==="SUCCESS"?i.data:[]},l=()=>{const i=e.store.playing.reservations.map(o=>o.gameRound);return new Set(i)},a=()=>n().filter(i=>l().has(i.uuid)).map(i=>({uuid:i.uuid,title:i.title,dateTime:i.slot}));return[r(nr,{get store(){return e.store.init},get isEditable(){return e.isEditable}}),d(nn),r(ir,{get entries(){return{play:a(),master:t,help:[]}},get changePage(){return e.changePage},get isEditable(){return e.isEditable}})]}function nr(e){const[t,n]=A(e.store),[l,a]=A(ye());return r(w,{get children(){return[r(E,{get when(){return l.open},get children(){return r(rr,{dialogStore:l,get currentState(){return e.store},updateCurrentState:n})}}),(()=>{var i=d(Jn),o=i.firstChild,c=o.nextSibling,m=c.firstChild,h=m.nextSibling,S=h.nextSibling,[_,$]=u(S.nextSibling),b=c.nextSibling,y=b.firstChild,k=y.nextSibling,p=k.nextSibling,[C,N]=u(p.nextSibling),I=b.nextSibling,L=I.firstChild,Y=L.nextSibling,te=Y.nextSibling,[T,J]=u(te.nextSibling),ne=I.nextSibling,[Z,B]=u(ne.nextSibling);return s(c,()=>e.store.name,_,$),s(b,()=>e.store.email,C,N),s(I,()=>e.store.mobile,T,J),s(i,r(E,{get when(){return e.isEditable},get children(){var K=d(qn);return s(K,r(H,{icon:"pencil",label:"Kontaktdaten editieren",onClick:()=>a("open",!0)})),K}}),Z,B),i})()]}})}function rr(e){const[t]=A({name:xt(e.currentState.name),email:xt(e.currentState.email),mobile:xt(e.currentState.mobile)}),n=at(()=>{const i={name:[],email:[]};return t.name.value.trim().length===0&&i.name.push(x.mandatoryField),t.email.value.trim().length===0?i.email.push(x.mandatoryField):t.email.value.includes("@")||i.email.push(x.invalidEmail),{...i,hasErrors:i.name.length+i.email.length>0}}),[l,a]=A(e.dialogStore);return r(pe,{get store(){return e.dialogStore},title:"Kontaktdaten editieren",onClose:()=>{},size:"medium",get children(){var i=d(Qn),o=i.firstChild,[c,m]=u(o.nextSibling),h=c.nextSibling,[S,_]=u(h.nextSibling),$=S.nextSibling,[b,y]=u($.nextSibling),k=b.nextSibling,[p,C]=u(k.nextSibling);return s(i,r(Ve,{get store(){return t.name},label:"Name",name:"name",showErrors:"ON_BLUR",get errors(){return n().name}}),c,m),s(i,r(Ve,{get store(){return t.email},label:"E-Mail",name:"email",showErrors:"ON_BLUR",get errors(){return n().email}}),S,_),s(i,r(Ve,{get store(){return t.mobile},label:"Handynummer",name:"mobile"}),b,y),s(i,r(j,{label:"Speichern",get disabled(){return n().hasErrors},onClick:()=>{n().hasErrors||(e.updateCurrentState({name:t.name.value,email:t.email.value,mobile:t.mobile.value}),a("open",!1))}}),p,C),i}})}function ir(e){const t=lr(e.entries,e.changePage,e.isEditable);return[d(Xn),d(nn),r(Wn,{programEntries:t})]}function pt(e){const t=e.range.to-e.range.from,n={"master-draft":{label:"SL",help:"Spielleitung",link:{icon:"pencil",label:"Spielrunde bearbeiten"}},master:{label:"SL",help:"Spielleitung",link:{icon:"pencil",label:"Spielrunde bearbeiten"}},play:{label:"TN",help:"Teilnehmer:in",link:{icon:"link",label:"Zur Spielrunde"}},help:{label:"HL",help:"Helfen",link:{icon:"link",label:""}}}[e.kind],l=()=>{const a=["timeview-entry","box-simple"];return e.kind==="master-draft"&&a.push("gray"),e.kind==="master"&&a.push("special"),e.kind==="play"&&a.push("danger"),a.join(" ")};return(()=>{var a=d(er),i=a.firstChild,[o,c]=u(i.nextSibling),m=o.nextSibling,[h,S]=u(m.nextSibling),_=h.nextSibling,$=_.nextSibling,b=$.firstChild,y=b.nextSibling,[k,p]=u(y.nextSibling),C=k.nextSibling,N=C.nextSibling,[I,L]=u(N.nextSibling),Y=I.nextSibling,te=Y.nextSibling,T=te.firstChild,J=T.firstChild,ne=J.nextSibling,[Z,B]=u(ne.nextSibling),K=Z.nextSibling,z=K.nextSibling,[ae,oe]=u(z.nextSibling);return ae.nextSibling,s(a,r(tn,{get title(){return n.help},inverted:!0,size:"small",get children(){return n.label}}),o,c),s(a,r(E,{get when(){return e.onClick},children:P=>r(qe,{get icon(){return n.link.icon},kind:"ghost",get onClick(){return P()},get title(){return n.link.label}})}),h,S),s(_,()=>e.title),s($,()=>e.range.from,k,p),s($,()=>e.range.to,I,L),s(T,t,Z,B),s(T,t===1?"Stunde":"Stunden",ae,oe),me(P=>{var re=l(),V=e.title;return re!==P.e&&Ue(a,P.e=re),V!==P.t&&it(_,"title",P.t=V),P},{e:void 0,t:void 0}),a})()}function lr(e,t,n){const l={SATURDAY:[],SUNDAY:[]};return n&&(e.play.forEach(a=>{l[a.dateTime.day].push({range:a.dateTime,component:()=>r(pt,{get title(){return a.title},get range(){return a.dateTime},kind:"play",onClick:()=>t({kind:"GAME",uuid:a.uuid})})})}),e.master.forEach(a=>{if(a.status==="archived")return;const i=[a.title];a.status==="draft"&&i.unshift("(noch nicht verÃ¶ffentlicht)"),l[a.dateTime.day].push({range:a.dateTime,component:()=>r(pt,{get title(){return i.join(" ")},get range(){return a.dateTime},get kind(){return a.status==="published"?"master":"master-draft"},onClick:()=>t({kind:"EDIT_GAMEROUND",uuid:a.uuid})})})}),e.help.forEach(a=>{l[a.dateTime.day].push({range:a.dateTime,component:()=>r(pt,{get title(){return a.title},get range(){return a.dateTime},kind:"help"})})})),l}var ar=g("<p>Diese Seite ist leider noch nicht bereit. Komm bitte spÃ¤ter nochmal zurÃ¼ck.");function sr(){return r(w,{type:"danger",get children(){return d(ar)}})}var or=g("<div class=grid><!$><!/><div>"),dr=g("<div class=boxLink>");function Ke(e){const t=e.type??"special";return(()=>{var n=d(dr);return s(n,r(w,{type:t,get onClick(){return e.onClick},get children(){var l=d(or),a=l.firstChild,[i,o]=u(a.nextSibling),c=i.nextSibling;return s(l,r(ie,{get icon(){return e.icon}}),i,o),s(c,()=>e.children),l}})),n})()}const Nt=ut(["SATURDAY","SUNDAY"]),rn=v({uuid:f().uuid(),day:Nt,from:q(),to:q()}).refine(e=>e.from<e.to,{message:"A TimeSlot can't end before it starts."});v({name:f(),label:f(),description:f()});const ct=ut(["draft","published","archived"]),ur=v({uuid:f().uuid(),kind:ct,title:f(),system:f(),description:v({short:f(),long:f()}),slots:le(rn),playerCount:v({min:q().min(1),max:q()}).transform(e=>{const[t,n]=Cn([e.min,e.max]);return{min:t,max:n}}),tagNames:le(f())}),ln=v({uuid:f().uuid(),kind:ct,title:et,system:et,description:v({short:et,long:et}),slots:le(rn),playerCount:v({min:Pt,max:Pt}),tagNames:le(f())});function cr(){const e={uuid:crypto.randomUUID(),kind:"draft",title:"",system:"",description:{short:"",long:""},slots:[],playerCount:{min:2,max:4},tagNames:["deutsch"]},t=gr(e);if(t.success)return t.data;throw console.error(t),Error("should not happen")}function gr(e){return ln.safeParse(e)}function mr(e){return{...e,title:e.title.value,system:e.system.value,description:{short:e.description.short.value,long:e.description.long.value},playerCount:{min:e.playerCount.min.value,max:e.playerCount.max.value}}}const Fe=[{name:"ab6jahren",label:"Ab 6 Jahren",description:"Spannungs- und Bedrohungsmomente werden kurz gehalten. In Begleitung oder nach Absprache mit einem Elternteil. Beispiele: My Little Pony, ..."},{name:"ab12jahren",label:"Ab 12 Jahren",description:"Antisoziales und destruktives wird auf ein Minimum begrenzt. Keine Diskriminierung, keine Radikalisierung, SexualitÃ¤t wird nicht explizit dargestellt."},{name:"ab18jahren",label:"Ab 18 Jahren",description:"Keinerlei Richtlinien bezÃ¼glich Inhalt, in der Gruppe sollte aber diskutiert werden, was akzeptabel ist und was nicht. Beispiele: Vampire the Masquerade, ..."},{name:"fantasy",label:"Fantasy",description:"Spielt in einer alternativen Vergangenheit, in welcher Elemente wie: Ritterinnen, Hexenmeister, RÃ¼stungen, Magie, Goblins, Turniere usw. vorkommen kÃ¶nnen. Beispiele: Das Schwarze Auge, Dungeons & Dragons, ..."},{name:"sciencefiction",label:"Science Fiction",description:"Spielt in einer alternativen Zukunft, in welcher Elemente wie: Raumschiffe, Sternenportale, KÃ¼nstliche Intelligenzen, Laserkanonen usw. vorkommen kÃ¶nnen. Beispiele: Shadowrun, Alien, ..."},{name:"postapokalyptisch",label:"Postapokalyptisch",description:"Spielt in einer Welt mitten oder nach einem Kollaps, wo die Mehrheit ums Ãberleben kÃ¤mpft. Beispiele: Mutant Year Zero, Apocalypse World"},{name:"horror",label:"Horror",description:"Eine gruselige AtmosphÃ¤re, psychologischer Druck oder unvorhersehbare Schreckensmomente. Beispiele: Cthulhu, ..."},{name:"offenewelt",label:"Offene Welt",description:"Es gibt nur einen losen Handlungsfaden, die Rollenspiel-Gruppe muss sich ihre Ziele selber festlegen. Beispiele: Ironsworn, Blades in the Dark, ..."},{name:"gemeinsamespielleitung",label:"Gemeinsame Spielleitung",description:"Die Regeln und die Umwelt werden gemeinsam von allen Spielenden umgesetzt. Beispiele: Microscope, The Quiet Year, ..."},{name:"regelleicht",label:"Regelleicht",description:"Die kompletten Regeln haben alle auf einer Seite Platz. Beispiele: Fiasco, Everyone is John, ..."},{name:"deutsch",label:"Deutsch",description:"Bei der Spielrunde reden die Spielenden miteinander Deutsch."},{name:"englisch",label:"Englisch",description:"Bei der Spielrunde reden die Spielenden miteinander Englisch."},{name:"workshop",label:"Workshop",description:"Unter Anleitung, gemeinsam ein Rollenspiel-Thema vertiefen. Kreative Techniken stehen im Vordergrund. Beispiele: Gemeinsam einen Dungeon erschaffen, gemeinsam eine Hintergrundgeschichte schreiben, ..."}],gt=200,an=500,sn=200;function hr(e){const t=e.title.value.trim().length===0,n=e.description.short.value.trim().length===0,l=e.description.short.value.length>gt,a=e.description.long.value.length>an,i=e.slots.length===0;return{titleMissing:t,descriptionShortMissing:n,descriptionShortTooLong:l,descriptionLongTooLong:a,slotMissing:i,hasErrors:t||n||l||a||i}}function $r(e){const t=e.updateText.value.trim().length===0,n=e.updateText.value.length>sn;return{missing:t,tooLong:n,hasErrors:t||n}}var Sr=g("<h3>"),_r=g("<br>"),br=g("<div style=margin-top:2rem;><h3 style=margin-bottom:1rem;></h3><ul class=event-list role=list>"),fr=g('<li><h3 class=event-title></h3><div class=event-details><div class=event-tags><strong>Status:</strong><!$><!/></div><div class=event-tags><strong>System:</strong><!$><!/></div><div class=event-tags><strong>Tag, Zeit:</strong><!$><!/></div><div class=event-tags><strong>Spielende:</strong> <!$><!/> - <!$><!/></div> <div class=event-tags><strong>Kategorien:</strong> <!$><!/></div></div><div class="event-description content"><p><strong>Kurzbeschreibung:</strong><br><!$><!/></p></div><ul role=list class=event-links><li><button class=event-link><span>Bearbeiten'),je=g("<em>"),vr=g("<span><!$><!/>, <!$><!/> - <!$><!/> Uhr");function yr(e){const[t,n]=A(e.store);function l(){const i=cr();n("games",t.games.length,i),e.changePage({kind:"EDIT_GAMEROUND",uuid:i.uuid})}const a=()=>e.store.games.flatMap(i=>i.slots.length===0?[{slot:null,game:i}]:i.slots.map(c=>({slot:c,game:i}))).toSorted((i,o)=>Ln(i.slot,o.slot));return[r(E,{get when(){return e.isEditable},get children(){return r(Ke,{icon:"grid-2-plus",type:"success",onClick:l,get children(){var i=d(Sr);return s(i,()=>x.createNewGameRound),i}})}}),d(_r),r(Ut,{label:"Ich habe wenig bis keine Spielleitung-Erfahrung und mÃ¶chte gerne in der Vorbereitung und/oder wÃ¤hrend der Spielrunde unterstÃ¼tzt werden.",get checked(){return t.wantsHelp},name:"wantsHelp",value:"wantsHelp",onValueUpdate:i=>{n("wantsHelp",i)},get disabled(){return!e.isEditable}}),r(E,{get when(){return a()},children:i=>(()=>{var o=d(br),c=o.firstChild,m=c.nextSibling;return s(c,()=>x.myGameRounds),s(m,r(W,{get each(){return i().filter(({game:h})=>h.kind!=="archived")},children:({game:h,slot:S})=>{const _=Fe.filter($=>h.tagNames.includes($.name)).map(({label:$})=>$);return r(kr,{game:h,slot:S,tags:_,get changePage(){return e.changePage}})}})),o})()})]}function kr(e){const{game:t,slot:n,tags:l,changePage:a}=e;return(()=>{var i=d(fr),o=i.firstChild,c=o.nextSibling,m=c.firstChild,h=m.firstChild,S=h.nextSibling,[_,$]=u(S.nextSibling),b=m.nextSibling,y=b.firstChild,k=y.nextSibling,[p,C]=u(k.nextSibling),N=b.nextSibling,I=N.firstChild,L=I.nextSibling,[Y,te]=u(L.nextSibling),T=N.nextSibling,J=T.firstChild,ne=J.nextSibling,Z=ne.nextSibling,[B,K]=u(Z.nextSibling),z=B.nextSibling,ae=z.nextSibling,[oe,P]=u(ae.nextSibling),re=T.nextSibling,V=re.nextSibling,Q=V.firstChild,de=Q.nextSibling,M=de.nextSibling,[X,ue]=u(M.nextSibling),ce=c.nextSibling,ee=ce.firstChild,he=ee.firstChild,be=he.nextSibling,Ee=be.nextSibling,[Ce,$e]=u(Ee.nextSibling),fe=ce.nextSibling,Se=fe.firstChild,we=Se.firstChild;return s(o,(()=>{var R=O(()=>t.title.value.length>0);return()=>R()?t.title.value:(()=>{var ge=d(je);return s(ge,()=>x.missingTitle),ge})()})()),s(m,()=>x.publishingSteps[t.kind],_,$),s(b,()=>t.system.value||(()=>{var R=d(je);return s(R,()=>x.missingSystem),R})(),p,C),s(N,n!==null?(()=>{var R=d(vr),ge=R.firstChild,[De,Ge]=u(ge.nextSibling),Re=De.nextSibling,He=Re.nextSibling,[ve,mt]=u(He.nextSibling),ht=ve.nextSibling,$t=ht.nextSibling,[Ye,St]=u($t.nextSibling);return Ye.nextSibling,s(R,()=>x.days[n.day],De,Ge),s(R,()=>n.from,ve,mt),s(R,()=>n.to,Ye,St),R})():(()=>{var R=d(je);return s(R,()=>x.missingSlot),R})(),Y,te),s(T,()=>t.playerCount.min.value,B,K),s(T,()=>t.playerCount.max.value,oe,P),s(V,()=>l.join(", ")||(()=>{var R=d(je);return s(R,()=>x.missingTags),R})(),X,ue),s(ee,(()=>{var R=O(()=>t.description.short.value.length===0);return()=>R()?(()=>{var ge=d(je);return s(ge,()=>x.missingShortDescription),ge})():Vt(t.description.short.value,gt)})(),Ce,$e),we.$$click=()=>a({kind:"EDIT_GAMEROUND",uuid:t.uuid}),me(()=>Ue(i,["event-entry",t.kind==="draft"?"gray":""].join(" "))),ot(),i})()}st(["click"]);var xr=g("<div class=game-dialog><ul role=list style=display:grid;gap:0.5rem;><li><strong style=color:var(--clr-accent-1);>Spielleitung:</strong><br> <!$><!/></li><li><strong style=color:var(--clr-accent-1);>System:</strong><br><!$><!/></li><li><strong style=color:var(--clr-accent-1);>Tag, Zeit:</strong> <br><!$><!/>, <!$><!/> - <!$><!/> Uhr</li><li><strong style=color:var(--clr-accent-1);>Freie PlÃ¤tze:</strong><br><!$><!/> (von <!$><!/>)</li><li><strong style=color:var(--clr-accent-1);>Kategorien:</strong><br><!$><!/></li><li><strong style=color:var(--clr-accent-1);>Kurze Beschreibung:</strong><br><!$><!/></li><li><strong style=color:var(--clr-accent-1);>Lange Beschreibung:</strong><br><!$><!/></li></ul><div class=reservations><h5 style=margin-block-start:0>PlÃ¤tze reservieren</h5><div class=reservation-table>"),pr=g("<em>kein System angegeben"),Er=g("<em>keine Kategorien"),Cr=g("<em>Keine lange Beschreibung angegeben."),wr=g("<div class=count>"),Rr=g("<div class=reservation-table-entry><p>Reserviert fÃ¼r mich </p><!$><!/>"),Ar=g('<div class=reservation-table-entry><p>Reserviert fÃ¼r "<!$><!/>"</p><!$><!/>'),Tr=g('<div style="display:grid;gap:1rem;grid-template-columns:max-content 1fr;"><!$><!/><!$><!/>'),Ur=g('<form style="display:grid;gap:0rem;grid-template-columns:1fr max-content"class=input-button><input type=text style=border-color:var(--clr-special-9);><!$><!/>');function Dr(e){const t=()=>e.reservations.filter(m=>m.gameRound===e.entry.uuid),n=Math.max(e.entry.playerCount.reserved+1-t.length,1),l=e.entry.tags.map(m=>Fe.find(({name:h})=>h===m)).filter(m=>m!==void 0).map(({label:m})=>m),a=e.entry.playerCount.max,i=()=>en(a).map(m=>{const h=t()[m];return h!==void 0?h:m+1===a?{kind:"RESERVED_SPONTANIOUS"}:a-n<=m?{kind:"RESERVED_OTHER"}:{kind:"FREE"}}),o=()=>t().find(m=>m.kind==="SELF")!==void 0,c=()=>{const m=i().filter(S=>S.kind==="SELF"||S.kind==="FRIEND").length,h=e.entry.playerCount.max-1-e.entry.playerCount.reserved-m;return Math.max(h,0)};return(()=>{var m=d(xr),h=m.firstChild,S=h.firstChild,_=S.firstChild,$=_.nextSibling,b=$.nextSibling,y=b.nextSibling,[k,p]=u(y.nextSibling),C=S.nextSibling,N=C.firstChild,I=N.nextSibling,L=I.nextSibling,[Y,te]=u(L.nextSibling),T=C.nextSibling,J=T.firstChild,ne=J.nextSibling,Z=ne.nextSibling,B=Z.nextSibling,[K,z]=u(B.nextSibling),ae=K.nextSibling,oe=ae.nextSibling,[P,re]=u(oe.nextSibling),V=P.nextSibling,Q=V.nextSibling,[de,M]=u(Q.nextSibling);de.nextSibling;var X=T.nextSibling,ue=X.firstChild,ce=ue.nextSibling,ee=ce.nextSibling,[he,be]=u(ee.nextSibling),Ee=he.nextSibling,Ce=Ee.nextSibling,[$e,fe]=u(Ce.nextSibling);$e.nextSibling;var Se=X.nextSibling,we=Se.firstChild,R=we.nextSibling,ge=R.nextSibling,[De,Ge]=u(ge.nextSibling),Re=Se.nextSibling,He=Re.firstChild,ve=He.nextSibling,mt=ve.nextSibling,[ht,$t]=u(mt.nextSibling),Ye=Re.nextSibling,St=Ye.firstChild,$n=St.nextSibling,Sn=$n.nextSibling,[_n,bn]=u(Sn.nextSibling),fn=h.nextSibling,vn=fn.firstChild,yn=vn.nextSibling;return s(S,()=>e.entry.gamemaster,k,p),s(C,(()=>{var F=O(()=>e.entry.system.trim().length>0);return()=>F()?e.entry.system:d(pr)})(),Y,te),s(T,()=>x.days[e.entry.slot.day],K,z),s(T,()=>e.entry.slot.from,P,re),s(T,()=>e.entry.slot.to,de,M),s(X,c,he,be),s(X,()=>e.entry.playerCount.max,$e,fe),s(Se,(()=>{var F=O(()=>l.length>0);return()=>F()?l.join(", "):d(Er)})(),De,Ge),s(Re,()=>e.entry.description.short,ht,$t),s(Ye,(()=>{var F=O(()=>e.entry.description.long.trim().length>0);return()=>F()?O(()=>e.entry.description.long):d(Cr)})(),_n,bn),s(yn,r(W,{get each(){return i()},children:(F,kn)=>[(()=>{var G=d(wr);return s(G,()=>kn()+1),G})(),r(xe,{get children(){return[r(U,{get when(){return F.kind==="RESERVED_OTHER"},get children(){return r(w,{children:"Bereits reserviert"})}}),r(U,{get when(){return F.kind==="RESERVED_SPONTANIOUS"},get children(){return r(w,{children:"Reserviert fÃ¼r spontane Spieler:innen"})}}),r(U,{get when(){return!e.isEditable},get children(){return r(w,{children:"Freier Platz"})}}),r(U,{get when(){return F.kind==="SELF"},get children(){return r(Mt,{type:"success",get children(){var G=d(Rr),Ae=G.firstChild,Oe=Ae.nextSibling,[Be,Ne]=u(Oe.nextSibling);return s(G,r(qe,{icon:"trash",onClick:()=>e.removeReservation(F.kind==="SELF"?F.uuid:"should not happen")}),Be,Ne),G}})}}),r(U,{get when(){return F.kind==="FRIEND"},get children(){return r(Mt,{type:"success",get children(){var G=d(Ar),Ae=G.firstChild,Oe=Ae.firstChild,Be=Oe.nextSibling,[Ne,_t]=u(Be.nextSibling);Ne.nextSibling;var bt=Ae.nextSibling,[ft,xn]=u(bt.nextSibling);return s(Ae,()=>F.kind==="FRIEND"?F.name:"[Fehler beim Laden]",Ne,_t),s(G,r(qe,{icon:"trash",onClick:()=>e.removeReservation(F.kind==="FRIEND"?F.uuid:"should not happen")}),ft,xn),G}})}}),r(U,{get when(){return F.kind==="FREE"},get children(){return r(E,{get when(){return o()},get fallback(){return(()=>{var G=d(Tr),Ae=G.firstChild,[Oe,Be]=u(Ae.nextSibling),Ne=Oe.nextSibling,[_t,bt]=u(Ne.nextSibling);return s(G,r(H,{icon:"person-to-portal",label:"Mich anmelden",kind:"success",onClick:()=>e.addReservation({kind:"SELF",gameRound:e.entry.uuid})}),Oe,Be),s(G,r(Gt,{addFriend:ft=>e.addReservation({kind:"FRIEND",gameRound:e.entry.uuid,name:ft})}),_t,bt),G})()},get children(){return r(Gt,{addFriend:G=>e.addReservation({kind:"FRIEND",gameRound:e.entry.uuid,name:G})})}})}})]}})]})),m})()}function Gt(e){const[t,n]=Tt("");return(()=>{var l=d(Ur),a=l.firstChild,i=a.nextSibling,[o,c]=u(i.nextSibling);return l.addEventListener("submit",m=>{m.preventDefault();const h=t();h.trim().length>0&&e.addFriend(h)}),lt(l,"novalidate",!0),a.$$input=m=>n(m.target.value),s(l,r(H,{icon:"arrow-right",type:"submit",label:"Begleitperson anmelden",kind:"special"}),o,c),me(()=>lt(a,"value",t())),ot(),l})()}st(["input"]);var Or=g("<div style=display:flex;flex-wrap:wrap;gap:1rem;justify-content:space-between;><h5 style=margin:0;>Filter</h5><!$><!/>"),Nr=g("<h6 style=margin-block:0.5rem;>Tage"),Mr=g("<div style=display:flex;flex-wrap:wrap;gap:0.5rem;><!$><!/><!$><!/>"),Ir=g("<h6 style=margin-block:0.5rem;>Kategorien <span>"),Pr=g("<div style=display:flex;flex-wrap:wrap;gap:0.5rem;>");const se={day:"fDay",tags:"fTags",options:"fOpts"};function Lr(){const e=new URL(location.href),t=e.searchParams.get(se.day),n=t==="SATURDAY"||t==="SUNDAY"?t:null,l=e.searchParams.getAll(se.tags),a=e.searchParams.getAll(se.options);return{day:n,tags:l,withOpenSeats:a.includes("withOpenSeats"),iHaveTime:a.includes("iHaveTime")}}function Fr(e,t){return{toggleDay:n=>{const l=e.day===n,a=new URL(location.href);l?(a.searchParams.delete(se.day),t("day",null)):(a.searchParams.set(se.day,n),t("day",n)),history.pushState(Ze(e),"",a)},toggleTag:n=>{const l=e.tags.includes(n),a=new URL(location.href);l?(a.searchParams.delete(se.tags),t("tags",e.tags.filter(i=>i!==n)),e.tags.forEach(i=>{a.searchParams.append(se.tags,i)})):(a.searchParams.append(se.tags,n),t("tags",e.tags.length,n)),history.pushState(Ze(e),"",a)},toggleOption:n=>{const l=e[n],a=new URL(location.href);t(n,!l),["withOpenSeats","iHaveTime"].forEach(i=>{e[i]&&a.searchParams.append(se.options,i)}),history.pushState(Ze(e),"",a)},reset:()=>{t({day:null,tags:[],withOpenSeats:!1,iHaveTime:!1});const n=new URL(location.href);n.searchParams.delete(se.day),n.searchParams.delete(se.tags),n.searchParams.delete(se.options),history.pushState(Ze(e),"",n)}}}function Gr(e){const[t,n]=A(e.activeFilter),l=Fr(t,n);return r(w,{get children(){return[(()=>{var a=d(Or),i=a.firstChild,o=i.nextSibling,[c,m]=u(o.nextSibling);return s(a,r(H,{label:"Filter zurÃ¼cksetzen",icon:"circle-xmark",kind:"ghost-danger",onClick:()=>l.reset()}),c,m),a})(),d(Nr),(()=>{var a=d(Mr),i=a.firstChild,[o,c]=u(i.nextSibling),m=o.nextSibling,[h,S]=u(m.nextSibling);return s(a,r(j,{label:"Samstag",get kind(){return t.day!=="SUNDAY"?"success":"gray"},onClick:()=>l.toggleDay("SATURDAY")}),o,c),s(a,r(j,{label:"Sonntag",get kind(){return t.day!=="SATURDAY"?"success":"gray"},onClick:()=>l.toggleDay("SUNDAY")}),h,S),a})(),(()=>{var a=d(Ir),i=a.firstChild,o=i.nextSibling;return s(o,r(qe,{icon:"circle-question",kind:"ghost",title:"ErklÃ¤rungen der Kategorien",get onClick(){return e.showExplanationOfCategories}})),a})(),(()=>{var a=d(Pr);return s(a,r(W,{each:Fe,children:i=>r(j,{get label(){return i.label},get kind(){return t.tags.length===0||t.tags.includes(i.name)?"success":"gray"},onClick:()=>l.toggleTag(i.name)})})),a})()]}})}function Hr(e,t){return e.filter(n=>!(t.day!==n.slot.day&&t.day!==null||!Yr(n.tags,t.tags)))}function Yr(e,t){return t.length===0?!0:t.filter(l=>!e.includes(l)).length===0}var Ie=g("<br>"),Br=g("<ul style=padding:0;padding-block-start:1rem;margin:0;max-inline-size:100%;display:grid;gap:0.5rem;>"),zr=g("<li><strong></strong><br><p>"),jr=g("<p>Programm konnte nicht geladen werden."),Wr=g("<em><!$><!/> von <!$><!/> Runden gefunden."),Zr=g("<h3>"),Kr=g("<h4 style=margin-block-start:2rem;margin-block-end:1rem;>Start: <!$><!/> Uhr"),Vr=g('<ul class="event-list max"role=list>'),qr=g("<small><!$><!/> - <!$><!/> Uhr"),Jr=g("<h4 style=margin-block-end:0.5rem;>"),Qr=g("<em>Das MenÃ¼ wird zu einem spÃ¤teren Zeitpunkt kommuniziert."),Xr=g("<div style=margin-block-start:2rem;>"),ei=g('<li><h3 class=event-title></h3><div class=event-details><div class=event-tags><strong>Spielleitung:</strong><!$><!/></div><div class=event-tags><strong>System:</strong><!$><!/></div><div class=event-tags><strong>Tag, Zeit:</strong><span><!$><!/>, <!$><!/> - <!$><!/> Uhr</span></div><div class=event-tags><strong>Freie PlÃ¤tze:</strong> <!$><!/> (von <!$><!/>)</div> <div class=event-tags><strong>Kategorien:</strong> <!$><!/></div></div><div class="event-description content"><p><strong>Kurzbeschreibung:</strong><br><!$><!/></p></div><ul role=list class=event-links><li><button class=event-link><span>Details & Teilnahme'),ti=g("<em>kein System angegeben"),ni=g("<em>keine Kategorien");function ri(e){const[t,n]=A({playing:e.store,activeFilter:Lr(),categoryDialog:ye()});return[r(Ut,{label:"Schickt mir bitte E-Mails, wenn neue Spielrunden verÃ¶ffentlicht werden.",get checked(){return t.playing.wantsUpdates},name:"wantsUpdates",value:"wantsUpdates",onValueUpdate:l=>{n("playing","wantsUpdates",l)}}),d(Ie),r(Gr,{get activeFilter(){return t.activeFilter},showExplanationOfCategories:()=>n("categoryDialog","open",!0)}),r(pe,{get store(){return t.categoryDialog},title:"ErklÃ¤rungen der Kategorien",onClose:()=>{},size:"medium",get children(){var l=d(Br);return s(l,()=>Fe.map(a=>(()=>{var i=d(zr),o=i.firstChild,c=o.nextSibling,m=c.nextSibling;return s(o,()=>a.label),s(m,()=>a.description),i})())),l}}),d(Ie),r(dt,{get fallback(){return r(w,{get children(){return x.loading.program}})},get children(){return r(E,{get when(){return e.program()},get fallback(){return r(w,{type:"danger",get children(){return x.error.program}})},children:l=>r(E,{get when(){return l().kind==="SUCCESS"},get fallback(){return r(w,{type:"danger",get children(){return d(jr)}})},get children(){return r(ii,{get program(){return l().data},get filter(){return t.activeFilter},get reservations(){return t.playing.reservations},get isEditable(){return e.isEditable},addReservation:a=>n("playing","reservations",t.playing.reservations.length,{...a,uuid:crypto.randomUUID()}),removeReservation:a=>{n("playing","reservations",t.playing.reservations.filter(i=>i.uuid!==a))},get uuid(){return e.uuid},get changePage(){return e.changePage}})}})})}})]}function ii(e){const[t,n]=A(ye(e.uuid!==void 0));Jt(()=>{n("open",e.uuid!==null)});const l=()=>e.program.find(o=>o.uuid===e.uuid),a=()=>Hr(e.program,e.filter),i=()=>si(ai(a()));return[(()=>{var o=d(Wr),c=o.firstChild,[m,h]=u(c.nextSibling),S=m.nextSibling,_=S.nextSibling,[$,b]=u(_.nextSibling);return $.nextSibling,s(o,()=>a().length,m,h),s(o,()=>e.program.length,$,b),o})(),d(Ie),r(E,{get when(){return l()},children:o=>r(pe,{store:t,get title(){return o().title},onClose:()=>e.changePage({kind:"PLAYER"},{disableScroll:!0}),size:"large",get children(){return r(Dr,{get entry(){return o()},get reservations(){return e.reservations},get isEditable(){return e.isEditable},get addReservation(){return e.addReservation},get removeReservation(){return e.removeReservation}})}})}),d(Ie),r(Ht,{day:"SATURDAY",get programOfDay(){return i().SATURDAY},get changePage(){return e.changePage}}),d(Ie),d(Ie),r(Ht,{day:"SUNDAY",get programOfDay(){return i().SUNDAY},get changePage(){return e.changePage}})]}function Ht(e){const t=()=>Object.values(e.programOfDay).flat().length>0,l=Te[e.day].breaks.map(i=>i.from),a=i=>l.indexOf(i)===0?"LUNCH":"DINNER";return[(()=>{var i=d(Zr);return s(i,()=>x.days[e.day]),i})(),r(E,{get when(){return t()},get fallback(){return r(w,{get children(){return["Keine Spielrunden mit den ausgewÃ¤hlten Filtern am"," ",O(()=>x.days[e.day])," gefunden."]}})},get children(){return r(W,{get each(){return Object.entries(e.programOfDay)},children:([i,o])=>l.includes(Number(i))?r(li,{get type(){return a(Number(i))},get range(){return{from:Number(i),to:Number(i)+1}}}):o.length===0?null:[(()=>{var c=d(Kr),m=c.firstChild,h=m.nextSibling,[S,_]=u(h.nextSibling);return S.nextSibling,s(c,i,S,_),c})(),(()=>{var c=d(Vr);return s(c,r(W,{each:o,children:m=>r(oi,{entry:m,get changePage(){return e.changePage}})})),c})()]})}})]}function li(e){const t=e.type==="LUNCH"?"Mittagessen":"Nachtessen";return(()=>{var n=d(Xr);return s(n,r(w,{get children(){return[(()=>{var l=d(qr),a=l.firstChild,[i,o]=u(a.nextSibling),c=i.nextSibling,m=c.nextSibling,[h,S]=u(m.nextSibling);return h.nextSibling,s(l,()=>e.range.from,i,o),s(l,()=>e.range.to,h,S),l})(),(()=>{var l=d(Jr);return s(l,t),l})(),d(Qr)]}})),n})()}function ai(e){const t=Object.groupBy(e,n=>n.slot.day);return{SATURDAY:t.SATURDAY??[],SUNDAY:t.SUNDAY??[]}}function si(e){function t(o,c){const{from:m,to:h}=o.slot,{from:S,to:_}=c.slot;return m===S?h-_:m-S}const n=e.SATURDAY.toSorted(t),l=e.SUNDAY.toSorted(t),a=Je(Te.SATURDAY.open).reduce((o,c)=>(o[c]=n.filter(m=>m.slot.from===c),o),{}),i=Je(Te.SUNDAY.open).reduce((o,c)=>(o[c]=l.filter(m=>m.slot.from===c),o),{});return{SATURDAY:a,SUNDAY:i}}function oi(e){const t=Fe.filter(n=>e.entry.tags.includes(n.name)).map(({label:n})=>n);return(()=>{var n=d(ei),l=n.firstChild,a=l.nextSibling,i=a.firstChild,o=i.firstChild,c=o.nextSibling,[m,h]=u(c.nextSibling),S=i.nextSibling,_=S.firstChild,$=_.nextSibling,[b,y]=u($.nextSibling),k=S.nextSibling,p=k.firstChild,C=p.nextSibling,N=C.firstChild,[I,L]=u(N.nextSibling),Y=I.nextSibling,te=Y.nextSibling,[T,J]=u(te.nextSibling),ne=T.nextSibling,Z=ne.nextSibling,[B,K]=u(Z.nextSibling);B.nextSibling;var z=k.nextSibling,ae=z.firstChild,oe=ae.nextSibling,P=oe.nextSibling,[re,V]=u(P.nextSibling),Q=re.nextSibling,de=Q.nextSibling,[M,X]=u(de.nextSibling);M.nextSibling;var ue=z.nextSibling,ce=ue.nextSibling,ee=ce.firstChild,he=ee.nextSibling,be=he.nextSibling,[Ee,Ce]=u(be.nextSibling),$e=a.nextSibling,fe=$e.firstChild,Se=fe.firstChild,we=Se.nextSibling,R=we.nextSibling,[ge,De]=u(R.nextSibling),Ge=$e.nextSibling,Re=Ge.firstChild,He=Re.firstChild;return s(l,()=>e.entry.title),s(i,()=>e.entry.gamemaster,m,h),s(S,(()=>{var ve=O(()=>e.entry.system.trim().length>0);return()=>ve()?e.entry.system:d(ti)})(),b,y),s(C,()=>x.days[e.entry.slot.day],I,L),s(C,()=>e.entry.slot.from,T,J),s(C,()=>e.entry.slot.to,B,K),s(z,()=>Math.max(e.entry.playerCount.max-1-e.entry.playerCount.reserved,0),re,V),s(z,()=>e.entry.playerCount.max,M,X),s(ce,(()=>{var ve=O(()=>t.length>0);return()=>ve()?t.join(", "):d(ni)})(),Ee,Ce),s(fe,()=>Vt(e.entry.description.short,gt),ge,De),He.$$click=()=>e.changePage({kind:"GAME",uuid:e.entry.uuid},{disableScroll:!0}),me(()=>Ue(n,["event-entry"].join(" "))),ot(),n})()}st(["click"]);var di=g("<h3>Spielrunden ansehen"),ui=g("<p>Melde dich (und deine Freunde) fÃ¼r diverse Spielrunden an."),Et=g("<br>"),ci=g("<h3>Spielrunden erstellen"),gi=g("<p>Falls du wenig oder gar keine Erfahrung als Spielleiter:in hast, werden wir dich vor und wÃ¤hrend dem Anlass unterstÃ¼tzen."),mi=g("<h3>Helfen"),hi=g("<p>Beim Kiosk und der Essensausgabe kÃ¶nnen wir immer ein paar helfende HÃ¤nde gebrauchen."),$i=g("<p><strong>Noch nicht verfÃ¼gbar."),Si=g("<h3>Zusammenfassung"),_i=g("<p>Erhalte einen Ãberblick Ã¼ber dein gesamtes Programm.");function bi(e){return[r(Ke,{icon:"dice-d20",onClick:()=>e.changePage({kind:"PLAYER"}),get children(){return[d(di),d(ui)]}}),d(Et),r(Ke,{icon:"grid-2-plus",onClick:()=>e.changePage({kind:"GAMEMASTER"}),get children(){return[d(ci),d(gi)]}}),d(Et),r(Ke,{type:"gray",icon:"hand-heart",onClick:()=>e.changePage({kind:"HELPING"}),get children(){return[d(mi),d(hi),d($i)]}}),d(Et),r(Ke,{icon:"list",onClick:()=>e.changePage({kind:"SUMMARY"}),get children(){return[d(Si),d(_i)]}})]}var fi=g("<fieldset><legend>Zeitslots</legend><!$><!/><!$><!/>"),Yt=g("<br>"),vi=g("<div style=margin-block-end:0.5rem;>Zeitslot: <!$><!/>, <!$><!/> -<!$><!/> Uhr"),yi=g("<ul class=event-list role=list>"),ki=g("<em>werden geladen..."),xi=g("<li class=event-entry><h3 class=event-title><!$><!/>, <!$><!/> - <!$><!/> Uhr</h3><div class=event-details><div class=event-tags><strong>Dauer:</strong><!$><!/> <!$><!/></div><div class=event-tags><strong>Spielende:</strong> <!$><!/></div></div><div></div><ul role=list class=event-links>"),pi=g("<em>Fehler beim Laden."),Ei=g("<em>noch keine Anmeldungen"),Ci=g("<li><em style=font-size:smaller;>Aktionen werden geladen..."),Bt=g("<li><em style=font-size:smaller;>kann nicht gelÃ¶scht werden"),wi=g("<li><button type=button class=event-link><div style=display:flex;gap:0.25rem;align-items:center;><!$><!/><span>LÃ¶schen"),Ri=g("<div style=display:grid;gap:0.5rem;>"),Ai=g("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/>"),Ti=g("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/><!$><!/>"),Ui=g("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/><!$><!/><div style=margin-block-start:1rem;>"),Di=g("<div style=display:flex;flex-wrap:wrap;gap:0.5rem;align-items:center;><!$><!/> <span>Neuen Slot erfassen"),Oi=g("<em>WÃ¤hle eine Tag:"),Ni=g("<div style=display:flex;flex-wrap:wrap;gap:.5rem;><!$><!/><!$><!/>"),Mi=g("<em>WÃ¤hle eine Startzeit:"),on=g("<div style=display:flex;flex-wrap:wrap;gap:.5rem;>"),dn=g("<span style=white-space:nowrap;><!$><!/> Uhr"),Ii=g("<em>WÃ¤hle eine Endzeit:");function Pi(e){return(()=>{var t=d(fi),n=t.firstChild,l=n.nextSibling,[a,i]=u(l.nextSibling),o=a.nextSibling,[c,m]=u(o.nextSibling);return s(t,r(Fi,{get store(){return e.store},get registrations(){return e.registrations},get isEditable(){return e.isEditable}}),a,i),s(t,r(E,{get when(){return e.slotMissing},get children(){return r(w,{type:"danger",children:"WÃ¤hle mindestens einen Zeitslot aus."})}}),c,m),t})()}const zt=1;function Li(e){function t(n){const l=Je(n.open,!0);return n.breaks.map(i=>Je(i,!0)).reduce((i,o)=>{const c=o.at(0),m=o.at(-1);if(c===void 0||m===void 0)return i;const h=[];return i.forEach(S=>{const _=[],$=[];S.forEach(b=>{b<=c&&_.push(b),m<=b&&$.push(b)}),_.length>0&&h.push(_),$.length>0&&h.push($)}),h},[l]).map(i=>{const o=i.slice(0,zt*-1);return wn(o.map(c=>{const m=i.filter(h=>h>=c+zt);return[c,m]}))}).reduce((i,o)=>({...i,...o}),{})}return{SATURDAY:t(e.SATURDAY),SUNDAY:t(e.SUNDAY)}}function Fi(e){const[t,n]=A(e.store),[l,a]=A({dialog:ye()}),i=at(()=>Li(Te));function o(h){n(t.concat(h))}function c(h){a("dialog","open",!1),a("slot",void 0),n(t.filter(S=>S.uuid!==h))}function m(h){a("dialog","open",!0),a("slot",t.find(S=>S.uuid===h))}return[r(Hi,{get daySections(){return i()},chooseTimeSlot:o,get isEditable(){return e.isEditable}}),d(Yt),d(Yt),r(pe,{get store(){return l.dialog},title:"Zeitslot lÃ¶schen",onClose:()=>a("slot",void 0),get children(){return[(()=>{var h=d(vi),S=h.firstChild,_=S.nextSibling,[$,b]=u(_.nextSibling),y=$.nextSibling,k=y.nextSibling,[p,C]=u(k.nextSibling),N=p.nextSibling,I=N.nextSibling,[L,Y]=u(I.nextSibling);return L.nextSibling,s(h,()=>x.days[l.slot?.day],$,b),s(h,()=>l.slot?.from,p,C),s(h,()=>l.slot?.to,L,Y),h})(),r(H,{kind:"danger",icon:"trash",label:"LÃ¶schen",onClick:()=>c(l.slot?.uuid)})]}}),r(Gi,{slots:t,get registrations(){return e.registrations},confirmRemoval:m,get isEditable(){return e.isEditable}})]}function Gi(e){return(()=>{var t=d(yi);return s(t,r(W,{get each(){return Yi(e.slots)},children:n=>(()=>{var l=d(xi),a=l.firstChild,i=a.firstChild,[o,c]=u(i.nextSibling),m=o.nextSibling,h=m.nextSibling,[S,_]=u(h.nextSibling),$=S.nextSibling,b=$.nextSibling,[y,k]=u(b.nextSibling);y.nextSibling;var p=a.nextSibling,C=p.firstChild,N=C.firstChild,I=N.nextSibling,[L,Y]=u(I.nextSibling),te=L.nextSibling,T=te.nextSibling,[J,ne]=u(T.nextSibling),Z=C.nextSibling,B=Z.firstChild,K=B.nextSibling,z=K.nextSibling,[ae,oe]=u(z.nextSibling),P=p.nextSibling,re=P.nextSibling;return s(a,()=>x.days[n.day],o,c),s(a,()=>n.from,S,_),s(a,()=>n.to,y,k),s(C,()=>n.to-n.from,L,Y),s(C,()=>n.to-n.from>1?"Stunden":"Stunde",J,ne),s(Z,r(xe,{get children(){return[r(U,{get when(){return e.registrations.loading},get children(){return d(ki)}}),r(U,{get when(){return e.registrations()},children:V=>{const Q=V();if(Q.kind==="FAILURE")return d(pi);const de=Q.data.filter(M=>M.uuid===n.uuid).map(M=>M.name);return O(()=>de.join(", ")||d(Ei))}})]}}),ae,oe),s(re,r(dt,{get fallback(){return d(Ci)},get children(){return r(E,{get when(){return e.registrations()},children:V=>{const Q=V();return Q.kind==="FAILURE"?d(Bt):Q.data.filter(M=>M.uuid===n.uuid).map(M=>M.name).length>0?d(Bt):(()=>{var M=d(wi),X=M.firstChild,ue=X.firstChild,ce=ue.firstChild,[ee,he]=u(ce.nextSibling);return ee.nextSibling,X.$$click=()=>e.confirmRemoval(n.uuid),s(ue,r(ie,{icon:"trash"}),ee,he),me(()=>lt(X,"disabled",!e.isEditable)),ot(),M})()}})}})),l})()})),t})()}function Hi(e){const[t,n]=A({slot:{kind:"CHOOSE_DAY"},dialog:ye()});function l(){n("slot",{kind:"CHOOSE_DAY"}),n("dialog","open",!1)}function a(i){e.chooseTimeSlot(i),l()}return[r(j,{kind:"success",get label(){return(()=>{var i=d(Di),o=i.firstChild,[c,m]=u(o.nextSibling);return c.nextSibling,s(i,r(ie,{icon:"circle-plus"}),c,m),i})()},onClick:()=>n("dialog","open",!0),get disabled(){return!e.isEditable}}),r(pe,{title:"Zeitslot erfassen",get store(){return t.dialog},size:"medium",onClose:l,get children(){return r(xe,{get children(){return[r(U,{get when(){return t.slot.kind==="CHOOSE_DAY"},get children(){var i=d(Ri);return s(i,r(nt,{changeDay:o=>n("slot",{kind:"CHOOSE_START",day:o})})),i}}),r(U,{get when(){return t.slot.kind==="CHOOSE_START"},get children(){var i=d(Ai),o=i.firstChild,[c,m]=u(o.nextSibling),h=c.nextSibling,[S,_]=u(h.nextSibling);return s(i,r(nt,{get chosenDay(){return t.slot.kind==="CHOOSE_START"?t.slot.day:void 0},changeDay:$=>n("slot",{kind:"CHOOSE_START",day:$})}),c,m),s(i,r(Ct,{get startTimes(){return O(()=>t.slot.kind==="CHOOSE_START")()?yt(e.daySections[t.slot.day]):[]},changeStart:$=>n("slot",{kind:"CHOOSE_END",start:$})}),S,_),i}}),r(U,{get when(){return t.slot.kind==="CHOOSE_END"},get children(){var i=d(Ti),o=i.firstChild,[c,m]=u(o.nextSibling),h=c.nextSibling,[S,_]=u(h.nextSibling),$=S.nextSibling,[b,y]=u($.nextSibling);return s(i,r(nt,{get chosenDay(){return t.slot.kind==="CHOOSE_END"?t.slot.day:void 0},changeDay:k=>n("slot",{kind:"CHOOSE_START",day:k})}),c,m),s(i,r(Ct,{get chosenStart(){return t.slot.kind==="CHOOSE_END"?t.slot.start:void 0},get startTimes(){return O(()=>t.slot.kind==="CHOOSE_END")()?yt(e.daySections[t.slot.day]):[]},changeStart:k=>n("slot",{kind:"CHOOSE_END",start:k})}),S,_),s(i,r(jt,{get endTimes(){return t.slot.kind==="CHOOSE_END"?e.daySections[t.slot.day][t.slot.start]??[]:[]},changeEnd:k=>{t.slot.kind==="CHOOSE_END"&&n("slot",{kind:"WAIT_FOR_CONFIRMATION",day:t.slot.day,start:t.slot.start,end:k})}}),b,y),i}}),r(U,{get when(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"},get children(){var i=d(Ui),o=i.firstChild,[c,m]=u(o.nextSibling),h=c.nextSibling,[S,_]=u(h.nextSibling),$=S.nextSibling,[b,y]=u($.nextSibling),k=b.nextSibling;return s(i,r(nt,{get chosenDay(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?t.slot.day:void 0},changeDay:p=>n("slot",{kind:"CHOOSE_START",day:p})}),c,m),s(i,r(Ct,{get chosenStart(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?t.slot.start:void 0},get startTimes(){return O(()=>t.slot.kind==="WAIT_FOR_CONFIRMATION")()?yt(e.daySections[t.slot.day]):[]},changeStart:p=>n("slot",{kind:"CHOOSE_END",start:p})}),S,_),s(i,r(jt,{get chosenEnd(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?t.slot.end:void 0},get endTimes(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?e.daySections[t.slot.day][t.slot.start]??[]:[]},changeEnd:p=>{t.slot.kind==="WAIT_FOR_CONFIRMATION"&&n("slot",{kind:"WAIT_FOR_CONFIRMATION",day:t.slot.day,start:t.slot.start,end:p})}}),b,y),s(k,r(j,{get label(){return`Slot "${t.slot.kind==="WAIT_FOR_CONFIRMATION"?`${x.days[t.slot.day]}, von ${t.slot.start} bis ${t.slot.end} Uhr`:""}" erstellen`},kind:"success",onClick:()=>{t.slot.kind==="WAIT_FOR_CONFIRMATION"&&a({uuid:crypto.randomUUID(),day:t.slot.day,from:t.slot.start,to:t.slot.end})}})),i}})]}})}})]}function nt(e){return[d(Oi),(()=>{var t=d(Ni),n=t.firstChild,[l,a]=u(n.nextSibling),i=l.nextSibling,[o,c]=u(i.nextSibling);return s(t,r(j,{get kind(){return e.chosenDay==="SATURDAY"?"success":"gray"},label:"Samstag",onClick:()=>e.changeDay("SATURDAY")}),l,a),s(t,r(j,{get kind(){return e.chosenDay==="SUNDAY"?"success":"gray"},label:"Sonntag",onClick:()=>e.changeDay("SUNDAY")}),o,c),t})()]}function Ct(e){return[d(Mi),(()=>{var t=d(on);return s(t,r(W,{get each(){return e.startTimes},children:n=>r(j,{get kind(){return e.chosenStart===n?"success":"gray"},get label(){return(()=>{var l=d(dn),a=l.firstChild,[i,o]=u(a.nextSibling);return i.nextSibling,s(l,n,i,o),l})()},onClick:()=>e.changeStart(n)})})),t})()]}function jt(e){return[d(Ii),(()=>{var t=d(on);return s(t,r(W,{get each(){return e.endTimes},children:n=>r(j,{get kind(){return e.chosenEnd===n?"success":"gray"},get label(){return(()=>{var l=d(dn),a=l.firstChild,[i,o]=u(a.nextSibling);return i.nextSibling,s(l,n,i,o),l})()},onClick:()=>e.changeEnd(n)})})),t})()]}function Yi(e){return e.toSorted((t,n)=>t.day!==n.day?t.day==="SATURDAY"?-1:1:t.from-n.from)}st(["click"]);const Bi={version:1,init:{name:"",email:"",mobile:""},lastSaved:new Date().toISOString(),playing:{wantsUpdates:!0,reservations:[]},master:{games:[],wantsHelp:!1},helping:{},publishState:"draft"};async function zi(e){const t=new URL(Le("/rst25/load"));t.searchParams.append("secret",e);const n=await fetch(t);if(!n.ok)return{kind:"FAILURE"};const l=await n.json();return typeof l=="object"&&l!==null?{kind:"SUCCESS",data:Object.assign(Bi,l)}:(console.error("`last_save` not found on ",l),{kind:"FAILURE"})}async function ji(e,t){try{const n=await fetch(Le("/rst25/save"),{method:"post",body:JSON.stringify({secret:t,save:e}),headers:{"Content-Type":"application/json"}});return n.ok?{kind:"SUCCESS",data:t}:(console.error(await n.text()),{kind:"FAILURE"})}catch(n){return console.error(n),{kind:"FAILURE"}}}async function Wi(e){try{const t=new URL(Le("/rst25/program"));t.searchParams.append("secret",e);const n=await fetch(t,{headers:{"Content-Type":"application/json"}});return n.ok?{kind:"SUCCESS",data:await n.json()}:(console.error(await n.text()),{kind:"FAILURE"})}catch(t){return console.error(t),{kind:"FAILURE"}}}async function Zi(e){try{const t=new URL(Le("/rst25/reservations"));t.searchParams.append("secret",e);const n=await fetch(t);return n.ok?{kind:"SUCCESS",data:await n.json()}:(console.error(await n.text()),{kind:"FAILURE"})}catch(t){return console.error(t),{kind:"FAILURE"}}}async function Ki(e){try{const t=await fetch(Le("/rst25/publishGameround"),{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});return t.ok?{kind:"SUCCESS",data:e.gameroundUuid}:(console.error(await t.text()),{kind:"FAILURE"})}catch(t){return console.error(t),{kind:"FAILURE"}}}async function Vi(e){try{const t=await fetch(Le("/rst25/sendGameroundUpdate"),{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});return t.ok?{kind:"SUCCESS",data:e.gameroundUuid}:(console.error(await t.text()),{kind:"FAILURE"})}catch(t){return console.error(t),{kind:"FAILURE"}}}function qi(e){return async()=>{await Ki(e)}}function Ji(e){return async()=>{await Vi(e)}}var Qe=g("<br>"),Qi=g("<div class=content><p>MÃ¶chtest du diese Spielrunde gerne verÃ¶ffentlichen?</p><!$><!/>"),Xi=g("<em>Informationen zu den Anmeldungen mÃ¼ssen geladen werden..."),el=g("<em>Du kannst kein Update versenden, da sich noch niemand fÃ¼r diese Spielrunde angemeldet hat."),tl=g("<p>An: <!$><!/>"),nl=g("<em>Du kannst die Spielrunde nur lÃ¶schen, wenn du zuerst alle Zeitslots entfernt hast."),rl=g("<div class=content><p>Bist du sicher, dass du die Spielrunde lÃ¶schen mÃ¶chtest?</p><!$><!/>"),il=g('<form novalidate><!$><!/><!$><!/><!$><!/><div style="display:grid;grid-template-columns:repeat(2, 1fr);gap:1rem;"><!$><!/><!$><!/></div><!$><!/><!$><!/><!$><!/><fieldset><legend>Kategorien (optional)</legend><!$><!/></fieldset><!$><!/><div style=display:flex;flex-wrap:wrap;gap:1rem;justify-content:space-between;><!$><!/><div style=display:flex;flex-wrap:wrap;gap:1rem;><!$><!/><!$><!/><!$><!/>'),ll=g("<h4>Spielrunde inkomplett"),al=g("<p>Du hast noch einen oder mehre Fehler/fehlende Informationen in dieser Spielrunde:"),sl=g("<li>Â«TitelÂ» ist ein Pflichtfeld."),ol=g("<li>Â«kurz BeschreibungÂ» ist ein Pflichtfeld."),dl=g("<li>Â«kurz BeschreibungÂ» ist zu lang."),ul=g("<li>Â«lange BeschreibungÂ» ist zu lang."),cl=g("<li>Mindest einen Zeitslot muss ausgewÃ¤hlt werden."),gl=g("<ul><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),ml=g("<p><strong>ErklÃ¤rung:</strong> Hast du eine wichtige Ãnderung an dieser Spielrunde durchgefÃ¼hrt, wÃ¤hrend bereits Spielende angemeldet waren? Lass hiermit die Angemeldeten wissen, was du geÃ¤ndert hast. Wichtige Ãnderungen kÃ¶nnen sein: System geÃ¤ndert, Kategorien geÃ¤ndert. FÃ¼r kleine Ãnderungen, wie z.B. Rechtschreibfehler, sollte dies nicht genutzt werden."),hl=g("<p><em>Halte dich kurz und am besten Stichwortartig."),$l=g("<form><!$><!/><!$><!/>"),Sl=g("<div style=display:grid;gap:0.5rem;margin-block-end:1rem;>");function _l(e){const t=e.allRounds.find(n=>n.uuid===e.uuid);return r(E,{get fallback(){return e.fallback},when:t,children:n=>e.children(n())})}function bl(e){const[t,n]=A(e.store),[l,a]=A({delete:ye(),publish:ye(),sendUpdate:ye()});function i(c){c.preventDefault(),a("publish","open",!0)}function o(){e.changePage({kind:"GAMEMASTER"})}return[r(tn,{kind:"special",get children(){return["Status: ",O(()=>x.publishingSteps[t.kind])]}}),d(Qe),d(Qe),r(kl,{store:t,get registrations(){return e.registrations},onSubmit:i,onCancel:()=>a("delete","open",!0),onSendUpdate:()=>a("sendUpdate","open",!0),goBack:o,get isEditable(){return e.isEditable}}),r(fl,{get store(){return l.publish},get title(){return t.title.value},onPublish:()=>{n("kind","published"),a("publish","open",!1),e.queue.enqueue(qi({secret:e.secret,gameroundUuid:t.uuid}))}}),r(vl,{get store(){return l.sendUpdate},get players(){return El(e.registrations,t.slots.map(c=>c.uuid))},onSend:c=>{e.queue.enqueue(Ji({update:c,slotUuids:t.slots.map(m=>m.uuid),gameroundUuid:t.uuid}))}}),r(yl,{get store(){return l.delete},get hasSlots(){return t.slots.length!==0},get title(){return t.title.value},onDelete:()=>{n("kind","archived"),e.changePage({kind:"GAMEMASTER"})}})]}function fl(e){return r(pe,{get store(){return e.store},title:"Spielrunde verÃ¶ffentlichen",onClose:()=>{},get children(){var t=d(Qi),n=t.firstChild,l=n.nextSibling,[a,i]=u(l.nextSibling);return s(t,r(H,{kind:"success",icon:"circle-plus",get label(){return`Ja, bitte "${e.title||"["+x.missingTitle+"]"}" verÃ¶ffentlichen.`},get onClick(){return e.onPublish}}),a,i),t}})}function vl(e){return r(pe,{get store(){return e.store},title:"Update senden",onClose:()=>{},size:"medium",get children(){return()=>e.players.kind==="LOADING"?d(Xi):e.players.kind==="ERROR"?O(()=>x.error.general):e.players.data.length===0?d(el):[(()=>{var t=d(tl),n=t.firstChild,l=n.nextSibling,[a,i]=u(l.nextSibling);return s(t,()=>e.players.data.map(o=>o.name).join(", "),a,i),t})(),d(Qe),r(xl,{get onSend(){return e.onSend}})]}})}function yl(e){return r(pe,{get store(){return e.store},title:"Spielrunde lÃ¶schen",onClose:()=>{},get children(){return[r(E,{get when(){return e.hasSlots},get children(){return d(nl)}}),r(E,{get when(){return!e.hasSlots},get children(){var t=d(rl),n=t.firstChild,l=n.nextSibling,[a,i]=u(l.nextSibling);return s(t,r(H,{kind:"danger",icon:"trash",get label(){return`Ja, bitte "${e.title||"["+x.missingTitle+"]"}" lÃ¶schen.`},get onClick(){return e.onDelete}}),a,i),t}})]}})}function kl(e){const[t]=A(e.store),n=at(()=>hr(t));return(()=>{var l=d(il),a=l.firstChild,[i,o]=u(a.nextSibling),c=i.nextSibling,[m,h]=u(c.nextSibling),S=m.nextSibling,[_,$]=u(S.nextSibling),b=_.nextSibling,y=b.firstChild,[k,p]=u(y.nextSibling),C=k.nextSibling,[N,I]=u(C.nextSibling),L=b.nextSibling,[Y,te]=u(L.nextSibling),T=Y.nextSibling,[J,ne]=u(T.nextSibling),Z=J.nextSibling,[B,K]=u(Z.nextSibling),z=B.nextSibling,ae=z.firstChild,oe=ae.nextSibling,[P,re]=u(oe.nextSibling),V=z.nextSibling,[Q,de]=u(V.nextSibling),M=Q.nextSibling,X=M.firstChild,[ue,ce]=u(X.nextSibling),ee=ue.nextSibling,he=ee.firstChild,[be,Ee]=u(he.nextSibling),Ce=be.nextSibling,[$e,fe]=u(Ce.nextSibling),Se=$e.nextSibling,[we,R]=u(Se.nextSibling);return s(l,r(E,{get when(){return t.kind==="published"},get children(){return r(Wt,{get errors(){return n()}})}}),i,o),s(l,r(Ve,{get store(){return t.title},label:"Titel",name:"title",get showErrors(){return t.kind==="published"?"ALWAYS":"ON_BLUR"},get errors(){return n().titleMissing?[x.mandatoryField]:[]},get disabled(){return!e.isEditable}}),m,h),s(l,r(Ve,{get store(){return t.system},label:"System (optional)",name:"System",get disabled(){return!e.isEditable}}),_,$),s(b,r(It,{get store(){return t.playerCount.min},label:"Anzahl Mitspielende (Minimum)",name:"playerCountMin",min:1,get max(){return t.playerCount.max.value},get disabled(){return!e.isEditable}}),k,p),s(b,r(It,{get store(){return t.playerCount.max},label:"Anzahl Mitspielende (Maximum)",name:"playerCountMax",get min(){return t.playerCount.min.value},get disabled(){return!e.isEditable}}),N,I),s(l,r(Rt,{get store(){return t.description.short},label:"kurze Beschreibung",name:"descriptionShort",size:"small",get showErrors(){return t.kind==="published"?"ALWAYS":"ON_BLUR"},get errors(){return O(()=>!!n().descriptionShortMissing)()?[x.mandatoryField]:O(()=>!!n().descriptionShortTooLong)()?[x.charLimitBy.replace("{}",String(gt))]:[]},get disabled(){return!e.isEditable}}),Y,te),s(l,r(Rt,{get store(){return t.description.long},label:"lange Beschreibung (optional)",name:"descriptionLong",get showErrors(){return t.kind==="published"?"ALWAYS":"ON_BLUR"},get errors(){return O(()=>!!n().descriptionLongTooLong)()?[x.charLimitBy.replace("{}",String(an))]:[]},get disabled(){return!e.isEditable}}),J,ne),s(l,r(Pi,{get store(){return e.store.slots},get registrations(){return e.registrations},get slotMissing(){return n().slotMissing},get isEditable(){return e.isEditable}}),B,K),s(z,r(pl,{get store(){return t.tagNames},get isEditable(){return e.isEditable}}),P,re),s(l,r(Wt,{get errors(){return n()}}),Q,de),s(M,r(H,{icon:"backward",label:"ZurÃ¼ck zu deinen Spielrunden",get onClick(){return e.goBack}}),ue,ce),s(ee,r(E,{get when(){return t.kind!=="archived"},get children(){return r(H,{icon:"trash",kind:"danger",label:"LÃ¶schen",onClick:()=>e.onCancel(),get disabled(){return!e.isEditable}})}}),be,Ee),s(ee,r(E,{get when(){return t.kind==="draft"},get children(){return r(H,{icon:"circle-plus",get kind(){return n().hasErrors?"gray":"success"},get disabled(){return n().hasErrors||!e.isEditable},label:"Spielrunde verÃ¶ffentlichen",get onClick(){return n().hasErrors?void 0:e.onSubmit}})}}),$e,fe),s(ee,r(E,{get when(){return t.kind==="published"},get children(){return r(H,{icon:"circle-plus",kind:"success",label:"Update an Spielende schicken",get onClick(){return e.onSendUpdate},get disabled(){return!e.isEditable}})}}),we,R),l})()}function Wt(e){return r(E,{get when(){return e.errors.hasErrors},get children(){return r(w,{type:"danger",get children(){return[d(ll),d(al),(()=>{var t=d(gl),n=t.firstChild,[l,a]=u(n.nextSibling),i=l.nextSibling,[o,c]=u(i.nextSibling),m=o.nextSibling,[h,S]=u(m.nextSibling),_=h.nextSibling,[$,b]=u(_.nextSibling),y=$.nextSibling,[k,p]=u(y.nextSibling);return s(t,r(E,{get when(){return e.errors.titleMissing},get children(){return d(sl)}}),l,a),s(t,r(E,{get when(){return e.errors.descriptionShortMissing},get children(){return d(ol)}}),o,c),s(t,r(E,{get when(){return e.errors.descriptionShortTooLong},get children(){return d(dl)}}),h,S),s(t,r(E,{get when(){return e.errors.descriptionLongTooLong},get children(){return d(ul)}}),$,b),s(t,r(E,{get when(){return e.errors.slotMissing},get children(){return d(cl)}}),k,p),t})()]}})}})}function xl(e){const[t,n]=A({updateText:{value:"",isDirty:!1},hasBeenSent:!1}),l=at(()=>$r(t));return r(xe,{get fallback(){return r(w,{type:"success",children:"Nachricht wurde registriert und wird in den nÃ¤chsten 24 Stunden an die Spielenden verschickt."})},get children(){return r(U,{get when(){return!t.hasBeenSent},get children(){return[d(ml),d(Qe),d(hl),d(Qe),(()=>{var a=d($l),i=a.firstChild,[o,c]=u(i.nextSibling),m=o.nextSibling,[h,S]=u(m.nextSibling);return lt(a,"novalidate",!0),s(a,r(Rt,{get store(){return t.updateText},label:"Zusammenfassung der Ãnderung",name:"updateText",size:"small",showErrors:"ALWAYS",get errors(){return O(()=>!!l().missing)()?[x.mandatoryField]:O(()=>!!l().tooLong)()?[x.charLimitBy.replace("{}",String(sn))]:[]}}),o,c),s(a,r(H,{icon:"paper-plane",label:"Spielende informieren",get kind(){return l().hasErrors?"gray":"success"},get disabled(){return l().hasErrors},get onClick(){return l().hasErrors?void 0:()=>{e.onSend(t.updateText.value),n("hasBeenSent",!0)}}}),h,S),a})()]}})}})}function pl(e){const[t,n]=A(e.store);return[(()=>{var l=d(Sl);return s(l,r(W,{each:Fe,children:a=>r(Ut,{get label(){return a.label},get description(){return a.description},get checked(){return t.includes(a.name)},get name(){return a.name},get value(){return a.name},onValueUpdate:i=>{n(i?t.concat([a.name]):t.filter(o=>o!==a.name))},get disabled(){return!e.isEditable}})})),l})(),r(w,{get children(){return x.tagIdeas}})]}const El=(e,t)=>{if(e.loading)return{kind:"LOADING"};if(e.error)return{kind:"ERROR"};const n=e();return n===void 0||n.kind==="FAILURE"?{kind:"ERROR"}:{kind:"SUCCESS",data:n.data.filter(l=>t.includes(l.uuid))}},Cl=Xt("kind",[v({kind:D("CHOOSE"),uuid:ze()}),v({kind:D("PLAYER"),uuid:ze()}),v({kind:D("GAME"),uuid:f().uuid()}),v({kind:D("GAMEMASTER"),uuid:ze()}),v({kind:D("HELPING"),uuid:ze()}),v({kind:D("SUMMARY"),uuid:ze()}),v({kind:D("EDIT_GAMEROUND"),uuid:f().uuid()})]);Xt("kind",[v({kind:D("CHOOSE")}),v({kind:D("PLAYER")}),v({kind:D("GAME"),uuid:f().uuid()}),v({kind:D("GAMEMASTER")}),v({kind:D("HELPING")}),v({kind:D("SUMMARY")}),v({kind:D("EDIT_GAMEROUND"),uuid:f().uuid()})]);const wl=ut(["SAVING","IDLE","ERROR"]),Rl=v({saveState:wl,page:Cl,secret:f(),showCreateMessage:Pe(),isDebugging:Pe()});function un(e){const t=e.searchParams.get("page")??"",n=e.searchParams.get("uuid")??null,l=e.searchParams.get("secret")??"",a=e.searchParams.get("showCreateMessage")==="true",i=e.searchParams.get("debug")==="true",o=Rl.safeParse({saveState:"IDLE",page:{kind:t.toUpperCase(),uuid:n},secret:l,showCreateMessage:a,isDebugging:i});return o.success?o.data:{saveState:"IDLE",page:{kind:"CHOOSE",uuid:null},secret:l,showCreateMessage:a,isDebugging:i}}function Al(e,t){return e.kind!==t.kind?!1:e.kind==="EDIT_GAMEROUND"&&t.kind==="EDIT_GAMEROUND"||e.kind==="GAME"&&t.kind==="GAME"?e.uuid===t.uuid:!0}const Tl="2024-08-15T07:45:21.335Z",_e={game:"37831e19-29d6-40bd-b99d-fb91b78aa7f9",slot:"bfcbd156-b703-4664-9944-8936aede8476",slot2:"f58e7242-e1ff-4cfc-a992-ca18dd5207c3",program:"16f387ab-0adf-406b-ba5c-2e4eb200fda8",program2:"11b6b38a-a4d3-40ed-9d4a-d2abcab661a5",program3:"5294bc63-4857-404e-b72d-53ecbd87a27b",program4:"6e9477f1-6dd5-4cd7-b3c3-03085022d967"};function Ul(e,t){const n=localStorage.getItem(e);return n===null?t:n}function Dl(e,t){localStorage.setItem(e,t)}const cn="SAVE",Ol={version:1,init:{name:"John Doe",email:"john@doe.ch",mobile:"+41 66 123 45 67"},lastSaved:Tl,playing:{wantsUpdates:!1,reservations:[]},master:{games:[{uuid:_e.game,kind:"published",title:"Grolle in der Dunkelheit",system:"Warhammer Fantasy Rollenspiel",description:{short:"Ein kurzes Abenteuer bei dem es um Fantasy, Action und einfaches Rollenspiel geht.",long:"Eine kleine Gruppe wagt sich in die dunklen SchÃ¤chten einer Mine und weiter hinab, um einen mÃ¤chtigen Gegenstand wieder zu erlangen. Wie werden die GefÃ¤hrten auf die Gefahren des Untergrundes reagieren und welche Gefahren lauern in der Finsternis?"},slots:[{uuid:_e.slot,day:"SATURDAY",from:10,to:12},{uuid:_e.slot2,day:"SUNDAY",from:14,to:17}],playerCount:{min:1,max:3},tagNames:["deutsch"]}],wantsHelp:!1},helping:{},publishState:"published"};async function Nl(){return new Promise(e=>setTimeout(()=>e({kind:"SUCCESS",data:JSON.parse(Ul(cn,JSON.stringify(Ol)))}),1e3))}async function Ml(e,t){return new Promise(n=>setTimeout(()=>(Dl(cn,JSON.stringify(e)),n({kind:"SUCCESS",data:t})),1e3))}const Il=[{uuid:_e.program,gamemaster:"Game Master",title:"Grolle in der Dunkelheit",system:"Warhammer Fantasy Rollenspiel",description:{short:"Ein kurzes Abenteuer bei dem es um Fantasy, Action und einfaches Rollenspiel geht.",long:"Eine kleine Gruppe wagt sich in die dunklen SchÃ¤chten einer Mine und weiter hinab, um einen mÃ¤chtigen Gegenstand wieder zu erlangen. Wie werden die GefÃ¤hrten auf die Gefahren des Untergrundes reagieren und welche Gefahren lauern in der Finsternis?"},slot:{day:"SATURDAY",from:10,to:13},playerCount:{min:1,max:3,reserved:0},tags:["ab12jahren"]},{uuid:_e.program2,gamemaster:"Other Game Master",title:"Acrimony",system:"D&D",description:{short:"Ein Lo-Fi Space Western Abenteuer",long:'Ein Lo-Fi Space Western Abenteuer: "Eine frisch formierte Gruppe von KopfgeldjÃ¤gern wird mit einer riskanten Mission betraut: Sie mÃ¼ssen den berÃ¼chtigten Outlaw Jeb "Rusty" Rourke in der abgeschiedenen Grenzstadt aufspÃ¼ren. Bei dieser unbarmherzigen Jagd lernen die Spieler die harte RealitÃ¤t der Kopfgeldjagd kennen, wo jeder Schuss und jede Entscheidung Ã¼ber ihr Schicksal entscheidet.'},slot:{day:"SATURDAY",from:10,to:13},playerCount:{min:2,max:8,reserved:3},tags:["ab12jahren","horror"]},{uuid:_e.program3,gamemaster:"Other Game Master",title:"Acrimony",system:"D&D",description:{short:"Ein Lo-Fi Space Western Abenteuer",long:'Ein Lo-Fi Space Western Abenteuer: "Eine frisch formierte Gruppe von KopfgeldjÃ¤gern wird mit einer riskanten Mission betraut: Sie mÃ¼ssen den berÃ¼chtigten Outlaw Jeb "Rusty" Rourke in der abgeschiedenen Grenzstadt aufspÃ¼ren. Bei dieser unbarmherzigen Jagd lernen die Spieler die harte RealitÃ¤t der Kopfgeldjagd kennen, wo jeder Schuss und jede Entscheidung Ã¼ber ihr Schicksal entscheidet.'},slot:{day:"SATURDAY",from:14,to:18},playerCount:{min:2,max:8,reserved:3},tags:["ab12jahren","horror"]},{uuid:_e.program4,gamemaster:"Some Other Game Master",title:"Solo RPGs",system:"",description:{short:"Wir spielen primÃ¤r das Solo Rollenspiel NoteQuest, werden aber kurz auch noch ein paar andere Solo Rollenspiele miteinander anschauen.",long:""},slot:{day:"SATURDAY",from:14,to:18},playerCount:{min:2,max:4,reserved:3},tags:[]}];async function Pl(){return new Promise(e=>setTimeout(()=>e({kind:"SUCCESS",data:Il}),5e3))}const Ll=[{uuid:_e.slot,name:"Alice"},{uuid:_e.slot,name:"Bob"}];async function Fl(e){return new Promise(t=>setTimeout(()=>t({kind:"SUCCESS",data:Ll.filter(n=>e.includes(n.uuid))}),5e3))}var Gl=g("<div aria-atomic=true><!$><!/><!$><!/>"),Hl=g("<div class=toast-container aria-live=polite aria-atomic=true>");const[ke,Xe]=A([]);function Yl(e){const t=()=>{const n=["toast"];return e.options.kind!==void 0&&n.push(`toast-${e.options.kind}`),n.join(" ")};return(()=>{var n=d(Gl),l=n.firstChild,[a,i]=u(l.nextSibling),o=a.nextSibling,[c,m]=u(o.nextSibling);return s(n,()=>e.options.message,a,i),s(n,r(E,{get when(){return e.options.dismissable},get children(){return r(j,{kind:"ghost",get label(){return r(ie,{icon:"xmark",classes:["toast-dismiss"]})},get onClick(){return e.dismiss}})}}),c,m),me(h=>{var S=t(),_=e.options.kind==="danger"?"alert":"status",$=e.options.kind==="danger"?"assertive":"polite";return S!==h.e&&Ue(n,h.e=S),_!==h.t&&it(n,"role",h.t=_),$!==h.a&&it(n,"aria-live",h.a=$),h},{e:void 0,t:void 0,a:void 0}),n})()}function Bl(){function e(t){ke.find(n=>n.uuid===t)?.cleanup(),Xe(ke.filter(n=>n.uuid!==t))}return(()=>{var t=d(Hl);return s(t,r(W,{each:ke,children:n=>r(Yl,{options:n,dismiss:()=>e(n.uuid)})})),t})()}function gn(e,t){if(t?.uuid!==void 0&&ke.find(c=>c.uuid===t.uuid)!==void 0)return At(t.uuid,e,t);const n=t?.uuid??crypto.randomUUID(),l=t?.duration??5e3,a=t?.kind??"gray",i=t?.dismissable??!0,o=setTimeout(()=>{Xe(ke.filter(c=>c.uuid!==n))},l);return Xe(ke.length,{uuid:n,kind:a,message:e,duration:l,dismissable:i,cleanup:()=>clearTimeout(o)}),n}function At(e,t,n){const l=ke.find(m=>m.uuid===e);if(l===void 0)return e;l.cleanup();const a=n.duration??l.duration,i=n.kind??l.kind,o=n?.dismissable??l.dismissable,c=setTimeout(()=>{Xe(ke.filter(m=>m.uuid!==e))},a);return Xe(m=>m.uuid===e,{uuid:e,kind:i,message:t,duration:a,dismissable:o,cleanup:()=>clearTimeout(c)}),e}const zl=v({name:f(),email:f(),mobile:f()}),jl=v({name:f(),email:f(),mobile:f()}),Wl=Dt([v({kind:D("SELF"),gameRound:f().uuid(),uuid:f().uuid()}),v({kind:D("FRIEND"),gameRound:f().uuid(),name:f(),uuid:f().uuid()})]),Zl=v({wantsUpdates:Pe(),reservations:le(Wl)}),Kl=Dt([v({kind:D("SELF"),gameRound:f().uuid(),uuid:f().uuid()}),v({kind:D("FRIEND"),gameRound:f().uuid(),name:f(),uuid:f().uuid()})]);Dt([v({kind:D("SELF"),gameRound:f().uuid()}),v({kind:D("FRIEND"),gameRound:f().uuid(),name:f()})]);const Vl=v({wantsUpdates:Pe(),reservations:le(Kl)}),ql=v({games:le(ur),wantsHelp:Pe()}),Jl=v({games:le(ln),wantsHelp:Pe()}),Ql=v({}),Xl=v({}),ea=v({version:D(1),init:zl,lastSaved:f(),playing:Zl,master:ql,helping:Ql,publishState:ct}),ta=v({version:D(1),init:jl,lastSaved:Nn.date(),playing:Vl,master:Jl,helping:Xl,publishState:ct});async function na(e){if(e.length!==36&&e.length!==4)return{kind:"SECRET_INVALID"};const t=e==="demo"?await Nl():await zi(e);if(t.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE"};const n=ea.safeParse(t.data);if(!n.success)return console.error(n.error),{kind:"FAILURE"};const l=ra(n.data);return l.success?{kind:"SUCCESS",data:l.data}:{kind:"FAILURE"}}function ra(e){return ta.safeParse(e)}const wt=crypto.randomUUID();async function ia(e,t,n){const[l,a]=A(e);a("saveState","SAVING"),gn("Am Speichern...",{uuid:wt,dismissable:!1});const i=new Date;t.lastSaved=i;const o=la(t);try{if((n==="demo"?await Ml(o,n):await ji(o,n)).kind==="FAILURE")throw Error("")}catch(c){return a("saveState","ERROR"),console.error(c),At(wt,"Speichern war nicht mÃ¶glich!",{kind:"danger",duration:1e4,dismissable:!0}),{kind:"FAILURE"}}return At(wt,`Zuletzt gespeichert um: ${qt(i)} Uhr`,{kind:"success",dismissable:!0}),a("saveState","IDLE"),{kind:"SUCCESS",data:i}}function la(e){return{...e,lastSaved:String(e.lastSaved),master:{...e.master,games:e.master.games.map(mr)}}}const aa=Rn(ia,1e3);var sa=g("<div class=tooltip-wrapper><div class=tooltip></div><!$><!/>");function We(e){return(()=>{var t=d(sa),n=t.firstChild,l=n.nextSibling,[a,i]=u(l.nextSibling);return s(n,()=>e.tooltip),s(t,()=>e.children,a,i),t})()}var oa=g("<div class=quickmenu-wrapper><div class=quickmenu><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),da=g('<div class="quickmenu extended"><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>'),ua=g("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center;><!$><!/><em>Zuletzt gespeichert um: <!$><!/> Uhr"),ca=g("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center;><!$><!/><em>Am Speichern..."),ga=g("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center;><!$><!/><em>Speichern war nicht mÃ¶glich!");function ma(e){return(()=>{var t=d(oa),n=t.firstChild,l=n.firstChild,[a,i]=u(l.nextSibling),o=a.nextSibling,[c,m]=u(o.nextSibling),h=c.nextSibling,[S,_]=u(h.nextSibling),$=S.nextSibling,[b,y]=u($.nextSibling),k=b.nextSibling,[p,C]=u(k.nextSibling);return s(n,r(We,{tooltip:"Zur Ãbersicht",get children(){return r(j,{get label(){return r(ie,{icon:"backward"})},onClick:()=>e.changePage({kind:"CHOOSE"})})}}),a,i),s(n,r(We,{tooltip:"Zu den Spielrunden",get children(){return r(j,{get label(){return r(ie,{icon:"dice-d20"})},onClick:()=>e.changePage({kind:"PLAYER"})})}}),c,m),s(n,r(We,{tooltip:"Zu deinen Spielrunden",get children(){return r(j,{get label(){return r(ie,{icon:"grid-2-plus"})},onClick:()=>e.changePage({kind:"GAMEMASTER"})})}}),S,_),s(n,r(We,{tooltip:"Zum Helferplan",get children(){return r(j,{get label(){return r(ie,{icon:"hand-heart"})},onClick:()=>e.changePage({kind:"HELPING"})})}}),b,y),s(n,r(We,{tooltip:"Zur Zusammenfassung",get children(){return r(j,{get label(){return r(ie,{icon:"list"})},onClick:()=>e.changePage({kind:"SUMMARY"})})}}),p,C),t})()}function ha(e){return[r(w,{type:"gray",get children(){var t=d(da),n=t.firstChild,[l,a]=u(n.nextSibling),i=l.nextSibling,[o,c]=u(i.nextSibling),m=o.nextSibling,[h,S]=u(m.nextSibling),_=h.nextSibling,[$,b]=u(_.nextSibling),y=$.nextSibling,[k,p]=u(y.nextSibling);return s(t,r(H,{icon:"backward",label:"Zur Ãbersicht",onClick:()=>e.changePage({kind:"CHOOSE"})}),l,a),s(t,r(H,{icon:"dice-d20",label:"Zu den Spielrunden",onClick:()=>e.changePage({kind:"PLAYER"})}),o,c),s(t,r(H,{icon:"grid-2-plus",label:"Zu deinen Spielrunden",onClick:()=>e.changePage({kind:"GAMEMASTER"})}),h,S),s(t,r(H,{icon:"hand-heart",label:"Zum Helferplan",onClick:()=>e.changePage({kind:"HELPING"})}),$,b),s(t,r(H,{icon:"list",label:"Zur Zusammenfassung",onClick:()=>e.changePage({kind:"SUMMARY"})}),k,p),t}}),r($a,{get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}})]}function $a(e){return r(xe,{get children(){return[r(U,{get when(){return e.saveState==="IDLE"},get children(){var t=d(ua),n=t.firstChild,[l,a]=u(n.nextSibling),i=l.nextSibling,o=i.firstChild,c=o.nextSibling,[m,h]=u(c.nextSibling);return m.nextSibling,s(t,r(ie,{icon:"circle-check"}),l,a),s(i,()=>qt(e.lastSaved),m,h),t}}),r(U,{get when(){return e.saveState==="SAVING"},get children(){var t=d(ca),n=t.firstChild,[l,a]=u(n.nextSibling);return l.nextSibling,s(t,r(ie,{icon:"floppy-disk-circle-arrow-right"}),l,a),t}}),r(U,{get when(){return e.saveState==="ERROR"},get children(){var t=d(ga),n=t.firstChild,[l,a]=u(n.nextSibling);return l.nextSibling,s(t,r(ie,{icon:"triangle-exclamation"}),l,a),t}})]}})}var Sa=g("<div class=page><!$><!/><div class=page-content><h2></h2><br><!$><!/></div><!$><!/>"),_a=g("<div class=extended-wrapper style=margin-block-start:1rem;>");function Me(e){return(()=>{var t=d(Sa),n=t.firstChild,[l,a]=u(n.nextSibling),i=l.nextSibling,o=i.firstChild,c=o.nextSibling,m=c.nextSibling,[h,S]=u(m.nextSibling),_=i.nextSibling,[$,b]=u(_.nextSibling);return s(t,(()=>{var y=O(()=>e.showQuickmenu!==!1);return()=>y()?r(ma,{get changePage(){return e.changePage},get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}}):null})(),l,a),s(o,()=>e.title),s(i,()=>e.children,h,S),s(t,(()=>{var y=O(()=>e.showQuickmenu!==!1);return()=>y()?(()=>{var k=d(_a);return s(k,r(ha,{get changePage(){return e.changePage},get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}})),k})():null})(),$,b),t})()}const ba=v({uuid:f().uuid(),name:f()}),mn=le(ba),fa=mn;async function va(e,t){const n=e==="demo"?await Fl(t):await Zi(e);if(n.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE"};const l=mn.safeParse(n.data);if(!l.success)return{kind:"FAILURE"};const a=ya(l.data);return a.success?{kind:"SUCCESS",data:a.data}:{kind:"FAILURE"}}function ya(e){return fa.safeParse(e)}const ka=v({uuid:f().uuid(),title:f(),system:f(),gamemaster:f(),description:v({short:f(),long:f()}),slot:v({day:Nt,from:q(),to:q()}),playerCount:v({min:q(),max:q(),reserved:q()}),tags:le(f())}),xa=le(ka),pa=v({uuid:f().uuid(),title:f(),system:f(),gamemaster:f(),description:v({short:f(),long:f()}),slot:v({day:Nt,from:q(),to:q()}),playerCount:v({min:q(),max:q(),reserved:q()}),tags:le(f())}),Ea=le(pa);async function Ca(e){const t=e==="demo"?await Pl():await Wi(e);if(t.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE"};const n=xa.safeParse(t.data);if(!n.success)return{kind:"FAILURE"};const l=wa(n.data);return l.success?{kind:"SUCCESS",data:l.data}:{kind:"FAILURE"}}function wa(e){return Ea.safeParse(e)}var Zt=g("<br>"),Kt=g("<pre>"),Ra=g("<hr>"),Aa=g("<div><code>Reservations (read-only)"),Ta=g("<em>loading...");function Ua(e){const t=new URL(location.href);t.searchParams.set("page",e.page.kind.toLowerCase()),e.page.kind==="EDIT_GAMEROUND"&&t.searchParams.set("uuid",e.page.uuid),t.searchParams.delete("showCreateMessage"),history.replaceState({page:e},"",t);const n=x.pageTitle[e.page.kind];document.title=x.metaTitle.replace("{}",n)}function Da(e){const[t,n]=A(e.page);return(l,a)=>{if(Al(l,t))return;const i=a?.backButton??!1,o=a?.disableScroll??!1,c=new URL(location.href);c.searchParams.set("page",l.kind.toLowerCase()),l.kind==="EDIT_GAMEROUND"||l.kind==="GAME"?(c.searchParams.set("uuid",l.uuid),n(l)):(c.searchParams.delete("uuid"),n({...l,uuid:null})),i||history.pushState({page:l},"",c);const m=x.pageTitle[l.kind];document.title=x.metaTitle.replace("{}",m),o||window.scrollTo({top:0})}}function Oa(e){Ua(e.meta);const[t,n]=A({meta:e.meta,save:e.save}),l=()=>t.save.master.games.flatMap(_=>_.slots.map($=>$.uuid)),[a]=rt(l(),_=>va(t.meta.secret,_)),[i]=rt(()=>Ca(t.meta.secret)),o=crypto.randomUUID(),[c,m]=Tt(!1);rt(()=>JSON.stringify(t.save),async()=>{if(!c()){m(!0);return}if(t.save.publishState!=="published"){gn("Diese Anmeldung wurde deaktiviert und kann nicht editiert werden.",{kind:"danger",uuid:o});return}const _=Ze(t.save);try{const $=await aa(t.meta,_,t.meta.secret);$.kind==="FAILURE"?console.error($):n("save","lastSaved",$.data)}catch($){console.error($),n("meta","saveState","ERROR")}});const h=Da(t.meta),S=An();return Qt(()=>{window.addEventListener("popstate",_=>{if(typeof _=="object"&&_!==null&&"state"in _){const $=new URL(location.href),b=un($);h(b.page,{backButton:!0})}}),setInterval(async()=>{const _=S.dequeue();_.kind==="NEXT_ELEMENT"&&await _.data()},1e3)}),[r(E,{get when(){return t.meta.showCreateMessage},get children(){return[r(w,{type:"success",get children(){return x.registrationStarted}}),d(Zt)]}}),r(E,{get when(){return t.save.publishState!=="published"},get children(){return[r(w,{type:"danger",children:"Diese Anmeldung wurde deaktiviert. Sollte dies ein Fehler sein, kontaktiere uns bitte."}),d(Zt)]}}),r(xe,{get fallback(){return r(Me,{title:"Wo mÃ¶chtest du starten?",showQuickmenu:!1,changePage:h,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(bi,{changePage:h,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved}})}})},get children(){return[r(U,{get when(){return t.meta.page.kind==="PLAYER"||t.meta.page.kind==="GAME"},get children(){return r(Me,{title:"SpielrundenÃ¼bersicht",changePage:h,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(ri,{get store(){return t.save.playing},program:i,get uuid(){return t.meta.page.kind==="GAME"?t.meta.page.uuid:null},get isEditable(){return t.save.publishState==="published"},changePage:h})}})}}),r(U,{get when(){return t.meta.page.kind==="GAMEMASTER"},get children(){return r(Me,{title:"Meine Spielrunden",changePage:h,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(yr,{get store(){return t.save.master},get isEditable(){return t.save.publishState==="published"},changePage:h})}})}}),r(U,{get when(){return t.meta.page.kind==="EDIT_GAMEROUND"},get children(){return r(Me,{title:"Spielrunde editieren",changePage:h,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(_l,{get allRounds(){return t.save.master.games},get uuid(){return t.meta.page.kind==="EDIT_GAMEROUND"?t.meta.page.uuid:"should never happen"},get fallback(){return r(w,{type:"danger",get children(){return x.error.gameroundUuidError}})},children:_=>r(bl,{store:_,registrations:a,queue:S,get isEditable(){return t.save.publishState==="published"},changePage:h,get secret(){return t.meta.secret}})})}})}}),r(U,{get when(){return t.meta.page.kind==="HELPING"},get children(){return r(Me,{title:"Helfen",changePage:h,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(sr,{})}})}}),r(U,{get when(){return t.meta.page.kind==="SUMMARY"},get children(){return r(Me,{title:"Zusammenfassung",changePage:h,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(tr,{get store(){return t.save},program:i,get isEditable(){return t.save.publishState==="published"},changePage:h})}})}})]}}),r(E,{get when(){return t.meta.isDebugging},get children(){return[(()=>{var _=d(Kt);return s(_,()=>JSON.stringify(t,null,2)),_})(),d(Ra),d(Aa),r(dt,{get fallback(){return d(Ta)},get children(){return r(E,{get when(){return a()},children:_=>(()=>{var $=d(Kt);return s($,()=>JSON.stringify(_(),null,2)),$})()})}})]}}),r(Bl,{})]}function hn(){return r(w,{get children(){return x.loading.registration}})}function Ha(){const[e,t]=Tt(null);return Qt(()=>{const n=new URL(location.href);t(un(n))}),r(E,{get fallback(){return r(hn,{})},get when(){return e()},children:n=>r(Na,{get page(){return n()}})})}function Na(e){const[t]=rt(()=>na(e.page.secret));return r(Dn,{fallback:n=>(console.error(n),r(w,{type:"danger",get children(){return x.error.general}})),get children(){return r(dt,{get fallback(){return r(hn,{})},get children(){return r(xe,{get children(){return r(U,{get when(){return t()},children:n=>{const{kind:l,value:a}=Tn(n());return l==="SECRET_INVALID"?r(w,{type:"danger",get children(){return x.error.secretError}}):l==="FAILURE"?(console.error(a),r(w,{type:"danger",get children(){return x.error.ourMistake}})):r(Oa,{get meta(){return e.page},get save(){return a.data}})}})}})}})}})}export{Ha as MeineAnmeldungWrapper};
