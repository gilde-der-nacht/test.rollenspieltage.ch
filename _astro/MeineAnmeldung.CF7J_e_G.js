import{g as a,t as i,i as o,d as t,a as m,m as T,e as ie,o as le,M as A,f as U,h as Y,j as se,E as ce,S as oe}from"./web.5PWvPun-.js";import{e as O,I as E,B as D,a as P}from"./utils.q22qP-MV.js";import{e as ge,a as N,o as f,s as c,b as M,n as $,c as ue,l as K,u as Q,d as q}from"./index.BmTnCDYh.js";import{c as de}from"./store.UIwYTWTH.js";/* empty css                                 */const y=1,Z="SAVE",W="PROGRAM",j={registrationId:-1,name:"Demo",email:"demo@mail.com",handynummer:"+41 12 123 12 12",wantsEmailUpdates:!0,games:[],lastSaved:"2024-08-15T07:45:21.335Z"};function he(){const n=localStorage.getItem(Z);let e;return n===null?e={version:y,data:j}:e=JSON.parse(n),e.version!==y&&(console.error("Your local storage data was outdated and has been replaced with new demo content."),e={version:y,data:j}),localStorage.setItem(Z,JSON.stringify(e)),e.data}const J={gameList:[],reservedList:[]};function me(){const n=localStorage.getItem(W);let e;return n===null?e={version:y,data:J}:e=JSON.parse(n),e.version!==y&&(console.error("Your local storage data was outdated and has been replaced with new demo content."),e={version:y,data:J}),localStorage.setItem(W,JSON.stringify(e)),e.data}const X=ge(["SATURDAY","SUNDAY"]);N(f({uuid:c(),description:M(c()),title:M(c()),system:c(),master:f({first:c(),last:M(c())}),playerCount:f({min:$(),max:$()}),slot:f({day:X,start:$(),end:$()})}));const ee=f({game:c(),self:K(!0),spielerName:ue()}),ne=f({game:c(),self:K(!1),spielerName:c()}),Se=Q([ee.extend({id:$()}),ne.extend({id:$()})]),pe=Q([ee,ne]),fe=f({registrationId:$(),name:c(),email:c(),handynummer:c(),wantsEmailUpdates:q(),games:N(Se),lastSaved:c()});f({registrationId:$(),name:c(),email:c(),handynummer:c(),wantsEmailUpdates:q(),games:N(pe),lastSaved:c()});async function $e(n){if(n==="demo")return{kind:"SUCCESS",save:he()};const e=O("/rst24/load");e.searchParams.append("secret",n);const r=await fetch(e);if(!r.ok)return{kind:"FAILED"};const l=await r.json(),h=fe.safeParse(l);return h.success?{kind:"SUCCESS",save:h.data}:{kind:"FAILED"}}const _e=f({uuid:c(),title:M(c()),system:c(),description:M(c()),playerCount:f({min:$(),max:$()}),master:f({first:c(),last:M(c())}),slot:f({day:X,start:$(),end:$()})}),ve=f({id:$(),gameId:c()});async function Ee(n){if(n)return{kind:"SUCCESS",program:me()};const e=O("/rst24/program"),r=O("/rst24/reserved"),[l,h]=await Promise.all([fetch(e),fetch(r)]);if(!l.ok)return{kind:"FAILED"};if(!h.ok)return{kind:"FAILED"};const S=await l.json(),v=await h.json(),b=N(_e).safeParse(S);if(!b.success)return{kind:"FAILED"};const w=N(ve).safeParse(v);return w.success?{kind:"SUCCESS",program:{gameList:b.data,reservedList:w.data}}:{kind:"FAILED"}}const be=["CHOOSE","PLAYER","GAMEMASTER","GAMEMASTER_NEW","HELPING","SUMMARY"],V={CHOOSE:"Übersicht",PLAYER:"Spielanmeldung",GAMEMASTER:"Spielleitung",GAMEMASTER_NEW:"Neue Spielrunde",HELPING:"Helfen",SUMMARY:"Zusammenfassung"};function te(n){const e=n.searchParams.get("page");return be.find(r=>e?.toUpperCase()===r.toUpperCase())??"CHOOSE"}function Pe(){const n=new URL(location.href),e=n.searchParams.get("secret"),r=te(n),l=n.searchParams.get("showCreateMessage")==="true";return{secret:e,page:r,showCreateMessage:l}}async function re(n){if(n.secret===null)throw Error("SECRET_ERROR");const e=await $e(n.secret);if(e.kind==="FAILED")throw Error("SECRET_ERROR");return{state:"IDLE",secret:n.secret,page:n.page,showCreateMessage:n.showCreateMessage,currentSave:e.save,activeTab:"Contact",lastSaved:e.save.lastSaved,hasChanged:!1,tentativeReservations:[],markedForDeletionReservations:[]}}async function Re(n=!1){const e=await Ee(n);if(e.kind==="FAILED")throw Error("PROGRAM_ERROR");return e.program}function ke(n){const[e,r]=de(n);function l(s){r("activeTab",s),window.scrollTo({top:0})}function h(s){const g=new URL(location.href);g.searchParams.set("page",s.toLowerCase()),g.searchParams.delete("showCreateMessage"),history.replaceState({page:s},"",g);const _=V[s];document.title=`Meine Anmeldung: ${_} | Luzerner Rollenspieltage `}h(n.page);function S(s,g=!1){if(s===e.page)return;if(!g){const d=new URL(location.href);d.searchParams.set("page",s.toLowerCase()),history.pushState({page:s},"",d)}const _=V[s];document.title=`Meine Anmeldung: ${_} | Luzerner Rollenspieltage `,r("page",s),window.scrollTo({top:0})}function v(s,g){r("hasChanged",!0),r("currentSave",s,g)}async function b(){if(e.state!=="IDLE")throw Error("ASSERTION_ERROR");r("state","SAVING");const s=O("/rst24/save"),g={...e.currentSave,games:[...e.currentSave.games.filter(d=>!e.markedForDeletionReservations.includes(d.id)),...e.tentativeReservations.map(d=>d.friendsName===null?{game:d.gameUuid,self:!0,spielerName:null}:{game:d.gameUuid,self:!1,spielerName:d.friendsName})]};if((await fetch(s,{method:"post",body:JSON.stringify(g),headers:{"Content-Type":"application/json"}})).ok){const d=await re({secret:e.secret,page:e.page,showCreateMessage:!1});r({...d,activeTab:e.activeTab})}else throw Error("SAVE_ERROR")}function w(s){r("hasChanged",!0),r("tentativeReservations",g=>[...g,s])}function C(s){if(r("hasChanged",!0),s.confirmed)r("markedForDeletionReservations",g=>[...g,s.reservationId]);else{const g=e.currentSave.name;r("tentativeReservations",_=>_.filter(d=>d.gameUuid!==s.gameUuid?!0:d.friendsName===s.name?!1:s.name!==g))}}return{state:e,actions:{changeTab:l,changePage:S,updateSave:v,saveCurrentState:b,addTentativeReservation:w,deleteReservation:C}}}var B=i("<br>"),we=i("<strong>Donnerstag, 21. August 2025");const Ae=function(){const e="Donnerstag, 21. August 2025",r=["Deine Anmeldung wurde erfolgreich gestartet.",a(B),a(B),"Wir haben eine E-Mail an deine Adresse gesendet. In dieser E-Mail findest du einen persönlichen Link, um deine Anmeldung bis am"," ",a(we)," anzupassen."];return{registrationDeadline:e,registrationStarted:r}}();var Ce=i("<div class=grid><!$><!/><div>"),Me=i("<div class=boxLink>");function I(n){const e=n.type??"special";return(()=>{var r=a(Me);return o(r,t(D,{type:e,get onClick(){return n.onClick},get children(){var l=a(Ce),h=l.firstChild,[S,v]=m(h.nextSibling),b=S.nextSibling;return o(l,t(E,{get icon(){return n.icon}}),S,v),o(b,()=>n.children),l}})),r})()}var ye=i("<div class=tooltip-wrapper><div class=tooltip></div><!$><!/>");function L(n){return(()=>{var e=a(ye),r=e.firstChild,l=r.nextSibling,[h,S]=m(l.nextSibling);return o(r,()=>n.tooltip),o(e,()=>n.children,h,S),e})()}var xe=i("<div class=quickmenu><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),Te=i('<div class="quickmenu extended"><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>'),Le=i("<div class=grid><!$><!/><span>Zur Übersicht"),Ne=i("<div class=grid><!$><!/><span>Zu den Spielrunden"),Ie=i("<div class=grid><!$><!/><span>Zu deinen Spielrunden"),Ue=i("<div class=grid><!$><!/><span>Zum Helferplan"),Oe=i("<div class=grid><!$><!/><span>Zur Zusammenfassung");function De(n){return(()=>{var e=a(xe),r=e.firstChild,[l,h]=m(r.nextSibling),S=l.nextSibling,[v,b]=m(S.nextSibling),w=v.nextSibling,[C,s]=m(w.nextSibling),g=C.nextSibling,[_,d]=m(g.nextSibling),G=_.nextSibling,[F,H]=m(G.nextSibling);return o(e,t(L,{tooltip:"Zur Übersicht",get children(){return t(P,{get label(){return t(E,{icon:"backward"})},onClick:()=>n.changePage("CHOOSE")})}}),l,h),o(e,t(L,{tooltip:"Zu den Spielrunden",get children(){return t(P,{get label(){return t(E,{icon:"dice-d20"})},onClick:()=>n.changePage("PLAYER")})}}),v,b),o(e,t(L,{tooltip:"Zu deinen Spielrunden",get children(){return t(P,{get label(){return t(E,{icon:"grid-2-plus"})},onClick:()=>n.changePage("GAMEMASTER")})}}),C,s),o(e,t(L,{tooltip:"Zum Helferplan",get children(){return t(P,{get label(){return t(E,{icon:"hand-heart"})},onClick:()=>n.changePage("HELPING")})}}),_,d),o(e,t(L,{tooltip:"Zur Zusammenfassung",get children(){return t(P,{get label(){return t(E,{icon:"list"})},onClick:()=>n.changePage("SUMMARY")})}}),F,H),e})()}function Ge(n){return(()=>{var e=a(Te),r=e.firstChild,[l,h]=m(r.nextSibling),S=l.nextSibling,[v,b]=m(S.nextSibling),w=v.nextSibling,[C,s]=m(w.nextSibling),g=C.nextSibling,[_,d]=m(g.nextSibling),G=_.nextSibling,[F,H]=m(G.nextSibling);return o(e,t(P,{get label(){return(()=>{var u=a(Le),R=u.firstChild,[p,k]=m(R.nextSibling);return p.nextSibling,o(u,t(E,{icon:"backward"}),p,k),u})()},onClick:()=>n.changePage("CHOOSE")}),l,h),o(e,t(P,{get label(){return(()=>{var u=a(Ne),R=u.firstChild,[p,k]=m(R.nextSibling);return p.nextSibling,o(u,t(E,{icon:"dice-d20"}),p,k),u})()},onClick:()=>n.changePage("PLAYER")}),v,b),o(e,t(P,{get label(){return(()=>{var u=a(Ie),R=u.firstChild,[p,k]=m(R.nextSibling);return p.nextSibling,o(u,t(E,{icon:"grid-2-plus"}),p,k),u})()},onClick:()=>n.changePage("GAMEMASTER")}),C,s),o(e,t(P,{get label(){return(()=>{var u=a(Ue),R=u.firstChild,[p,k]=m(R.nextSibling);return p.nextSibling,o(u,t(E,{icon:"hand-heart"}),p,k),u})()},onClick:()=>n.changePage("HELPING")}),_,d),o(e,t(P,{get label(){return(()=>{var u=a(Oe),R=u.firstChild,[p,k]=m(R.nextSibling);return p.nextSibling,o(u,t(E,{icon:"list"}),p,k),u})()},onClick:()=>n.changePage("SUMMARY")}),F,H),e})()}var Fe=i("<h2>"),He=i("<br>");function x(n){return[T(()=>T(()=>n.showQuickmenu!==!1)()?t(De,{get changePage(){return n.changePage}}):null),(()=>{var e=a(Fe);return o(e,()=>n.title),e})(),a(He),T(()=>n.children),T(()=>T(()=>n.showQuickmenu!==!1)()?t(Ge,{get changePage(){return n.changePage}}):null)]}var Ye=i("<h3>Spielrunden ansehen"),Ze=i("<p>Melde dich (und deine Freunde) für diverse Spielrunden an."),z=i("<br>"),We=i("<h3>Spielrunden erstellen"),je=i("<p>Falls du wenig oder gar keine Erfahrung als Spielleiter:in hast, werden wir dich vor und während dem Anlass unterstützen."),Je=i("<h3>Helfen"),Ve=i("<p>Beim Kiosk und der Essensausgabe können wir immer ein paar helfende Hände gebrauchen.");function Be(n){return t(x,{title:"Wie möchtest du starten?",showQuickmenu:!1,get changePage(){return n.changePage},get children(){return[t(I,{icon:"dice-d20",onClick:()=>n.changePage("PLAYER"),get children(){return[a(Ye),a(Ze)]}}),a(z),t(I,{icon:"grid-2-plus",onClick:()=>n.changePage("GAMEMASTER"),get children(){return[a(We),a(je)]}}),a(z),t(I,{icon:"hand-heart",onClick:()=>n.changePage("HELPING"),get children(){return[a(Je),a(Ve)]}})]}})}var ze=i("<h3>Neue Spielrunde erstellen");function Ke(n){return t(x,{title:"Meine Spielrunden",get changePage(){return n.changePage},get children(){return t(I,{icon:"grid-2-plus",type:"success",onClick:()=>n.changePage("GAMEMASTER_NEW"),get children(){return a(ze)}})}})}function Qe(n){return t(x,{title:"Neue Spielrunde erfassen",get changePage(){return n.changePage}})}var qe=i("<pre><code>Noch nicht implementiert");function Xe(n){return t(x,{title:"Helfen",get changePage(){return n.changePage},get children(){return a(qe)}})}var en=i("<pre><code>Noch nicht implementiert");function nn(n){return t(x,{title:"Spielrundenübersicht",get changePage(){return n.changePage},get children(){return a(en)}})}var tn=i("<pre><code>Noch nicht implementiert");function rn(n){return t(x,{title:"Zusammenfassung",get changePage(){return n.changePage},get children(){return a(tn)}})}var an=i("<p>Deine Anmeldung wird geladen..."),ln=i("<p>Wir konnten leider keine Anmeldung finden. Wenn du bereits eine Anmeldung begonnen hast, solltest du den korrekten Link per E-Mail erhalten haben.<br><br> Falls du noch keine Anmeldung begonnen hast, kannst du <a href=/anmeldung>hier</a> deine persönliche Anmeldung beginnen. <br><br>Für generelle Fragen oder Probleme, schreibe uns doch bitte über unser <a href=/kontatk>Kontaktformular</a>."),sn=i("<p>Leider ist ein unerwarteter Fehler passiert. Versuche deine Anmeldung erneut zu laden. Wiederholt sich dieser Fehler, bitte kontaktiere uns sobald als möglich über das <a href=/kontakt>Kontaktformular</a>, da dies nicht passieren sollte."),cn=i("<br>");function ae(){return t(D,{get children(){return a(an)}})}function pn(){const[n,e]=ie(null);return le(()=>{e(Pe())}),t(U,{get fallback(){return t(ae,{})},get children(){return t(A,{get when(){return n()},children:r=>t(on,{get params(){return r()}})})}})}function on(n){const[e]=Y(()=>re(n.params)),[r]=Y(()=>Re(n.params.secret==="demo"));return t(ce,{fallback:l=>t(D,{type:"danger",get children(){return t(U,{get fallback(){return a(sn)},get children(){return t(A,{get when(){return l.message==="SECRET_ERROR"},get children(){return a(ln)}})}})}}),get children(){return t(se,{get fallback(){return t(ae,{})},get children(){return t(U,{get children(){return t(A,{get when(){return e()},children:l=>t(gn,{get state(){return l()},programResource:r})})}})}})}})}function gn(n){const{state:e,actions:r}=ke(n.state);return window.addEventListener("popstate",l=>{if(typeof l=="object"&&l!==null&&"state"in l){const h=new URL(location.href),S=te(h);r.changePage(S,!0)}}),[t(oe,{get when(){return e.showCreateMessage},get children(){return[t(D,{type:"success",get children(){return Ae.registrationStarted}}),a(cn)]}}),t(U,{get fallback(){return t(Be,{get changePage(){return r.changePage}})},get children(){return[t(A,{get when(){return e.page==="PLAYER"},get children(){return t(nn,{get changePage(){return r.changePage}})}}),t(A,{get when(){return e.page==="GAMEMASTER"},get children(){return t(Ke,{get changePage(){return r.changePage}})}}),t(A,{get when(){return e.page==="GAMEMASTER_NEW"},get children(){return t(Qe,{get changePage(){return r.changePage}})}}),t(A,{get when(){return e.page==="HELPING"},get children(){return t(Xe,{get changePage(){return r.changePage}})}}),t(A,{get when(){return e.page==="SUMMARY"},get children(){return t(rn,{get changePage(){return r.changePage}})}})]}})]}export{pn as MeineAnmeldungWrapper};
