import{c as qe,I as Cn,B as C,d as wn,f as re,g as vt,h as B,b as W,s as An,i as Qt,S as Mt,j as yt,k as Rn,e as Fe,l as Dn,m as Xt,n as Tn,u as Un}from"./utils.D4lVKdag.js";import{b as en,g as d,t as g,a as c,u as On,i as s,c as r,S as E,d as ge,e as Ue,F as K,M as A,f as $e,s as kt,h as lt,j as st,k as ot,m as O,r as dt,l as Dt,n as at,o as ut,p as it,q as tn,E as Nn}from"./web.BCh8zNxO.js";/* empty css                                 */import{c as D,u as Ke}from"./store.BK-5lGMP.js";import{T as Mn}from"./Textarea.BaP5nL_S.js";import{s as f,n as Q,e as ct,T as x,o as v,a as ie,C as Tt,d as nn,b as ze,l as U,c as Le,u as Ut,f as Pn}from"./texts.CWjYF-lE.js";var In=g("<dialog><!$><!/><!$><!/><!$><!/>"),Ln=g("<h4>");function ke(e=!1){return{open:e}}function pe(e){let t;const[n,l]=D(e.store);en(()=>{n.open?t.showModal():t.close()});function a(){l({open:!1}),e.onClose?.()}const i=()=>{const o=[];return e.type!==void 0&&o.push(e.type),e.size!==void 0&&o.push(e.size),e.onClose!==void 0&&o.push("dialog-with-close"),o};return(()=>{var o=d(In),u=o.firstChild,[h,m]=c(u.nextSibling),_=h.nextSibling,[S,$]=c(_.nextSibling),b=S.nextSibling,[y,k]=c(b.nextSibling);o.addEventListener("close",a);var p=t;return typeof p=="function"?On(p,o):t=o,s(o,r(E,{get when(){return e.onClose},get children(){return r(qe,{onClick:a,icon:"circle-xmark",kind:"gray"})}}),h,m),s(o,r(E,{get when(){return e.title},children:w=>(()=>{var N=d(Ln);return s(N,w),N})()}),S,$),s(o,()=>e.children,y,k),ge(()=>Ue(o,i().join(" "))),o})()}var Ot=g("<p>");function Ze(e){const[t,n]=D(e.store),l=e.showErrors==="ALWAYS",a=()=>l||t.isDirty?e.errors??[]:[];return[r(Cn,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:i=>n("value",i),onBlur:()=>n("isDirty",!0),get type(){return e.type},get required(){return e.required},get isHoneypot(){return e.isHoneypot},get disabled(){return e.disabled}}),r(E,{get when(){return a().length>0},get children(){return r(C,{type:"danger",get children(){return r(K,{get each(){return a()},children:i=>(()=>{var o=d(Ot);return s(o,i),o})()})}})}})]}function Pt(e){const[t,n]=D(e.store),l=e.showErrors==="ALWAYS",a=()=>l||t.isDirty?e.errors??[]:[];return[r(wn,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:i=>n("value",i),onBlur:()=>n("isDirty",!0),get required(){return e.required},get isHoneypot(){return e.isHoneypot},get min(){return e.min},get max(){return e.max},get disabled(){return e.disabled}}),r(E,{get when(){return a().length>0},get children(){return r(C,{type:"danger",get children(){return r(K,{get each(){return a()},children:i=>(()=>{var o=d(Ot);return s(o,i),o})()})}})}})]}function At(e){const[t,n]=D(e.store),l=e.showErrors==="ALWAYS",a=()=>l||t.isDirty?e.errors??[]:[];return[r(Mn,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:i=>n("value",i),onBlur:()=>n("isDirty",!0),get required(){return e.required},get size(){return e.size},get disabled(){return e.disabled}}),r(E,{get when(){return a().length>0},get children(){return r(C,{type:"danger",get children(){return r(K,{get each(){return a()},children:i=>(()=>{var o=d(Ot);return s(o,i),o})()})}})}})]}const tt=f().transform(e=>({value:e,isDirty:!1}));function xt(e){return{value:e,isDirty:!1}}const It=Q().transform(e=>({value:e,isDirty:!1})),Te={SATURDAY:{open:{from:10,to:24},breaks:[{from:13,to:14},{from:18,to:19}]},SUNDAY:{open:{from:10,to:18},breaks:[{from:13,to:14}]}};ct(["SATURDAY","SUNDAY"]);function nt(e,t){const{from:n,to:l}=t;return n<e&&e<l}function Fn(e,t){const{from:n,to:l}=e,{from:a,to:i}=t;return nt(n,t)||nt(l,t)||nt(a,e)||nt(i,e)||n===a&&l===i}function Je(e,t=!1){const{from:n,to:l}=e;if(n>l)return[];const a=l-n;return rn(t?a+1:a,n)}function rn(e,t=0){return[...Array(e)].map((n,l)=>l+t)}function Gn(e,t){return e===null?-1:t===null?1:e.day==="SATURDAY"&&t.day==="SUNDAY"?-1:e.day==="SUNDAY"&&t.day==="SATURDAY"?1:e.from===t.from?e.to-t.to:e.from-t.from}var Hn=g("<div class=dynamic-columns style=gap:1rem;--min-width:30rem;><!$><!/><!$><!/>"),Yn=g("<div><h4 style=margin-block-end:1.5rem;></h4><!$><!/>"),Bn=g("<p>Konflikte gefunden! Bitte stelle sicher, dass du nicht zeitlich Ã¼berlappende Spielrunden eingetragen hast:"),zn=g('<div style="display:grid;grid-template-columns:1fr max-content 1fr;gap:1rem;margin-block:0.5rem;"><!$><!/><span style=color:var(--clr-warning-10);align-self:center;font-size:2rem;></span><!$><!/>'),jn=g("<div class=timetable><!$><!/><div class=entries></div><div class=after-hour><div class=annotation>"),Wn=g("<div><div class=annotation></div><div class=background>"),Kn=g("<div class=entry>");function Zn(e){return(()=>{var t=d(Hn),n=t.firstChild,[l,a]=c(n.nextSibling),i=l.nextSibling,[o,u]=c(i.nextSibling);return s(t,r(Lt,{get programEntries(){return e.programEntries.SATURDAY},get openingHours(){return Te.SATURDAY},day:"SATURDAY"}),l,a),s(t,r(Lt,{get programEntries(){return e.programEntries.SUNDAY},get openingHours(){return Te.SUNDAY},day:"SUNDAY"}),o,u),t})()}function Lt(e){const t=Jn(e.programEntries);return(()=>{var n=d(Yn),l=n.firstChild,a=l.nextSibling,[i,o]=c(a.nextSibling);return s(l,()=>x.days[e.day]),s(n,r($e,{get fallback(){return[r(C,{type:"danger",get children(){return d(Bn)}}),r(K,{each:t,children:([u,h])=>(()=>{var m=d(zn),_=m.firstChild,[S,$]=c(_.nextSibling),b=S.nextSibling,y=b.nextSibling,[k,p]=c(y.nextSibling);return s(m,()=>u.component(),S,$),s(b,r(re,{icon:"triangle-exclamation"})),s(m,()=>h.component(),k,p),m})()})]},get children(){return r(A,{get when(){return t.length===0},get children(){return r(qn,{get programEntries(){return e.programEntries},get openingHours(){return e.openingHours},get day(){return e.day}})}})}}),i,o),n})()}function qn(e){const t=Je(e.openingHours.open),n=e.openingHours.breaks.map(({from:i})=>i),l=(t[0]??0)-1,a=t.at(-1)??0;return(()=>{var i=d(jn),o=i.firstChild,[u,h]=c(o.nextSibling),m=u.nextSibling,_=m.nextSibling,S=_.firstChild;return s(i,r(K,{each:t,children:$=>{const b=n.includes($);return(()=>{var y=d(Wn),k=y.firstChild;return Ue(y,`hour ${b?"break":""}`),s(k,$),ge(p=>kt(y,Ft({from:$,to:$},l,e.day),p)),y})()}}),u,h),s(m,r(K,{get each(){return e.programEntries},children:$=>(()=>{var b=d(Kn);return s(b,()=>$.component()),ge(y=>kt(b,Ft($.range,l,e.day),y)),b})()})),s(S,a+1),ge($=>kt(m,`grid-row: 1 / ${a-l+1};`,$)),i})()}function Ft(e,t,n){const{from:l,to:a}=e,i=l-t,o=a-t,u=Te[n].open.to;return vt(i>0,`Entry can't start at ${l}.`),vt(o>0,`Entry can't end at ${a}.`),vt(a<=u,`Entry can't end at ${a}.`),`grid-row: ${i} / ${o};`}function Jn(e){const t=[];return e.forEach((n,l)=>{e.slice(l+1).forEach(a=>{Fn(n.range,a.range)&&t.push([n,a])})}),t}var Vn=g("<span>");function ln(e){const t=()=>{const n=["chip"];return n.push(e.kind??"gray"),e.inverted&&n.push("inverted"),e.size==="small"&&n.push("small"),n.join(" ")};return(()=>{var n=d(Vn);return s(n,()=>e.children),ge(l=>{var a=t(),i=e.title;return a!==l.e&&Ue(n,l.e=a),i!==l.t&&lt(n,"title",l.t=i),l},{e:void 0,t:void 0}),n})()}var an=g("<br>"),Qn=g("<div>"),Xn=g("<div style=display:grid;gap:1rem;><h3>Meine Kontaktdaten</h3><p><strong>Name:</strong> <!$><!/></p><p><strong>E-Mail:</strong> <!$><!/></p><p><strong>Handynummer:</strong> <!$><!/></p><!$><!/>"),er=g("<form novalidate><!$><!/><!$><!/><!$><!/><!$><!/>"),tr=g("<h3>Mein Programm"),nr=g("<div><!$><!/><!$><!/><h5></h5><p class=duration>von <!$><!/> bis <!$><!/> Uhr <em><small>(<!$><!/> <!$><!/>)");function rr(e){const t=e.store.master.games.flatMap(i=>i.slots.map(o=>({status:i.kind,uuid:i.uuid,title:i.title.value,dateTime:o}))),n=()=>{const i=e.program();return i?.kind==="SUCCESS"?i.data:[]},l=()=>{const i=e.store.playing.reservations.map(o=>o.gameRound);return new Set(i)},a=()=>n().filter(i=>l().has(i.uuid)).map(i=>({uuid:i.uuid,title:i.title,dateTime:i.slot}));return[r(ir,{get store(){return e.store.init},get isEditable(){return e.isEditable}}),d(an),r(ar,{get entries(){return{play:a(),master:t,help:[]}},get changePage(){return e.changePage},get isEditable(){return e.isEditable}})]}function ir(e){const[t,n]=D(e.store),[l,a]=D(ke());return r(C,{get children(){return[r(E,{get when(){return l.open},get children(){return r(lr,{dialogStore:l,get currentState(){return e.store},updateCurrentState:n})}}),(()=>{var i=d(Xn),o=i.firstChild,u=o.nextSibling,h=u.firstChild,m=h.nextSibling,_=m.nextSibling,[S,$]=c(_.nextSibling),b=u.nextSibling,y=b.firstChild,k=y.nextSibling,p=k.nextSibling,[w,N]=c(p.nextSibling),M=b.nextSibling,I=M.firstChild,z=I.nextSibling,L=z.nextSibling,[P,X]=c(L.nextSibling),te=M.nextSibling,[Z,F]=c(te.nextSibling);return s(u,()=>e.store.name,S,$),s(b,()=>e.store.email,w,N),s(M,()=>e.store.mobile,P,X),s(i,r(E,{get when(){return e.isEditable},get children(){var ee=d(Qn);return s(ee,r(B,{icon:"pencil",label:"Kontaktdaten editieren",onClick:()=>a("open",!0)})),ee}}),Z,F),i})()]}})}function lr(e){const[t]=D({name:xt(e.currentState.name),email:xt(e.currentState.email),mobile:xt(e.currentState.mobile)}),n=st(()=>{const i={name:[],email:[]};return t.name.value.trim().length===0&&i.name.push(x.mandatoryField),t.email.value.trim().length===0?i.email.push(x.mandatoryField):t.email.value.includes("@")||i.email.push(x.invalidEmail),{...i,hasErrors:i.name.length+i.email.length>0}}),[l,a]=D(e.dialogStore);return r(pe,{get store(){return e.dialogStore},title:"Kontaktdaten editieren",onClose:()=>{},size:"medium",get children(){var i=d(er),o=i.firstChild,[u,h]=c(o.nextSibling),m=u.nextSibling,[_,S]=c(m.nextSibling),$=_.nextSibling,[b,y]=c($.nextSibling),k=b.nextSibling,[p,w]=c(k.nextSibling);return s(i,r(Ze,{get store(){return t.name},label:"Name",name:"name",showErrors:"ON_BLUR",get errors(){return n().name}}),u,h),s(i,r(Ze,{get store(){return t.email},label:"E-Mail",name:"email",showErrors:"ON_BLUR",get errors(){return n().email}}),_,S),s(i,r(Ze,{get store(){return t.mobile},label:"Handynummer",name:"mobile"}),b,y),s(i,r(W,{label:"Speichern",get disabled(){return n().hasErrors},onClick:()=>{n().hasErrors||(e.updateCurrentState({name:t.name.value,email:t.email.value,mobile:t.mobile.value}),a("open",!1))}}),p,w),i}})}function ar(e){const t=sr(e.entries,e.changePage,e.isEditable);return[d(tr),d(an),r(Zn,{programEntries:t})]}function pt(e){const t=e.range.to-e.range.from,n={"master-draft":{label:"SL",help:"Spielleitung",link:{icon:"pencil",label:"Spielrunde bearbeiten"}},master:{label:"SL",help:"Spielleitung",link:{icon:"pencil",label:"Spielrunde bearbeiten"}},play:{label:"TN",help:"Teilnehmer:in",link:{icon:"link",label:"Zur Spielrunde"}},help:{label:"HL",help:"Helfen",link:{icon:"link",label:""}}}[e.kind],l=()=>{const a=["timeview-entry","box-simple"];return e.kind==="master-draft"&&a.push("gray"),e.kind==="master"&&a.push("special"),e.kind==="play"&&a.push("danger"),a.join(" ")};return(()=>{var a=d(nr),i=a.firstChild,[o,u]=c(i.nextSibling),h=o.nextSibling,[m,_]=c(h.nextSibling),S=m.nextSibling,$=S.nextSibling,b=$.firstChild,y=b.nextSibling,[k,p]=c(y.nextSibling),w=k.nextSibling,N=w.nextSibling,[M,I]=c(N.nextSibling),z=M.nextSibling,L=z.nextSibling,P=L.firstChild,X=P.firstChild,te=X.nextSibling,[Z,F]=c(te.nextSibling),ee=Z.nextSibling,j=ee.nextSibling,[le,ae]=c(j.nextSibling);return le.nextSibling,s(a,r(ln,{get title(){return n.help},inverted:!0,size:"small",get children(){return n.label}}),o,u),s(a,r(E,{get when(){return e.onClick},children:G=>r(qe,{get icon(){return n.link.icon},kind:"ghost",get onClick(){return G()},get title(){return n.link.label}})}),m,_),s(S,()=>e.title),s($,()=>e.range.from,k,p),s($,()=>e.range.to,M,I),s(P,t,Z,F),s(P,t===1?"Stunde":"Stunden",le,ae),ge(G=>{var ne=l(),q=e.title;return ne!==G.e&&Ue(a,G.e=ne),q!==G.t&&lt(S,"title",G.t=q),G},{e:void 0,t:void 0}),a})()}function sr(e,t,n){const l={SATURDAY:[],SUNDAY:[]};return n&&(e.play.forEach(a=>{l[a.dateTime.day].push({range:a.dateTime,component:()=>r(pt,{get title(){return a.title},get range(){return a.dateTime},kind:"play",onClick:()=>t({kind:"GAME",uuid:a.uuid})})})}),e.master.forEach(a=>{if(a.status==="archived")return;const i=[a.title];a.status==="draft"&&i.unshift("(noch nicht verÃ¶ffentlicht)"),l[a.dateTime.day].push({range:a.dateTime,component:()=>r(pt,{get title(){return i.join(" ")},get range(){return a.dateTime},get kind(){return a.status==="published"?"master":"master-draft"},onClick:()=>t({kind:"EDIT_GAMEROUND",uuid:a.uuid})})})}),e.help.forEach(a=>{l[a.dateTime.day].push({range:a.dateTime,component:()=>r(pt,{get title(){return a.title},get range(){return a.dateTime},kind:"help"})})})),l}var or=g("<p>Diese Seite ist leider noch nicht bereit. Komm bitte spÃ¤ter nochmal zurÃ¼ck.");function dr(){return r(C,{type:"danger",get children(){return d(or)}})}var ur=g("<div class=grid><!$><!/><div>"),cr=g("<div class=boxLink>");function Ie(e){const t=e.type??"special";return(()=>{var n=d(cr);return s(n,r(C,{type:t,get onClick(){return e.onClick},get children(){var l=d(ur),a=l.firstChild,[i,o]=c(a.nextSibling),u=i.nextSibling;return s(l,r(re,{get icon(){return e.icon}}),i,o),s(u,()=>e.children),l}})),n})()}const Nt=ct(["SATURDAY","SUNDAY"]),sn=v({uuid:f().uuid(),day:Nt,from:Q(),to:Q()}).refine(e=>e.from<e.to,{message:"A TimeSlot can't end before it starts."});v({name:f(),label:f(),description:f()});const gt=ct(["draft","published","archived"]),gr=v({uuid:f().uuid(),kind:gt,title:f(),system:f(),description:v({short:f(),long:f()}),slots:ie(sn),playerCount:v({min:Q().min(1),max:Q()}).transform(e=>{const[t,n]=An([e.min,e.max]);return{min:t,max:n}}),tagNames:ie(f())}),on=v({uuid:f().uuid(),kind:gt,title:tt,system:tt,description:v({short:tt,long:tt}),slots:ie(sn),playerCount:v({min:It,max:It}),tagNames:ie(f())});function mr(){const e={uuid:crypto.randomUUID(),kind:"draft",title:"",system:"",description:{short:"",long:""},slots:[],playerCount:{min:2,max:4},tagNames:["deutsch"]},t=hr(e);if(t.success)return t.data;throw console.error(t),Error("should not happen")}function hr(e){return on.safeParse(e)}function $r(e){return{...e,title:e.title.value,system:e.system.value,description:{short:e.description.short.value,long:e.description.long.value},playerCount:{min:e.playerCount.min.value,max:e.playerCount.max.value}}}const Ge=[{name:"ab6jahren",label:"Ab 6 Jahren",description:"Spannungs- und Bedrohungsmomente werden kurz gehalten. In Begleitung oder nach Absprache mit einem Elternteil. Beispiele: My Little Pony, ..."},{name:"ab12jahren",label:"Ab 12 Jahren",description:"Antisoziales und destruktives wird auf ein Minimum begrenzt. Keine Diskriminierung, keine Radikalisierung, SexualitÃ¤t wird nicht explizit dargestellt."},{name:"ab18jahren",label:"Ab 18 Jahren",description:"Keinerlei Richtlinien bezÃ¼glich Inhalt, in der Gruppe sollte aber diskutiert werden, was akzeptabel ist und was nicht. Beispiele: Vampire the Masquerade, ..."},{name:"fantasy",label:"Fantasy",description:"Spielt in einer alternativen Vergangenheit, in welcher Elemente wie: Ritterinnen, Hexenmeister, RÃ¼stungen, Magie, Goblins, Turniere usw. vorkommen kÃ¶nnen. Beispiele: Das Schwarze Auge, Dungeons & Dragons, ..."},{name:"sciencefiction",label:"Science Fiction",description:"Spielt in einer alternativen Zukunft, in welcher Elemente wie: Raumschiffe, Sternenportale, KÃ¼nstliche Intelligenzen, Laserkanonen usw. vorkommen kÃ¶nnen. Beispiele: Shadowrun, Alien, ..."},{name:"postapokalyptisch",label:"Postapokalyptisch",description:"Spielt in einer Welt mitten oder nach einem Kollaps, wo die Mehrheit ums Ãberleben kÃ¤mpft. Beispiele: Mutant Year Zero, Apocalypse World"},{name:"horror",label:"Horror",description:"Eine gruselige AtmosphÃ¤re, psychologischer Druck oder unvorhersehbare Schreckensmomente. Beispiele: Cthulhu, ..."},{name:"offenewelt",label:"Offene Welt",description:"Es gibt nur einen losen Handlungsfaden, die Rollenspiel-Gruppe muss sich ihre Ziele selber festlegen. Beispiele: Ironsworn, Blades in the Dark, ..."},{name:"gemeinsamespielleitung",label:"Gemeinsame Spielleitung",description:"Die Regeln und die Umwelt werden gemeinsam von allen Spielenden umgesetzt. Beispiele: Microscope, The Quiet Year, ..."},{name:"regelleicht",label:"Regelleicht",description:"Die kompletten Regeln haben alle auf einer Seite Platz. Beispiele: Fiasco, Everyone is John, ..."},{name:"deutsch",label:"Deutsch",description:"Bei der Spielrunde reden die Spielenden miteinander Deutsch."},{name:"englisch",label:"Englisch",description:"Bei der Spielrunde reden die Spielenden miteinander Englisch."},{name:"workshop",label:"Workshop",description:"Unter Anleitung, gemeinsam ein Rollenspiel-Thema vertiefen. Kreative Techniken stehen im Vordergrund. Beispiele: Gemeinsam einen Dungeon erschaffen, gemeinsam eine Hintergrundgeschichte schreiben, ..."}],mt=200,dn=500,un=200;function Sr(e){const t=e.title.value.trim().length===0,n=e.description.short.value.trim().length===0,l=e.description.short.value.length>mt,a=e.description.long.value.length>dn,i=e.slots.length===0;return{titleMissing:t,descriptionShortMissing:n,descriptionShortTooLong:l,descriptionLongTooLong:a,slotMissing:i,hasErrors:t||n||l||a||i}}function _r(e){const t=e.updateText.value.trim().length===0,n=e.updateText.value.length>un;return{missing:t,tooLong:n,hasErrors:t||n}}var br=g("<h3>"),fr=g("<br>"),vr=g("<div style=margin-top:2rem;><h3 style=margin-bottom:1rem;></h3><ul class=event-list role=list>"),yr=g('<li><h3 class=event-title></h3><div class=event-details><div class=event-tags><strong>Status:</strong><!$><!/></div><div class=event-tags><strong>System:</strong><!$><!/></div><div class=event-tags><strong>Tag, Zeit:</strong><!$><!/></div><div class=event-tags><strong>Spielende:</strong> <!$><!/> - <!$><!/></div> <div class=event-tags><strong>Kategorien:</strong> <!$><!/></div></div><div class="event-description content"><p><strong>Kurzbeschreibung:</strong><br><!$><!/></p></div><ul role=list class=event-links><li><button class=event-link><span>Bearbeiten'),je=g("<em>"),kr=g("<span><!$><!/>, <!$><!/> - <!$><!/> Uhr");function xr(e){const[t,n]=D(e.store);function l(){const i=mr();n("games",t.games.length,i),e.changePage({kind:"EDIT_GAMEROUND",uuid:i.uuid})}const a=()=>e.store.games.flatMap(i=>i.slots.length===0?[{slot:null,game:i}]:i.slots.map(u=>({slot:u,game:i}))).toSorted((i,o)=>Gn(i.slot,o.slot));return[r(E,{get when(){return e.isEditable},get children(){return r(Ie,{icon:"grid-2-plus",type:"success",onClick:l,get children(){var i=d(br);return s(i,()=>x.createNewGameRound),i}})}}),d(fr),r(Tt,{label:"Ich habe wenig bis keine Spielleitung-Erfahrung und mÃ¶chte gerne in der Vorbereitung und/oder wÃ¤hrend der Spielrunde unterstÃ¼tzt werden.",get checked(){return t.wantsHelp},name:"wantsHelp",value:"wantsHelp",onValueUpdate:i=>{n("wantsHelp",i)},get disabled(){return!e.isEditable}}),r(E,{get when(){return a()},children:i=>(()=>{var o=d(vr),u=o.firstChild,h=u.nextSibling;return s(u,()=>x.myGameRounds),s(h,r(K,{get each(){return i().filter(({game:m})=>m.kind!=="archived")},children:({game:m,slot:_})=>{const S=m.tagNames.map($=>Ge.find(({name:b})=>b===$)).filter($=>$!==void 0).map(({label:$})=>$);return r(pr,{game:m,slot:_,tags:S,get changePage(){return e.changePage}})}})),o})()})]}function pr(e){const{game:t,slot:n,tags:l,changePage:a}=e;return(()=>{var i=d(yr),o=i.firstChild,u=o.nextSibling,h=u.firstChild,m=h.firstChild,_=m.nextSibling,[S,$]=c(_.nextSibling),b=h.nextSibling,y=b.firstChild,k=y.nextSibling,[p,w]=c(k.nextSibling),N=b.nextSibling,M=N.firstChild,I=M.nextSibling,[z,L]=c(I.nextSibling),P=N.nextSibling,X=P.firstChild,te=X.nextSibling,Z=te.nextSibling,[F,ee]=c(Z.nextSibling),j=F.nextSibling,le=j.nextSibling,[ae,G]=c(le.nextSibling),ne=P.nextSibling,q=ne.nextSibling,J=q.firstChild,me=J.nextSibling,T=me.nextSibling,[oe,de]=c(T.nextSibling),ue=u.nextSibling,V=ue.firstChild,Se=V.firstChild,fe=Se.nextSibling,Ee=fe.nextSibling,[ve,_e]=c(Ee.nextSibling),he=ue.nextSibling,Ce=he.firstChild,we=Ce.firstChild;return s(o,(()=>{var R=O(()=>t.title.value.length>0);return()=>R()?t.title.value:(()=>{var ce=d(je);return s(ce,()=>x.missingTitle),ce})()})()),s(h,()=>x.publishingSteps[t.kind],S,$),s(b,()=>t.system.value||(()=>{var R=d(je);return s(R,()=>x.missingSystem),R})(),p,w),s(N,n!==null?(()=>{var R=d(kr),ce=R.firstChild,[Oe,Ae]=c(ce.nextSibling),He=Oe.nextSibling,Ye=He.nextSibling,[ye,ht]=c(Ye.nextSibling),$t=ye.nextSibling,Xe=$t.nextSibling,[et,St]=c(Xe.nextSibling);return et.nextSibling,s(R,()=>x.days[n.day],Oe,Ae),s(R,()=>n.from,ye,ht),s(R,()=>n.to,et,St),R})():(()=>{var R=d(je);return s(R,()=>x.missingSlot),R})(),z,L),s(P,()=>t.playerCount.min.value,F,ee),s(P,()=>t.playerCount.max.value,ae,G),s(q,()=>l.join(", ")||(()=>{var R=d(je);return s(R,()=>x.missingTags),R})(),oe,de),s(V,(()=>{var R=O(()=>t.description.short.value.length===0);return()=>R()?(()=>{var ce=d(je);return s(ce,()=>x.missingShortDescription),ce})():Qt(t.description.short.value,mt)})(),ve,_e),we.$$click=()=>a({kind:"EDIT_GAMEROUND",uuid:t.uuid}),ge(()=>Ue(i,["event-entry",t.kind==="draft"?"gray":""].join(" "))),dt(),i})()}ot(["click"]);var Er=g("<div class=game-dialog><ul role=list style=display:grid;gap:0.5rem;><li><strong style=color:var(--clr-accent-1);>Spielleitung:</strong><br> <!$><!/></li><li><strong style=color:var(--clr-accent-1);>System:</strong><br><!$><!/></li><li><strong style=color:var(--clr-accent-1);>Tag, Zeit:</strong> <br><!$><!/>, <!$><!/> - <!$><!/> Uhr</li><li><strong style=color:var(--clr-accent-1);>Freie PlÃ¤tze:</strong><br><!$><!/> (von <!$><!/>)</li><li><strong style=color:var(--clr-accent-1);>Kategorien:</strong><br><!$><!/></li><li><strong style=color:var(--clr-accent-1);>Kurze Beschreibung:</strong><br><!$><!/></li><li><strong style=color:var(--clr-accent-1);>Lange Beschreibung:</strong><br><!$><!/></li></ul><div class=reservations><h5 style=margin-block-start:0>PlÃ¤tze reservieren</h5><div class=reservation-table>"),Cr=g("<em>kein System angegeben"),wr=g("<em>keine Kategorien"),Ar=g("<em>Keine lange Beschreibung angegeben."),Rr=g("<div class=count>"),Dr=g("<div class=reservation-table-entry><p>Reserviert fÃ¼r mich </p><!$><!/>"),Tr=g('<div class=reservation-table-entry><p>Reserviert fÃ¼r "<!$><!/>"</p><!$><!/>'),Ur=g('<div style="display:grid;gap:1rem;grid-template-columns:max-content 1fr;"><!$><!/><!$><!/>'),Or=g('<form style="display:grid;gap:0rem;grid-template-columns:1fr max-content"class=input-button><input type=text style=border-color:var(--clr-special-9);><!$><!/>');function Nr(e){const t=()=>e.reservations.filter(u=>u.gameRound===e.entry.uuid),n=Math.max(e.entry.playerCount.reserved+1-t.length,1),l=e.entry.tags.map(u=>Ge.find(({name:h})=>h===u)).filter(u=>u!==void 0).map(({label:u})=>u),a=e.entry.playerCount.max,i=()=>rn(a).map(u=>{const h=t()[u];return h!==void 0?h:u+1===a?{kind:"RESERVED_SPONTANIOUS"}:a-n<=u?{kind:"RESERVED_OTHER"}:{kind:"FREE"}}),o=()=>t().find(u=>u.kind==="SELF")!==void 0;return(()=>{var u=d(Er),h=u.firstChild,m=h.firstChild,_=m.firstChild,S=_.nextSibling,$=S.nextSibling,b=$.nextSibling,[y,k]=c(b.nextSibling),p=m.nextSibling,w=p.firstChild,N=w.nextSibling,M=N.nextSibling,[I,z]=c(M.nextSibling),L=p.nextSibling,P=L.firstChild,X=P.nextSibling,te=X.nextSibling,Z=te.nextSibling,[F,ee]=c(Z.nextSibling),j=F.nextSibling,le=j.nextSibling,[ae,G]=c(le.nextSibling),ne=ae.nextSibling,q=ne.nextSibling,[J,me]=c(q.nextSibling);J.nextSibling;var T=L.nextSibling,oe=T.firstChild,de=oe.nextSibling,ue=de.nextSibling,[V,Se]=c(ue.nextSibling),fe=V.nextSibling,Ee=fe.nextSibling,[ve,_e]=c(Ee.nextSibling);ve.nextSibling;var he=T.nextSibling,Ce=he.firstChild,we=Ce.nextSibling,R=we.nextSibling,[ce,Oe]=c(R.nextSibling),Ae=he.nextSibling,He=Ae.firstChild,Ye=He.nextSibling,ye=Ye.nextSibling,[ht,$t]=c(ye.nextSibling),Xe=Ae.nextSibling,et=Xe.firstChild,St=et.nextSibling,bn=St.nextSibling,[fn,vn]=c(bn.nextSibling),yn=h.nextSibling,kn=yn.firstChild,xn=kn.nextSibling;return s(m,()=>e.entry.gamemaster,y,k),s(p,(()=>{var H=O(()=>e.entry.system.trim().length>0);return()=>H()?e.entry.system:d(Cr)})(),I,z),s(L,()=>x.days[e.entry.slot.day],F,ee),s(L,()=>e.entry.slot.from,ae,G),s(L,()=>e.entry.slot.to,J,me),s(T,()=>Math.max(e.entry.playerCount.max-1-e.entry.playerCount.reserved,0),V,Se),s(T,()=>e.entry.playerCount.max-1,ve,_e),s(he,(()=>{var H=O(()=>l.length>0);return()=>H()?l.join(", "):d(wr)})(),ce,Oe),s(Ae,()=>e.entry.description.short,ht,$t),s(Xe,(()=>{var H=O(()=>e.entry.description.long.trim().length>0);return()=>H()?O(()=>e.entry.description.long):d(Ar)})(),fn,vn),s(xn,r(K,{get each(){return i()},children:(H,pn)=>[(()=>{var Y=d(Rr);return s(Y,()=>pn()+1),Y})(),r($e,{get children(){return[r(A,{get when(){return H.kind==="RESERVED_OTHER"},get children(){return r(C,{children:"Bereits reserviert"})}}),r(A,{get when(){return H.kind==="RESERVED_SPONTANIOUS"},get children(){return r(C,{children:"Reserviert fÃ¼r spontane Spieler:innen"})}}),r(A,{get when(){return!e.isEditable},get children(){return r(C,{children:"Freier Platz"})}}),r(A,{get when(){return H.kind==="SELF"},get children(){return r(Mt,{type:"success",get children(){var Y=d(Dr),Re=Y.firstChild,Ne=Re.nextSibling,[Be,Me]=c(Ne.nextSibling);return s(Y,r(qe,{icon:"trash",onClick:()=>e.removeReservation(H.kind==="SELF"?H.uuid:"should not happen")}),Be,Me),Y}})}}),r(A,{get when(){return H.kind==="FRIEND"},get children(){return r(Mt,{type:"success",get children(){var Y=d(Tr),Re=Y.firstChild,Ne=Re.firstChild,Be=Ne.nextSibling,[Me,_t]=c(Be.nextSibling);Me.nextSibling;var bt=Re.nextSibling,[ft,En]=c(bt.nextSibling);return s(Re,()=>H.kind==="FRIEND"?H.name:"[Fehler beim Laden]",Me,_t),s(Y,r(qe,{icon:"trash",onClick:()=>e.removeReservation(H.kind==="FRIEND"?H.uuid:"should not happen")}),ft,En),Y}})}}),r(A,{get when(){return H.kind==="FREE"},get children(){return r(E,{get when(){return o()},get fallback(){return(()=>{var Y=d(Ur),Re=Y.firstChild,[Ne,Be]=c(Re.nextSibling),Me=Ne.nextSibling,[_t,bt]=c(Me.nextSibling);return s(Y,r(B,{icon:"person-to-portal",label:"Mich anmelden",kind:"success",onClick:()=>e.addReservation({kind:"SELF",gameRound:e.entry.uuid})}),Ne,Be),s(Y,r(Gt,{addFriend:ft=>e.addReservation({kind:"FRIEND",gameRound:e.entry.uuid,name:ft})}),_t,bt),Y})()},get children(){return r(Gt,{addFriend:Y=>e.addReservation({kind:"FRIEND",gameRound:e.entry.uuid,name:Y})})}})}})]}})]})),u})()}function Gt(e){const[t,n]=Dt("");return(()=>{var l=d(Or),a=l.firstChild,i=a.nextSibling,[o,u]=c(i.nextSibling);return l.addEventListener("submit",h=>{h.preventDefault();const m=t();m.trim().length>0&&e.addFriend(m)}),at(l,"novalidate",!0),a.$$input=h=>n(h.target.value),s(l,r(B,{icon:"arrow-right",type:"submit",label:"Begleitperson anmelden",kind:"special"}),o,u),ge(()=>at(a,"value",t())),dt(),l})()}ot(["input"]);var Mr=g("<div style=display:flex;flex-wrap:wrap;gap:1rem;justify-content:space-between;><h5 style=margin:0;>Filter</h5><!$><!/>"),Pr=g("<h6 style=margin-block:0.5rem;>Tage"),Ir=g("<div style=display:flex;flex-wrap:wrap;gap:0.5rem;><!$><!/><!$><!/>"),Lr=g("<h6 style=margin-block:0.5rem;>Kategorien <span>"),Fr=g("<div style=display:flex;flex-wrap:wrap;gap:0.5rem;>");const se={day:"fDay",tags:"fTags",options:"fOpts"};function Gr(){const e=new URL(location.href),t=e.searchParams.get(se.day),n=t==="SATURDAY"||t==="SUNDAY"?t:null,l=e.searchParams.getAll(se.tags),a=e.searchParams.getAll(se.options);return{day:n,tags:l,withOpenSeats:a.includes("withOpenSeats"),iHaveTime:a.includes("iHaveTime")}}function Hr(e,t){return{toggleDay:n=>{const l=e.day===n,a=new URL(location.href);l?(a.searchParams.delete(se.day),t("day",null)):(a.searchParams.set(se.day,n),t("day",n)),history.pushState(Ke(e),"",a)},toggleTag:n=>{const l=e.tags.includes(n),a=new URL(location.href);l?(a.searchParams.delete(se.tags),t("tags",e.tags.filter(i=>i!==n)),e.tags.forEach(i=>{a.searchParams.append(se.tags,i)})):(a.searchParams.append(se.tags,n),t("tags",e.tags.length,n)),history.pushState(Ke(e),"",a)},toggleOption:n=>{const l=e[n],a=new URL(location.href);t(n,!l),["withOpenSeats","iHaveTime"].forEach(i=>{e[i]&&a.searchParams.append(se.options,i)}),history.pushState(Ke(e),"",a)},reset:()=>{t({day:null,tags:[],withOpenSeats:!1,iHaveTime:!1});const n=new URL(location.href);n.searchParams.delete(se.day),n.searchParams.delete(se.tags),n.searchParams.delete(se.options),history.pushState(Ke(e),"",n)}}}function Yr(e){const[t,n]=D(e.activeFilter),l=Hr(t,n);return r(C,{get children(){return[(()=>{var a=d(Mr),i=a.firstChild,o=i.nextSibling,[u,h]=c(o.nextSibling);return s(a,r(B,{label:"Filter zurÃ¼cksetzen",icon:"circle-xmark",kind:"ghost-danger",onClick:()=>l.reset()}),u,h),a})(),d(Pr),(()=>{var a=d(Ir),i=a.firstChild,[o,u]=c(i.nextSibling),h=o.nextSibling,[m,_]=c(h.nextSibling);return s(a,r(W,{label:"Samstag",get kind(){return t.day!=="SUNDAY"?"success":"gray"},onClick:()=>l.toggleDay("SATURDAY")}),o,u),s(a,r(W,{label:"Sonntag",get kind(){return t.day!=="SATURDAY"?"success":"gray"},onClick:()=>l.toggleDay("SUNDAY")}),m,_),a})(),(()=>{var a=d(Lr),i=a.firstChild,o=i.nextSibling;return s(o,r(qe,{icon:"circle-question",kind:"ghost",title:"ErklÃ¤rungen der Kategorien",get onClick(){return e.showExplanationOfCategories}})),a})(),(()=>{var a=d(Fr);return s(a,r(K,{each:Ge,children:i=>r(W,{get label(){return i.label},get kind(){return t.tags.length===0||t.tags.includes(i.name)?"success":"gray"},onClick:()=>l.toggleTag(i.name)})})),a})()]}})}function Br(e,t){return e.filter(n=>!(t.day!==n.slot.day&&t.day!==null||!zr(n.tags,t.tags)))}function zr(e,t){return t.length===0?!0:t.filter(l=>!e.includes(l)).length===0}var jr=g("<p>WIP"),De=g("<br>"),Wr=g("<ul style=padding:0;padding-block-start:1rem;margin:0;max-inline-size:100%;display:grid;gap:0.5rem;>"),Kr=g("<p>Diese Seite ist leider noch nicht bereit. Komm bitte spÃ¤ter nochmal zurÃ¼ck."),Zr=g("<li><strong></strong><br><p>"),qr=g("<p>Programm konnte nicht geladen werden."),Jr=g("<em><!$><!/> von <!$><!/> Runden gefunden."),Vr=g("<h3>"),Qr=g("<h4 style=margin-block-start:2rem;margin-block-end:1rem;>Start: <!$><!/> Uhr"),Xr=g('<ul class="event-list max"role=list>'),ei=g("<small><!$><!/> - <!$><!/> Uhr"),ti=g("<h4 style=margin-block-end:0.5rem;>"),ni=g("<em>Das MenÃ¼ wird zu einem spÃ¤teren Zeitpunkt kommuniziert."),ri=g("<div style=margin-block-start:2rem;>"),ii=g('<li><h3 class=event-title></h3><div class=event-details><div class=event-tags><strong>Spielleitung:</strong><!$><!/></div><div class=event-tags><strong>System:</strong><!$><!/></div><div class=event-tags><strong>Tag, Zeit:</strong><span><!$><!/>, <!$><!/> - <!$><!/> Uhr</span></div><div class=event-tags><strong>Freie PlÃ¤tze:</strong> <!$><!/> (von <!$><!/>)</div> <div class=event-tags><strong>Kategorien:</strong> <!$><!/></div></div><div class="event-description content"><p><strong>Kurzbeschreibung:</strong><br><!$><!/></p></div><ul role=list class=event-links><li><button class=event-link><span>Details & Teilnahme'),li=g("<em>kein System angegeben"),ai=g("<em>keine Kategorien");function si(e){const[t,n]=D({playing:e.store,activeFilter:Gr(),categoryDialog:ke()});return r($e,{get fallback(){return r(C,{type:"danger",get children(){return d(Kr)}})},get children(){return r(A,{get when(){return e.isDebugging},get children(){return[r(C,{type:"danger",get children(){return d(jr)}}),d(De),r(Tt,{label:"Schickt mir bitte E-Mails, wenn neue Spielrunden verÃ¶ffentlicht werden.",get checked(){return t.playing.wantsUpdates},name:"wantsUpdates",value:"wantsUpdates",onValueUpdate:l=>{n("playing","wantsUpdates",l)}}),d(De),r(Yr,{get activeFilter(){return t.activeFilter},showExplanationOfCategories:()=>n("categoryDialog","open",!0)}),r(pe,{get store(){return t.categoryDialog},title:"ErklÃ¤rungen der Kategorien",onClose:()=>{},size:"medium",get children(){var l=d(Wr);return s(l,()=>Ge.map(a=>(()=>{var i=d(Zr),o=i.firstChild,u=o.nextSibling,h=u.nextSibling;return s(o,()=>a.label),s(h,()=>a.description),i})())),l}}),d(De),r(ut,{get fallback(){return r(C,{get children(){return x.loading.program}})},get children(){return r(E,{get when(){return e.program()},get fallback(){return r(C,{type:"danger",get children(){return x.error.program}})},children:l=>r(E,{get when(){return l().kind==="SUCCESS"},get fallback(){return r(C,{type:"danger",get children(){return d(qr)}})},get children(){return r(oi,{get program(){return l().data},get filter(){return t.activeFilter},get reservations(){return t.playing.reservations},get isEditable(){return e.isEditable},addReservation:a=>n("playing","reservations",t.playing.reservations.length,{...a,uuid:crypto.randomUUID()}),removeReservation:a=>{n("playing","reservations",t.playing.reservations.filter(i=>i.uuid!==a))},get uuid(){return e.uuid},get changePage(){return e.changePage}})}})})}})]}})}})}function oi(e){const[t,n]=D(ke(e.uuid!==void 0));en(()=>{n("open",e.uuid!==null)});const l=()=>e.program.find(o=>o.uuid===e.uuid),a=()=>Br(e.program,e.filter),i=()=>ci(ui(a()));return[(()=>{var o=d(Jr),u=o.firstChild,[h,m]=c(u.nextSibling),_=h.nextSibling,S=_.nextSibling,[$,b]=c(S.nextSibling);return $.nextSibling,s(o,()=>a().length,h,m),s(o,()=>e.program.length,$,b),o})(),d(De),r(E,{get when(){return l()},children:o=>r(pe,{store:t,get title(){return o().title},onClose:()=>e.changePage({kind:"PLAYER"},{disableScroll:!0}),size:"large",get children(){return r(Nr,{get entry(){return o()},get reservations(){return e.reservations},get isEditable(){return e.isEditable},get addReservation(){return e.addReservation},get removeReservation(){return e.removeReservation}})}})}),d(De),r(Ht,{day:"SATURDAY",get programOfDay(){return i().SATURDAY},get changePage(){return e.changePage}}),d(De),d(De),r(Ht,{day:"SUNDAY",get programOfDay(){return i().SUNDAY},get changePage(){return e.changePage}})]}function Ht(e){const t=()=>Object.values(e.programOfDay).flat().length>0,l=Te[e.day].breaks.map(i=>i.from),a=i=>l.indexOf(i)===0?"LUNCH":"DINNER";return[(()=>{var i=d(Vr);return s(i,()=>x.days[e.day]),i})(),r(E,{get when(){return t()},get fallback(){return r(C,{get children(){return["Keine Spielrunden mit den ausgewÃ¤hlten Filtern am"," ",O(()=>x.days[e.day])," gefunden."]}})},get children(){return r(K,{get each(){return Object.entries(e.programOfDay)},children:([i,o])=>l.includes(Number(i))?r(di,{get type(){return a(Number(i))},get range(){return{from:Number(i),to:Number(i)-1}}}):o.length===0?null:[(()=>{var u=d(Qr),h=u.firstChild,m=h.nextSibling,[_,S]=c(m.nextSibling);return _.nextSibling,s(u,i,_,S),u})(),(()=>{var u=d(Xr);return s(u,r(K,{each:o,children:h=>r(gi,{entry:h,get changePage(){return e.changePage}})})),u})()]})}})]}function di(e){const t=e.type==="LUNCH"?"Mittagessen":"Nachtessen";return(()=>{var n=d(ri);return s(n,r(C,{get children(){return[(()=>{var l=d(ei),a=l.firstChild,[i,o]=c(a.nextSibling),u=i.nextSibling,h=u.nextSibling,[m,_]=c(h.nextSibling);return m.nextSibling,s(l,()=>e.range.from,i,o),s(l,()=>e.range.to,m,_),l})(),(()=>{var l=d(ti);return s(l,t),l})(),d(ni)]}})),n})()}function ui(e){const t=Object.groupBy(e,n=>n.slot.day);return{SATURDAY:t.SATURDAY??[],SUNDAY:t.SUNDAY??[]}}function ci(e){function t(o,u){const{from:h,to:m}=o.slot,{from:_,to:S}=u.slot;return h===_?m-S:h-_}const n=e.SATURDAY.toSorted(t),l=e.SUNDAY.toSorted(t),a=Je(Te.SATURDAY.open).reduce((o,u)=>(o[u]=n.filter(h=>h.slot.from===u),o),{}),i=Je(Te.SUNDAY.open).reduce((o,u)=>(o[u]=l.filter(h=>h.slot.from===u),o),{});return{SATURDAY:a,SUNDAY:i}}function gi(e){const t=Ge.filter(n=>e.entry.tags.includes(n.name)).map(({label:n})=>n);return(()=>{var n=d(ii),l=n.firstChild,a=l.nextSibling,i=a.firstChild,o=i.firstChild,u=o.nextSibling,[h,m]=c(u.nextSibling),_=i.nextSibling,S=_.firstChild,$=S.nextSibling,[b,y]=c($.nextSibling),k=_.nextSibling,p=k.firstChild,w=p.nextSibling,N=w.firstChild,[M,I]=c(N.nextSibling),z=M.nextSibling,L=z.nextSibling,[P,X]=c(L.nextSibling),te=P.nextSibling,Z=te.nextSibling,[F,ee]=c(Z.nextSibling);F.nextSibling;var j=k.nextSibling,le=j.firstChild,ae=le.nextSibling,G=ae.nextSibling,[ne,q]=c(G.nextSibling),J=ne.nextSibling,me=J.nextSibling,[T,oe]=c(me.nextSibling);T.nextSibling;var de=j.nextSibling,ue=de.nextSibling,V=ue.firstChild,Se=V.nextSibling,fe=Se.nextSibling,[Ee,ve]=c(fe.nextSibling),_e=a.nextSibling,he=_e.firstChild,Ce=he.firstChild,we=Ce.nextSibling,R=we.nextSibling,[ce,Oe]=c(R.nextSibling),Ae=_e.nextSibling,He=Ae.firstChild,Ye=He.firstChild;return s(l,()=>e.entry.title),s(i,()=>e.entry.gamemaster,h,m),s(_,(()=>{var ye=O(()=>e.entry.system.trim().length>0);return()=>ye()?e.entry.system:d(li)})(),b,y),s(w,()=>x.days[e.entry.slot.day],M,I),s(w,()=>e.entry.slot.from,P,X),s(w,()=>e.entry.slot.to,F,ee),s(j,()=>Math.max(e.entry.playerCount.max-1-e.entry.playerCount.reserved,0),ne,q),s(j,()=>e.entry.playerCount.max-1,T,oe),s(ue,(()=>{var ye=O(()=>t.length>0);return()=>ye()?t.join(", "):d(ai)})(),Ee,ve),s(he,()=>Qt(e.entry.description.short,mt),ce,Oe),Ye.$$click=()=>e.changePage({kind:"GAME",uuid:e.entry.uuid},{disableScroll:!0}),ge(()=>Ue(n,["event-entry"].join(" "))),dt(),n})()}ot(["click"]);var Yt=g("<h3>Spielrunden ansehen"),Bt=g("<p>Melde dich (und deine Freunde) fÃ¼r diverse Spielrunden an."),Et=g("<br>"),mi=g("<h3>Spielrunden erstellen"),hi=g("<p>Falls du wenig oder gar keine Erfahrung als Spielleiter:in hast, werden wir dich vor und wÃ¤hrend dem Anlass unterstÃ¼tzen."),$i=g("<h3>Helfen"),Si=g("<p>Beim Kiosk und der Essensausgabe kÃ¶nnen wir immer ein paar helfende HÃ¤nde gebrauchen."),zt=g("<p><strong>Noch nicht verfÃ¼gbar."),_i=g("<h3>Zusammenfassung"),bi=g("<p>Erhalte einen Ãberblick Ã¼ber dein gesamtes Programm.");function fi(e){return[r($e,{get fallback(){return r(Ie,{type:"gray",icon:"dice-d20",onClick:()=>e.changePage({kind:"PLAYER"}),get children(){return[d(Yt),d(Bt),d(zt)]}})},get children(){return r(A,{get when(){return e.isDebugging},get children(){return r(Ie,{icon:"dice-d20",onClick:()=>e.changePage({kind:"PLAYER"}),get children(){return[d(Yt),d(Bt)]}})}})}}),d(Et),r(Ie,{icon:"grid-2-plus",onClick:()=>e.changePage({kind:"GAMEMASTER"}),get children(){return[d(mi),d(hi)]}}),d(Et),r(Ie,{type:"gray",icon:"hand-heart",onClick:()=>e.changePage({kind:"HELPING"}),get children(){return[d($i),d(Si),d(zt)]}}),d(Et),r(Ie,{icon:"list",onClick:()=>e.changePage({kind:"SUMMARY"}),get children(){return[d(_i),d(bi)]}})]}var vi=g("<fieldset><legend>Zeitslots</legend><!$><!/><!$><!/>"),jt=g("<br>"),yi=g("<div style=margin-block-end:0.5rem;>Zeitslot: <!$><!/>, <!$><!/> -<!$><!/> Uhr"),ki=g("<ul class=event-list role=list>"),xi=g("<em>werden geladen..."),pi=g("<li class=event-entry><h3 class=event-title><!$><!/>, <!$><!/> - <!$><!/> Uhr</h3><div class=event-details><div class=event-tags><strong>Dauer:</strong><!$><!/> <!$><!/></div><div class=event-tags><strong>Spielende:</strong> <!$><!/></div></div><div></div><ul role=list class=event-links>"),Ei=g("<em>Fehler beim Laden."),Ci=g("<em>noch keine Anmeldungen"),wi=g("<li><em style=font-size:smaller;>Aktionen werden geladen..."),Wt=g("<li><em style=font-size:smaller;>kann nicht gelÃ¶scht werden"),Ai=g("<li><button type=button class=event-link><div style=display:flex;gap:0.25rem;align-items:center;><!$><!/><span>LÃ¶schen"),Ri=g("<div style=display:grid;gap:0.5rem;>"),Di=g("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/>"),Ti=g("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/><!$><!/>"),Ui=g("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/><!$><!/><div style=margin-block-start:1rem;>"),Oi=g("<div style=display:flex;flex-wrap:wrap;gap:0.5rem;align-items:center;><!$><!/> <span>Neuen Slot erfassen"),Ni=g("<em>WÃ¤hle eine Tag:"),Mi=g("<div style=display:flex;flex-wrap:wrap;gap:.5rem;><!$><!/><!$><!/>"),Pi=g("<em>WÃ¤hle eine Startzeit:"),cn=g("<div style=display:flex;flex-wrap:wrap;gap:.5rem;>"),gn=g("<span style=white-space:nowrap;><!$><!/> Uhr"),Ii=g("<em>WÃ¤hle eine Endzeit:");function Li(e){return(()=>{var t=d(vi),n=t.firstChild,l=n.nextSibling,[a,i]=c(l.nextSibling),o=a.nextSibling,[u,h]=c(o.nextSibling);return s(t,r(Gi,{get store(){return e.store},get registrations(){return e.registrations},get isEditable(){return e.isEditable}}),a,i),s(t,r(E,{get when(){return e.slotMissing},get children(){return r(C,{type:"danger",children:"WÃ¤hle mindestens einen Zeitslot aus."})}}),u,h),t})()}const Kt=1;function Fi(e){function t(n){const l=Je(n.open,!0);return n.breaks.map(i=>Je(i,!0)).reduce((i,o)=>{const u=o.at(0),h=o.at(-1);if(u===void 0||h===void 0)return i;const m=[];return i.forEach(_=>{const S=[],$=[];_.forEach(b=>{b<=u&&S.push(b),h<=b&&$.push(b)}),S.length>0&&m.push(S),$.length>0&&m.push($)}),m},[l]).map(i=>{const o=i.slice(0,Kt*-1);return Rn(o.map(u=>{const h=i.filter(m=>m>=u+Kt);return[u,h]}))}).reduce((i,o)=>({...i,...o}),{})}return{SATURDAY:t(e.SATURDAY),SUNDAY:t(e.SUNDAY)}}function Gi(e){const[t,n]=D(e.store),[l,a]=D({dialog:ke()}),i=st(()=>Fi(Te));function o(m){n(t.concat(m))}function u(m){a("dialog","open",!1),a("slot",void 0),n(t.filter(_=>_.uuid!==m))}function h(m){a("dialog","open",!0),a("slot",t.find(_=>_.uuid===m))}return[r(Yi,{get daySections(){return i()},chooseTimeSlot:o,get isEditable(){return e.isEditable}}),d(jt),d(jt),r(pe,{get store(){return l.dialog},title:"Zeitslot lÃ¶schen",onClose:()=>a("slot",void 0),get children(){return[(()=>{var m=d(yi),_=m.firstChild,S=_.nextSibling,[$,b]=c(S.nextSibling),y=$.nextSibling,k=y.nextSibling,[p,w]=c(k.nextSibling),N=p.nextSibling,M=N.nextSibling,[I,z]=c(M.nextSibling);return I.nextSibling,s(m,()=>x.days[l.slot?.day],$,b),s(m,()=>l.slot?.from,p,w),s(m,()=>l.slot?.to,I,z),m})(),r(B,{kind:"danger",icon:"trash",label:"LÃ¶schen",onClick:()=>u(l.slot?.uuid)})]}}),r(Hi,{slots:t,get registrations(){return e.registrations},confirmRemoval:h,get isEditable(){return e.isEditable}})]}function Hi(e){return(()=>{var t=d(ki);return s(t,r(K,{get each(){return Bi(e.slots)},children:n=>(()=>{var l=d(pi),a=l.firstChild,i=a.firstChild,[o,u]=c(i.nextSibling),h=o.nextSibling,m=h.nextSibling,[_,S]=c(m.nextSibling),$=_.nextSibling,b=$.nextSibling,[y,k]=c(b.nextSibling);y.nextSibling;var p=a.nextSibling,w=p.firstChild,N=w.firstChild,M=N.nextSibling,[I,z]=c(M.nextSibling),L=I.nextSibling,P=L.nextSibling,[X,te]=c(P.nextSibling),Z=w.nextSibling,F=Z.firstChild,ee=F.nextSibling,j=ee.nextSibling,[le,ae]=c(j.nextSibling),G=p.nextSibling,ne=G.nextSibling;return s(a,()=>x.days[n.day],o,u),s(a,()=>n.from,_,S),s(a,()=>n.to,y,k),s(w,()=>n.to-n.from,I,z),s(w,()=>n.to-n.from>1?"Stunden":"Stunde",X,te),s(Z,r($e,{get children(){return[r(A,{get when(){return e.registrations.loading},get children(){return d(xi)}}),r(A,{get when(){return e.registrations()},children:q=>{const J=q();if(J.kind==="FAILURE")return d(Ei);const me=J.data.filter(T=>T.uuid===n.uuid).map(T=>T.name);return O(()=>me.join(", ")||d(Ci))}})]}}),le,ae),s(ne,r(ut,{get fallback(){return d(wi)},get children(){return r(E,{get when(){return e.registrations()},children:q=>{const J=q();return J.kind==="FAILURE"?d(Wt):J.data.filter(T=>T.uuid===n.uuid).map(T=>T.name).length>0?d(Wt):(()=>{var T=d(Ai),oe=T.firstChild,de=oe.firstChild,ue=de.firstChild,[V,Se]=c(ue.nextSibling);return V.nextSibling,oe.$$click=()=>e.confirmRemoval(n.uuid),s(de,r(re,{icon:"trash"}),V,Se),ge(()=>at(oe,"disabled",!e.isEditable)),dt(),T})()}})}})),l})()})),t})()}function Yi(e){const[t,n]=D({slot:{kind:"CHOOSE_DAY"},dialog:ke()});function l(){n("slot",{kind:"CHOOSE_DAY"}),n("dialog","open",!1)}function a(i){e.chooseTimeSlot(i),l()}return[r(W,{kind:"success",get label(){return(()=>{var i=d(Oi),o=i.firstChild,[u,h]=c(o.nextSibling);return u.nextSibling,s(i,r(re,{icon:"circle-plus"}),u,h),i})()},onClick:()=>n("dialog","open",!0),get disabled(){return!e.isEditable}}),r(pe,{title:"Zeitslot erfassen",get store(){return t.dialog},size:"medium",onClose:l,get children(){return r($e,{get children(){return[r(A,{get when(){return t.slot.kind==="CHOOSE_DAY"},get children(){var i=d(Ri);return s(i,r(rt,{changeDay:o=>n("slot",{kind:"CHOOSE_START",day:o})})),i}}),r(A,{get when(){return t.slot.kind==="CHOOSE_START"},get children(){var i=d(Di),o=i.firstChild,[u,h]=c(o.nextSibling),m=u.nextSibling,[_,S]=c(m.nextSibling);return s(i,r(rt,{get chosenDay(){return t.slot.kind==="CHOOSE_START"?t.slot.day:void 0},changeDay:$=>n("slot",{kind:"CHOOSE_START",day:$})}),u,h),s(i,r(Ct,{get startTimes(){return O(()=>t.slot.kind==="CHOOSE_START")()?yt(e.daySections[t.slot.day]):[]},changeStart:$=>n("slot",{kind:"CHOOSE_END",start:$})}),_,S),i}}),r(A,{get when(){return t.slot.kind==="CHOOSE_END"},get children(){var i=d(Ti),o=i.firstChild,[u,h]=c(o.nextSibling),m=u.nextSibling,[_,S]=c(m.nextSibling),$=_.nextSibling,[b,y]=c($.nextSibling);return s(i,r(rt,{get chosenDay(){return t.slot.kind==="CHOOSE_END"?t.slot.day:void 0},changeDay:k=>n("slot",{kind:"CHOOSE_START",day:k})}),u,h),s(i,r(Ct,{get chosenStart(){return t.slot.kind==="CHOOSE_END"?t.slot.start:void 0},get startTimes(){return O(()=>t.slot.kind==="CHOOSE_END")()?yt(e.daySections[t.slot.day]):[]},changeStart:k=>n("slot",{kind:"CHOOSE_END",start:k})}),_,S),s(i,r(Zt,{get endTimes(){return t.slot.kind==="CHOOSE_END"?e.daySections[t.slot.day][t.slot.start]??[]:[]},changeEnd:k=>{t.slot.kind==="CHOOSE_END"&&n("slot",{kind:"WAIT_FOR_CONFIRMATION",day:t.slot.day,start:t.slot.start,end:k})}}),b,y),i}}),r(A,{get when(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"},get children(){var i=d(Ui),o=i.firstChild,[u,h]=c(o.nextSibling),m=u.nextSibling,[_,S]=c(m.nextSibling),$=_.nextSibling,[b,y]=c($.nextSibling),k=b.nextSibling;return s(i,r(rt,{get chosenDay(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?t.slot.day:void 0},changeDay:p=>n("slot",{kind:"CHOOSE_START",day:p})}),u,h),s(i,r(Ct,{get chosenStart(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?t.slot.start:void 0},get startTimes(){return O(()=>t.slot.kind==="WAIT_FOR_CONFIRMATION")()?yt(e.daySections[t.slot.day]):[]},changeStart:p=>n("slot",{kind:"CHOOSE_END",start:p})}),_,S),s(i,r(Zt,{get chosenEnd(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?t.slot.end:void 0},get endTimes(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?e.daySections[t.slot.day][t.slot.start]??[]:[]},changeEnd:p=>{t.slot.kind==="WAIT_FOR_CONFIRMATION"&&n("slot",{kind:"WAIT_FOR_CONFIRMATION",day:t.slot.day,start:t.slot.start,end:p})}}),b,y),s(k,r(W,{get label(){return`Slot "${t.slot.kind==="WAIT_FOR_CONFIRMATION"?`${x.days[t.slot.day]}, von ${t.slot.start} bis ${t.slot.end} Uhr`:""}" erstellen`},kind:"success",onClick:()=>{t.slot.kind==="WAIT_FOR_CONFIRMATION"&&a({uuid:crypto.randomUUID(),day:t.slot.day,from:t.slot.start,to:t.slot.end})}})),i}})]}})}})]}function rt(e){return[d(Ni),(()=>{var t=d(Mi),n=t.firstChild,[l,a]=c(n.nextSibling),i=l.nextSibling,[o,u]=c(i.nextSibling);return s(t,r(W,{get kind(){return e.chosenDay==="SATURDAY"?"success":"gray"},label:"Samstag",onClick:()=>e.changeDay("SATURDAY")}),l,a),s(t,r(W,{get kind(){return e.chosenDay==="SUNDAY"?"success":"gray"},label:"Sonntag",onClick:()=>e.changeDay("SUNDAY")}),o,u),t})()]}function Ct(e){return[d(Pi),(()=>{var t=d(cn);return s(t,r(K,{get each(){return e.startTimes},children:n=>r(W,{get kind(){return e.chosenStart===n?"success":"gray"},get label(){return(()=>{var l=d(gn),a=l.firstChild,[i,o]=c(a.nextSibling);return i.nextSibling,s(l,n,i,o),l})()},onClick:()=>e.changeStart(n)})})),t})()]}function Zt(e){return[d(Ii),(()=>{var t=d(cn);return s(t,r(K,{get each(){return e.endTimes},children:n=>r(W,{get kind(){return e.chosenEnd===n?"success":"gray"},get label(){return(()=>{var l=d(gn),a=l.firstChild,[i,o]=c(a.nextSibling);return i.nextSibling,s(l,n,i,o),l})()},onClick:()=>e.changeEnd(n)})})),t})()]}function Bi(e){return e.toSorted((t,n)=>t.day!==n.day?t.day==="SATURDAY"?-1:1:t.from-n.from)}ot(["click"]);const zi={version:1,init:{name:"",email:"",mobile:""},lastSaved:new Date().toISOString(),playing:{wantsUpdates:!0,reservations:[]},master:{games:[],wantsHelp:!1},helping:{},publishState:"draft"};async function ji(e){const t=new URL(Fe("/rst25/load"));t.searchParams.append("secret",e);const n=await fetch(t);if(!n.ok)return{kind:"FAILURE"};const l=await n.json();return typeof l=="object"&&l!==null?{kind:"SUCCESS",data:Object.assign(zi,l)}:(console.error("`last_save` not found on ",l),{kind:"FAILURE"})}async function Wi(e,t){try{const n=await fetch(Fe("/rst25/save"),{method:"post",body:JSON.stringify({secret:t,save:e}),headers:{"Content-Type":"application/json"}});return n.ok?{kind:"SUCCESS",data:t}:(console.error(await n.text()),{kind:"FAILURE"})}catch(n){return console.error(n),{kind:"FAILURE"}}}async function Ki(){try{const e=await fetch(Fe("/rst25/program"),{headers:{"Content-Type":"application/json"}});return e.ok?{kind:"SUCCESS",data:await e.json()}:(console.error(await e.text()),{kind:"FAILURE"})}catch(e){return console.error(e),{kind:"FAILURE"}}}async function Zi(e){try{const t=new URL(Fe("/rst25/reservations"));t.searchParams.append("secret",e);const n=await fetch(t);return n.ok?{kind:"SUCCESS",data:await n.json()}:(console.error(await n.text()),{kind:"FAILURE"})}catch(t){return console.error(t),{kind:"FAILURE"}}}async function qi(e){try{const t=await fetch(Fe("/rst25/publishGameround"),{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});return t.ok?{kind:"SUCCESS",data:e.gameroundUuid}:(console.error(await t.text()),{kind:"FAILURE"})}catch(t){return console.error(t),{kind:"FAILURE"}}}async function Ji(e){try{const t=await fetch(Fe("/rst25/sendGameroundUpdate"),{method:"post",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});return t.ok?{kind:"SUCCESS",data:e.gameroundUuid}:(console.error(await t.text()),{kind:"FAILURE"})}catch(t){return console.error(t),{kind:"FAILURE"}}}function Vi(e){return async()=>{await qi(e)}}function Qi(e){return async()=>{await Ji(e)}}var Ve=g("<br>"),Xi=g("<div class=content><p>MÃ¶chtest du diese Spielrunde gerne verÃ¶ffentlichen?</p><!$><!/>"),el=g("<em>Informationen zu den Anmeldungen mÃ¼ssen geladen werden..."),tl=g("<em>Du kannst kein Update versenden, da sich noch niemand fÃ¼r diese Spielrunde angemeldet hat."),nl=g("<p>An: <!$><!/>"),rl=g("<em>Du kannst die Spielrunde nur lÃ¶schen, wenn du zuerst alle Zeitslots entfernt hast."),il=g("<div class=content><p>Bist du sicher, dass du die Spielrunde lÃ¶schen mÃ¶chtest?</p><!$><!/>"),ll=g('<form novalidate><!$><!/><!$><!/><!$><!/><div style="display:grid;grid-template-columns:repeat(2, 1fr);gap:1rem;"><!$><!/><!$><!/></div><!$><!/><!$><!/><!$><!/><fieldset><legend>Kategorien (optional)</legend><!$><!/></fieldset><!$><!/><div style=display:flex;flex-wrap:wrap;gap:1rem;justify-content:space-between;><!$><!/><div style=display:flex;flex-wrap:wrap;gap:1rem;><!$><!/><!$><!/><!$><!/>'),al=g("<h4>Spielrunde inkomplett"),sl=g("<p>Du hast noch einen oder mehre Fehler/fehlende Informationen in dieser Spielrunde:"),ol=g("<li>Â«TitelÂ» ist ein Pflichtfeld."),dl=g("<li>Â«kurz BeschreibungÂ» ist ein Pflichtfeld."),ul=g("<li>Â«kurz BeschreibungÂ» ist zu lang."),cl=g("<li>Â«lange BeschreibungÂ» ist zu lang."),gl=g("<li>Mindest einen Zeitslot muss ausgewÃ¤hlt werden."),ml=g("<ul><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),hl=g("<p><strong>ErklÃ¤rung:</strong> Hast du eine wichtige Ãnderung an dieser Spielrunde durchgefÃ¼hrt, wÃ¤hrend bereits Spielende angemeldet waren? Lass hiermit die Angemeldeten wissen, was du geÃ¤ndert hast. Wichtige Ãnderungen kÃ¶nnen sein: System geÃ¤ndert, Kategorien geÃ¤ndert. FÃ¼r kleine Ãnderungen, wie z.B. Rechtschreibfehler, sollte dies nicht genutzt werden."),$l=g("<p><em>Halte dich kurz und am besten Stichwortartig."),Sl=g("<form><!$><!/><!$><!/>"),_l=g("<div style=display:grid;gap:0.5rem;margin-block-end:1rem;>");function bl(e){const t=e.allRounds.find(n=>n.uuid===e.uuid);return r(E,{get fallback(){return e.fallback},when:t,children:n=>e.children(n())})}function fl(e){const[t,n]=D(e.store),[l,a]=D({delete:ke(),publish:ke(),sendUpdate:ke()});function i(u){u.preventDefault(),a("publish","open",!0)}function o(){e.changePage({kind:"GAMEMASTER"})}return[r(ln,{kind:"special",get children(){return["Status: ",O(()=>x.publishingSteps[t.kind])]}}),d(Ve),d(Ve),r(xl,{store:t,get registrations(){return e.registrations},onSubmit:i,onCancel:()=>a("delete","open",!0),onSendUpdate:()=>a("sendUpdate","open",!0),goBack:o,get isEditable(){return e.isEditable}}),r(vl,{get store(){return l.publish},get title(){return t.title.value},onPublish:()=>{n("kind","published"),a("publish","open",!1),e.queue.enqueue(Vi({secret:e.secret,gameroundUuid:t.uuid}))}}),r(yl,{get store(){return l.sendUpdate},get players(){return Cl(e.registrations,t.slots.map(u=>u.uuid))},onSend:u=>{e.queue.enqueue(Qi({update:u,slotUuids:t.slots.map(h=>h.uuid),gameroundUuid:t.uuid}))}}),r(kl,{get store(){return l.delete},get hasSlots(){return t.slots.length!==0},get title(){return t.title.value},onDelete:()=>{n("kind","archived"),e.changePage({kind:"GAMEMASTER"})}})]}function vl(e){return r(pe,{get store(){return e.store},title:"Spielrunde verÃ¶ffentlichen",onClose:()=>{},get children(){var t=d(Xi),n=t.firstChild,l=n.nextSibling,[a,i]=c(l.nextSibling);return s(t,r(B,{kind:"success",icon:"circle-plus",get label(){return`Ja, bitte "${e.title||"["+x.missingTitle+"]"}" verÃ¶ffentlichen.`},get onClick(){return e.onPublish}}),a,i),t}})}function yl(e){return r(pe,{get store(){return e.store},title:"Update senden",onClose:()=>{},size:"medium",get children(){return()=>e.players.kind==="LOADING"?d(el):e.players.kind==="ERROR"?O(()=>x.error.general):e.players.data.length===0?d(tl):[(()=>{var t=d(nl),n=t.firstChild,l=n.nextSibling,[a,i]=c(l.nextSibling);return s(t,()=>e.players.data.map(o=>o.name).join(", "),a,i),t})(),d(Ve),r(pl,{get onSend(){return e.onSend}})]}})}function kl(e){return r(pe,{get store(){return e.store},title:"Spielrunde lÃ¶schen",onClose:()=>{},get children(){return[r(E,{get when(){return e.hasSlots},get children(){return d(rl)}}),r(E,{get when(){return!e.hasSlots},get children(){var t=d(il),n=t.firstChild,l=n.nextSibling,[a,i]=c(l.nextSibling);return s(t,r(B,{kind:"danger",icon:"trash",get label(){return`Ja, bitte "${e.title||"["+x.missingTitle+"]"}" lÃ¶schen.`},get onClick(){return e.onDelete}}),a,i),t}})]}})}function xl(e){const[t]=D(e.store),n=st(()=>Sr(t));return(()=>{var l=d(ll),a=l.firstChild,[i,o]=c(a.nextSibling),u=i.nextSibling,[h,m]=c(u.nextSibling),_=h.nextSibling,[S,$]=c(_.nextSibling),b=S.nextSibling,y=b.firstChild,[k,p]=c(y.nextSibling),w=k.nextSibling,[N,M]=c(w.nextSibling),I=b.nextSibling,[z,L]=c(I.nextSibling),P=z.nextSibling,[X,te]=c(P.nextSibling),Z=X.nextSibling,[F,ee]=c(Z.nextSibling),j=F.nextSibling,le=j.firstChild,ae=le.nextSibling,[G,ne]=c(ae.nextSibling),q=j.nextSibling,[J,me]=c(q.nextSibling),T=J.nextSibling,oe=T.firstChild,[de,ue]=c(oe.nextSibling),V=de.nextSibling,Se=V.firstChild,[fe,Ee]=c(Se.nextSibling),ve=fe.nextSibling,[_e,he]=c(ve.nextSibling),Ce=_e.nextSibling,[we,R]=c(Ce.nextSibling);return s(l,r(E,{get when(){return t.kind==="published"},get children(){return r(qt,{get errors(){return n()}})}}),i,o),s(l,r(Ze,{get store(){return t.title},label:"Titel",name:"title",get showErrors(){return t.kind==="published"?"ALWAYS":"ON_BLUR"},get errors(){return n().titleMissing?[x.mandatoryField]:[]},get disabled(){return!e.isEditable}}),h,m),s(l,r(Ze,{get store(){return t.system},label:"System (optional)",name:"System",get disabled(){return!e.isEditable}}),S,$),s(b,r(Pt,{get store(){return t.playerCount.min},label:"Anzahl Mitspielende (Minimum)",name:"playerCountMin",min:1,get max(){return t.playerCount.max.value},get disabled(){return!e.isEditable}}),k,p),s(b,r(Pt,{get store(){return t.playerCount.max},label:"Anzahl Mitspielende (Maximum)",name:"playerCountMax",get min(){return t.playerCount.min.value},get disabled(){return!e.isEditable}}),N,M),s(l,r(At,{get store(){return t.description.short},label:"kurze Beschreibung",name:"descriptionShort",size:"small",get showErrors(){return t.kind==="published"?"ALWAYS":"ON_BLUR"},get errors(){return O(()=>!!n().descriptionShortMissing)()?[x.mandatoryField]:O(()=>!!n().descriptionShortTooLong)()?[x.charLimitBy.replace("{}",String(mt))]:[]},get disabled(){return!e.isEditable}}),z,L),s(l,r(At,{get store(){return t.description.long},label:"lange Beschreibung (optional)",name:"descriptionLong",get showErrors(){return t.kind==="published"?"ALWAYS":"ON_BLUR"},get errors(){return O(()=>!!n().descriptionLongTooLong)()?[x.charLimitBy.replace("{}",String(dn))]:[]},get disabled(){return!e.isEditable}}),X,te),s(l,r(Li,{get store(){return e.store.slots},get registrations(){return e.registrations},get slotMissing(){return n().slotMissing},get isEditable(){return e.isEditable}}),F,ee),s(j,r(El,{get store(){return t.tagNames},get isEditable(){return e.isEditable}}),G,ne),s(l,r(qt,{get errors(){return n()}}),J,me),s(T,r(B,{icon:"backward",label:"ZurÃ¼ck zu deinen Spielrunden",get onClick(){return e.goBack}}),de,ue),s(V,r(E,{get when(){return t.kind!=="archived"},get children(){return r(B,{icon:"trash",kind:"danger",label:"LÃ¶schen",onClick:()=>e.onCancel(),get disabled(){return!e.isEditable}})}}),fe,Ee),s(V,r(E,{get when(){return t.kind==="draft"},get children(){return r(B,{icon:"circle-plus",get kind(){return n().hasErrors?"gray":"success"},get disabled(){return n().hasErrors||!e.isEditable},label:"Spielrunde verÃ¶ffentlichen",get onClick(){return n().hasErrors?void 0:e.onSubmit}})}}),_e,he),s(V,r(E,{get when(){return t.kind==="published"},get children(){return r(B,{icon:"circle-plus",kind:"success",label:"Update an Spielende schicken",get onClick(){return e.onSendUpdate},get disabled(){return!e.isEditable}})}}),we,R),l})()}function qt(e){return r(E,{get when(){return e.errors.hasErrors},get children(){return r(C,{type:"danger",get children(){return[d(al),d(sl),(()=>{var t=d(ml),n=t.firstChild,[l,a]=c(n.nextSibling),i=l.nextSibling,[o,u]=c(i.nextSibling),h=o.nextSibling,[m,_]=c(h.nextSibling),S=m.nextSibling,[$,b]=c(S.nextSibling),y=$.nextSibling,[k,p]=c(y.nextSibling);return s(t,r(E,{get when(){return e.errors.titleMissing},get children(){return d(ol)}}),l,a),s(t,r(E,{get when(){return e.errors.descriptionShortMissing},get children(){return d(dl)}}),o,u),s(t,r(E,{get when(){return e.errors.descriptionShortTooLong},get children(){return d(ul)}}),m,_),s(t,r(E,{get when(){return e.errors.descriptionLongTooLong},get children(){return d(cl)}}),$,b),s(t,r(E,{get when(){return e.errors.slotMissing},get children(){return d(gl)}}),k,p),t})()]}})}})}function pl(e){const[t,n]=D({updateText:{value:"",isDirty:!1},hasBeenSent:!1}),l=st(()=>_r(t));return r($e,{get fallback(){return r(C,{type:"success",children:"Nachricht wurde registriert und wird in den nÃ¤chsten 24 Stunden an die Spielenden verschickt."})},get children(){return r(A,{get when(){return!t.hasBeenSent},get children(){return[d(hl),d(Ve),d($l),d(Ve),(()=>{var a=d(Sl),i=a.firstChild,[o,u]=c(i.nextSibling),h=o.nextSibling,[m,_]=c(h.nextSibling);return at(a,"novalidate",!0),s(a,r(At,{get store(){return t.updateText},label:"Zusammenfassung der Ãnderung",name:"updateText",size:"small",showErrors:"ALWAYS",get errors(){return O(()=>!!l().missing)()?[x.mandatoryField]:O(()=>!!l().tooLong)()?[x.charLimitBy.replace("{}",String(un))]:[]}}),o,u),s(a,r(B,{icon:"paper-plane",label:"Spielende informieren",get kind(){return l().hasErrors?"gray":"success"},get disabled(){return l().hasErrors},get onClick(){return l().hasErrors?void 0:()=>{e.onSend(t.updateText.value),n("hasBeenSent",!0)}}}),m,_),a})()]}})}})}function El(e){const[t,n]=D(e.store);return[(()=>{var l=d(_l);return s(l,r(K,{each:Ge,children:a=>r(Tt,{get label(){return a.label},get description(){return a.description},get checked(){return t.includes(a.name)},get name(){return a.name},get value(){return a.name},onValueUpdate:i=>{n(i?t.concat([a.name]):t.filter(o=>o!==a.name))},get disabled(){return!e.isEditable}})})),l})(),r(C,{get children(){return x.tagIdeas}})]}const Cl=(e,t)=>{if(e.loading)return{kind:"LOADING"};if(e.error)return{kind:"ERROR"};const n=e();return n===void 0||n.kind==="FAILURE"?{kind:"ERROR"}:{kind:"SUCCESS",data:n.data.filter(l=>t.includes(l.uuid))}},wl=nn("kind",[v({kind:U("CHOOSE"),uuid:ze()}),v({kind:U("PLAYER"),uuid:ze()}),v({kind:U("GAME"),uuid:f().uuid()}),v({kind:U("GAMEMASTER"),uuid:ze()}),v({kind:U("HELPING"),uuid:ze()}),v({kind:U("SUMMARY"),uuid:ze()}),v({kind:U("EDIT_GAMEROUND"),uuid:f().uuid()})]);nn("kind",[v({kind:U("CHOOSE")}),v({kind:U("PLAYER")}),v({kind:U("GAME"),uuid:f().uuid()}),v({kind:U("GAMEMASTER")}),v({kind:U("HELPING")}),v({kind:U("SUMMARY")}),v({kind:U("EDIT_GAMEROUND"),uuid:f().uuid()})]);const Al=ct(["SAVING","IDLE","ERROR"]),Rl=v({saveState:Al,page:wl,secret:f(),showCreateMessage:Le(),isDebugging:Le()});function mn(e){const t=e.searchParams.get("page")??"",n=e.searchParams.get("uuid")??null,l=e.searchParams.get("secret")??"",a=e.searchParams.get("showCreateMessage")==="true",i=e.searchParams.get("debug")==="true",o=Rl.safeParse({saveState:"IDLE",page:{kind:t.toUpperCase(),uuid:n},secret:l,showCreateMessage:a,isDebugging:i});return o.success?o.data:{saveState:"IDLE",page:{kind:"CHOOSE",uuid:null},secret:l,showCreateMessage:a,isDebugging:i}}function Dl(e,t){return e.kind!==t.kind?!1:e.kind==="EDIT_GAMEROUND"&&t.kind==="EDIT_GAMEROUND"||e.kind==="GAME"&&t.kind==="GAME"?e.uuid===t.uuid:!0}const Tl="2024-08-15T07:45:21.335Z",be={game:"37831e19-29d6-40bd-b99d-fb91b78aa7f9",slot:"bfcbd156-b703-4664-9944-8936aede8476",slot2:"f58e7242-e1ff-4cfc-a992-ca18dd5207c3",program:"16f387ab-0adf-406b-ba5c-2e4eb200fda8",program2:"11b6b38a-a4d3-40ed-9d4a-d2abcab661a5",program3:"5294bc63-4857-404e-b72d-53ecbd87a27b",program4:"6e9477f1-6dd5-4cd7-b3c3-03085022d967"};function Ul(e,t){const n=localStorage.getItem(e);return n===null?t:n}function Ol(e,t){localStorage.setItem(e,t)}const hn="SAVE",Nl={version:1,init:{name:"John Doe",email:"john@doe.ch",mobile:"+41 66 123 45 67"},lastSaved:Tl,playing:{wantsUpdates:!1,reservations:[]},master:{games:[{uuid:be.game,kind:"published",title:"Grolle in der Dunkelheit",system:"Warhammer Fantasy Rollenspiel",description:{short:"Ein kurzes Abenteuer bei dem es um Fantasy, Action und einfaches Rollenspiel geht.",long:"Eine kleine Gruppe wagt sich in die dunklen SchÃ¤chten einer Mine und weiter hinab, um einen mÃ¤chtigen Gegenstand wieder zu erlangen. Wie werden die GefÃ¤hrten auf die Gefahren des Untergrundes reagieren und welche Gefahren lauern in der Finsternis?"},slots:[{uuid:be.slot,day:"SATURDAY",from:10,to:12},{uuid:be.slot2,day:"SUNDAY",from:14,to:17}],playerCount:{min:1,max:3},tagNames:["deutsch"]}],wantsHelp:!1},helping:{},publishState:"published"};async function Ml(){return new Promise(e=>setTimeout(()=>e({kind:"SUCCESS",data:JSON.parse(Ul(hn,JSON.stringify(Nl)))}),1e3))}async function Pl(e,t){return new Promise(n=>setTimeout(()=>(Ol(hn,JSON.stringify(e)),n({kind:"SUCCESS",data:t})),1e3))}const Il=[{uuid:be.program,gamemaster:"Game Master",title:"Grolle in der Dunkelheit",system:"Warhammer Fantasy Rollenspiel",description:{short:"Ein kurzes Abenteuer bei dem es um Fantasy, Action und einfaches Rollenspiel geht.",long:"Eine kleine Gruppe wagt sich in die dunklen SchÃ¤chten einer Mine und weiter hinab, um einen mÃ¤chtigen Gegenstand wieder zu erlangen. Wie werden die GefÃ¤hrten auf die Gefahren des Untergrundes reagieren und welche Gefahren lauern in der Finsternis?"},slot:{day:"SATURDAY",from:10,to:13},playerCount:{min:1,max:3,reserved:0},tags:["ab12jahren"]},{uuid:be.program2,gamemaster:"Other Game Master",title:"Acrimony",system:"D&D",description:{short:"Ein Lo-Fi Space Western Abenteuer",long:'Ein Lo-Fi Space Western Abenteuer: "Eine frisch formierte Gruppe von KopfgeldjÃ¤gern wird mit einer riskanten Mission betraut: Sie mÃ¼ssen den berÃ¼chtigten Outlaw Jeb "Rusty" Rourke in der abgeschiedenen Grenzstadt aufspÃ¼ren. Bei dieser unbarmherzigen Jagd lernen die Spieler die harte RealitÃ¤t der Kopfgeldjagd kennen, wo jeder Schuss und jede Entscheidung Ã¼ber ihr Schicksal entscheidet.'},slot:{day:"SATURDAY",from:10,to:13},playerCount:{min:2,max:8,reserved:3},tags:["ab12jahren","horror"]},{uuid:be.program3,gamemaster:"Other Game Master",title:"Acrimony",system:"D&D",description:{short:"Ein Lo-Fi Space Western Abenteuer",long:'Ein Lo-Fi Space Western Abenteuer: "Eine frisch formierte Gruppe von KopfgeldjÃ¤gern wird mit einer riskanten Mission betraut: Sie mÃ¼ssen den berÃ¼chtigten Outlaw Jeb "Rusty" Rourke in der abgeschiedenen Grenzstadt aufspÃ¼ren. Bei dieser unbarmherzigen Jagd lernen die Spieler die harte RealitÃ¤t der Kopfgeldjagd kennen, wo jeder Schuss und jede Entscheidung Ã¼ber ihr Schicksal entscheidet.'},slot:{day:"SATURDAY",from:14,to:18},playerCount:{min:2,max:8,reserved:3},tags:["ab12jahren","horror"]},{uuid:be.program4,gamemaster:"Some Other Game Master",title:"Solo RPGs",system:"",description:{short:"Wir spielen primÃ¤r das Solo Rollenspiel NoteQuest, werden aber kurz auch noch ein paar andere Solo Rollenspiele miteinander anschauen.",long:""},slot:{day:"SATURDAY",from:14,to:18},playerCount:{min:2,max:4,reserved:3},tags:[]}];async function Ll(){return new Promise(e=>setTimeout(()=>e({kind:"SUCCESS",data:Il}),5e3))}const Fl=[{uuid:be.slot,name:"Alice"},{uuid:be.slot,name:"Bob"}];async function Gl(e){return new Promise(t=>setTimeout(()=>t({kind:"SUCCESS",data:Fl.filter(n=>e.includes(n.uuid))}),5e3))}var Hl=g("<div aria-atomic=true><!$><!/><!$><!/>"),Yl=g("<div class=toast-container aria-live=polite aria-atomic=true>");const[xe,Qe]=D([]);function Bl(e){const t=()=>{const n=["toast"];return e.options.kind!==void 0&&n.push(`toast-${e.options.kind}`),n.join(" ")};return(()=>{var n=d(Hl),l=n.firstChild,[a,i]=c(l.nextSibling),o=a.nextSibling,[u,h]=c(o.nextSibling);return s(n,()=>e.options.message,a,i),s(n,r(E,{get when(){return e.options.dismissable},get children(){return r(W,{kind:"ghost",get label(){return r(re,{icon:"xmark",classes:["toast-dismiss"]})},get onClick(){return e.dismiss}})}}),u,h),ge(m=>{var _=t(),S=e.options.kind==="danger"?"alert":"status",$=e.options.kind==="danger"?"assertive":"polite";return _!==m.e&&Ue(n,m.e=_),S!==m.t&&lt(n,"role",m.t=S),$!==m.a&&lt(n,"aria-live",m.a=$),m},{e:void 0,t:void 0,a:void 0}),n})()}function zl(){function e(t){xe.find(n=>n.uuid===t)?.cleanup(),Qe(xe.filter(n=>n.uuid!==t))}return(()=>{var t=d(Yl);return s(t,r(K,{each:xe,children:n=>r(Bl,{options:n,dismiss:()=>e(n.uuid)})})),t})()}function $n(e,t){if(t?.uuid!==void 0&&xe.find(u=>u.uuid===t.uuid)!==void 0)return Rt(t.uuid,e,t);const n=t?.uuid??crypto.randomUUID(),l=t?.duration??5e3,a=t?.kind??"gray",i=t?.dismissable??!0,o=setTimeout(()=>{Qe(xe.filter(u=>u.uuid!==n))},l);return Qe(xe.length,{uuid:n,kind:a,message:e,duration:l,dismissable:i,cleanup:()=>clearTimeout(o)}),n}function Rt(e,t,n){const l=xe.find(h=>h.uuid===e);if(l===void 0)return e;l.cleanup();const a=n.duration??l.duration,i=n.kind??l.kind,o=n?.dismissable??l.dismissable,u=setTimeout(()=>{Qe(xe.filter(h=>h.uuid!==e))},a);return Qe(h=>h.uuid===e,{uuid:e,kind:i,message:t,duration:a,dismissable:o,cleanup:()=>clearTimeout(u)}),e}const jl=v({name:f(),email:f(),mobile:f()}),Wl=v({name:f(),email:f(),mobile:f()}),Kl=Ut([v({kind:U("SELF"),gameRound:f().uuid(),uuid:f().uuid()}),v({kind:U("FRIEND"),gameRound:f().uuid(),name:f(),uuid:f().uuid()})]),Zl=v({wantsUpdates:Le(),reservations:ie(Kl)}),ql=Ut([v({kind:U("SELF"),gameRound:f().uuid(),uuid:f().uuid()}),v({kind:U("FRIEND"),gameRound:f().uuid(),name:f(),uuid:f().uuid()})]);Ut([v({kind:U("SELF"),gameRound:f().uuid()}),v({kind:U("FRIEND"),gameRound:f().uuid(),name:f()})]);const Jl=v({wantsUpdates:Le(),reservations:ie(ql)}),Vl=v({games:ie(gr),wantsHelp:Le()}),Ql=v({games:ie(on),wantsHelp:Le()}),Xl=v({}),ea=v({}),ta=v({version:U(1),init:jl,lastSaved:f(),playing:Zl,master:Vl,helping:Xl,publishState:gt}),na=v({version:U(1),init:Wl,lastSaved:Pn.date(),playing:Jl,master:Ql,helping:ea,publishState:gt});async function ra(e){const t=e==="demo"?await Ml():await ji(e);if(t.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE"};const n=ta.safeParse(t.data);if(!n.success)return console.error(n.error),{kind:"FAILURE"};const l=ia(n.data);return l.success?{kind:"SUCCESS",data:l.data}:{kind:"FAILURE"}}function ia(e){return na.safeParse(e)}const wt=crypto.randomUUID();async function la(e,t,n){const[l,a]=D(e);a("saveState","SAVING"),$n("Am Speichern...",{uuid:wt,dismissable:!1});const i=new Date;t.lastSaved=i;const o=aa(t);try{if((n==="demo"?await Pl(o,n):await Wi(o,n)).kind==="FAILURE")throw Error("")}catch(u){return a("saveState","ERROR"),console.error(u),Rt(wt,"Speichern war nicht mÃ¶glich!",{kind:"danger",duration:1e4,dismissable:!0}),{kind:"FAILURE"}}return Rt(wt,`Zuletzt gespeichert um: ${Xt(i)} Uhr`,{kind:"success",dismissable:!0}),a("saveState","IDLE"),{kind:"SUCCESS",data:i}}function aa(e){return{...e,lastSaved:String(e.lastSaved),master:{...e.master,games:e.master.games.map($r)}}}const sa=Dn(la,1e3);var oa=g("<div class=tooltip-wrapper><div class=tooltip></div><!$><!/>");function We(e){return(()=>{var t=d(oa),n=t.firstChild,l=n.nextSibling,[a,i]=c(l.nextSibling);return s(n,()=>e.tooltip),s(t,()=>e.children,a,i),t})()}var da=g("<div class=quickmenu-wrapper><div class=quickmenu><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),ua=g('<div class="quickmenu extended"><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>'),ca=g("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center;><!$><!/><em>Zuletzt gespeichert um: <!$><!/> Uhr"),ga=g("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center;><!$><!/><em>Am Speichern..."),ma=g("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center;><!$><!/><em>Speichern war nicht mÃ¶glich!");function ha(e){return(()=>{var t=d(da),n=t.firstChild,l=n.firstChild,[a,i]=c(l.nextSibling),o=a.nextSibling,[u,h]=c(o.nextSibling),m=u.nextSibling,[_,S]=c(m.nextSibling),$=_.nextSibling,[b,y]=c($.nextSibling),k=b.nextSibling,[p,w]=c(k.nextSibling);return s(n,r(We,{tooltip:"Zur Ãbersicht",get children(){return r(W,{get label(){return r(re,{icon:"backward"})},onClick:()=>e.changePage({kind:"CHOOSE"})})}}),a,i),s(n,r(We,{tooltip:"Zu den Spielrunden",get children(){return r(W,{get label(){return r(re,{icon:"dice-d20"})},onClick:()=>e.changePage({kind:"PLAYER"})})}}),u,h),s(n,r(We,{tooltip:"Zu deinen Spielrunden",get children(){return r(W,{get label(){return r(re,{icon:"grid-2-plus"})},onClick:()=>e.changePage({kind:"GAMEMASTER"})})}}),_,S),s(n,r(We,{tooltip:"Zum Helferplan",get children(){return r(W,{get label(){return r(re,{icon:"hand-heart"})},onClick:()=>e.changePage({kind:"HELPING"})})}}),b,y),s(n,r(We,{tooltip:"Zur Zusammenfassung",get children(){return r(W,{get label(){return r(re,{icon:"list"})},onClick:()=>e.changePage({kind:"SUMMARY"})})}}),p,w),t})()}function $a(e){return[r(C,{type:"gray",get children(){var t=d(ua),n=t.firstChild,[l,a]=c(n.nextSibling),i=l.nextSibling,[o,u]=c(i.nextSibling),h=o.nextSibling,[m,_]=c(h.nextSibling),S=m.nextSibling,[$,b]=c(S.nextSibling),y=$.nextSibling,[k,p]=c(y.nextSibling);return s(t,r(B,{icon:"backward",label:"Zur Ãbersicht",onClick:()=>e.changePage({kind:"CHOOSE"})}),l,a),s(t,r(B,{icon:"dice-d20",label:"Zu den Spielrunden",onClick:()=>e.changePage({kind:"PLAYER"})}),o,u),s(t,r(B,{icon:"grid-2-plus",label:"Zu deinen Spielrunden",onClick:()=>e.changePage({kind:"GAMEMASTER"})}),m,_),s(t,r(B,{icon:"hand-heart",label:"Zum Helferplan",onClick:()=>e.changePage({kind:"HELPING"})}),$,b),s(t,r(B,{icon:"list",label:"Zur Zusammenfassung",onClick:()=>e.changePage({kind:"SUMMARY"})}),k,p),t}}),r(Sa,{get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}})]}function Sa(e){return r($e,{get children(){return[r(A,{get when(){return e.saveState==="IDLE"},get children(){var t=d(ca),n=t.firstChild,[l,a]=c(n.nextSibling),i=l.nextSibling,o=i.firstChild,u=o.nextSibling,[h,m]=c(u.nextSibling);return h.nextSibling,s(t,r(re,{icon:"circle-check"}),l,a),s(i,()=>Xt(e.lastSaved),h,m),t}}),r(A,{get when(){return e.saveState==="SAVING"},get children(){var t=d(ga),n=t.firstChild,[l,a]=c(n.nextSibling);return l.nextSibling,s(t,r(re,{icon:"floppy-disk-circle-arrow-right"}),l,a),t}}),r(A,{get when(){return e.saveState==="ERROR"},get children(){var t=d(ma),n=t.firstChild,[l,a]=c(n.nextSibling);return l.nextSibling,s(t,r(re,{icon:"triangle-exclamation"}),l,a),t}})]}})}var _a=g("<div class=page><!$><!/><div class=page-content><h2></h2><br><!$><!/></div><!$><!/>"),ba=g("<div class=extended-wrapper style=margin-block-start:1rem;>");function Pe(e){return(()=>{var t=d(_a),n=t.firstChild,[l,a]=c(n.nextSibling),i=l.nextSibling,o=i.firstChild,u=o.nextSibling,h=u.nextSibling,[m,_]=c(h.nextSibling),S=i.nextSibling,[$,b]=c(S.nextSibling);return s(t,(()=>{var y=O(()=>e.showQuickmenu!==!1);return()=>y()?r(ha,{get changePage(){return e.changePage},get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}}):null})(),l,a),s(o,()=>e.title),s(i,()=>e.children,m,_),s(t,(()=>{var y=O(()=>e.showQuickmenu!==!1);return()=>y()?(()=>{var k=d(ba);return s(k,r($a,{get changePage(){return e.changePage},get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}})),k})():null})(),$,b),t})()}const fa=v({uuid:f().uuid(),name:f()}),Sn=ie(fa),va=Sn;async function ya(e,t){const n=e==="demo"?await Gl(t):await Zi(e);if(n.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE"};const l=Sn.safeParse(n.data);if(!l.success)return{kind:"FAILURE"};const a=ka(l.data);return a.success?{kind:"SUCCESS",data:a.data}:{kind:"FAILURE"}}function ka(e){return va.safeParse(e)}const xa=v({uuid:f().uuid(),title:f(),system:f(),gamemaster:f(),description:v({short:f(),long:f()}),slot:v({day:Nt,from:Q(),to:Q()}),playerCount:v({min:Q(),max:Q(),reserved:Q()}),tags:ie(f())}),pa=ie(xa),Ea=v({uuid:f().uuid(),title:f(),system:f(),gamemaster:f(),description:v({short:f(),long:f()}),slot:v({day:Nt,from:Q(),to:Q()}),playerCount:v({min:Q(),max:Q(),reserved:Q()}),tags:ie(f())}),Ca=ie(Ea);async function wa(e){const t=e==="demo"?await Ll():await Ki();if(t.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE"};const n=pa.safeParse(t.data);if(!n.success)return{kind:"FAILURE"};const l=Aa(n.data);return l.success?{kind:"SUCCESS",data:l.data}:{kind:"FAILURE"}}function Aa(e){return Ca.safeParse(e)}var Jt=g("<br>"),Vt=g("<pre>"),Ra=g("<hr>"),Da=g("<div><code>Reservations (read-only)"),Ta=g("<em>loading...");function Ua(e){const t=new URL(location.href);t.searchParams.set("page",e.page.kind.toLowerCase()),e.page.kind==="EDIT_GAMEROUND"&&t.searchParams.set("uuid",e.page.uuid),t.searchParams.delete("showCreateMessage"),history.replaceState({page:e},"",t);const n=x.pageTitle[e.page.kind];document.title=x.metaTitle.replace("{}",n)}function Oa(e){const[t,n]=D(e.page);return(l,a)=>{if(Dl(l,t))return;const i=a?.backButton??!1,o=a?.disableScroll??!1,u=new URL(location.href);u.searchParams.set("page",l.kind.toLowerCase()),l.kind==="EDIT_GAMEROUND"||l.kind==="GAME"?(u.searchParams.set("uuid",l.uuid),n(l)):(u.searchParams.delete("uuid"),n({...l,uuid:null})),i||history.pushState({page:l},"",u);const h=x.pageTitle[l.kind];document.title=x.metaTitle.replace("{}",h),o||window.scrollTo({top:0})}}function Na(e){Ua(e.meta);const[t,n]=D({meta:e.meta,save:e.save}),l=()=>t.save.master.games.flatMap(S=>S.slots.map($=>$.uuid)),[a]=it(l(),S=>ya(t.meta.secret,S)),[i]=it(()=>wa(t.meta.secret)),o=crypto.randomUUID(),[u,h]=Dt(!1);it(()=>JSON.stringify(t.save),async()=>{if(!u()){h(!0);return}if(t.save.publishState!=="published"){$n("Diese Anmeldung wurde deaktiviert und kann nicht editiert werden.",{kind:"danger",uuid:o});return}const S=Ke(t.save);try{const $=await sa(t.meta,S,t.meta.secret);$.kind==="FAILURE"?console.error($):n("save","lastSaved",$.data)}catch($){console.error($),n("meta","saveState","ERROR")}});const m=Oa(t.meta),_=Tn();return tn(()=>{window.addEventListener("popstate",S=>{if(typeof S=="object"&&S!==null&&"state"in S){const $=new URL(location.href),b=mn($);m(b.page,{backButton:!0})}}),setInterval(async()=>{const S=_.dequeue();S.kind==="NEXT_ELEMENT"&&await S.data()},1e3)}),[r(E,{get when(){return t.meta.showCreateMessage},get children(){return[r(C,{type:"success",get children(){return x.registrationStarted}}),d(Jt)]}}),r(E,{get when(){return t.save.publishState!=="published"},get children(){return[r(C,{type:"danger",children:"Diese Anmeldung wurde deaktiviert. Sollte dies ein Fehler sein, kontaktiere uns bitte."}),d(Jt)]}}),r($e,{get fallback(){return r(Pe,{title:"Wo mÃ¶chtest du starten?",showQuickmenu:!1,changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(fi,{changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get isDebugging(){return t.meta.isDebugging}})}})},get children(){return[r(A,{get when(){return t.meta.page.kind==="PLAYER"||t.meta.page.kind==="GAME"},get children(){return r(Pe,{title:"SpielrundenÃ¼bersicht",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(si,{get store(){return t.save.playing},program:i,get uuid(){return t.meta.page.kind==="GAME"?t.meta.page.uuid:null},get isEditable(){return t.save.publishState==="published"},changePage:m,get isDebugging(){return t.meta.isDebugging}})}})}}),r(A,{get when(){return t.meta.page.kind==="GAMEMASTER"},get children(){return r(Pe,{title:"Meine Spielrunden",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(xr,{get store(){return t.save.master},get isEditable(){return t.save.publishState==="published"},changePage:m})}})}}),r(A,{get when(){return t.meta.page.kind==="EDIT_GAMEROUND"},get children(){return r(Pe,{title:"Spielrunde editieren",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(bl,{get allRounds(){return t.save.master.games},get uuid(){return t.meta.page.kind==="EDIT_GAMEROUND"?t.meta.page.uuid:"should never happen"},get fallback(){return r(C,{type:"danger",get children(){return x.error.gameroundUuidError}})},children:S=>r(fl,{store:S,registrations:a,queue:_,get isEditable(){return t.save.publishState==="published"},changePage:m,get secret(){return t.meta.secret}})})}})}}),r(A,{get when(){return t.meta.page.kind==="HELPING"},get children(){return r(Pe,{title:"Helfen",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(dr,{})}})}}),r(A,{get when(){return t.meta.page.kind==="SUMMARY"},get children(){return r(Pe,{title:"Zusammenfassung",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(rr,{get store(){return t.save},program:i,get isEditable(){return t.save.publishState==="published"},changePage:m})}})}})]}}),r(E,{get when(){return t.meta.isDebugging},get children(){return[(()=>{var S=d(Vt);return s(S,()=>JSON.stringify(t,null,2)),S})(),d(Ra),d(Da),r(ut,{get fallback(){return d(Ta)},get children(){return r(E,{get when(){return a()},children:S=>(()=>{var $=d(Vt);return s($,()=>JSON.stringify(S(),null,2)),$})()})}})]}}),r(zl,{})]}function _n(){return r(C,{get children(){return x.loading.registration}})}function Ya(){const[e,t]=Dt(null);return tn(()=>{const n=new URL(location.href);t(mn(n))}),r(E,{get fallback(){return r(_n,{})},get when(){return e()},children:n=>r(Ma,{get page(){return n()}})})}function Ma(e){const[t]=it(()=>ra(e.page.secret));return r(Nn,{fallback:n=>(console.error(n),r(C,{type:"danger",get children(){return x.error.general}})),get children(){return r(ut,{get fallback(){return r(_n,{})},get children(){return r($e,{get children(){return r(A,{get when(){return t()},children:n=>{const{kind:l,value:a}=Un(n());return l==="SECRET_INVALID"?r(C,{type:"danger",get children(){return x.error.secretError}}):l==="FAILURE"?(console.error(a),r(C,{type:"danger",get children(){return x.error.ourMistake}})):r(Na,{get meta(){return e.page},get save(){return a.data}})}})}})}})}})}export{Ya as MeineAnmeldungWrapper};
