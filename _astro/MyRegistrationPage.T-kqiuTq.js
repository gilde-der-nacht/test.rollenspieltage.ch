import{c as et,I as xn,B as R,d as pn,f as te,g as St,h as z,b as ne,s as En,i as Kt,S as Dt,j as _t,k as Cn,e as Ct,l as Rn,m as qt,n as wn,u as An}from"./utils.Cqf3U9su.js";import{b as Vt,g as u,t as c,a as d,u as Tn,i as s,c as r,S as E,d as me,e as Ae,F as W,M as A,f as $e,s as bt,h as tt,j as rt,k as it,m as O,r as lt,l as Rt,n as nt,o as at,p as Qe,q as Jt,E as Dn}from"./web.BCh8zNxO.js";/* empty css                                 */import{c as U,u as Un}from"./store.BK-5lGMP.js";import{T as On}from"./Textarea.CUTSClbg.js";import{s as f,n as V,e as st,T as x,o as v,a as re,C as Qt,d as Xt,b as Ge,l as D,c as Ie,u as wt,f as Nn}from"./texts.CDOmb1zn.js";var Mn=c("<dialog><!$><!/><!$><!/><!$><!/>"),In=c("<h4>");function Re(e=!1){return{open:e}}function Te(e){let t;const[n,i]=U(e.store);Vt(()=>{n.open?t.showModal():t.close()});function l(){i({open:!1}),e.onClose?.()}const a=()=>{const o=[];return e.type!==void 0&&o.push(e.type),e.size!==void 0&&o.push(e.size),e.onClose!==void 0&&o.push("dialog-with-close"),o};return(()=>{var o=u(Mn),g=o.firstChild,[m,h]=d(g.nextSibling),$=m.nextSibling,[S,_]=d($.nextSibling),b=S.nextSibling,[k,y]=d(b.nextSibling);o.addEventListener("close",l);var p=t;return typeof p=="function"?Tn(p,o):t=o,s(o,r(E,{get when(){return e.onClose},get children(){return r(et,{onClick:l,icon:"circle-xmark",kind:"gray"})}}),m,h),s(o,r(E,{get when(){return e.title},children:C=>(()=>{var N=u(In);return s(N,C),N})()}),S,_),s(o,()=>e.children,k,y),me(()=>Ae(o,a().join(" "))),o})()}var At=c("<p>");function Ye(e){const[t,n]=U(e.store),i=e.showErrors==="ALWAYS",l=()=>i||t.isDirty?e.errors??[]:[];return[r(xn,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:a=>n("value",a),onBlur:()=>n("isDirty",!0),get type(){return e.type},get required(){return e.required},get isHoneypot(){return e.isHoneypot}}),r(E,{get when(){return l().length>0},get children(){return r(R,{type:"danger",get children(){return r(W,{get each(){return l()},children:a=>(()=>{var o=u(At);return s(o,a),o})()})}})}})]}function Ut(e){const[t,n]=U(e.store),i=e.showErrors==="ALWAYS",l=()=>i||t.isDirty?e.errors??[]:[];return[r(pn,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:a=>n("value",a),onBlur:()=>n("isDirty",!0),get required(){return e.required},get isHoneypot(){return e.isHoneypot},get min(){return e.min},get max(){return e.max}}),r(E,{get when(){return l().length>0},get children(){return r(R,{type:"danger",get children(){return r(W,{get each(){return l()},children:a=>(()=>{var o=u(At);return s(o,a),o})()})}})}})]}function pt(e){const[t,n]=U(e.store),i=e.showErrors==="ALWAYS",l=()=>i||t.isDirty?e.errors??[]:[];return[r(On,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:a=>n("value",a),onBlur:()=>n("isDirty",!0),get required(){return e.required},get size(){return e.size}}),r(E,{get when(){return l().length>0},get children(){return r(R,{type:"danger",get children(){return r(W,{get each(){return l()},children:a=>(()=>{var o=u(At);return s(o,a),o})()})}})}})]}const qe=f().transform(e=>({value:e,isDirty:!1}));function ft(e){return{value:e,isDirty:!1}}const Ot=V().transform(e=>({value:e,isDirty:!1})),we={SATURDAY:{open:{from:10,to:24},breaks:[{from:13,to:14},{from:18,to:19}]},SUNDAY:{open:{from:10,to:18},breaks:[{from:13,to:14}]}};st(["SATURDAY","SUNDAY"]);function Ve(e,t){const{from:n,to:i}=t;return n<e&&e<i}function Pn(e,t){const{from:n,to:i}=e,{from:l,to:a}=t;return Ve(n,t)||Ve(i,t)||Ve(l,e)||Ve(a,e)||n===l&&i===a}function ze(e,t=!1){const{from:n,to:i}=e;if(n>i)return[];const l=i-n;return en(t?l+1:l,n)}function en(e,t=0){return[...Array(e)].map((n,i)=>i+t)}var Ln=c("<div class=dynamic-columns style=gap:1rem;--min-width:30rem;><!$><!/><!$><!/>"),Fn=c("<div><h4 style=margin-block-end:1.5rem;></h4><!$><!/>"),Gn=c("<p>Konflikte gefunden! Bitte stelle sicher, dass du nicht zeitlich Ã¼berlappende Spielrunden eingetragen hast:"),Hn=c('<div style="display:grid;grid-template-columns:1fr max-content 1fr;gap:1rem;margin-block:0.5rem;"><!$><!/><span style=color:var(--clr-warning-10);align-self:center;font-size:2rem;></span><!$><!/>'),Bn=c("<div class=timetable><!$><!/><div class=entries></div><div class=after-hour><div class=annotation>"),Yn=c("<div><div class=annotation></div><div class=background>"),zn=c("<div class=entry>");function Wn(e){return(()=>{var t=u(Ln),n=t.firstChild,[i,l]=d(n.nextSibling),a=i.nextSibling,[o,g]=d(a.nextSibling);return s(t,r(Nt,{get programEntries(){return e.programEntries.SATURDAY},get openingHours(){return we.SATURDAY},day:"SATURDAY"}),i,l),s(t,r(Nt,{get programEntries(){return e.programEntries.SUNDAY},get openingHours(){return we.SUNDAY},day:"SUNDAY"}),o,g),t})()}function Nt(e){const t=Zn(e.programEntries);return(()=>{var n=u(Fn),i=n.firstChild,l=i.nextSibling,[a,o]=d(l.nextSibling);return s(i,()=>x.days[e.day]),s(n,r($e,{get fallback(){return[r(R,{type:"danger",get children(){return u(Gn)}}),r(W,{each:t,children:([g,m])=>(()=>{var h=u(Hn),$=h.firstChild,[S,_]=d($.nextSibling),b=S.nextSibling,k=b.nextSibling,[y,p]=d(k.nextSibling);return s(h,()=>g.component(),S,_),s(b,r(te,{icon:"triangle-exclamation"})),s(h,()=>m.component(),y,p),h})()})]},get children(){return r(A,{get when(){return t.length===0},get children(){return r(jn,{get programEntries(){return e.programEntries},get openingHours(){return e.openingHours},get day(){return e.day}})}})}}),a,o),n})()}function jn(e){const t=ze(e.openingHours.open),n=e.openingHours.breaks.map(({from:a})=>a),i=(t[0]??0)-1,l=t.at(-1)??0;return(()=>{var a=u(Bn),o=a.firstChild,[g,m]=d(o.nextSibling),h=g.nextSibling,$=h.nextSibling,S=$.firstChild;return s(a,r(W,{each:t,children:_=>{const b=n.includes(_);return(()=>{var k=u(Yn),y=k.firstChild;return Ae(k,`hour ${b?"break":""}`),s(y,_),me(p=>bt(k,Mt({from:_,to:_},i,e.day),p)),k})()}}),g,m),s(h,r(W,{get each(){return e.programEntries},children:_=>(()=>{var b=u(zn);return s(b,()=>_.component()),me(k=>bt(b,Mt(_.range,i,e.day),k)),b})()})),s(S,l+1),me(_=>bt(h,`grid-row: 1 / ${l-i+1};`,_)),a})()}function Mt(e,t,n){const{from:i,to:l}=e,a=i-t,o=l-t,g=we[n].open.to;return St(a>0,`Entry can't start at ${i}.`),St(o>0,`Entry can't end at ${l}.`),St(l<=g,`Entry can't end at ${l}.`),`grid-row: ${a} / ${o};`}function Zn(e){const t=[];return e.forEach((n,i)=>{e.slice(i+1).forEach(l=>{Pn(n.range,l.range)&&t.push([n,l])})}),t}var Kn=c("<span>");function tn(e){const t=()=>{const n=["chip"];return n.push(e.kind??"gray"),e.inverted&&n.push("inverted"),e.size==="small"&&n.push("small"),n.join(" ")};return(()=>{var n=u(Kn);return s(n,()=>e.children),me(i=>{var l=t(),a=e.title;return l!==i.e&&Ae(n,i.e=l),a!==i.t&&tt(n,"title",i.t=a),i},{e:void 0,t:void 0}),n})()}var nn=c("<br>"),qn=c("<div style=display:grid;gap:1rem;><h3>Meine Kontaktdaten</h3><p><strong>Name:</strong> <!$><!/></p><p><strong>E-Mail:</strong> <!$><!/></p><p><strong>Handynummer:</strong> <!$><!/></p><div>"),Vn=c("<form novalidate><!$><!/><!$><!/><!$><!/><!$><!/>"),Jn=c("<h3>Mein Programm"),Qn=c("<div><!$><!/><!$><!/><h5></h5><p class=duration>von <!$><!/> bis <!$><!/> Uhr <em><small>(<!$><!/> <!$><!/>)");function Xn(e){const t=e.store.master.games.flatMap(a=>a.slots.map(o=>({status:a.kind,uuid:a.uuid,title:a.title.value,dateTime:o}))),n=()=>{const a=e.program();return a?.kind==="SUCCESS"?a.data:[]},i=()=>{const a=e.store.playing.reservations.map(o=>o.gameRound);return new Set(a)},l=()=>n().filter(a=>i().has(a.uuid)).map(a=>({uuid:a.uuid,title:a.title,dateTime:a.slot}));return[r(er,{get store(){return e.store.init}}),u(nn),r(nr,{get entries(){return{play:l(),master:t,help:[]}},get changePage(){return e.changePage}})]}function er(e){const[t,n]=U(e.store),[i,l]=U(Re());return r(R,{get children(){return[r(E,{get when(){return i.open},get children(){return r(tr,{dialogStore:i,get currentState(){return e.store},updateCurrentState:n})}}),(()=>{var a=u(qn),o=a.firstChild,g=o.nextSibling,m=g.firstChild,h=m.nextSibling,$=h.nextSibling,[S,_]=d($.nextSibling),b=g.nextSibling,k=b.firstChild,y=k.nextSibling,p=y.nextSibling,[C,N]=d(p.nextSibling),M=b.nextSibling,P=M.firstChild,B=P.nextSibling,L=B.nextSibling,[I,J]=d(L.nextSibling),Q=M.nextSibling;return s(g,()=>e.store.name,S,_),s(b,()=>e.store.email,C,N),s(M,()=>e.store.mobile,I,J),s(Q,r(z,{icon:"pencil",label:"Kontakdaten editieren",onClick:()=>l("open",!0)})),a})()]}})}function tr(e){const[t]=U({name:ft(e.currentState.name),email:ft(e.currentState.email),mobile:ft(e.currentState.mobile)}),n=rt(()=>{const a={name:[],email:[]};return t.name.value.trim().length===0&&a.name.push(x.mandatoryField),t.email.value.trim().length===0?a.email.push(x.mandatoryField):t.email.value.includes("@")||a.email.push(x.invalidEmail),{...a,hasErrors:a.name.length+a.email.length>0}}),[i,l]=U(e.dialogStore);return r(Te,{get store(){return e.dialogStore},title:"Kontaktdaten editieren",onClose:()=>{},size:"medium",get children(){var a=u(Vn),o=a.firstChild,[g,m]=d(o.nextSibling),h=g.nextSibling,[$,S]=d(h.nextSibling),_=$.nextSibling,[b,k]=d(_.nextSibling),y=b.nextSibling,[p,C]=d(y.nextSibling);return s(a,r(Ye,{get store(){return t.name},label:"Name",name:"name",showErrors:"ON_BLUR",get errors(){return n().name}}),g,m),s(a,r(Ye,{get store(){return t.email},label:"E-Mail",name:"email",showErrors:"ON_BLUR",get errors(){return n().email}}),$,S),s(a,r(Ye,{get store(){return t.mobile},label:"Handynummer",name:"mobile"}),b,k),s(a,r(ne,{label:"Speichern",get disabled(){return n().hasErrors},onClick:()=>{n().hasErrors||(e.updateCurrentState({name:t.name.value,email:t.email.value,mobile:t.mobile.value}),l("open",!1))}}),p,C),a}})}function nr(e){const t=rr(e.entries,e.changePage);return[u(Jn),u(nn),r(Wn,{programEntries:t})]}function vt(e){const t=e.range.to-e.range.from,n={"master-draft":{label:"SL",help:"Spielleitung",link:{icon:"pencil",label:"Spielrunde bearbeiten"}},master:{label:"SL",help:"Spielleitung",link:{icon:"pencil",label:"Spielrunde bearbeiten"}},play:{label:"TN",help:"Teilnehmer:in",link:{icon:"link",label:"Zur Spielrunde"}},help:{label:"HL",help:"Helfen",link:{icon:"link",label:""}}}[e.kind],i=()=>{const l=["timeview-entry","box-simple"];return e.kind==="master-draft"&&l.push("gray"),e.kind==="master"&&l.push("special"),e.kind==="play"&&l.push("danger"),l.join(" ")};return(()=>{var l=u(Qn),a=l.firstChild,[o,g]=d(a.nextSibling),m=o.nextSibling,[h,$]=d(m.nextSibling),S=h.nextSibling,_=S.nextSibling,b=_.firstChild,k=b.nextSibling,[y,p]=d(k.nextSibling),C=y.nextSibling,N=C.nextSibling,[M,P]=d(N.nextSibling),B=M.nextSibling,L=B.nextSibling,I=L.firstChild,J=I.firstChild,Q=J.nextSibling,[X,j]=d(Q.nextSibling),ae=X.nextSibling,Y=ae.nextSibling,[ie,le]=d(Y.nextSibling);return ie.nextSibling,s(l,r(tn,{get title(){return n.help},inverted:!0,size:"small",get children(){return n.label}}),o,g),s(l,r(E,{get when(){return e.onClick},children:F=>r(et,{get icon(){return n.link.icon},kind:"ghost",get onClick(){return F()},get title(){return n.link.label}})}),h,$),s(S,()=>e.title),s(_,()=>e.range.from,y,p),s(_,()=>e.range.to,M,P),s(I,t,X,j),s(I,t===1?"Stunde":"Stunden",ie,le),me(F=>{var ee=i(),Z=e.title;return ee!==F.e&&Ae(l,F.e=ee),Z!==F.t&&tt(S,"title",F.t=Z),F},{e:void 0,t:void 0}),l})()}function rr(e,t){const n={SATURDAY:[],SUNDAY:[]};return e.play.forEach(i=>{n[i.dateTime.day].push({range:i.dateTime,component:()=>r(vt,{get title(){return i.title},get range(){return i.dateTime},kind:"play",onClick:()=>t({kind:"GAME",uuid:i.uuid})})})}),e.master.forEach(i=>{if(i.status==="deleted")return;const l=[i.title];i.status==="draft"&&l.unshift("(noch nicht verÃ¶ffentlicht)"),n[i.dateTime.day].push({range:i.dateTime,component:()=>r(vt,{get title(){return l.join(" ")},get range(){return i.dateTime},get kind(){return i.status==="published"?"master":"master-draft"},onClick:()=>t({kind:"EDIT_GAMEROUND",uuid:i.uuid})})})}),e.help.forEach(i=>{n[i.dateTime.day].push({range:i.dateTime,component:()=>r(vt,{get title(){return i.title},get range(){return i.dateTime},kind:"help"})})}),n}var ir=c("<p>Diese Seite ist leider noch nicht bereit. Komm bitte spÃ¤ter nochmal zurÃ¼ck.");function lr(){return r(R,{type:"danger",get children(){return u(ir)}})}var ar=c("<div class=grid><!$><!/><div>"),sr=c("<div class=boxLink>");function Me(e){const t=e.type??"special";return(()=>{var n=u(sr);return s(n,r(R,{type:t,get onClick(){return e.onClick},get children(){var i=u(ar),l=i.firstChild,[a,o]=d(l.nextSibling),g=a.nextSibling;return s(i,r(te,{get icon(){return e.icon}}),a,o),s(g,()=>e.children),i}})),n})()}const Tt=st(["SATURDAY","SUNDAY"]),rn=v({uuid:f().uuid(),day:Tt,from:V(),to:V()}).refine(e=>e.from<e.to,{message:"A TimeSlot can't end before it starts."});v({name:f(),label:f(),description:f()});const ln=st(["draft","published","deleted"]),or=v({uuid:f().uuid(),kind:ln,title:f(),system:f(),description:v({short:f(),long:f()}),slots:re(rn),playerCount:v({min:V().min(1),max:V()}).transform(e=>{const[t,n]=En([e.min,e.max]);return{min:t,max:n}}),tagNames:re(f())}),an=v({uuid:f().uuid(),kind:ln,title:qe,system:qe,description:v({short:qe,long:qe}),slots:re(rn),playerCount:v({min:Ot,max:Ot}),tagNames:re(f())});function ur(){const e={uuid:crypto.randomUUID(),kind:"draft",title:"",system:"",description:{short:"",long:""},slots:[],playerCount:{min:2,max:4},tagNames:["deutsch"]},t=dr(e);if(t.success)return t.data;throw console.error(t),Error("should not happen")}function dr(e){return an.safeParse(e)}function gr(e){return{...e,title:e.title.value,system:e.system.value,description:{short:e.description.short.value,long:e.description.long.value},playerCount:{min:e.playerCount.min.value,max:e.playerCount.max.value}}}const ot=[{name:"ab6jahren",label:"Ab 6 Jahren",description:"Spannungs- und Bedrohungsmomente werden kurz gehalten. In Begleitung oder nach Absprache mit einem Elternteil. Beispiele: My Little Pony, ..."},{name:"ab12jahren",label:"Ab 12 Jahren",description:"Antisoziales und destruktives wird auf ein Minimum begrenzt. Keine Diskriminierung, keine Radikalisierung, SexualitÃ¤t wird nicht explizit dargestellt."},{name:"ab18jahren",label:"Ab 18 Jahren",description:"Keinerlei Richtlinien bezÃ¼glich Inhalt, in der Gruppe sollte aber diskutiert werden, was akzeptabel ist und was nicht. Beispiele: Vampire the Masquerade, ..."},{name:"fantasy",label:"Fantasy",description:"Spielt in einer alternativen Vergangenheit, in welcher Elemente wie: Ritterinnen, Hexenmeister, RÃ¼stungen, Magie, Goblins, Turniere usw. vorkommen kÃ¶nnen. Beispiele: Das Schwarze Auge, Dungeons & Dragons, ..."},{name:"sciencefiction",label:"Science Fiction",description:"Spielt in einer alternativen Zukunft, in welcher Elemente wie: Raumschiffe, Sternenportale, KÃ¼nstliche Intelligenzen, Laserkanonen usw. vorkommen kÃ¶nnen. Beispiele: Shadowrun, Alien, ..."},{name:"postapokalyptisch",label:"Postapokalyptisch",description:"Spielt in einer Welt mitten oder nach einem Kollaps, wo die Mehrheit ums Ãberleben kÃ¤mpft. Beispiele: Mutant Year Zero, Apocalypse World"},{name:"horror",label:"Horror",description:"Eine gruselige AtmosphÃ¤re, psychologischen Druck oder unvorhersehbare Schreckensmomente. Beispiele: Cthulhu, ..."},{name:"offenewelt",label:"Offene Welt",description:"Es gibt nur einen losen Handlungsfaden, die Rollenspiel-Gruppe muss sich ihre Ziele selber festlegen. Beispiele: Ironsworn, Blades in the Dark, ..."},{name:"gemeinsamespielleitung",label:"Gemeinsame Spielleitung",description:"Die Regeln und die Umwelt werden gemeinsam von allen Spielenden umgesetzt. Beispiele: Microscope, The Quiet Year, ..."},{name:"regelleicht",label:"Regelleicht",description:"Die kompletten Regeln haben alle auf einer Seite Platz. Beispiele: Fiasco, Everyone is John, ..."},{name:"deutsch",label:"Deutsch",description:"Bei der Spielrunde reden die Spielenden miteinander Deutsch."},{name:"englisch",label:"Englisch",description:"Bei der Spielrunde reden die Spielenden miteinander Englisch."},{name:"workshop",label:"Workshop",description:"Unter Anleitung, gemeinsam ein Rollenspiel-Thema vertiefen. Kreative Techniken stehen im Vordergrund. Beispiele: Gemeinsam ein Dungeon erschaffen, Gemeinsam ein Hintergrundgeschichte schreiben, ..."}],ut=200,sn=500,on=200;function cr(e){const t=e.title.value.trim().length===0,n=e.description.short.value.trim().length===0,i=e.description.short.value.length>ut,l=e.description.long.value.length>sn,a=e.slots.length===0;return{titleMissing:t,descriptionShortMissing:n,descriptionShortTooLong:i,descriptionLongTooLong:l,slotMissing:a,hasErrors:t||n||i||l||a}}function mr(e){const t=e.updateText.value.trim().length===0,n=e.updateText.value.length>on;return{missing:t,tooLong:n,hasErrors:t||n}}var $r=c("<h3>"),hr=c("<br>"),Sr=c("<div style=margin-top:2rem;><h3 style=margin-bottom:1rem;></h3><ul class=event-list role=list>"),_r=c('<li><h3 class=event-title></h3><div class=event-details><div class=event-tags><strong>Status:</strong><!$><!/></div><div class=event-tags><strong>System:</strong><!$><!/></div><div class=event-tags><strong>Tag, Zeit:</strong><!$><!/></div><div class=event-tags><strong>Spielende:</strong> <!$><!/> - <!$><!/></div> <div class=event-tags><strong>Kategorien:</strong> <!$><!/></div></div><div class="event-description content"><p><strong>Kurzbeschreibung:</strong><br><!$><!/></p></div><ul role=list class=event-links><li><button class=event-link><span>Bearbeiten'),He=c("<em>"),br=c("<span><!$><!/>, <!$><!/> - <!$><!/> Uhr");function fr(e){const[t,n]=U(e.store);function i(){const l=ur();n("games",t.games.length,l),e.changePage({kind:"EDIT_GAMEROUND",uuid:l.uuid})}return[r(Me,{icon:"grid-2-plus",type:"success",onClick:i,get children(){var l=u($r);return s(l,()=>x.createNewGameRound),l}}),u(hr),r(Qt,{label:"Ich habe wenig bis keine Spielleitung-Erfahrung und mÃ¶chte gerne in der Vorbereitung und/oder wÃ¤hrend der Spielrunde unterstÃ¼tzt werden.",get checked(){return t.wantsHelp},name:"wantsHelp",value:"wantsHelp",onValueUpdate:l=>{n("wantsHelp",l)}}),r(E,{get when(){return e.store.games},children:l=>(()=>{var a=u(Sr),o=a.firstChild,g=o.nextSibling;return s(o,()=>x.myGameRounds),s(g,r(W,{get each(){return l().filter(m=>m.kind!=="deleted")},children:m=>{const h=m.tagNames.map($=>ot.find(({name:S})=>S===$)).filter($=>$!==void 0).map(({label:$})=>$);return r(W,{get each(){return m.slots},get fallback(){return r(It,{game:m,slot:null,tags:h,get changePage(){return e.changePage}})},children:$=>r(It,{game:m,slot:$,tags:h,get changePage(){return e.changePage}})})}})),a})()})]}function It(e){const{game:t,slot:n,tags:i,changePage:l}=e;return(()=>{var a=u(_r),o=a.firstChild,g=o.nextSibling,m=g.firstChild,h=m.firstChild,$=h.nextSibling,[S,_]=d($.nextSibling),b=m.nextSibling,k=b.firstChild,y=k.nextSibling,[p,C]=d(y.nextSibling),N=b.nextSibling,M=N.firstChild,P=M.nextSibling,[B,L]=d(P.nextSibling),I=N.nextSibling,J=I.firstChild,Q=J.nextSibling,X=Q.nextSibling,[j,ae]=d(X.nextSibling),Y=j.nextSibling,ie=Y.nextSibling,[le,F]=d(ie.nextSibling),ee=I.nextSibling,Z=ee.nextSibling,K=Z.firstChild,de=K.nextSibling,T=de.nextSibling,[ge,se]=d(T.nextSibling),oe=g.nextSibling,q=oe.firstChild,he=q.firstChild,be=he.nextSibling,ye=be.nextSibling,[fe,Se]=d(ye.nextSibling),ce=oe.nextSibling,xe=ce.firstChild,pe=xe.firstChild;return s(o,(()=>{var w=O(()=>t.title.value.length>0);return()=>w()?t.title.value:(()=>{var ue=u(He);return s(ue,()=>x.missingTitle),ue})()})()),s(m,()=>x.publishingSteps[t.kind],S,_),s(b,()=>t.system.value||(()=>{var w=u(He);return s(w,()=>x.missingSystem),w})(),p,C),s(N,n!==null?(()=>{var w=u(br),ue=w.firstChild,[De,Ee]=d(ue.nextSibling),Pe=De.nextSibling,Le=Pe.nextSibling,[ve,dt]=d(Le.nextSibling),gt=ve.nextSibling,Ze=gt.nextSibling,[Ke,ct]=d(Ze.nextSibling);return Ke.nextSibling,s(w,()=>x.days[n.day],De,Ee),s(w,()=>n.from,ve,dt),s(w,()=>n.to,Ke,ct),w})():(()=>{var w=u(He);return s(w,()=>x.missingSlot),w})(),B,L),s(I,()=>t.playerCount.min.value,j,ae),s(I,()=>t.playerCount.max.value,le,F),s(Z,()=>i.join(", ")||(()=>{var w=u(He);return s(w,()=>x.missingTags),w})(),ge,se),s(q,(()=>{var w=O(()=>t.description.short.value.length===0);return()=>w()?(()=>{var ue=u(He);return s(ue,()=>x.missingShortDescription),ue})():Kt(t.description.short.value,ut)})(),fe,Se),pe.$$click=()=>l({kind:"EDIT_GAMEROUND",uuid:t.uuid}),me(()=>Ae(a,["event-entry",t.kind==="draft"?"gray":""].join(" "))),lt(),a})()}it(["click"]);var vr=c("<div class=game-dialog><ul role=list style=display:grid;gap:0.5rem;><li><strong style=color:var(--clr-accent-1);>Spielleitung:</strong><br> <!$><!/></li><li><strong style=color:var(--clr-accent-1);>System:</strong><br><!$><!/></li><li><strong style=color:var(--clr-accent-1);>Tag, Zeit:</strong> <br><!$><!/>, <!$><!/> - <!$><!/> Uhr</li><li><strong style=color:var(--clr-accent-1);>Freie PlÃ¤tze:</strong><br><!$><!/> (von <!$><!/>)</li><li><strong style=color:var(--clr-accent-1);>Kategorien:</strong><br><!$><!/></li><li><strong style=color:var(--clr-accent-1);>Kurze Beschreibung:</strong><br><!$><!/></li><li><strong style=color:var(--clr-accent-1);>Lange Beschreibung:</strong><br><!$><!/></li></ul><div class=reservations><h5 style=margin-block-start:0>PlÃ¤tze reservieren</h5><div class=reservation-table>"),kr=c("<em>kein System angegeben"),yr=c("<em>keine Kategorien"),xr=c("<em>Keine lange Beschreibung angegeben."),pr=c("<div class=count>"),Er=c("<div class=reservation-table-entry><p>Reserviert fÃ¼r mich </p><!$><!/>"),Cr=c('<div class=reservation-table-entry><p>Reserviert fÃ¼r "<!$><!/>"</p><!$><!/>'),Rr=c('<div style="display:grid;gap:1rem;grid-template-columns:max-content 1fr;"><!$><!/><!$><!/>'),wr=c('<form style="display:grid;gap:0rem;grid-template-columns:1fr max-content"class=input-button><input type=text style=border-color:var(--clr-success-9);><!$><!/>');function Ar(e){const t=()=>e.reservations.filter(g=>g.gameRound===e.entry.uuid),n=Math.max(e.entry.playerCount.reserved+1-t.length,1),i=e.entry.tags.map(g=>ot.find(({name:m})=>m===g)).filter(g=>g!==void 0).map(({label:g})=>g),l=e.entry.playerCount.max,a=()=>en(l).map(g=>{const m=t()[g];return m!==void 0?m:g+1===l?{kind:"RESERVED_SPONTANIOUS"}:l-n<=g?{kind:"RESERVED_OTHER"}:{kind:"FREE"}}),o=()=>t().find(g=>g.kind==="SELF")!==void 0;return(()=>{var g=u(vr),m=g.firstChild,h=m.firstChild,$=h.firstChild,S=$.nextSibling,_=S.nextSibling,b=_.nextSibling,[k,y]=d(b.nextSibling),p=h.nextSibling,C=p.firstChild,N=C.nextSibling,M=N.nextSibling,[P,B]=d(M.nextSibling),L=p.nextSibling,I=L.firstChild,J=I.nextSibling,Q=J.nextSibling,X=Q.nextSibling,[j,ae]=d(X.nextSibling),Y=j.nextSibling,ie=Y.nextSibling,[le,F]=d(ie.nextSibling),ee=le.nextSibling,Z=ee.nextSibling,[K,de]=d(Z.nextSibling);K.nextSibling;var T=L.nextSibling,ge=T.firstChild,se=ge.nextSibling,oe=se.nextSibling,[q,he]=d(oe.nextSibling),be=q.nextSibling,ye=be.nextSibling,[fe,Se]=d(ye.nextSibling);fe.nextSibling;var ce=T.nextSibling,xe=ce.firstChild,pe=xe.nextSibling,w=pe.nextSibling,[ue,De]=d(w.nextSibling),Ee=ce.nextSibling,Pe=Ee.firstChild,Le=Pe.nextSibling,ve=Le.nextSibling,[dt,gt]=d(ve.nextSibling),Ze=Ee.nextSibling,Ke=Ze.firstChild,ct=Ke.nextSibling,hn=ct.nextSibling,[Sn,_n]=d(hn.nextSibling),bn=m.nextSibling,fn=bn.firstChild,vn=fn.nextSibling;return s(h,()=>e.entry.gamemaster,k,y),s(p,(()=>{var G=O(()=>e.entry.system.trim().length>0);return()=>G()?e.entry.system:u(kr)})(),P,B),s(L,()=>x.days[e.entry.slot.day],j,ae),s(L,()=>e.entry.slot.from,le,F),s(L,()=>e.entry.slot.to,K,de),s(T,()=>Math.max(e.entry.playerCount.max-1-e.entry.playerCount.reserved,0),q,he),s(T,()=>e.entry.playerCount.max-1,fe,Se),s(ce,(()=>{var G=O(()=>i.length>0);return()=>G()?i.join(", "):u(yr)})(),ue,De),s(Ee,()=>e.entry.description.short,dt,gt),s(Ze,(()=>{var G=O(()=>e.entry.description.long.trim().length>0);return()=>G()?O(()=>e.entry.description.long):u(xr)})(),Sn,_n),s(vn,r(W,{get each(){return a()},children:(G,kn)=>[(()=>{var H=u(pr);return s(H,()=>kn()+1),H})(),r($e,{get children(){return[r(A,{get when(){return G.kind==="SELF"},get children(){return r(Dt,{type:"success",get children(){var H=u(Er),Ce=H.firstChild,Ue=Ce.nextSibling,[Fe,Oe]=d(Ue.nextSibling);return s(H,r(et,{icon:"trash",onClick:()=>e.removeReservation(G.kind==="SELF"?G.uuid:"should not happen")}),Fe,Oe),H}})}}),r(A,{get when(){return G.kind==="FRIEND"},get children(){return r(Dt,{type:"success",get children(){var H=u(Cr),Ce=H.firstChild,Ue=Ce.firstChild,Fe=Ue.nextSibling,[Oe,mt]=d(Fe.nextSibling);Oe.nextSibling;var $t=Ce.nextSibling,[ht,yn]=d($t.nextSibling);return s(Ce,()=>G.kind==="FRIEND"?G.name:"[Fehler beim Laden]",Oe,mt),s(H,r(et,{icon:"trash",onClick:()=>e.removeReservation(G.kind==="FRIEND"?G.uuid:"should not happen")}),ht,yn),H}})}}),r(A,{get when(){return G.kind==="RESERVED_OTHER"},get children(){return r(R,{children:"Bereits reserviert"})}}),r(A,{get when(){return G.kind==="RESERVED_SPONTANIOUS"},get children(){return r(R,{children:"Reserviert fÃ¼r spontane Spieler:innen"})}}),r(A,{get when(){return G.kind==="FREE"},get children(){return r(E,{get when(){return o()},get fallback(){return(()=>{var H=u(Rr),Ce=H.firstChild,[Ue,Fe]=d(Ce.nextSibling),Oe=Ue.nextSibling,[mt,$t]=d(Oe.nextSibling);return s(H,r(z,{icon:"person-to-portal",label:"Mich anmelden",kind:"special",onClick:()=>e.addReservation({kind:"SELF",gameRound:e.entry.uuid})}),Ue,Fe),s(H,r(Pt,{addFriend:ht=>e.addReservation({kind:"FRIEND",gameRound:e.entry.uuid,name:ht})}),mt,$t),H})()},get children(){return r(Pt,{addFriend:H=>e.addReservation({kind:"FRIEND",gameRound:e.entry.uuid,name:H})})}})}})]}})]})),g})()}function Pt(e){const[t,n]=Rt("");return(()=>{var i=u(wr),l=i.firstChild,a=l.nextSibling,[o,g]=d(a.nextSibling);return i.addEventListener("submit",m=>{m.preventDefault();const h=t();h.trim().length>0&&e.addFriend(h)}),nt(i,"novalidate",!0),l.$$input=m=>n(m.target.value),s(i,r(z,{icon:"arrow-right",type:"submit",label:"Begleitperson anmelden",kind:"success"}),o,g),me(()=>nt(l,"value",t())),lt(),i})()}it(["input"]);var Tr=c("<p>WIP"),Xe=c("<br>"),Dr=c("<p>Diese Seite ist leider noch nicht bereit. Komm bitte spÃ¤ter nochmal zurÃ¼ck."),Ur=c("<p>Programm konnte nicht geladen werden."),Or=c("<h3>"),Nr=c("<h4 style=margin-block-start:2rem;margin-block-end:1rem;>Start: <!$><!/> Uhr"),Mr=c('<ul class="event-list max"role=list>'),Ir=c("<small><!$><!/> - <!$><!/> Uhr"),Pr=c("<h4 style=margin-block-end:0.5rem;>"),Lr=c("<p>Wir kochen: <span>"),Fr=c("<div style=margin-block-start:2rem;>"),Gr=c('<li><h3 class=event-title></h3><div class=event-details><div class=event-tags><strong>Spielleitung:</strong><!$><!/></div><div class=event-tags><strong>System:</strong><!$><!/></div><div class=event-tags><strong>Tag, Zeit:</strong><span><!$><!/>, <!$><!/> - <!$><!/> Uhr</span></div><div class=event-tags><strong>Freie PlÃ¤tze:</strong> <!$><!/> (von <!$><!/>)</div> <div class=event-tags><strong>Kategorien:</strong> <!$><!/></div></div><div class="event-description content"><p><strong>Kurzbeschreibung:</strong><br><!$><!/></p></div><ul role=list class=event-links><li><button class=event-link><span>Details & Teilnehmen'),Hr=c("<em>kein System angegeben"),Br=c("<em>keine Kategorien");function Yr(e){return r($e,{get fallback(){return r(R,{type:"danger",get children(){return u(Dr)}})},get children(){return r(A,{get when(){return e.isDebugging},get children(){return[r(R,{type:"danger",get children(){return u(Tr)}}),u(Xe),r(at,{get fallback(){return r(R,{get children(){return x.loading.program}})},get children(){return r(E,{get when(){return e.program()},get fallback(){return r(R,{type:"danger",get children(){return x.error.program}})},children:t=>r(E,{get when(){return t().kind==="SUCCESS"},get fallback(){return r(R,{type:"danger",get children(){return u(Ur)}})},get children(){return r(zr,{get program(){return t().data},get reservations(){return e.reservations},get addReservation(){return e.addReservation},get removeReservation(){return e.removeReservation},get uuid(){return e.uuid},get changePage(){return e.changePage}})}})})}})]}})}})}function zr(e){const[t,n]=U(Re(e.uuid!==void 0));Vt(()=>{n("open",e.uuid!==null)});const i=()=>e.program.find(a=>a.uuid===e.uuid),l=Zr(jr(e.program));return[r(E,{get when(){return i()},children:a=>r(Te,{store:t,get title(){return a().title},onClose:()=>e.changePage({kind:"PLAYER"},{disableScroll:!0}),size:"large",get children(){return r(Ar,{get entry(){return a()},get reservations(){return e.reservations},get addReservation(){return e.addReservation},get removeReservation(){return e.removeReservation}})}})}),u(Xe),r(Lt,{day:"SATURDAY",get programOfDay(){return l.SATURDAY},get changePage(){return e.changePage}}),u(Xe),u(Xe),r(Lt,{day:"SUNDAY",get programOfDay(){return l.SUNDAY},get changePage(){return e.changePage}})]}function Lt(e){const n=we[e.day].breaks.map(l=>l.from),i=l=>n.indexOf(l)===0?"LUNCH":"DINNER";return[(()=>{var l=u(Or);return s(l,()=>x.days[e.day]),l})(),r(W,{get each(){return Object.entries(e.programOfDay)},get fallback(){return r(R,{children:"Keine Spielrunden gefunden."})},children:([l,a])=>n.includes(Number(l))?r(Wr,{get type(){return i(Number(l))},get range(){return{from:Number(l),to:Number(l)-1}}}):a.length===0?null:[(()=>{var o=u(Nr),g=o.firstChild,m=g.nextSibling,[h,$]=d(m.nextSibling);return h.nextSibling,s(o,l,h,$),o})(),(()=>{var o=u(Mr);return s(o,r(W,{each:a,children:g=>r(Kr,{entry:g,get changePage(){return e.changePage}})})),o})()]})]}function Wr(e){const t=e.type==="LUNCH"?"Mittagessen":"Nachtessen";return(()=>{var n=u(Fr);return s(n,r(R,{get children(){return[(()=>{var i=u(Ir),l=i.firstChild,[a,o]=d(l.nextSibling),g=a.nextSibling,m=g.nextSibling,[h,$]=d(m.nextSibling);return h.nextSibling,s(i,()=>e.range.from,a,o),s(i,()=>e.range.to,h,$),i})(),(()=>{var i=u(Pr);return s(i,t),i})(),(()=>{var i=u(Lr),l=i.firstChild,a=l.nextSibling;return nt(a,"innerHTML","Pilzrisotto (vegi&nbsp;/&nbsp;vegan), Penne All'Arrabbiata und Penne Pesto (vegi&nbsp;/&nbsp;vegan)."),i})()]}})),n})()}function jr(e){const t=Object.groupBy(e,n=>n.slot.day);return{SATURDAY:t.SATURDAY??[],SUNDAY:t.SUNDAY??[]}}function Zr(e){function t(o,g){const{from:m,to:h}=o.slot,{from:$,to:S}=g.slot;return m===$?h-S:m-$}const n=e.SATURDAY.toSorted(t),i=e.SUNDAY.toSorted(t),l=ze(we.SATURDAY.open).reduce((o,g)=>(o[g]=n.filter(m=>m.slot.from===g),o),{}),a=ze(we.SUNDAY.open).reduce((o,g)=>(o[g]=i.filter(m=>m.slot.from===g),o),{});return{SATURDAY:l,SUNDAY:a}}function Kr(e){const t=e.entry.tags.map(n=>ot.find(({name:i})=>i===n)).filter(n=>n!==void 0).map(({label:n})=>n);return(()=>{var n=u(Gr),i=n.firstChild,l=i.nextSibling,a=l.firstChild,o=a.firstChild,g=o.nextSibling,[m,h]=d(g.nextSibling),$=a.nextSibling,S=$.firstChild,_=S.nextSibling,[b,k]=d(_.nextSibling),y=$.nextSibling,p=y.firstChild,C=p.nextSibling,N=C.firstChild,[M,P]=d(N.nextSibling),B=M.nextSibling,L=B.nextSibling,[I,J]=d(L.nextSibling),Q=I.nextSibling,X=Q.nextSibling,[j,ae]=d(X.nextSibling);j.nextSibling;var Y=y.nextSibling,ie=Y.firstChild,le=ie.nextSibling,F=le.nextSibling,[ee,Z]=d(F.nextSibling),K=ee.nextSibling,de=K.nextSibling,[T,ge]=d(de.nextSibling);T.nextSibling;var se=Y.nextSibling,oe=se.nextSibling,q=oe.firstChild,he=q.nextSibling,be=he.nextSibling,[ye,fe]=d(be.nextSibling),Se=l.nextSibling,ce=Se.firstChild,xe=ce.firstChild,pe=xe.nextSibling,w=pe.nextSibling,[ue,De]=d(w.nextSibling),Ee=Se.nextSibling,Pe=Ee.firstChild,Le=Pe.firstChild;return s(i,()=>e.entry.title),s(a,()=>e.entry.gamemaster,m,h),s($,(()=>{var ve=O(()=>e.entry.system.trim().length>0);return()=>ve()?e.entry.system:u(Hr)})(),b,k),s(C,()=>x.days[e.entry.slot.day],M,P),s(C,()=>e.entry.slot.from,I,J),s(C,()=>e.entry.slot.to,j,ae),s(Y,()=>Math.max(e.entry.playerCount.max-1-e.entry.playerCount.reserved,0),ee,Z),s(Y,()=>e.entry.playerCount.max-1,T,ge),s(oe,(()=>{var ve=O(()=>t.length>0);return()=>ve()?t.join(", "):u(Br)})(),ye,fe),s(ce,()=>Kt(e.entry.description.short,ut),ue,De),Le.$$click=()=>e.changePage({kind:"GAME",uuid:e.entry.uuid},{disableScroll:!0}),me(()=>Ae(n,["event-entry"].join(" "))),lt(),n})()}it(["click"]);var Ft=c("<h3>Spielrunden ansehen"),Gt=c("<p>Melde dich (und deine Freunde) fÃ¼r diverse Spielrunden an."),kt=c("<br>"),qr=c("<h3>Spielrunden erstellen"),Vr=c("<p>Falls du wenig oder gar keine Erfahrung als Spielleiter:in hast, werden wir dich vor und wÃ¤hrend dem Anlass unterstÃ¼tzen."),Jr=c("<h3>Helfen"),Qr=c("<p>Beim Kiosk und der Essensausgabe kÃ¶nnen wir immer ein paar helfende HÃ¤nde gebrauchen."),Ht=c("<p><strong>Noch nicht verfÃ¼gbar."),Xr=c("<h3>Zusammenfassung"),ei=c("<p>Erhalte einen Ãberblick Ã¼ber dein gesamtes Programm.");function ti(e){return[r($e,{get fallback(){return r(Me,{type:"gray",icon:"dice-d20",onClick:()=>e.changePage({kind:"PLAYER"}),get children(){return[u(Ft),u(Gt),u(Ht)]}})},get children(){return r(A,{get when(){return e.isDebugging},get children(){return r(Me,{icon:"dice-d20",onClick:()=>e.changePage({kind:"PLAYER"}),get children(){return[u(Ft),u(Gt)]}})}})}}),u(kt),r(Me,{icon:"grid-2-plus",onClick:()=>e.changePage({kind:"GAMEMASTER"}),get children(){return[u(qr),u(Vr)]}}),u(kt),r(Me,{type:"gray",icon:"hand-heart",onClick:()=>e.changePage({kind:"HELPING"}),get children(){return[u(Jr),u(Qr),u(Ht)]}}),u(kt),r(Me,{icon:"list",onClick:()=>e.changePage({kind:"SUMMARY"}),get children(){return[u(Xr),u(ei)]}})]}var ni=c("<fieldset><legend>Zeitslots</legend><!$><!/><!$><!/>"),Bt=c("<br>"),ri=c("<div style=margin-block-end:0.5rem;>Zeitslot: <!$><!/>, <!$><!/> -<!$><!/> Uhr"),ii=c("<ul class=event-list role=list>"),li=c("<em>werden geladen..."),ai=c("<li class=event-entry><h3 class=event-title><!$><!/>, <!$><!/> - <!$><!/> Uhr</h3><div class=event-details><div class=event-tags><strong>Dauer:</strong><!$><!/> <!$><!/></div><div class=event-tags><strong>Spielende:</strong> <!$><!/></div></div><div></div><ul role=list class=event-links>"),si=c("<em>Fehler beim Laden."),oi=c("<em>noch keine Anmeldungen"),ui=c("<li><em style=font-size:smaller;>Aktionen werden geladen..."),Yt=c("<li><em style=font-size:smaller;>kann nicht gelÃ¶scht werden"),di=c("<li><button type=button class=event-link><div style=display:flex;gap:0.25rem;align-items:center;><!$><!/><span>LÃ¶schen"),gi=c("<div style=display:grid;gap:0.5rem;>"),ci=c("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/>"),mi=c("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/><!$><!/>"),$i=c("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/><!$><!/><div style=margin-block-start:1rem;>"),hi=c("<div style=display:flex;flex-wrap:wrap;gap:0.5rem;align-items:center;><!$><!/> <span>Neuen Slot erfassen"),Si=c("<em>WÃ¤hle eine Tag:"),_i=c("<div style=display:flex;flex-wrap:wrap;gap:.5rem;><!$><!/><!$><!/>"),bi=c("<em>WÃ¤hle eine Startzeit:"),un=c("<div style=display:flex;flex-wrap:wrap;gap:.5rem;>"),dn=c("<span style=white-space:nowrap;><!$><!/> Uhr"),fi=c("<em>WÃ¤hle eine Endzeit:");function vi(e){return(()=>{var t=u(ni),n=t.firstChild,i=n.nextSibling,[l,a]=d(i.nextSibling),o=l.nextSibling,[g,m]=d(o.nextSibling);return s(t,r(yi,{get store(){return e.store},get registrations(){return e.registrations}}),l,a),s(t,r(E,{get when(){return e.slotMissing},get children(){return r(R,{type:"danger",children:"WÃ¤hle mindestens einen Zeitslot aus."})}}),g,m),t})()}const zt=1;function ki(e){function t(n){const i=ze(n.open,!0);return n.breaks.map(a=>ze(a,!0)).reduce((a,o)=>{const g=o.at(0),m=o.at(-1);if(g===void 0||m===void 0)return a;const h=[];return a.forEach($=>{const S=[],_=[];$.forEach(b=>{b<=g&&S.push(b),m<=b&&_.push(b)}),S.length>0&&h.push(S),_.length>0&&h.push(_)}),h},[i]).map(a=>{const o=a.slice(0,zt*-1);return Cn(o.map(g=>{const m=a.filter(h=>h>=g+zt);return[g,m]}))}).reduce((a,o)=>({...a,...o}),{})}return{SATURDAY:t(e.SATURDAY),SUNDAY:t(e.SUNDAY)}}function yi(e){const[t,n]=U(e.store),[i,l]=U({dialog:Re()}),a=rt(()=>ki(we));function o(h){n(t.concat(h))}function g(h){l("dialog","open",!1),l("slot",void 0),n(t.filter($=>$.uuid!==h))}function m(h){l("dialog","open",!0),l("slot",t.find($=>$.uuid===h))}return[r(pi,{get daySections(){return a()},chooseTimeSlot:o}),u(Bt),u(Bt),r(Te,{get store(){return i.dialog},title:"Zeitslot lÃ¶schen",onClose:()=>l("slot",void 0),get children(){return[(()=>{var h=u(ri),$=h.firstChild,S=$.nextSibling,[_,b]=d(S.nextSibling),k=_.nextSibling,y=k.nextSibling,[p,C]=d(y.nextSibling),N=p.nextSibling,M=N.nextSibling,[P,B]=d(M.nextSibling);return P.nextSibling,s(h,()=>x.days[i.slot?.day],_,b),s(h,()=>i.slot?.from,p,C),s(h,()=>i.slot?.to,P,B),h})(),r(z,{kind:"danger",icon:"trash",label:"LÃ¶schen",onClick:()=>g(i.slot?.uuid)})]}}),r(xi,{slots:t,get registrations(){return e.registrations},confirmRemoval:m})]}function xi(e){return(()=>{var t=u(ii);return s(t,r(W,{get each(){return Ei(e.slots)},children:n=>(()=>{var i=u(ai),l=i.firstChild,a=l.firstChild,[o,g]=d(a.nextSibling),m=o.nextSibling,h=m.nextSibling,[$,S]=d(h.nextSibling),_=$.nextSibling,b=_.nextSibling,[k,y]=d(b.nextSibling);k.nextSibling;var p=l.nextSibling,C=p.firstChild,N=C.firstChild,M=N.nextSibling,[P,B]=d(M.nextSibling),L=P.nextSibling,I=L.nextSibling,[J,Q]=d(I.nextSibling),X=C.nextSibling,j=X.firstChild,ae=j.nextSibling,Y=ae.nextSibling,[ie,le]=d(Y.nextSibling),F=p.nextSibling,ee=F.nextSibling;return s(l,()=>x.days[n.day],o,g),s(l,()=>n.from,$,S),s(l,()=>n.to,k,y),s(C,()=>n.to-n.from,P,B),s(C,()=>n.to-n.from>1?"Stunden":"Stunde",J,Q),s(X,r($e,{get children(){return[r(A,{get when(){return e.registrations.loading},get children(){return u(li)}}),r(A,{get when(){return e.registrations()},children:Z=>{const K=Z();if(K.kind==="FAILURE")return u(si);const de=K.data.entries.filter(T=>T.uuid===n.uuid).map(T=>T.name);return O(()=>de.join(", ")||u(oi))}})]}}),ie,le),s(ee,r(at,{get fallback(){return u(ui)},get children(){return r(E,{get when(){return e.registrations()},children:Z=>{const K=Z();return K.kind==="FAILURE"?u(Yt):K.data.entries.filter(T=>T.uuid===n.uuid).map(T=>T.name).length>0?u(Yt):(()=>{var T=u(di),ge=T.firstChild,se=ge.firstChild,oe=se.firstChild,[q,he]=d(oe.nextSibling);return q.nextSibling,ge.$$click=()=>e.confirmRemoval(n.uuid),s(se,r(te,{icon:"trash"}),q,he),lt(),T})()}})}})),i})()})),t})()}function pi(e){const[t,n]=U({slot:{kind:"CHOOSE_DAY"},dialog:Re()});function i(){n("slot",{kind:"CHOOSE_DAY"}),n("dialog","open",!1)}function l(a){e.chooseTimeSlot(a),i()}return[r(ne,{kind:"success",get label(){return(()=>{var a=u(hi),o=a.firstChild,[g,m]=d(o.nextSibling);return g.nextSibling,s(a,r(te,{icon:"circle-plus"}),g,m),a})()},onClick:()=>n("dialog","open",!0)}),r(Te,{title:"Zeitslot erfassen",get store(){return t.dialog},size:"medium",onClose:i,get children(){return r($e,{get children(){return[r(A,{get when(){return t.slot.kind==="CHOOSE_DAY"},get children(){var a=u(gi);return s(a,r(Je,{changeDay:o=>n("slot",{kind:"CHOOSE_START",day:o})})),a}}),r(A,{get when(){return t.slot.kind==="CHOOSE_START"},get children(){var a=u(ci),o=a.firstChild,[g,m]=d(o.nextSibling),h=g.nextSibling,[$,S]=d(h.nextSibling);return s(a,r(Je,{get chosenDay(){return t.slot.kind==="CHOOSE_START"?t.slot.day:void 0},changeDay:_=>n("slot",{kind:"CHOOSE_START",day:_})}),g,m),s(a,r(yt,{get startTimes(){return O(()=>t.slot.kind==="CHOOSE_START")()?_t(e.daySections[t.slot.day]):[]},changeStart:_=>n("slot",{kind:"CHOOSE_END",start:_})}),$,S),a}}),r(A,{get when(){return t.slot.kind==="CHOOSE_END"},get children(){var a=u(mi),o=a.firstChild,[g,m]=d(o.nextSibling),h=g.nextSibling,[$,S]=d(h.nextSibling),_=$.nextSibling,[b,k]=d(_.nextSibling);return s(a,r(Je,{get chosenDay(){return t.slot.kind==="CHOOSE_END"?t.slot.day:void 0},changeDay:y=>n("slot",{kind:"CHOOSE_START",day:y})}),g,m),s(a,r(yt,{get chosenStart(){return t.slot.kind==="CHOOSE_END"?t.slot.start:void 0},get startTimes(){return O(()=>t.slot.kind==="CHOOSE_END")()?_t(e.daySections[t.slot.day]):[]},changeStart:y=>n("slot",{kind:"CHOOSE_END",start:y})}),$,S),s(a,r(Wt,{get endTimes(){return t.slot.kind==="CHOOSE_END"?e.daySections[t.slot.day][t.slot.start]??[]:[]},changeEnd:y=>{t.slot.kind==="CHOOSE_END"&&n("slot",{kind:"WAIT_FOR_CONFIRMATION",day:t.slot.day,start:t.slot.start,end:y})}}),b,k),a}}),r(A,{get when(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"},get children(){var a=u($i),o=a.firstChild,[g,m]=d(o.nextSibling),h=g.nextSibling,[$,S]=d(h.nextSibling),_=$.nextSibling,[b,k]=d(_.nextSibling),y=b.nextSibling;return s(a,r(Je,{get chosenDay(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?t.slot.day:void 0},changeDay:p=>n("slot",{kind:"CHOOSE_START",day:p})}),g,m),s(a,r(yt,{get chosenStart(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?t.slot.start:void 0},get startTimes(){return O(()=>t.slot.kind==="WAIT_FOR_CONFIRMATION")()?_t(e.daySections[t.slot.day]):[]},changeStart:p=>n("slot",{kind:"CHOOSE_END",start:p})}),$,S),s(a,r(Wt,{get chosenEnd(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?t.slot.end:void 0},get endTimes(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?e.daySections[t.slot.day][t.slot.start]??[]:[]},changeEnd:p=>{t.slot.kind==="WAIT_FOR_CONFIRMATION"&&n("slot",{kind:"WAIT_FOR_CONFIRMATION",day:t.slot.day,start:t.slot.start,end:p})}}),b,k),s(y,r(ne,{get label(){return`Slot "${t.slot.kind==="WAIT_FOR_CONFIRMATION"?`${x.days[t.slot.day]}, von ${t.slot.start} bis ${t.slot.end} Uhr`:""}" erstellen`},kind:"success",onClick:()=>{t.slot.kind==="WAIT_FOR_CONFIRMATION"&&l({uuid:crypto.randomUUID(),day:t.slot.day,from:t.slot.start,to:t.slot.end})}})),a}})]}})}})]}function Je(e){return[u(Si),(()=>{var t=u(_i),n=t.firstChild,[i,l]=d(n.nextSibling),a=i.nextSibling,[o,g]=d(a.nextSibling);return s(t,r(ne,{get kind(){return e.chosenDay==="SATURDAY"?"success":"gray"},label:"Samstag",onClick:()=>e.changeDay("SATURDAY")}),i,l),s(t,r(ne,{get kind(){return e.chosenDay==="SUNDAY"?"success":"gray"},label:"Sonntag",onClick:()=>e.changeDay("SUNDAY")}),o,g),t})()]}function yt(e){return[u(bi),(()=>{var t=u(un);return s(t,r(W,{get each(){return e.startTimes},children:n=>r(ne,{get kind(){return e.chosenStart===n?"success":"gray"},get label(){return(()=>{var i=u(dn),l=i.firstChild,[a,o]=d(l.nextSibling);return a.nextSibling,s(i,n,a,o),i})()},onClick:()=>e.changeStart(n)})})),t})()]}function Wt(e){return[u(fi),(()=>{var t=u(un);return s(t,r(W,{get each(){return e.endTimes},children:n=>r(ne,{get kind(){return e.chosenEnd===n?"success":"gray"},get label(){return(()=>{var i=u(dn),l=i.firstChild,[a,o]=d(l.nextSibling);return a.nextSibling,s(i,n,a,o),i})()},onClick:()=>e.changeEnd(n)})})),t})()]}function Ei(e){return e.toSorted((t,n)=>t.day!==n.day?t.day==="SATURDAY"?-1:1:t.from-n.from)}it(["click"]);function Ci(e){const t=new Date;return async()=>new Promise(n=>{setTimeout(()=>(console.error("NOT YET IMPLEMENTED: `publishGameround`",e,t),n()),500)})}function Ri(e,t){const n=new Date;return async()=>new Promise(i=>{setTimeout(()=>(console.error("NOT YET IMPLEMENTED: `sendGameroundUpdate`",e,t.join(", "),n),i()),500)})}var We=c("<br>"),wi=c("<div class=content><p>MÃ¶chtest du diese Spielrunde gerne verÃ¶ffentlichen?</p><!$><!/>"),Ai=c("<em>Informationen zu den Anmeldungen mÃ¼ssen geladen werden..."),Ti=c("<em>Du kannst kein Update versenden, da sich noch niemand fÃ¼r diese Spielrunde angemeldet hat."),Di=c("<p>An: <!$><!/>"),Ui=c("<em>Du kannst die Spielrunde nur lÃ¶schen, wenn du zuerst alle Zeitslots entfernt hast."),Oi=c("<div class=content><p>Bist du sicher, dass du die Spielrunde lÃ¶schen mÃ¶chtest?</p><!$><!/>"),Ni=c('<form novalidate><!$><!/><!$><!/><!$><!/><div style="display:grid;grid-template-columns:repeat(2, 1fr);gap:1rem;"><!$><!/><!$><!/></div><!$><!/><!$><!/><!$><!/><fieldset><legend>Kategorien (optional)</legend><!$><!/></fieldset><!$><!/><div style=display:flex;flex-wrap:wrap;gap:1rem;justify-content:space-between;><!$><!/><div style=display:flex;flex-wrap:wrap;gap:1rem;><!$><!/><!$><!/><!$><!/>'),Mi=c("<h4>Spielrunde inkomplett"),Ii=c("<p>Du hast noch einen oder mehre Fehler/fehlende Informationen in dieser Spielrunde:"),Pi=c("<li>Â«TitelÂ» ist ein Pflichtfeld."),Li=c("<li>Â«kurz BeschreibungÂ» ist ein Pflichtfeld."),Fi=c("<li>Â«kurz BeschreibungÂ» ist zu lang."),Gi=c("<li>Â«lange BeschreibungÂ» ist zu lang."),Hi=c("<li>Mindest einen Zeitslot muss ausgewÃ¤hlt werden."),Bi=c("<ul><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),Yi=c("<p><strong>ErklÃ¤rung:</strong> Hast du eine wichtige Ãnderung an dieser Spielrunde durchgefÃ¼hrt, wÃ¤hrend bereits Spielende angemeldet waren? Lass hiermit die Angemeldeten wissen, was du geÃ¤ndert hast. Wichtige Ãnderungen kÃ¶nnen sein: System geÃ¤ndert, Kategorien geÃ¤ndert. FÃ¼r kleine Ãnderungen, wie z.B. Rechtschreibfehler, sollte dies nicht genutzt werden."),zi=c("<p><em>Halte dich kurz und am besten Stichwortartig."),Wi=c("<form><!$><!/><!$><!/>"),ji=c("<div style=display:grid;gap:0.5rem;margin-block-end:1rem;>");function Zi(e){const t=e.allRounds.find(n=>n.uuid===e.uuid);return r(E,{get fallback(){return e.fallback},when:t,children:n=>e.children(n())})}function Ki(e){const[t,n]=U(e.store),[i,l]=U({delete:Re(),publish:Re(),sendUpdate:Re()});function a(g){g.preventDefault(),l("publish","open",!0)}function o(){e.changePage({kind:"GAMEMASTER"})}return[r(tn,{kind:"special",get children(){return["Status: ",O(()=>x.publishingSteps[t.kind])]}}),u(We),u(We),r(Qi,{store:t,get registrations(){return e.registrations},onSubmit:a,onCancel:()=>l("delete","open",!0),onSendUpdate:()=>l("sendUpdate","open",!0),goBack:o}),r(qi,{get store(){return i.publish},get title(){return t.title.value},onPublish:()=>{n("kind","published"),l("publish","open",!1),e.queue.enqueue(Ci(t.uuid))}}),r(Vi,{get store(){return i.sendUpdate},get players(){return tl(e.registrations,t.slots.map(g=>g.uuid))},onSend:g=>{e.queue.enqueue(Ri(g,t.slots.map(m=>m.uuid)))}}),r(Ji,{get store(){return i.delete},get hasSlots(){return t.slots.length!==0},get title(){return t.title.value},onDelete:()=>{n("kind","deleted"),e.changePage({kind:"GAMEMASTER"})}})]}function qi(e){return r(Te,{get store(){return e.store},title:"Spielrunde verÃ¶ffentlichen",onClose:()=>{},get children(){var t=u(wi),n=t.firstChild,i=n.nextSibling,[l,a]=d(i.nextSibling);return s(t,r(z,{kind:"success",icon:"circle-plus",get label(){return`Ja, bitte "${e.title||"["+x.missingTitle+"]"}" verÃ¶ffentlichen.`},get onClick(){return e.onPublish}}),l,a),t}})}function Vi(e){return r(Te,{get store(){return e.store},title:"Update senden",onClose:()=>{},size:"medium",get children(){return()=>e.players.kind==="LOADING"?u(Ai):e.players.kind==="ERROR"?O(()=>x.error.general):e.players.data.length===0?u(Ti):[(()=>{var t=u(Di),n=t.firstChild,i=n.nextSibling,[l,a]=d(i.nextSibling);return s(t,()=>e.players.data.map(o=>o.name).join(", "),l,a),t})(),u(We),r(Xi,{get onSend(){return e.onSend}})]}})}function Ji(e){return r(Te,{get store(){return e.store},title:"Spielrunde lÃ¶schen",onClose:()=>{},get children(){return[r(E,{get when(){return e.hasSlots},get children(){return u(Ui)}}),r(E,{get when(){return!e.hasSlots},get children(){var t=u(Oi),n=t.firstChild,i=n.nextSibling,[l,a]=d(i.nextSibling);return s(t,r(z,{kind:"danger",icon:"trash",get label(){return`Ja, bitte "${e.title||"["+x.missingTitle+"]"}" lÃ¶schen.`},get onClick(){return e.onDelete}}),l,a),t}})]}})}function Qi(e){const[t]=U(e.store),n=rt(()=>cr(t));return(()=>{var i=u(Ni),l=i.firstChild,[a,o]=d(l.nextSibling),g=a.nextSibling,[m,h]=d(g.nextSibling),$=m.nextSibling,[S,_]=d($.nextSibling),b=S.nextSibling,k=b.firstChild,[y,p]=d(k.nextSibling),C=y.nextSibling,[N,M]=d(C.nextSibling),P=b.nextSibling,[B,L]=d(P.nextSibling),I=B.nextSibling,[J,Q]=d(I.nextSibling),X=J.nextSibling,[j,ae]=d(X.nextSibling),Y=j.nextSibling,ie=Y.firstChild,le=ie.nextSibling,[F,ee]=d(le.nextSibling),Z=Y.nextSibling,[K,de]=d(Z.nextSibling),T=K.nextSibling,ge=T.firstChild,[se,oe]=d(ge.nextSibling),q=se.nextSibling,he=q.firstChild,[be,ye]=d(he.nextSibling),fe=be.nextSibling,[Se,ce]=d(fe.nextSibling),xe=Se.nextSibling,[pe,w]=d(xe.nextSibling);return s(i,r(E,{get when(){return t.kind==="published"},get children(){return r(jt,{get errors(){return n()}})}}),a,o),s(i,r(Ye,{get store(){return t.title},label:"Titel",name:"title",get showErrors(){return t.kind==="published"?"ALWAYS":"ON_BLUR"},get errors(){return n().titleMissing?[x.mandatoryField]:[]}}),m,h),s(i,r(Ye,{get store(){return t.system},label:"System (optional)",name:"System"}),S,_),s(b,r(Ut,{get store(){return t.playerCount.min},label:"Anzahl Mitspielende (Minimum)",name:"playerCountMin",min:1,get max(){return t.playerCount.max.value}}),y,p),s(b,r(Ut,{get store(){return t.playerCount.max},label:"Anzahl Mitspielende (Maximum)",name:"playerCountMax",get min(){return t.playerCount.min.value}}),N,M),s(i,r(pt,{get store(){return t.description.short},label:"kurze Beschreibung",name:"descriptionShort",size:"small",get showErrors(){return t.kind==="published"?"ALWAYS":"ON_BLUR"},get errors(){return O(()=>!!n().descriptionShortMissing)()?[x.mandatoryField]:O(()=>!!n().descriptionShortTooLong)()?[x.charLimitBy.replace("{}",String(ut))]:[]}}),B,L),s(i,r(pt,{get store(){return t.description.long},label:"lange Beschreibung (optional)",name:"descriptionLong",get showErrors(){return t.kind==="published"?"ALWAYS":"ON_BLUR"},get errors(){return O(()=>!!n().descriptionLongTooLong)()?[x.charLimitBy.replace("{}",String(sn))]:[]}}),J,Q),s(i,r(vi,{get store(){return e.store.slots},get registrations(){return e.registrations},get slotMissing(){return n().slotMissing}}),j,ae),s(Y,r(el,{get store(){return t.tagNames}}),F,ee),s(i,r(jt,{get errors(){return n()}}),K,de),s(T,r(z,{icon:"backward",label:"ZurÃ¼ck zu deinen Spielrunden",get onClick(){return e.goBack}}),se,oe),s(q,r(E,{get when(){return t.kind!=="deleted"},get children(){return r(z,{icon:"trash",kind:"danger",label:"LÃ¶schen",onClick:()=>e.onCancel()})}}),be,ye),s(q,r(E,{get when(){return t.kind==="draft"},get children(){return r(z,{icon:"circle-plus",get kind(){return n().hasErrors?"gray":"success"},get disabled(){return n().hasErrors},label:"Spielrunde verÃ¶ffentlichen",get onClick(){return n().hasErrors?void 0:e.onSubmit}})}}),Se,ce),s(q,r(E,{get when(){return t.kind==="published"},get children(){return r(z,{icon:"circle-plus",kind:"success",label:"Update an Spielende schicken",get onClick(){return e.onSendUpdate}})}}),pe,w),i})()}function jt(e){return r(E,{get when(){return e.errors.hasErrors},get children(){return r(R,{type:"danger",get children(){return[u(Mi),u(Ii),(()=>{var t=u(Bi),n=t.firstChild,[i,l]=d(n.nextSibling),a=i.nextSibling,[o,g]=d(a.nextSibling),m=o.nextSibling,[h,$]=d(m.nextSibling),S=h.nextSibling,[_,b]=d(S.nextSibling),k=_.nextSibling,[y,p]=d(k.nextSibling);return s(t,r(E,{get when(){return e.errors.titleMissing},get children(){return u(Pi)}}),i,l),s(t,r(E,{get when(){return e.errors.descriptionShortMissing},get children(){return u(Li)}}),o,g),s(t,r(E,{get when(){return e.errors.descriptionShortTooLong},get children(){return u(Fi)}}),h,$),s(t,r(E,{get when(){return e.errors.descriptionLongTooLong},get children(){return u(Gi)}}),_,b),s(t,r(E,{get when(){return e.errors.slotMissing},get children(){return u(Hi)}}),y,p),t})()]}})}})}function Xi(e){const[t,n]=U({updateText:{value:"",isDirty:!1},hasBeenSent:!1}),i=rt(()=>mr(t));return r($e,{get fallback(){return r(R,{type:"success",children:"Nachricht wurde registriert und wird in den nÃ¤chsten 24 Stunden an die Spielenden verschickt."})},get children(){return r(A,{get when(){return!t.hasBeenSent},get children(){return[u(Yi),u(We),u(zi),u(We),(()=>{var l=u(Wi),a=l.firstChild,[o,g]=d(a.nextSibling),m=o.nextSibling,[h,$]=d(m.nextSibling);return nt(l,"novalidate",!0),s(l,r(pt,{get store(){return t.updateText},label:"Zusammenfassung der Ãnderung",name:"updateText",size:"small",showErrors:"ALWAYS",get errors(){return O(()=>!!i().missing)()?[x.mandatoryField]:O(()=>!!i().tooLong)()?[x.charLimitBy.replace("{}",String(on))]:[]}}),o,g),s(l,r(z,{icon:"paper-plane",label:"Spielende informieren",get kind(){return i().hasErrors?"gray":"success"},get disabled(){return i().hasErrors},get onClick(){return i().hasErrors?void 0:()=>{e.onSend(t.updateText.value),n("hasBeenSent",!0)}}}),h,$),l})()]}})}})}function el(e){const[t,n]=U(e.store);return[(()=>{var i=u(ji);return s(i,r(W,{each:ot,children:l=>r(Qt,{get label(){return l.label},get description(){return l.description},get checked(){return t.includes(l.name)},get name(){return l.name},get value(){return l.name},onValueUpdate:a=>{n(a?t.concat([l.name]):t.filter(o=>o!==l.name))}})})),i})(),r(R,{get children(){return x.tagIdeas}})]}const tl=(e,t)=>{if(e.loading)return{kind:"LOADING"};if(e.error)return{kind:"ERROR"};const n=e();return n===void 0||n.kind==="FAILURE"?{kind:"ERROR"}:{kind:"SUCCESS",data:n.data.entries.filter(i=>t.includes(i.uuid))}},nl=Xt("kind",[v({kind:D("CHOOSE"),uuid:Ge()}),v({kind:D("PLAYER"),uuid:Ge()}),v({kind:D("GAME"),uuid:f().uuid()}),v({kind:D("GAMEMASTER"),uuid:Ge()}),v({kind:D("HELPING"),uuid:Ge()}),v({kind:D("SUMMARY"),uuid:Ge()}),v({kind:D("EDIT_GAMEROUND"),uuid:f().uuid()})]);Xt("kind",[v({kind:D("CHOOSE")}),v({kind:D("PLAYER")}),v({kind:D("GAME"),uuid:f().uuid()}),v({kind:D("GAMEMASTER")}),v({kind:D("HELPING")}),v({kind:D("SUMMARY")}),v({kind:D("EDIT_GAMEROUND"),uuid:f().uuid()})]);const rl=st(["SAVING","IDLE","ERROR"]),il=v({saveState:rl,page:nl,secret:f(),showCreateMessage:Ie(),isDebugging:Ie()});function gn(e){const t=e.searchParams.get("page")??"",n=e.searchParams.get("uuid")??null,i=e.searchParams.get("secret")??"",l=e.searchParams.get("showCreateMessage")==="true",a=e.searchParams.get("debug")==="true",o=il.safeParse({saveState:"IDLE",page:{kind:t.toUpperCase(),uuid:n},secret:i,showCreateMessage:l,isDebugging:a});return o.success?o.data:{saveState:"IDLE",page:{kind:"CHOOSE",uuid:null},secret:i,showCreateMessage:l,isDebugging:a}}function ll(e,t){return e.kind!==t.kind?!1:e.kind==="EDIT_GAMEROUND"&&t.kind==="EDIT_GAMEROUND"||e.kind==="GAME"&&t.kind==="GAME"?e.uuid===t.uuid:!0}const al="2024-08-15T07:45:21.335Z",_e={game:"37831e19-29d6-40bd-b99d-fb91b78aa7f9",slot:"bfcbd156-b703-4664-9944-8936aede8476",slot2:"f58e7242-e1ff-4cfc-a992-ca18dd5207c3",program:"16f387ab-0adf-406b-ba5c-2e4eb200fda8",program2:"11b6b38a-a4d3-40ed-9d4a-d2abcab661a5",program3:"5294bc63-4857-404e-b72d-53ecbd87a27b",program4:"6e9477f1-6dd5-4cd7-b3c3-03085022d967"};function sl(e,t){const n=localStorage.getItem(e);return n===null?t:n}function ol(e,t){localStorage.setItem(e,t)}const cn="SAVE",ul={version:1,init:{name:"John Doe",email:"john@doe.ch",mobile:"+41 66 123 45 67"},lastSaved:al,playing:{wantsUpdates:!1,reservations:[]},master:{games:[{uuid:_e.game,kind:"published",title:"Grolle in der Dunkelheit",system:"Warhammer Fantasy Rollenspiel",description:{short:"Ein kurzes Abenteuer bei dem es um Fantasy, Action und einfaches Rollenspiel geht.",long:"Eine kleine Gruppe wagt sich in die dunklen SchÃ¤chten einer Mine und weiter hinab, um einen mÃ¤chtigen Gegenstand wieder zu erlangen. Wie werden die GefÃ¤hrten auf die Gefahren des Untergrundes reagieren und welche Gefahren lauern in der Finsternis?"},slots:[{uuid:_e.slot,day:"SATURDAY",from:10,to:12},{uuid:_e.slot2,day:"SUNDAY",from:14,to:17}],playerCount:{min:1,max:3},tagNames:["deutsch"]}],wantsHelp:!1},helping:{}};async function dl(){return new Promise(e=>setTimeout(()=>e({kind:"SUCCESS",data:JSON.parse(sl(cn,JSON.stringify(ul)))}),1e3))}async function gl(e,t){return new Promise(n=>setTimeout(()=>(ol(cn,JSON.stringify(e)),n({kind:"SUCCESS",data:t})),1e3))}const cl=[{uuid:_e.program,gamemaster:"Game Master",title:"Grolle in der Dunkelheit",system:"Warhammer Fantasy Rollenspiel",description:{short:"Ein kurzes Abenteuer bei dem es um Fantasy, Action und einfaches Rollenspiel geht.",long:"Eine kleine Gruppe wagt sich in die dunklen SchÃ¤chten einer Mine und weiter hinab, um einen mÃ¤chtigen Gegenstand wieder zu erlangen. Wie werden die GefÃ¤hrten auf die Gefahren des Untergrundes reagieren und welche Gefahren lauern in der Finsternis?"},slot:{day:"SATURDAY",from:10,to:13},playerCount:{min:1,max:3,reserved:0},tags:["ab12jahren"]},{uuid:_e.program2,gamemaster:"Other Game Master",title:"Acrimony",system:"D&D",description:{short:"Ein Lo-Fi Space Western Abenteuer",long:'Ein Lo-Fi Space Western Abenteuer: "Eine frisch formierte Gruppe von KopfgeldjÃ¤gern wird mit einer riskanten Mission betraut: Sie mÃ¼ssen den berÃ¼chtigten Outlaw Jeb "Rusty" Rourke in der abgeschiedenen Grenzstadt aufspÃ¼ren. Bei dieser unbarmherzigen Jagd lernen die Spieler die harte RealitÃ¤t der Kopfgeldjagd kennen, wo jeder Schuss und jede Entscheidung Ã¼ber ihr Schicksal entscheidet.'},slot:{day:"SATURDAY",from:10,to:13},playerCount:{min:2,max:8,reserved:3},tags:["ab12jahren","horror"]},{uuid:_e.program3,gamemaster:"Other Game Master",title:"Acrimony",system:"D&D",description:{short:"Ein Lo-Fi Space Western Abenteuer",long:'Ein Lo-Fi Space Western Abenteuer: "Eine frisch formierte Gruppe von KopfgeldjÃ¤gern wird mit einer riskanten Mission betraut: Sie mÃ¼ssen den berÃ¼chtigten Outlaw Jeb "Rusty" Rourke in der abgeschiedenen Grenzstadt aufspÃ¼ren. Bei dieser unbarmherzigen Jagd lernen die Spieler die harte RealitÃ¤t der Kopfgeldjagd kennen, wo jeder Schuss und jede Entscheidung Ã¼ber ihr Schicksal entscheidet.'},slot:{day:"SATURDAY",from:14,to:18},playerCount:{min:2,max:8,reserved:3},tags:["ab12jahren","horror"]},{uuid:_e.program4,gamemaster:"Some Other Game Master",title:"Solo RPGs",system:"",description:{short:"Wir spielen primÃ¤r das Solo Rollenspiel NoteQuest, werden aber kurz auch noch ein paar andere Solo Rollenspiele miteinander anschauen.",long:""},slot:{day:"SATURDAY",from:14,to:18},playerCount:{min:2,max:4,reserved:3},tags:[]}];async function ml(){return new Promise(e=>setTimeout(()=>e({kind:"SUCCESS",data:cl}),5e3))}const $l={entries:[{uuid:_e.slot,name:"Alice"},{uuid:_e.slot,name:"Bob"}]};async function hl(e){return new Promise(t=>setTimeout(()=>t({entries:$l.entries.filter(n=>e.includes(n.uuid))}),5e3))}var Sl=c("<div aria-atomic=true><!$><!/><!$><!/>"),_l=c("<div class=toast-container aria-live=polite aria-atomic=true>");const[ke,je]=U([]);function bl(e){const t=()=>{const n=["toast"];return e.options.kind!==void 0&&n.push(`toast-${e.options.kind}`),n.join(" ")};return(()=>{var n=u(Sl),i=n.firstChild,[l,a]=d(i.nextSibling),o=l.nextSibling,[g,m]=d(o.nextSibling);return s(n,()=>e.options.message,l,a),s(n,r(E,{get when(){return e.options.dismissable},get children(){return r(ne,{kind:"ghost",get label(){return r(te,{icon:"xmark",classes:["toast-dismiss"]})},get onClick(){return e.dismiss}})}}),g,m),me(h=>{var $=t(),S=e.options.kind==="danger"?"alert":"status",_=e.options.kind==="danger"?"assertive":"polite";return $!==h.e&&Ae(n,h.e=$),S!==h.t&&tt(n,"role",h.t=S),_!==h.a&&tt(n,"aria-live",h.a=_),h},{e:void 0,t:void 0,a:void 0}),n})()}function fl(){function e(t){ke.find(n=>n.uuid===t)?.cleanup(),je(ke.filter(n=>n.uuid!==t))}return(()=>{var t=u(_l);return s(t,r(W,{each:ke,children:n=>r(bl,{options:n,dismiss:()=>e(n.uuid)})})),t})()}function vl(e,t){if(t?.uuid!==void 0&&ke.find(g=>g.uuid===t.uuid)!==void 0)return Et(t.uuid,e,t);const n=t?.uuid??crypto.randomUUID(),i=t?.duration??5e3,l=t?.kind??"gray",a=t?.dismissable,o=setTimeout(()=>{je(ke.filter(g=>g.uuid!==n))},i);return je(ke.length,{uuid:n,kind:l,message:e,duration:i,dismissable:a,cleanup:()=>clearTimeout(o)}),n}function Et(e,t,n){const i=ke.find(m=>m.uuid===e);if(i===void 0)return e;i.cleanup();const l=n.duration??i.duration,a=n.kind??i.kind,o=n?.dismissable??i.dismissable,g=setTimeout(()=>{je(ke.filter(m=>m.uuid!==e))},l);return je(m=>m.uuid===e,{uuid:e,kind:a,message:t,duration:l,dismissable:o,cleanup:()=>clearTimeout(g)}),e}const kl={version:1,init:{name:"",email:"",mobile:""},lastSaved:new Date().toISOString(),playing:{wantsUpdates:!0,reservations:[]},master:{games:[],wantsHelp:!1},helping:{}};async function yl(e){const t=new URL(Ct("/rst25/load"));t.searchParams.append("secret",e);const n=await fetch(t);if(!n.ok)return{kind:"FAILURE"};const i=await n.json();return typeof i=="object"&&i!==null?{kind:"SUCCESS",data:Object.assign(kl,i)}:(console.error("`last_save` not found on ",i),{kind:"FAILURE"})}async function xl(e,t){try{const n=await fetch(Ct("/rst25/save"),{method:"post",body:JSON.stringify({secret:t,save:e}),headers:{"Content-Type":"application/json"}});return n.ok?{kind:"SUCCESS",data:t}:(console.error(await n.text()),{kind:"FAILURE"})}catch(n){return console.error(n),{kind:"FAILURE"}}}async function pl(){try{const e=await fetch(Ct("/rst25/program"),{headers:{"Content-Type":"application/json"}});return e.ok?{kind:"SUCCESS",data:await e.json()}:(console.error(await e.text()),{kind:"FAILURE"})}catch(e){return console.error(e),{kind:"FAILURE"}}}const El=v({name:f(),email:f(),mobile:f()}),Cl=v({name:f(),email:f(),mobile:f()}),Rl=wt([v({kind:D("SELF"),gameRound:f().uuid(),uuid:f().uuid()}),v({kind:D("FRIEND"),gameRound:f().uuid(),name:f(),uuid:f().uuid()})]),wl=v({wantsUpdates:Ie(),reservations:re(Rl)}),Al=wt([v({kind:D("SELF"),gameRound:f().uuid(),uuid:f().uuid()}),v({kind:D("FRIEND"),gameRound:f().uuid(),name:f(),uuid:f().uuid()})]);wt([v({kind:D("SELF"),gameRound:f().uuid()}),v({kind:D("FRIEND"),gameRound:f().uuid(),name:f()})]);const Tl=v({wantsUpdates:Ie(),reservations:re(Al)}),Dl=v({games:re(or),wantsHelp:Ie()}),Ul=v({games:re(an),wantsHelp:Ie()}),Ol=v({}),Nl=v({}),Ml=v({version:D(1),init:El,lastSaved:f(),playing:wl,master:Dl,helping:Ol}),Il=v({version:D(1),init:Cl,lastSaved:Nn.date(),playing:Tl,master:Ul,helping:Nl});async function Pl(e){const t=e==="demo"?await dl():await yl(e);if(t.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE"};const n=Ml.safeParse(t.data);if(!n.success)return console.error(n.error),{kind:"FAILURE"};const i=Ll(n.data);return i.success?{kind:"SUCCESS",data:i.data}:{kind:"FAILURE"}}function Ll(e){return Il.safeParse(e)}const xt=crypto.randomUUID();async function Fl(e,t,n){const[i,l]=U(e);l("saveState","SAVING"),vl("Am Speichern...",{uuid:xt,dismissable:!1});const a=new Date;t.lastSaved=a;const o=Gl(t);try{if((n==="demo"?await gl(o,n):await xl(o,n)).kind==="FAILURE")throw Error("")}catch(g){return l("saveState","ERROR"),console.error(g),Et(xt,"Speichern war nicht mÃ¶glich!",{kind:"danger",duration:1e4,dismissable:!0}),{kind:"FAILURE"}}return Et(xt,`Zuletzt gespeichert um: ${qt(a)} Uhr`,{kind:"success",dismissable:!0}),l("saveState","IDLE"),{kind:"SUCCESS",data:a}}function Gl(e){return{...e,lastSaved:String(e.lastSaved),master:{...e.master,games:e.master.games.map(gr)}}}const Hl=Rn(Fl,1e3);var Bl=c("<div class=tooltip-wrapper><div class=tooltip></div><!$><!/>");function Be(e){return(()=>{var t=u(Bl),n=t.firstChild,i=n.nextSibling,[l,a]=d(i.nextSibling);return s(n,()=>e.tooltip),s(t,()=>e.children,l,a),t})()}var Yl=c("<div class=quickmenu-wrapper><div class=quickmenu><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),zl=c('<div class="quickmenu extended"><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>'),Wl=c("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center;><!$><!/><em>Zuletzt gespeichert um: <!$><!/> Uhr"),jl=c("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center;><!$><!/><em>Am Speichern..."),Zl=c("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center;><!$><!/><em>Speichern war nicht mÃ¶glich!");function Kl(e){return(()=>{var t=u(Yl),n=t.firstChild,i=n.firstChild,[l,a]=d(i.nextSibling),o=l.nextSibling,[g,m]=d(o.nextSibling),h=g.nextSibling,[$,S]=d(h.nextSibling),_=$.nextSibling,[b,k]=d(_.nextSibling),y=b.nextSibling,[p,C]=d(y.nextSibling);return s(n,r(Be,{tooltip:"Zur Ãbersicht",get children(){return r(ne,{get label(){return r(te,{icon:"backward"})},onClick:()=>e.changePage({kind:"CHOOSE"})})}}),l,a),s(n,r(Be,{tooltip:"Zu den Spielrunden",get children(){return r(ne,{get label(){return r(te,{icon:"dice-d20"})},onClick:()=>e.changePage({kind:"PLAYER"})})}}),g,m),s(n,r(Be,{tooltip:"Zu deinen Spielrunden",get children(){return r(ne,{get label(){return r(te,{icon:"grid-2-plus"})},onClick:()=>e.changePage({kind:"GAMEMASTER"})})}}),$,S),s(n,r(Be,{tooltip:"Zum Helferplan",get children(){return r(ne,{get label(){return r(te,{icon:"hand-heart"})},onClick:()=>e.changePage({kind:"HELPING"})})}}),b,k),s(n,r(Be,{tooltip:"Zur Zusammenfassung",get children(){return r(ne,{get label(){return r(te,{icon:"list"})},onClick:()=>e.changePage({kind:"SUMMARY"})})}}),p,C),t})()}function ql(e){return[r(R,{type:"gray",get children(){var t=u(zl),n=t.firstChild,[i,l]=d(n.nextSibling),a=i.nextSibling,[o,g]=d(a.nextSibling),m=o.nextSibling,[h,$]=d(m.nextSibling),S=h.nextSibling,[_,b]=d(S.nextSibling),k=_.nextSibling,[y,p]=d(k.nextSibling);return s(t,r(z,{icon:"backward",label:"Zur Ãbersicht",onClick:()=>e.changePage({kind:"CHOOSE"})}),i,l),s(t,r(z,{icon:"dice-d20",label:"Zu den Spielrunden",onClick:()=>e.changePage({kind:"PLAYER"})}),o,g),s(t,r(z,{icon:"grid-2-plus",label:"Zu deinen Spielrunden",onClick:()=>e.changePage({kind:"GAMEMASTER"})}),h,$),s(t,r(z,{icon:"hand-heart",label:"Zum Helferplan",onClick:()=>e.changePage({kind:"HELPING"})}),_,b),s(t,r(z,{icon:"list",label:"Zur Zusammenfassung",onClick:()=>e.changePage({kind:"SUMMARY"})}),y,p),t}}),r(Vl,{get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}})]}function Vl(e){return r($e,{get children(){return[r(A,{get when(){return e.saveState==="IDLE"},get children(){var t=u(Wl),n=t.firstChild,[i,l]=d(n.nextSibling),a=i.nextSibling,o=a.firstChild,g=o.nextSibling,[m,h]=d(g.nextSibling);return m.nextSibling,s(t,r(te,{icon:"circle-check"}),i,l),s(a,()=>qt(e.lastSaved),m,h),t}}),r(A,{get when(){return e.saveState==="SAVING"},get children(){var t=u(jl),n=t.firstChild,[i,l]=d(n.nextSibling);return i.nextSibling,s(t,r(te,{icon:"floppy-disk-circle-arrow-right"}),i,l),t}}),r(A,{get when(){return e.saveState==="ERROR"},get children(){var t=u(Zl),n=t.firstChild,[i,l]=d(n.nextSibling);return i.nextSibling,s(t,r(te,{icon:"triangle-exclamation"}),i,l),t}})]}})}var Jl=c("<div class=page><!$><!/><div class=page-content><h2></h2><br><!$><!/></div><!$><!/>"),Ql=c("<div class=extended-wrapper style=margin-block-start:1rem;>");function Ne(e){return(()=>{var t=u(Jl),n=t.firstChild,[i,l]=d(n.nextSibling),a=i.nextSibling,o=a.firstChild,g=o.nextSibling,m=g.nextSibling,[h,$]=d(m.nextSibling),S=a.nextSibling,[_,b]=d(S.nextSibling);return s(t,(()=>{var k=O(()=>e.showQuickmenu!==!1);return()=>k()?r(Kl,{get changePage(){return e.changePage},get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}}):null})(),i,l),s(o,()=>e.title),s(a,()=>e.children,h,$),s(t,(()=>{var k=O(()=>e.showQuickmenu!==!1);return()=>k()?(()=>{var y=u(Ql);return s(y,r(ql,{get changePage(){return e.changePage},get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}})),y})():null})(),_,b),t})()}const Xl=v({uuid:f().uuid(),name:f()}),mn=v({entries:re(Xl)}),ea=mn;async function ta(e,t){console.log("loadRegistration still mocked",e.substring(0,4),"...");const n=await hl(t),i=mn.safeParse(n);if(!i.success)return{kind:"FAILURE"};const l=na(i.data);return l.success?{kind:"SUCCESS",data:l.data}:{kind:"FAILURE"}}function na(e){return ea.safeParse(e)}const ra=v({uuid:f().uuid(),title:f(),system:f(),gamemaster:f(),description:v({short:f(),long:f()}),slot:v({day:Tt,from:V(),to:V()}),playerCount:v({min:V(),max:V(),reserved:V()}),tags:re(f())}),ia=re(ra),la=v({uuid:f().uuid(),title:f(),system:f(),gamemaster:f(),description:v({short:f(),long:f()}),slot:v({day:Tt,from:V(),to:V()}),playerCount:v({min:V(),max:V(),reserved:V()}),tags:re(f())}),aa=re(la);async function sa(e){const t=e==="demo"?await ml():await pl();if(t.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE"};const n=ia.safeParse(t.data);if(!n.success)return{kind:"FAILURE"};const i=oa(n.data);return i.success?{kind:"SUCCESS",data:i.data}:{kind:"FAILURE"}}function oa(e){return aa.safeParse(e)}var ua=c("<br>"),Zt=c("<pre>"),da=c("<hr>"),ga=c("<div><code>Registrations (read-only)"),ca=c("<em>loading...");function ma(e){const t=new URL(location.href);t.searchParams.set("page",e.page.kind.toLowerCase()),e.page.kind==="EDIT_GAMEROUND"&&t.searchParams.set("uuid",e.page.uuid),t.searchParams.delete("showCreateMessage"),history.replaceState({page:e},"",t);const n=x.pageTitle[e.page.kind];document.title=x.metaTitle.replace("{}",n)}function $a(e){const[t,n]=U(e.page);return(i,l)=>{if(ll(i,t))return;const a=l?.backButton??!1,o=l?.disableScroll??!1;if(!a){const m=new URL(location.href);m.searchParams.set("page",i.kind.toLowerCase()),i.kind==="EDIT_GAMEROUND"||i.kind==="GAME"?(m.searchParams.set("uuid",i.uuid),n(i)):(m.searchParams.delete("uuid"),n({...i,uuid:null})),history.pushState({page:i},"",m)}const g=x.pageTitle[i.kind];document.title=x.metaTitle.replace("{}",g),o||window.scrollTo({top:0})}}function ha(e){ma(e.meta);const[t,n]=U({meta:e.meta,save:e.save}),i=()=>t.save.master.games.flatMap($=>$.slots.map(S=>S.uuid)),[l]=Qe(i(),$=>ta(t.meta.secret,$)),[a]=Qe(()=>sa(t.meta.secret)),[o,g]=Rt(!1);Qe(()=>JSON.stringify(t.save),async()=>{if(!o()){g(!0);return}const $=Un(t.save);try{const S=await Hl(t.meta,$,t.meta.secret);S.kind==="FAILURE"?console.error(S):n("save","lastSaved",S.data)}catch(S){console.error(S),n("meta","saveState","ERROR")}});const m=$a(t.meta),h=wn();return Jt(()=>{window.addEventListener("popstate",$=>{if(typeof $=="object"&&$!==null&&"state"in $){const S=new URL(location.href),_=gn(S);m(_.page,{backButton:!0})}}),setInterval(async()=>{const $=h.dequeue();$.kind==="NEXT_ELEMENT"&&await $.data()},1e3)}),[r(E,{get when(){return t.meta.showCreateMessage},get children(){return[r(R,{type:"success",get children(){return x.registrationStarted}}),u(ua)]}}),r($e,{get fallback(){return r(Ne,{title:"Wo mÃ¶chtest du starten?",showQuickmenu:!1,changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(ti,{changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get isDebugging(){return t.meta.isDebugging}})}})},get children(){return[r(A,{get when(){return t.meta.page.kind==="PLAYER"||t.meta.page.kind==="GAME"},get children(){return r(Ne,{title:"SpielrundenÃ¼bersicht",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(Yr,{program:a,get reservations(){return t.save.playing.reservations},addReservation:$=>n("save","playing","reservations",t.save.playing.reservations.length,{...$,uuid:crypto.randomUUID()}),removeReservation:$=>{n("save","playing","reservations",t.save.playing.reservations.filter(S=>S.uuid!==$))},get uuid(){return t.meta.page.kind==="GAME"?t.meta.page.uuid:null},changePage:m,get isDebugging(){return t.meta.isDebugging}})}})}}),r(A,{get when(){return t.meta.page.kind==="GAMEMASTER"},get children(){return r(Ne,{title:"Meine Spielrunden",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(fr,{get store(){return t.save.master},changePage:m})}})}}),r(A,{get when(){return t.meta.page.kind==="EDIT_GAMEROUND"},get children(){return r(Ne,{title:"Spielrunde editieren",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(Zi,{get allRounds(){return t.save.master.games},get uuid(){return t.meta.page.kind==="EDIT_GAMEROUND"?t.meta.page.uuid:"should never happen"},get fallback(){return r(R,{type:"danger",get children(){return x.error.gameroundUuidError}})},children:$=>r(Ki,{store:$,registrations:l,queue:h,changePage:m})})}})}}),r(A,{get when(){return t.meta.page.kind==="HELPING"},get children(){return r(Ne,{title:"Helfen",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(lr,{})}})}}),r(A,{get when(){return t.meta.page.kind==="SUMMARY"},get children(){return r(Ne,{title:"Zusammenfassung",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(Xn,{get store(){return t.save},program:a,changePage:m})}})}})]}}),r(E,{get when(){return t.meta.isDebugging},get children(){return[(()=>{var $=u(Zt);return s($,()=>JSON.stringify(t,null,2)),$})(),u(da),u(ga),r(at,{get fallback(){return u(ca)},get children(){return r(E,{get when(){return l()},children:$=>(()=>{var S=u(Zt);return s(S,()=>JSON.stringify($(),null,2)),S})()})}})]}}),r(fl,{})]}function $n(){return r(R,{get children(){return x.loading.registration}})}function xa(){const[e,t]=Rt(null);return Jt(()=>{const n=new URL(location.href);t(gn(n))}),r(E,{get fallback(){return r($n,{})},get when(){return e()},children:n=>r(Sa,{get page(){return n()}})})}function Sa(e){const[t]=Qe(()=>Pl(e.page.secret));return r(Dn,{fallback:n=>(console.error(n),r(R,{type:"danger",get children(){return x.error.general}})),get children(){return r(at,{get fallback(){return r($n,{})},get children(){return r($e,{get children(){return r(A,{get when(){return t()},children:n=>{const{kind:i,value:l}=An(n());return i==="SECRET_INVALID"?r(R,{type:"danger",get children(){return x.error.secretError}}):i==="FAILURE"?(console.error(l),r(R,{type:"danger",get children(){return x.error.ourMistake}})):r(ha,{get meta(){return e.page},get save(){return l.data}})}})}})}})}})}export{xa as MeineAnmeldungWrapper};
