import{b as E,c as N,B as T,I as bn,d as pn,g as we,f as fn,s as Ne,u as vn}from"./utils.B_PVY9pz.js";import{g as o,t as d,a as c,i as l,c as t,m as U,d as yn,S as P,F as G,b as kn,e as xn,r as Cn,f as Q,h as En,M,j as de,k as Ve,l as An,o as wn,n as Ge,p as Tn,E as Rn}from"./web.Do-WnCqr.js";/* empty css                                 */import{T as f,e as Je,C as Nn,d as Dn,o as _,l as W,s as $,b as X,n as F,a as R,c as Mn,f as On}from"./texts.Dsvu2vSt.js";import{c as O,u as In}from"./store.B2957kQY.js";import{T as Pn}from"./Textarea.Cw5Tlkr0.js";var Un=d("<div class=tooltip-wrapper><div class=tooltip></div><!$><!/>");function q(e){return(()=>{var n=o(Un),r=n.firstChild,i=r.nextSibling,[s,a]=c(i.nextSibling);return l(r,()=>e.tooltip),l(n,()=>e.children,s,a),n})()}var Fn=d("<div class=quickmenu-wrapper><div class=quickmenu><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),Gn=d('<div class="quickmenu extended"><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>'),Ln=d("<div class=grid><!$><!/><span>Zur Übersicht"),Hn=d("<div class=grid><!$><!/><span>Zu den Spielrunden"),Yn=d("<div class=grid><!$><!/><span>Zu deinen Spielrunden"),Bn=d("<div class=grid><!$><!/><span>Zum Helferplan"),Wn=d("<div class=grid><!$><!/><span>Zur Zusammenfassung");function zn(e){return(()=>{var n=o(Fn),r=n.firstChild,i=r.firstChild,[s,a]=c(i.nextSibling),u=s.nextSibling,[m,g]=c(u.nextSibling),h=m.nextSibling,[S,y]=c(h.nextSibling),v=S.nextSibling,[p,k]=c(v.nextSibling),D=p.nextSibling,[I,b]=c(D.nextSibling);return l(r,t(q,{tooltip:"Zur Übersicht",get children(){return t(E,{get label(){return t(N,{icon:"backward"})},onClick:()=>e.changePage({kind:"CHOOSE"})})}}),s,a),l(r,t(q,{tooltip:"Zu den Spielrunden",get children(){return t(E,{get label(){return t(N,{icon:"dice-d20"})},onClick:()=>e.changePage({kind:"PLAYER"})})}}),m,g),l(r,t(q,{tooltip:"Zu deinen Spielrunden",get children(){return t(E,{get label(){return t(N,{icon:"grid-2-plus"})},onClick:()=>e.changePage({kind:"GAMEMASTER"})})}}),S,y),l(r,t(q,{tooltip:"Zum Helferplan",get children(){return t(E,{get label(){return t(N,{icon:"hand-heart"})},onClick:()=>e.changePage({kind:"HELPING"})})}}),p,k),l(r,t(q,{tooltip:"Zur Zusammenfassung",get children(){return t(E,{get label(){return t(N,{icon:"list"})},onClick:()=>e.changePage({kind:"SUMMARY"})})}}),I,b),n})()}function Zn(e){return(()=>{var n=o(Gn),r=n.firstChild,[i,s]=c(r.nextSibling),a=i.nextSibling,[u,m]=c(a.nextSibling),g=u.nextSibling,[h,S]=c(g.nextSibling),y=h.nextSibling,[v,p]=c(y.nextSibling),k=v.nextSibling,[D,I]=c(k.nextSibling);return l(n,t(E,{get label(){return(()=>{var b=o(Ln),w=b.firstChild,[x,A]=c(w.nextSibling);return x.nextSibling,l(b,t(N,{icon:"backward"}),x,A),b})()},onClick:()=>e.changePage({kind:"CHOOSE"})}),i,s),l(n,t(E,{get label(){return(()=>{var b=o(Hn),w=b.firstChild,[x,A]=c(w.nextSibling);return x.nextSibling,l(b,t(N,{icon:"dice-d20"}),x,A),b})()},onClick:()=>e.changePage({kind:"PLAYER"})}),u,m),l(n,t(E,{get label(){return(()=>{var b=o(Yn),w=b.firstChild,[x,A]=c(w.nextSibling);return x.nextSibling,l(b,t(N,{icon:"grid-2-plus"}),x,A),b})()},onClick:()=>e.changePage({kind:"GAMEMASTER"})}),h,S),l(n,t(E,{get label(){return(()=>{var b=o(Bn),w=b.firstChild,[x,A]=c(w.nextSibling);return x.nextSibling,l(b,t(N,{icon:"hand-heart"}),x,A),b})()},onClick:()=>e.changePage({kind:"HELPING"})}),v,p),l(n,t(E,{get label(){return(()=>{var b=o(Wn),w=b.firstChild,[x,A]=c(w.nextSibling);return x.nextSibling,l(b,t(N,{icon:"list"}),x,A),b})()},onClick:()=>e.changePage({kind:"SUMMARY"})}),D,I),n})()}var jn=d("<div class=page><!$><!/><div class=page-content><h2></h2><br><!$><!/></div><!$><!/>");function B(e){return(()=>{var n=o(jn),r=n.firstChild,[i,s]=c(r.nextSibling),a=i.nextSibling,u=a.firstChild,m=u.nextSibling,g=m.nextSibling,[h,S]=c(g.nextSibling),y=a.nextSibling,[v,p]=c(y.nextSibling);return l(n,(()=>{var k=U(()=>e.showQuickmenu!==!1);return()=>k()?t(zn,{get changePage(){return e.changePage}}):null})(),i,s),l(u,()=>e.title),l(a,()=>e.children,h,S),l(n,(()=>{var k=U(()=>e.showQuickmenu!==!1);return()=>k()?t(Zn,{get changePage(){return e.changePage}}):null})(),v,p),n})()}var Kn=d("<pre><code>Noch nicht implementiert");function qn(e){return t(B,{title:"Zusammenfassung",get changePage(){return e.changePage},get children(){return o(Kn)}})}var Vn=d("<pre><code>Noch nicht implementiert");function Jn(e){return t(B,{title:"Helfen",get changePage(){return e.changePage},get children(){return o(Vn)}})}var Qn=d("<div class=grid><!$><!/><div>"),Xn=d("<div class=boxLink>");function J(e){const n=e.type??"special";return(()=>{var r=o(Xn);return l(r,t(T,{type:n,get onClick(){return e.onClick},get children(){var i=o(Qn),s=i.firstChild,[a,u]=c(s.nextSibling),m=a.nextSibling;return l(i,t(N,{get icon(){return e.icon}}),a,u),l(m,()=>e.children),i}})),r})()}const Qe=[{name:"ab6jahren",label:"Ab 6 Jahren",description:"Spannungs- und Bedrohungsmomente werden kurz gehalten. In Begleitung oder nach Absprache mit einem Elternteil. Beispiele: My Little Pony, ..."},{name:"ab12jahren",label:"Ab 12 Jahren",description:"Antisoziales und destruktives wird auf ein Minimum begrenzt. Keine Diskriminierung, keine Radikalisierung, Sexualität wird nicht explizit dargestellt."},{name:"ab18jahren",label:"Ab 18 Jahren",description:"Keinerlei Richtlinien bezüglich Inhalt, in der Gruppe sollte aber diskutiert werden, was akzeptabel ist und was nicht. Beispiele: Vampire the Masquerade, ..."},{name:"fantasy",label:"Fantasy",description:"Spielt in einer alternativen Vergangenheit, in welcher Elemente wie: Ritterinnen, Hexenmeister, Rüstungen, Magie, Goblins, Turniere usw. vorkommen können. Beispiele: Das Schwarze Auge, Dungeons & Dragons, ..."},{name:"sciencefiction",label:"Science Fiction",description:"Spielt in einer alternativen Zukunft, in welcher Elemente wie: Raumschiffe, Sternenportale, Künstliche Intelligenzen, Laserkanonen usw. vorkommen können. Beispiele: Shadowrun, Alien, ..."},{name:"postapokalyptisch",label:"Postapokalyptisch",description:"Spielt in einer Welt mitten oder nach einem Kollaps, wo nur ein grosser Teil der Gesellschaft ums Überleben kämpft. Beispiele: Mutant Year Zero, Apocalypse World"},{name:"offenewelt",label:"Offene Welt",description:"Es gibt nur einen losen Handlungsfaden, die Rollenspiel-Gruppe muss sich ihre Ziele selber festlegen. Beispiele: Ironsworn, Blades in the Dark, ..."},{name:"gemeinsamespielleitung",label:"Gemeinsame Spielleitung",description:"Die Regeln und die Umwelt werden gemeinsam von allen Spielenden umgesetzt. Beispiele: Microscope, The Quiet Year, ..."},{name:"regelleicht",label:"Regelleicht",description:"Die kompletten Regeln haben alle auf einer Seite Platz. Beispiele: Fiasco, Everyone is John, ..."},{name:"deutsch",label:"Deutsch",description:"Bei der Spielrunde reden die Spielenden miteinander Deutsch."},{name:"englisch",label:"Englisch",description:"Bei der Spielrunde reden die Spielenden miteinander Englisch."}],De=200,Me=500;function Oe(e){const n=e.title.value.trim().length===0,r=e.description.short.value.trim().length===0,i=e.description.short.value.length>De,s=e.description.long.value.length>Me,a=e.slots.length===0;return{titleMissing:n,descriptionShortMissing:r,descriptionShortTooLong:i,descriptionLongTooLong:s,slotMissing:a,hasErrors:n||r||i||s||a}}var et=d("<h3>"),nt=d("<div style=margin-top:2rem;><h3 style=margin-bottom:1rem;></h3><ul class=event-list role=list>"),tt=d('<li><h1 class=event-title><!$><!/><!$><!/></h1><div class=event-details><div class=event-tags><strong>System:</strong><!$><!/></div><div class=event-tags><strong>Tag, Zeit:</strong><!$><!/></div><div class=event-tags><strong>Spielende:</strong> <!$><!/> - <!$><!/></div> <div class=event-tags><strong>Kategorien:</strong> <!$><!/></div></div><div class="event-description content"><p><strong>Kurzbeschreibung:</strong><br><!$><!/></p></div><ul role=list class=event-links><li><button class=event-link><span>Bearbeiten'),rt=d("<em>[<!$><!/>] "),V=d("<em>"),it=d("<span><!$><!/>, <!$><!/> - <!$><!/> Uhr");function lt(e){return t(B,{title:"Meine Spielrunden",get changePage(){return e.changePage},get children(){return[t(J,{icon:"grid-2-plus",type:"success",onClick:()=>e.changePage({kind:"NEW_GAMEROUND"}),get children(){var n=o(et);return l(n,()=>f.createNewGameRound),n}}),t(P,{get when(){return e.store.games},children:n=>(()=>{var r=o(nt),i=r.firstChild,s=i.nextSibling;return l(i,()=>f.myGameRounds),l(s,t(G,{get each(){return n()},children:a=>{const u=a.tagNames.map(g=>Qe.find(({name:h})=>h===g)).filter(g=>g!==void 0).map(({label:g})=>g),m=at(a);return t(G,{get each(){return a.slots},get fallback(){return t(Le,{game:a,slot:null,tags:u,isDraft:m,get changePage(){return e.changePage}})},children:g=>t(Le,{game:a,slot:g,tags:u,isDraft:m,get changePage(){return e.changePage}})})}})),r})()})]}})}function Le(e){const{game:n,slot:r,isDraft:i,tags:s,changePage:a}=e;return(()=>{var u=o(tt),m=u.firstChild,g=m.firstChild,[h,S]=c(g.nextSibling),y=h.nextSibling,[v,p]=c(y.nextSibling),k=m.nextSibling,D=k.firstChild,I=D.firstChild,b=I.nextSibling,[w,x]=c(b.nextSibling),A=D.nextSibling,Y=A.firstChild,he=Y.nextSibling,[z,$e]=c(he.nextSibling),Z=A.nextSibling,ne=Z.firstChild,_e=ne.nextSibling,Se=_e.nextSibling,[te,be]=c(Se.nextSibling),j=te.nextSibling,pe=j.nextSibling,[fe,ve]=c(pe.nextSibling),ye=Z.nextSibling,re=ye.nextSibling,ie=re.firstChild,ke=ie.nextSibling,K=ke.nextSibling,[xe,le]=c(K.nextSibling),ae=k.nextSibling,se=ae.firstChild,Ce=se.firstChild,Ee=Ce.nextSibling,oe=Ee.nextSibling,[on,cn]=c(oe.nextSibling),un=ae.nextSibling,gn=un.firstChild,dn=gn.firstChild;return l(m,i?(()=>{var C=o(rt),L=C.firstChild,ce=L.nextSibling,[ue,Ae]=c(ce.nextSibling);return ue.nextSibling,l(C,()=>f.draft,ue,Ae),C})():"",h,S),l(m,(()=>{var C=U(()=>n.title.value.length>0);return()=>C()?n.title.value:(()=>{var L=o(V);return l(L,()=>f.missingTitle),L})()})(),v,p),l(D,()=>n.system.value||(()=>{var C=o(V);return l(C,()=>f.missingSystem),C})(),w,x),l(A,r!==null?(()=>{var C=o(it),L=C.firstChild,[ce,ue]=c(L.nextSibling),Ae=ce.nextSibling,mn=Ae.nextSibling,[Ue,hn]=c(mn.nextSibling),$n=Ue.nextSibling,_n=$n.nextSibling,[Fe,Sn]=c(_n.nextSibling);return Fe.nextSibling,l(C,()=>f.days[r.day],ce,ue),l(C,()=>r.from,Ue,hn),l(C,()=>r.to,Fe,Sn),C})():(()=>{var C=o(V);return l(C,()=>f.missingSlot),C})(),z,$e),l(Z,()=>n.playerCount.min.value,te,be),l(Z,()=>n.playerCount.max.value,fe,ve),l(re,()=>s.join(", ")||(()=>{var C=o(V);return l(C,()=>f.missingTags),C})(),xe,le),l(se,(()=>{var C=U(()=>n.description.short.value.length>0);return()=>C()?n.description.short.value:(()=>{var L=o(V);return l(L,()=>f.missingShortDescription),L})()})(),on,cn),dn.$$click=()=>a({kind:"EDIT_GAMEROUND",uuid:n.uuid}),kn(()=>xn(u,["event-entry",i?"gray":""].join(" "))),Cn(),u})()}function at(e){return e.title.value.trim().length===0||e.description.short.value.trim().length===0||e.description.short.value.length>De||e.description.long.value.length>Me||e.slots.length===0}yn(["click"]);var st=d("<pre><code>Noch nicht implementiert");function ot(e){return t(B,{title:"Spielrundenübersicht",get changePage(){return e.changePage},get children(){return o(st)}})}var ct=d("<h3>Spielrunden ansehen"),ut=d("<p>Melde dich (und deine Freunde) für diverse Spielrunden an."),Te=d("<br>"),gt=d("<h3>Spielrunden erstellen"),dt=d("<p>Falls du wenig oder gar keine Erfahrung als Spielleiter:in hast, werden wir dich vor und während dem Anlass unterstützen."),mt=d("<h3>Helfen"),ht=d("<p>Beim Kiosk und der Essensausgabe können wir immer ein paar helfende Hände gebrauchen."),$t=d("<h3>Zusammenfassung"),_t=d("<p>Erhalte einen Überblick über dein gesamtes Programm.");function St(e){return t(B,{title:"Wo möchtest du starten?",showQuickmenu:!1,get changePage(){return e.changePage},get children(){return[t(J,{icon:"dice-d20",onClick:()=>e.changePage({kind:"PLAYER"}),get children(){return[o(ct),o(ut)]}}),o(Te),t(J,{icon:"grid-2-plus",onClick:()=>e.changePage({kind:"GAMEMASTER"}),get children(){return[o(gt),o(dt)]}}),o(Te),t(J,{icon:"hand-heart",onClick:()=>e.changePage({kind:"HELPING"}),get children(){return[o(mt),o(ht)]}}),o(Te),t(J,{icon:"list",onClick:()=>e.changePage({kind:"SUMMARY"}),get children(){return[o($t),o(_t)]}})]}})}Je(["SATURDAY","SUNDAY"]);function He(e,n=!1){const{from:r,to:i}=e;if(r>i)return[];const s=i-r;return[...Array(n?s+1:s)].map((a,u)=>u+r)}const bt={SATURDAY:{open:{from:10,to:24},breaks:[{from:13,to:14},{from:18,to:19}]},SUNDAY:{open:{from:10,to:18},breaks:[{from:13,to:14}]}};var Ie=d("<p>");function Ye(e){const[n,r]=O(e.store),i=()=>n.isDirty?e.errors??[]:[];return[t(bn,{get label(){return e.label},get name(){return e.name},get value(){return n.value},onValueUpdate:s=>r("value",s),onBlur:()=>r("isDirty",!0),get type(){return e.type},get required(){return e.required},get isHoneypot(){return e.isHoneypot}}),t(P,{get when(){return i().length>0},get children(){return t(T,{type:"danger",get children(){return t(G,{get each(){return i()},children:s=>(()=>{var a=o(Ie);return l(a,s),a})()})}})}})]}function Be(e){const[n,r]=O(e.store),i=()=>n.isDirty?e.errors??[]:[];return[t(pn,{get label(){return e.label},get name(){return e.name},get value(){return n.value},onValueUpdate:s=>r("value",s),onBlur:()=>r("isDirty",!0),get required(){return e.required},get isHoneypot(){return e.isHoneypot},get min(){return e.min},get max(){return e.max}}),t(P,{get when(){return i().length>0},get children(){return t(T,{type:"danger",get children(){return t(G,{get each(){return i()},children:s=>(()=>{var a=o(Ie);return l(a,s),a})()})}})}})]}function We(e){const[n,r]=O(e.store),i=()=>n.isDirty?e.errors??[]:[];return[t(Pn,{get label(){return e.label},get name(){return e.name},get value(){return n.value},onValueUpdate:s=>r("value",s),onBlur:()=>r("isDirty",!0),get required(){return e.required},get size(){return e.size}}),t(P,{get when(){return i().length>0},get children(){return t(T,{type:"danger",get children(){return t(G,{get each(){return i()},children:s=>(()=>{var a=o(Ie);return l(a,s),a})()})}})}})]}var ze=d("<br>"),pt=d("<h4>Spielrunde inkomplett"),ft=d("<div style=margin-top:1rem;display:flex;justify-content:flex-end;>"),vt=d('<form novalidate><!$><!/><!$><!/><div style="display:grid;grid-template-columns:repeat(2, 1fr);gap:1rem;"><!$><!/><!$><!/></div><!$><!/><!$><!/><fieldset><legend>Zeitslots</legend><!$><!/><!$><!/></fieldset><fieldset><legend>Kategorien (optional)</legend><!$><!/></fieldset><!$><!/><div style=display:flex;flex-wrap:wrap;gap:1rem;justify-content:space-between;><!$><!/><!$><!/>'),yt=d("<div style=display:grid;gap:0.5rem;margin-block-end:1rem;>"),kt=d("<h6>Samstag, 23. August 2025"),Ze=d("<div style=display:flex;flex-wrap:wrap;gap:0.5rem;>"),xt=d("<h6>Sonntag, 24. August 2025"),je=d("<div style=display:flex;flex-wrap:wrap;gap:0.5rem;align-items:center;><span>von <!$><!/> bis <!$><!/> Uhr</span><!$><!/>"),Ct=d("<div style=display:grid;gap:0.5rem;>"),Et=d("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/>"),At=d("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/><!$><!/>"),wt=d("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/><!$><!/><div style=margin-block-start:1rem;>"),Tt=d("<div style=display:flex;flex-wrap:wrap;gap:0.5rem;align-items:center;><!$><!/> <span>Neuen Slot erfassen"),Rt=d("<em>Wähle eine Tag:"),Nt=d("<div style=display:flex;flex-wrap:wrap;gap:.5rem;><!$><!/><!$><!/>"),Dt=d("<em>Wähle eine Startzeit:"),Xe=d("<div style=display:flex;flex-wrap:wrap;gap:.5rem;>"),en=d("<span style=white-space:nowrap;><!$><!/> Uhr"),Mt=d("<em>Wähle eine Endzeit:");function nn(e){const[n]=O(e.store),r=Q(()=>Oe(n));return(()=>{var i=o(vt),s=i.firstChild,[a,u]=c(s.nextSibling),m=a.nextSibling,[g,h]=c(m.nextSibling),S=g.nextSibling,y=S.firstChild,[v,p]=c(y.nextSibling),k=v.nextSibling,[D,I]=c(k.nextSibling),b=S.nextSibling,[w,x]=c(b.nextSibling),A=w.nextSibling,[Y,he]=c(A.nextSibling),z=Y.nextSibling,$e=z.firstChild,Z=$e.nextSibling,[ne,_e]=c(Z.nextSibling),Se=ne.nextSibling,[te,be]=c(Se.nextSibling),j=z.nextSibling,pe=j.firstChild,fe=pe.nextSibling,[ve,ye]=c(fe.nextSibling),re=j.nextSibling,[ie,ke]=c(re.nextSibling),K=ie.nextSibling,xe=K.firstChild,[le,ae]=c(xe.nextSibling),se=le.nextSibling,[Ce,Ee]=c(se.nextSibling);return En(i,"submit",e.onSubmit),l(i,t(Ye,{get store(){return n.title},label:"Titel",name:"title",get errors(){return r().titleMissing?[f.mandatoryField]:[]}}),a,u),l(i,t(Ye,{get store(){return n.system},label:"System (optional)",name:"System"}),g,h),l(S,t(Be,{get store(){return n.playerCount.min},label:"Anzahl Mitspielende (Minimum)",name:"playerCountMin",min:1,get max(){return n.playerCount.max.value}}),v,p),l(S,t(Be,{get store(){return n.playerCount.max},label:"Anzahl Mitspielende (Maximum)",name:"playerCountMax",get min(){return n.playerCount.min.value}}),D,I),l(i,t(We,{get store(){return n.description.short},label:"kurze Beschreibung",name:"descriptionShort",size:"sm",get errors(){return U(()=>!!r().descriptionShortMissing)()?[f.mandatoryField]:U(()=>!!r().descriptionShortTooLong)()?[f.charLimitBy.replace("{}",String(De))]:[]}}),w,x),l(i,t(We,{get store(){return n.description.long},label:"lange Beschreibung (optional)",name:"descriptionLong",get errors(){return U(()=>!!r().descriptionLongTooLong)()?[f.charLimitBy.replace("{}",String(Me))]:[]}}),Y,he),l(z,t(Ut,{get store(){return e.store.slots}}),ne,_e),l(z,t(P,{get when(){return r().slotMissing},get children(){return[o(ze),o(ze),t(T,{type:"danger",children:"Wähle mindestens einen Zeitslot aus."})]}}),te,be),l(j,t(Ot,{get store(){return n.tagNames}}),ve,ye),l(i,t(P,{get when(){return r().hasErrors},get children(){return t(T,{type:"danger",get children(){return[o(pt),"Du hast noch einen oder mehre Fehler/fehlende Informationen in dieser Spielrunde (siehe oben). Du kannst die Spielrunde als Entwurf speichern und später vervollständigen. Die Spielrunde wird erst veröffentlicht, wenn alle Informationen komplett sind.",(()=>{var oe=o(ft);return l(oe,t(E,{kind:"success",label:"Spielrunde als Entwurf speichern",get onClick(){return e.onSubmit}})),oe})()]}})}}),ie,ke),l(K,t(E,{kind:"danger",label:"Abbrechen",onClick:()=>e.onCancel()}),le,ae),l(K,t(E,{type:"submit",get kind(){return r().hasErrors?"gray":"success"},get disabled(){return r().hasErrors},label:"Spielrunde erstellen"}),Ce,Ee),i})()}function Ot(e){const[n,r]=O(e.store);return[(()=>{var i=o(yt);return l(i,t(G,{each:Qe,children:s=>t(Nn,{get label(){return s.label},get description(){return s.description},get checked(){return n.includes(s.name)},get name(){return s.name},get value(){return s.name},onValueUpdate:a=>{r(a?n.concat([s.name]):n.filter(u=>u!==s.name))}})})),i})(),t(T,{get children(){return f.tagIdeas}})]}const Ke=1;function It(e){function n(r){const i=He(r.open,!0);return r.breaks.map(a=>He(a,!0)).reduce((a,u)=>{const m=u.at(0),g=u.at(-1);if(m===void 0||g===void 0)return a;const h=[];return a.forEach(S=>{const y=[],v=[];S.forEach(p=>{p<=m&&y.push(p),g<=p&&v.push(p)}),y.length>0&&h.push(y),v.length>0&&h.push(v)}),h},[i]).map(a=>{const u=a.slice(0,Ke*-1);return fn(u.map(m=>{const g=a.filter(h=>h>=m+Ke);return[m,g]}))}).reduce((a,u)=>({...a,...u}),{})}return{SATURDAY:n(e.SATURDAY),SUNDAY:n(e.SUNDAY)}}function Pt(e){const{SATURDAY:n,SUNDAY:r}=Object.groupBy(e,i=>i.day);return{SATURDAY:n??[],SUNDAY:r??[]}}function Ut(e){const[n,r]=O(e.store),i=Q(()=>It(bt)),s=Q(()=>Pt(n));function a(m){r(n.concat(m))}function u(m){r(n.filter(g=>g.from!==m.from||g.to!==m.to||g.day!==m.day))}return[t(Ft,{get daySections(){return i()},chooseTimeSlot:a}),t(P,{get when(){return s().SATURDAY.length>0},get children(){return[o(kt),(()=>{var m=o(Ze);return l(m,t(G,{get each(){return s().SATURDAY},children:g=>t(E,{get label(){return(()=>{var h=o(je),S=h.firstChild,y=S.firstChild,v=y.nextSibling,[p,k]=c(v.nextSibling),D=p.nextSibling,I=D.nextSibling,[b,w]=c(I.nextSibling);b.nextSibling;var x=S.nextSibling,[A,Y]=c(x.nextSibling);return l(S,()=>g.from,p,k),l(S,()=>g.to,b,w),l(h,t(N,{icon:"trash",style:"color: var(--clr-danger-11);"}),A,Y),h})()},kind:"gray",onClick:()=>u({day:"SATURDAY",from:g.from,to:g.to})})})),m})()]}}),t(P,{get when(){return s().SUNDAY.length>0},get children(){return[o(xt),(()=>{var m=o(Ze);return l(m,t(G,{get each(){return s().SUNDAY},children:g=>t(E,{get label(){return(()=>{var h=o(je),S=h.firstChild,y=S.firstChild,v=y.nextSibling,[p,k]=c(v.nextSibling),D=p.nextSibling,I=D.nextSibling,[b,w]=c(I.nextSibling);b.nextSibling;var x=S.nextSibling,[A,Y]=c(x.nextSibling);return l(S,()=>g.from,p,k),l(S,()=>g.to,b,w),l(h,t(N,{icon:"trash",style:"color: var(--clr-danger-11);"}),A,Y),h})()},kind:"gray",onClick:()=>u({day:"SUNDAY",from:g.from,to:g.to})})})),m})()]}})]}function Ft(e){const[n,r]=O({kind:"INITIAL"});return t(de,{get children(){return[t(M,{get when(){return n.kind==="INITIAL"},get children(){return t(E,{kind:"success",get label(){return(()=>{var i=o(Tt),s=i.firstChild,[a,u]=c(s.nextSibling);return a.nextSibling,l(i,t(N,{icon:"circle-plus"}),a,u),i})()},onClick:()=>r({kind:"CHOOSE_DAY"})})}}),t(M,{get when(){return n.kind==="CHOOSE_DAY"},get children(){return t(T,{onClose:()=>r({kind:"INITIAL"}),get children(){var i=o(Ct);return l(i,t(ge,{changeDay:s=>r({kind:"CHOOSE_START",day:s})})),i}})}}),t(M,{get when(){return n.kind==="CHOOSE_START"},get children(){return t(T,{onClose:()=>r({kind:"INITIAL"}),get children(){var i=o(Et),s=i.firstChild,[a,u]=c(s.nextSibling),m=a.nextSibling,[g,h]=c(m.nextSibling);return l(i,t(ge,{get chosenDay(){return n.kind==="CHOOSE_START"?n.day:void 0},changeDay:S=>r({kind:"CHOOSE_START",day:S})}),a,u),l(i,t(Re,{get startTimes(){return U(()=>n.kind==="CHOOSE_START")()?we(e.daySections[n.day]):[]},changeStart:S=>r({kind:"CHOOSE_END",start:S})}),g,h),i}})}}),t(M,{get when(){return n.kind==="CHOOSE_END"},get children(){return t(T,{onClose:()=>r({kind:"INITIAL"}),get children(){var i=o(At),s=i.firstChild,[a,u]=c(s.nextSibling),m=a.nextSibling,[g,h]=c(m.nextSibling),S=g.nextSibling,[y,v]=c(S.nextSibling);return l(i,t(ge,{get chosenDay(){return n.kind==="CHOOSE_END"?n.day:void 0},changeDay:p=>r({kind:"CHOOSE_START",day:p})}),a,u),l(i,t(Re,{get chosenStart(){return n.kind==="CHOOSE_END"?n.start:void 0},get startTimes(){return U(()=>n.kind==="CHOOSE_END")()?we(e.daySections[n.day]):[]},changeStart:p=>r({kind:"CHOOSE_END",start:p})}),g,h),l(i,t(qe,{get endTimes(){return n.kind==="CHOOSE_END"?e.daySections[n.day][n.start]??[]:[]},changeEnd:p=>{n.kind==="CHOOSE_END"&&r({kind:"WAIT_FOR_CONFIRMATION",day:n.day,start:n.start,end:p})}}),y,v),i}})}}),t(M,{get when(){return n.kind==="WAIT_FOR_CONFIRMATION"},get children(){return t(T,{onClose:()=>r({kind:"INITIAL"}),get children(){var i=o(wt),s=i.firstChild,[a,u]=c(s.nextSibling),m=a.nextSibling,[g,h]=c(m.nextSibling),S=g.nextSibling,[y,v]=c(S.nextSibling),p=y.nextSibling;return l(i,t(ge,{get chosenDay(){return n.kind==="WAIT_FOR_CONFIRMATION"?n.day:void 0},changeDay:k=>r({kind:"CHOOSE_START",day:k})}),a,u),l(i,t(Re,{get chosenStart(){return n.kind==="WAIT_FOR_CONFIRMATION"?n.start:void 0},get startTimes(){return U(()=>n.kind==="WAIT_FOR_CONFIRMATION")()?we(e.daySections[n.day]):[]},changeStart:k=>r({kind:"CHOOSE_END",start:k})}),g,h),l(i,t(qe,{get chosenEnd(){return n.kind==="WAIT_FOR_CONFIRMATION"?n.end:void 0},get endTimes(){return n.kind==="WAIT_FOR_CONFIRMATION"?e.daySections[n.day][n.start]??[]:[]},changeEnd:k=>{n.kind==="WAIT_FOR_CONFIRMATION"&&r({kind:"WAIT_FOR_CONFIRMATION",day:n.day,start:n.start,end:k})}}),y,v),l(p,t(E,{get label(){return`Slot "${n.kind==="WAIT_FOR_CONFIRMATION"?`${f.days[n.day]}, von ${n.start} bis ${n.end} Uhr`:""}" erstellen`},kind:"success",onClick:()=>{n.kind==="WAIT_FOR_CONFIRMATION"&&(e.chooseTimeSlot({day:n.day,from:n.start,to:n.end}),r({kind:"INITIAL"}))}})),i}})}})]}})}function ge(e){return[o(Rt),(()=>{var n=o(Nt),r=n.firstChild,[i,s]=c(r.nextSibling),a=i.nextSibling,[u,m]=c(a.nextSibling);return l(n,t(E,{get kind(){return e.chosenDay==="SATURDAY"?"success":"gray"},label:"Samstag",onClick:()=>e.changeDay("SATURDAY")}),i,s),l(n,t(E,{get kind(){return e.chosenDay==="SUNDAY"?"success":"gray"},label:"Sonntag",onClick:()=>e.changeDay("SUNDAY")}),u,m),n})()]}function Re(e){return[o(Dt),(()=>{var n=o(Xe);return l(n,t(G,{get each(){return e.startTimes},children:r=>t(E,{get kind(){return e.chosenStart===r?"success":"gray"},get label(){return(()=>{var i=o(en),s=i.firstChild,[a,u]=c(s.nextSibling);return a.nextSibling,l(i,r,a,u),i})()},onClick:()=>e.changeStart(r)})})),n})()]}function qe(e){return[o(Mt),(()=>{var n=o(Xe);return l(n,t(G,{get each(){return e.endTimes},children:r=>t(E,{get kind(){return e.chosenEnd===r?"success":"gray"},get label(){return(()=>{var i=o(en),s=i.firstChild,[a,u]=c(s.nextSibling);return a.nextSibling,l(i,r,a,u),i})()},onClick:()=>e.changeEnd(r)})})),n})()]}function Gt(e){const[n,r]=O(e.store),i=Q(()=>Oe(n));function s(a){a.preventDefault();const[u,m]=[n.playerCount.min.value,n.playerCount.max.value].map(g=>Math.max(1,g)).toSorted((g,h)=>g-h);Ve(()=>{r("playerCount","min","value",u??1),r("playerCount","max","value",m??1)}),!i().hasErrors&&(e.createNewGame(),e.changePage({kind:"GAMEMASTER"}))}return t(B,{title:"Neue Spielrunde erfassen",get changePage(){return e.changePage},get children(){return t(nn,{get store(){return e.store},onSubmit:s,onCancel:()=>{e.changePage({kind:"GAMEMASTER"})}})}})}function Lt(e){const n=e.allRounds.find(r=>r.uuid===e.uuid);return t(P,{get fallback(){return e.fallback},when:n,children:r=>e.children(r())})}function Ht(e){const[n,r]=O(e.store),i=Q(()=>Oe(n));function s(a){a.preventDefault();const[u,m]=[n.playerCount.min.value,n.playerCount.max.value].map(g=>Math.max(1,g)).toSorted((g,h)=>g-h);Ve(()=>{r("playerCount","min","value",u??1),r("playerCount","max","value",m??1)}),!i().hasErrors&&e.changePage({kind:"GAMEMASTER"})}return t(B,{title:"Spielrunde editieren",get changePage(){return e.changePage},get children(){return t(nn,{get store(){return e.store},onSubmit:s,onCancel:()=>{e.changePage({kind:"GAMEMASTER"})}})}})}const Yt=Dn("kind",[_({kind:W("CHOOSE")}),_({kind:W("PLAYER")}),_({kind:W("GAMEMASTER")}),_({kind:W("NEW_GAMEROUND")}),_({kind:W("HELPING")}),_({kind:W("SUMMARY")}),_({kind:W("EDIT_GAMEROUND"),uuid:$().uuid()})]),Bt=_({page:Yt,secret:$(),showCreateMessage:X()});function tn(e){const n=e.searchParams.get("page")??"",r=e.searchParams.get("uuid")??void 0,i=e.searchParams.get("secret")??"",s=e.searchParams.get("showCreateMessage")==="true",a=Bt.safeParse({page:{kind:n.toUpperCase(),uuid:r},secret:i,showCreateMessage:s});return a.success?a.data:{page:{kind:"CHOOSE"},secret:i,showCreateMessage:s}}function Wt(e,n){return e.kind!==n.kind?!1:e.kind!=="EDIT_GAMEROUND"||n.kind!=="EDIT_GAMEROUND"?!0:e.uuid===n.uuid}const zt=Je(["SATURDAY","SUNDAY"]),ee=_({day:zt,from:F(),to:F()}).refine(e=>e.from<e.to,{message:"A TimeSlot can't end before it starts."});_({name:$(),label:$(),description:$()});const H=$().transform(e=>({value:e,isDirty:!1})),me=F().transform(e=>({value:e,isDirty:!1})),Zt=_({uuid:$().uuid(),title:$(),system:$(),description:_({short:$(),long:$()}),slots:R(ee),playerCount:_({min:F().min(1),max:F()}).transform(e=>{const[n,r]=Ne([e.min,e.max]);return{min:n,max:r}}),playerNames:R($()),tagNames:R($())}),jt=_({uuid:$().uuid(),title:H,system:H,description:_({short:H,long:H}),slots:R(ee),playerCount:_({min:me,max:me}),playerNames:R(H),tagNames:R($())}),Kt=_({title:$(),system:$(),description:_({short:$(),long:$()}),slots:R(ee),playerCount:_({min:F().min(1),max:F()}).transform(e=>{const[n,r]=Ne([e.min,e.max]);return{min:n,max:r}}),tagNames:R($())}),rn=_({title:H,system:H,description:_({short:H,long:H}),slots:R(ee),playerCount:_({min:me,max:me}),tagNames:R($())});function qt(e){return rn.parse(e)}function Pe(){return{title:"",system:"",description:{short:"",long:""},slots:[],playerCount:{min:3,max:4},tagNames:[]}}function Vt(){return qt(Pe())}const Jt="2024-08-15T07:45:21.335Z",Qt="SAVE",Xt={uuid:crypto.randomUUID(),name:"John Doe",email:"john@doe.ch",mobile:"+41 66 123 45 67",lastSaved:Jt,playing:{wantsUpdates:!1},master:{games:[{uuid:crypto.randomUUID(),title:"Grolle in der Dunkelheit",system:"Warhammer Fantasy Rollenspiel",description:{short:"Ein kurzes Abenteuer bei dem es um Fantasy, Action und einfaches Rollenspiel geht.",long:"Eine kleine Gruppe wagt sich in die dunklen Schächten einer Mine und weiter hinab, um einen mächtigen Gegenstand wieder zu erlangen. Wie werden die Gefährten auf die Gefahren des Untergrundes reagieren und welche Gefahren lauern in der Finsternis?"},slots:[],playerCount:{min:1,max:3},playerNames:[],tagNames:["deutsch"]}],newEditForm:Pe(),wantsHelp:!1},helping:{}};async function er(){return Promise.resolve(ln(Qt,Xt))}const nr="PROGRAM",tr={entries:[{uuid:crypto.randomUUID(),gamemaster:"Mike Hunziker",title:"Grolle in der Dunkelheit",system:"Warhammer Fantasy Rollenspiel",description:{short:"Ein kurzes Abenteuer bei dem es um Fantasy, Action und einfaches Rollenspiel geht.",long:"Eine kleine Gruppe wagt sich in die dunklen Schächten einer Mine und weiter hinab, um einen mächtigen Gegenstand wieder zu erlangen. Wie werden die Gefährten auf die Gefahren des Untergrundes reagieren und welche Gefahren lauern in der Finsternis?"},slots:[],playerCount:{min:1,max:3,reserved:0},tagNames:["children"]}]};async function rr(){return Promise.resolve(ln(nr,tr))}function ln(e,n){const r=localStorage.getItem(e);return r===null?n:r}const ir=_({wantsUpdates:X()}),lr=_({wantsUpdates:X()}),ar=_({games:R(Zt),newEditForm:Mn(Kt).transform(e=>e??Pe()),wantsHelp:X()}),sr=_({games:R(jt),newEditForm:rn,wantsHelp:X()}),or=_({}),cr=_({}),ur=_({uuid:$().uuid(),name:$(),email:$(),mobile:$(),lastSaved:$(),playing:ir,master:ar,helping:or}),gr=_({uuid:$().uuid(),name:$(),email:$(),mobile:$(),lastSaved:On.date(),playing:lr,master:sr,helping:cr});async function dr(e){if(e!=="demo")return{kind:"FAILURE"};const n=await er(),r=ur.safeParse(n);if(!r.success)return{kind:"FAILURE"};const i=mr(r.data);return i.success?{kind:"SUCCESS",data:i.data}:{kind:"FAILURE"}}function mr(e){return gr.safeParse(e)}function hr(e){const[n,r]=O(e),i=In(e.save.master.newEditForm);r("save","master","games",e.save.master.games.length,{...i,uuid:crypto.randomUUID(),playerNames:[]}),r("save","master","newEditForm",Vt())}var $r=d("<br>"),_r=d("<pre>");function Sr(e){const n=new URL(location.href);n.searchParams.set("page",e.page.kind.toLowerCase()),e.page.kind==="EDIT_GAMEROUND"&&n.searchParams.set("uuid",e.page.uuid),n.searchParams.delete("showCreateMessage"),history.replaceState({page:e},"",n);const r=f.pageTitle[e.page.kind];document.title=f.metaTitle.replace("{}",r)}function br(e){const[n,r]=O(e.page);return(i,s)=>{if(Wt(i,n))return;if(!s){const u=new URL(location.href);u.searchParams.set("page",i.kind.toLowerCase()),i.kind==="EDIT_GAMEROUND"&&u.searchParams.set("uuid",i.uuid),history.pushState({page:i},"",u)}const a=f.pageTitle[i.kind];document.title=f.metaTitle.replace("{}",a),r(i),window.scrollTo({top:0})}}function pr(e){Sr(e.meta);const[n]=O({meta:e.meta,save:e.save}),r=br(n.meta);return window.addEventListener("popstate",i=>{if(typeof i=="object"&&i!==null&&"state"in i){const s=new URL(location.href),a=tn(s);r(a.page,!0)}}),[t(P,{get when(){return n.meta.showCreateMessage},get children(){return[t(T,{type:"success",get children(){return f.registrationStarted}}),o($r)]}}),t(de,{get fallback(){return t(St,{changePage:r})},get children(){return[t(M,{get when(){return n.meta.page.kind==="PLAYER"},get children(){return t(ot,{changePage:r})}}),t(M,{get when(){return n.meta.page.kind==="GAMEMASTER"},get children(){return t(lt,{get store(){return n.save.master},changePage:r})}}),t(M,{get when(){return n.meta.page.kind==="NEW_GAMEROUND"},get children(){return t(Gt,{get store(){return n.save.master.newEditForm},changePage:r,createNewGame:()=>hr(n)})}}),t(M,{get when(){return n.meta.page.kind==="EDIT_GAMEROUND"},get children(){return t(Lt,{get allRounds(){return n.save.master.games},get uuid(){return n.meta.page.kind==="EDIT_GAMEROUND"?n.meta.page.uuid:"should never happen"},get fallback(){return t(B,{title:"Spielrunde editieren",changePage:r,get children(){return t(T,{type:"danger",get children(){return f.error.gameroundUuidError}})}})},children:i=>t(Ht,{store:i,changePage:r})})}}),t(M,{get when(){return n.meta.page.kind==="HELPING"},get children(){return t(Jn,{changePage:r})}}),t(M,{get when(){return n.meta.page.kind==="SUMMARY"},get children(){return t(qn,{changePage:r})}})]}}),(()=>{var i=o(_r);return l(i,()=>JSON.stringify(n,null,2)),i})()]}const fr=_({uuid:$().uuid(),gamemaster:$(),title:$(),system:$(),description:_({short:$(),long:$()}),slots:R(ee),playerCount:_({min:F().min(1),max:F(),reserved:F()}).transform(e=>{const[n,r]=Ne([e.min,e.max]),i=Math.min(r,e.reserved);return{min:n,max:r,reserved:i}}),tagNames:R($())}),an=_({entries:R(fr)}),vr=an;async function yr(e){if(e!=="demo")return{kind:"FAILURE"};const n=await rr(),r=an.safeParse(n);if(!r.success)return{kind:"FAILURE"};const i=kr(r.data);return i.success?{kind:"SUCCESS",data:i.data}:{kind:"FAILURE"}}function kr(e){return vr.safeParse(e)}function sn(){return t(T,{get children(){return f.loading}})}function Nr(){const[e,n]=An(null);return wn(()=>{const r=new URL(location.href);n(tn(r))}),t(P,{get fallback(){return t(sn,{})},get when(){return e()},children:r=>t(xr,{get page(){return r()}})})}function xr(e){const[n]=Ge(()=>dr(e.page.secret)),[r]=Ge(()=>yr(e.page.secret));return t(Rn,{fallback:i=>t(T,{type:"danger",get children(){return t(de,{get fallback(){return f.error.general},get children(){return t(M,{get when(){return i.message==="SECRET_ERROR"},get children(){return f.error.secretError}})}})}}),get children(){return t(Tn,{get fallback(){return t(sn,{})},get children(){return t(de,{get children(){return t(M,{get when(){return n()},children:i=>{const{kind:s,value:a}=vn(i());return s==="FAILURE"?t(T,{type:"danger",get children(){return f.error.ourMistake}}):t(pr,{get meta(){return e.page},get save(){return a.data},programResource:r})}})}})}})}})}export{Nr as MeineAnmeldungWrapper};
