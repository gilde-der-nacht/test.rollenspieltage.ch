import{c as et,I as xn,B as w,d as pn,f as te,g as _t,h as z,b as ne,s as En,i as Vt,S as Ut,j as bt,k as Cn,e as rt,l as wn,m as qt,n as Rn,u as An}from"./utils.Cqf3U9su.js";import{b as Jt,g as u,t as g,a as d,u as Tn,i as s,c as r,S as E,d as me,e as Ae,F as j,M as A,f as $e,s as ft,h as tt,j as it,k as lt,m as O,r as at,l as wt,n as nt,o as st,p as Xe,q as Qt,E as Dn}from"./web.BCh8zNxO.js";/* empty css                                 */import{c as D,u as Un}from"./store.BK-5lGMP.js";import{T as On}from"./Textarea.CUTSClbg.js";import{s as f,n as q,e as ot,T as x,o as v,a as re,C as Rt,d as Xt,b as Ge,l as U,c as Ie,u as At,f as Mn}from"./texts.BO501Odx.js";var Nn=g("<dialog><!$><!/><!$><!/><!$><!/>"),In=g("<h4>");function we(e=!1){return{open:e}}function Te(e){let t;const[n,i]=D(e.store);Jt(()=>{n.open?t.showModal():t.close()});function l(){i({open:!1}),e.onClose?.()}const a=()=>{const o=[];return e.type!==void 0&&o.push(e.type),e.size!==void 0&&o.push(e.size),e.onClose!==void 0&&o.push("dialog-with-close"),o};return(()=>{var o=u(Nn),c=o.firstChild,[m,$]=d(c.nextSibling),h=m.nextSibling,[S,_]=d(h.nextSibling),b=S.nextSibling,[k,y]=d(b.nextSibling);o.addEventListener("close",l);var p=t;return typeof p=="function"?Tn(p,o):t=o,s(o,r(E,{get when(){return e.onClose},get children(){return r(et,{onClick:l,icon:"circle-xmark",kind:"gray"})}}),m,$),s(o,r(E,{get when(){return e.title},children:C=>(()=>{var M=u(In);return s(M,C),M})()}),S,_),s(o,()=>e.children,k,y),me(()=>Ae(o,a().join(" "))),o})()}var Tt=g("<p>");function Ye(e){const[t,n]=D(e.store),i=e.showErrors==="ALWAYS",l=()=>i||t.isDirty?e.errors??[]:[];return[r(xn,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:a=>n("value",a),onBlur:()=>n("isDirty",!0),get type(){return e.type},get required(){return e.required},get isHoneypot(){return e.isHoneypot}}),r(E,{get when(){return l().length>0},get children(){return r(w,{type:"danger",get children(){return r(j,{get each(){return l()},children:a=>(()=>{var o=u(Tt);return s(o,a),o})()})}})}})]}function Ot(e){const[t,n]=D(e.store),i=e.showErrors==="ALWAYS",l=()=>i||t.isDirty?e.errors??[]:[];return[r(pn,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:a=>n("value",a),onBlur:()=>n("isDirty",!0),get required(){return e.required},get isHoneypot(){return e.isHoneypot},get min(){return e.min},get max(){return e.max}}),r(E,{get when(){return l().length>0},get children(){return r(w,{type:"danger",get children(){return r(j,{get each(){return l()},children:a=>(()=>{var o=u(Tt);return s(o,a),o})()})}})}})]}function Et(e){const[t,n]=D(e.store),i=e.showErrors==="ALWAYS",l=()=>i||t.isDirty?e.errors??[]:[];return[r(On,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:a=>n("value",a),onBlur:()=>n("isDirty",!0),get required(){return e.required},get size(){return e.size}}),r(E,{get when(){return l().length>0},get children(){return r(w,{type:"danger",get children(){return r(j,{get each(){return l()},children:a=>(()=>{var o=u(Tt);return s(o,a),o})()})}})}})]}const qe=f().transform(e=>({value:e,isDirty:!1}));function vt(e){return{value:e,isDirty:!1}}const Mt=q().transform(e=>({value:e,isDirty:!1})),Re={SATURDAY:{open:{from:10,to:24},breaks:[{from:13,to:14},{from:18,to:19}]},SUNDAY:{open:{from:10,to:18},breaks:[{from:13,to:14}]}};ot(["SATURDAY","SUNDAY"]);function Je(e,t){const{from:n,to:i}=t;return n<e&&e<i}function Pn(e,t){const{from:n,to:i}=e,{from:l,to:a}=t;return Je(n,t)||Je(i,t)||Je(l,e)||Je(a,e)||n===l&&i===a}function je(e,t=!1){const{from:n,to:i}=e;if(n>i)return[];const l=i-n;return en(t?l+1:l,n)}function en(e,t=0){return[...Array(e)].map((n,i)=>i+t)}var Ln=g("<div class=dynamic-columns style=gap:1rem;--min-width:30rem;><!$><!/><!$><!/>"),Fn=g("<div><h4 style=margin-block-end:1.5rem;></h4><!$><!/>"),Gn=g("<p>Konflikte gefunden! Bitte stelle sicher, dass du nicht zeitlich Ã¼berlappende Spielrunden eingetragen hast:"),Hn=g('<div style="display:grid;grid-template-columns:1fr max-content 1fr;gap:1rem;margin-block:0.5rem;"><!$><!/><span style=color:var(--clr-warning-10);align-self:center;font-size:2rem;></span><!$><!/>'),Bn=g("<div class=timetable><!$><!/><div class=entries></div><div class=after-hour><div class=annotation>"),Yn=g("<div><div class=annotation></div><div class=background>"),zn=g("<div class=entry>");function jn(e){return(()=>{var t=u(Ln),n=t.firstChild,[i,l]=d(n.nextSibling),a=i.nextSibling,[o,c]=d(a.nextSibling);return s(t,r(Nt,{get programEntries(){return e.programEntries.SATURDAY},get openingHours(){return Re.SATURDAY},day:"SATURDAY"}),i,l),s(t,r(Nt,{get programEntries(){return e.programEntries.SUNDAY},get openingHours(){return Re.SUNDAY},day:"SUNDAY"}),o,c),t})()}function Nt(e){const t=Zn(e.programEntries);return(()=>{var n=u(Fn),i=n.firstChild,l=i.nextSibling,[a,o]=d(l.nextSibling);return s(i,()=>x.days[e.day]),s(n,r($e,{get fallback(){return[r(w,{type:"danger",get children(){return u(Gn)}}),r(j,{each:t,children:([c,m])=>(()=>{var $=u(Hn),h=$.firstChild,[S,_]=d(h.nextSibling),b=S.nextSibling,k=b.nextSibling,[y,p]=d(k.nextSibling);return s($,()=>c.component(),S,_),s(b,r(te,{icon:"triangle-exclamation"})),s($,()=>m.component(),y,p),$})()})]},get children(){return r(A,{get when(){return t.length===0},get children(){return r(Wn,{get programEntries(){return e.programEntries},get openingHours(){return e.openingHours},get day(){return e.day}})}})}}),a,o),n})()}function Wn(e){const t=je(e.openingHours.open),n=e.openingHours.breaks.map(({from:a})=>a),i=(t[0]??0)-1,l=t.at(-1)??0;return(()=>{var a=u(Bn),o=a.firstChild,[c,m]=d(o.nextSibling),$=c.nextSibling,h=$.nextSibling,S=h.firstChild;return s(a,r(j,{each:t,children:_=>{const b=n.includes(_);return(()=>{var k=u(Yn),y=k.firstChild;return Ae(k,`hour ${b?"break":""}`),s(y,_),me(p=>ft(k,It({from:_,to:_},i,e.day),p)),k})()}}),c,m),s($,r(j,{get each(){return e.programEntries},children:_=>(()=>{var b=u(zn);return s(b,()=>_.component()),me(k=>ft(b,It(_.range,i,e.day),k)),b})()})),s(S,l+1),me(_=>ft($,`grid-row: 1 / ${l-i+1};`,_)),a})()}function It(e,t,n){const{from:i,to:l}=e,a=i-t,o=l-t,c=Re[n].open.to;return _t(a>0,`Entry can't start at ${i}.`),_t(o>0,`Entry can't end at ${l}.`),_t(l<=c,`Entry can't end at ${l}.`),`grid-row: ${a} / ${o};`}function Zn(e){const t=[];return e.forEach((n,i)=>{e.slice(i+1).forEach(l=>{Pn(n.range,l.range)&&t.push([n,l])})}),t}var Kn=g("<span>");function tn(e){const t=()=>{const n=["chip"];return n.push(e.kind??"gray"),e.inverted&&n.push("inverted"),e.size==="small"&&n.push("small"),n.join(" ")};return(()=>{var n=u(Kn);return s(n,()=>e.children),me(i=>{var l=t(),a=e.title;return l!==i.e&&Ae(n,i.e=l),a!==i.t&&tt(n,"title",i.t=a),i},{e:void 0,t:void 0}),n})()}var nn=g("<br>"),Vn=g("<div style=display:grid;gap:1rem;><h3>Meine Kontaktdaten</h3><p><strong>Name:</strong> <!$><!/></p><p><strong>E-Mail:</strong> <!$><!/></p><p><strong>Handynummer:</strong> <!$><!/></p><div>"),qn=g("<form novalidate><!$><!/><!$><!/><!$><!/><!$><!/>"),Jn=g("<h3>Mein Programm"),Qn=g("<div><!$><!/><!$><!/><h5></h5><p class=duration>von <!$><!/> bis <!$><!/> Uhr <em><small>(<!$><!/> <!$><!/>)");function Xn(e){const t=e.store.master.games.flatMap(a=>a.slots.map(o=>({status:a.kind,uuid:a.uuid,title:a.title.value,dateTime:o}))),n=()=>{const a=e.program();return a?.kind==="SUCCESS"?a.data:[]},i=()=>{const a=e.store.playing.reservations.map(o=>o.gameRound);return new Set(a)},l=()=>n().filter(a=>i().has(a.uuid)).map(a=>({uuid:a.uuid,title:a.title,dateTime:a.slot}));return[r(er,{get store(){return e.store.init}}),u(nn),r(nr,{get entries(){return{play:l(),master:t,help:[]}},get changePage(){return e.changePage}})]}function er(e){const[t,n]=D(e.store),[i,l]=D(we());return r(w,{get children(){return[r(E,{get when(){return i.open},get children(){return r(tr,{dialogStore:i,get currentState(){return e.store},updateCurrentState:n})}}),(()=>{var a=u(Vn),o=a.firstChild,c=o.nextSibling,m=c.firstChild,$=m.nextSibling,h=$.nextSibling,[S,_]=d(h.nextSibling),b=c.nextSibling,k=b.firstChild,y=k.nextSibling,p=y.nextSibling,[C,M]=d(p.nextSibling),N=b.nextSibling,P=N.firstChild,B=P.nextSibling,L=B.nextSibling,[I,J]=d(L.nextSibling),Q=N.nextSibling;return s(c,()=>e.store.name,S,_),s(b,()=>e.store.email,C,M),s(N,()=>e.store.mobile,I,J),s(Q,r(z,{icon:"pencil",label:"Kontakdaten editieren",onClick:()=>l("open",!0)})),a})()]}})}function tr(e){const[t]=D({name:vt(e.currentState.name),email:vt(e.currentState.email),mobile:vt(e.currentState.mobile)}),n=it(()=>{const a={name:[],email:[]};return t.name.value.trim().length===0&&a.name.push(x.mandatoryField),t.email.value.trim().length===0?a.email.push(x.mandatoryField):t.email.value.includes("@")||a.email.push(x.invalidEmail),{...a,hasErrors:a.name.length+a.email.length>0}}),[i,l]=D(e.dialogStore);return r(Te,{get store(){return e.dialogStore},title:"Kontaktdaten editieren",onClose:()=>{},size:"medium",get children(){var a=u(qn),o=a.firstChild,[c,m]=d(o.nextSibling),$=c.nextSibling,[h,S]=d($.nextSibling),_=h.nextSibling,[b,k]=d(_.nextSibling),y=b.nextSibling,[p,C]=d(y.nextSibling);return s(a,r(Ye,{get store(){return t.name},label:"Name",name:"name",showErrors:"ON_BLUR",get errors(){return n().name}}),c,m),s(a,r(Ye,{get store(){return t.email},label:"E-Mail",name:"email",showErrors:"ON_BLUR",get errors(){return n().email}}),h,S),s(a,r(Ye,{get store(){return t.mobile},label:"Handynummer",name:"mobile"}),b,k),s(a,r(ne,{label:"Speichern",get disabled(){return n().hasErrors},onClick:()=>{n().hasErrors||(e.updateCurrentState({name:t.name.value,email:t.email.value,mobile:t.mobile.value}),l("open",!1))}}),p,C),a}})}function nr(e){const t=rr(e.entries,e.changePage);return[u(Jn),u(nn),r(jn,{programEntries:t})]}function kt(e){const t=e.range.to-e.range.from,n={"master-draft":{label:"SL",help:"Spielleitung",link:{icon:"pencil",label:"Spielrunde bearbeiten"}},master:{label:"SL",help:"Spielleitung",link:{icon:"pencil",label:"Spielrunde bearbeiten"}},play:{label:"TN",help:"Teilnehmer:in",link:{icon:"link",label:"Zur Spielrunde"}},help:{label:"HL",help:"Helfen",link:{icon:"link",label:""}}}[e.kind],i=()=>{const l=["timeview-entry","box-simple"];return e.kind==="master-draft"&&l.push("gray"),e.kind==="master"&&l.push("special"),e.kind==="play"&&l.push("danger"),l.join(" ")};return(()=>{var l=u(Qn),a=l.firstChild,[o,c]=d(a.nextSibling),m=o.nextSibling,[$,h]=d(m.nextSibling),S=$.nextSibling,_=S.nextSibling,b=_.firstChild,k=b.nextSibling,[y,p]=d(k.nextSibling),C=y.nextSibling,M=C.nextSibling,[N,P]=d(M.nextSibling),B=N.nextSibling,L=B.nextSibling,I=L.firstChild,J=I.firstChild,Q=J.nextSibling,[X,W]=d(Q.nextSibling),ae=X.nextSibling,Y=ae.nextSibling,[ie,le]=d(Y.nextSibling);return ie.nextSibling,s(l,r(tn,{get title(){return n.help},inverted:!0,size:"small",get children(){return n.label}}),o,c),s(l,r(E,{get when(){return e.onClick},children:F=>r(et,{get icon(){return n.link.icon},kind:"ghost",get onClick(){return F()},get title(){return n.link.label}})}),$,h),s(S,()=>e.title),s(_,()=>e.range.from,y,p),s(_,()=>e.range.to,N,P),s(I,t,X,W),s(I,t===1?"Stunde":"Stunden",ie,le),me(F=>{var ee=i(),Z=e.title;return ee!==F.e&&Ae(l,F.e=ee),Z!==F.t&&tt(S,"title",F.t=Z),F},{e:void 0,t:void 0}),l})()}function rr(e,t){const n={SATURDAY:[],SUNDAY:[]};return e.play.forEach(i=>{n[i.dateTime.day].push({range:i.dateTime,component:()=>r(kt,{get title(){return i.title},get range(){return i.dateTime},kind:"play",onClick:()=>t({kind:"GAME",uuid:i.uuid})})})}),e.master.forEach(i=>{if(i.status==="archived")return;const l=[i.title];i.status==="draft"&&l.unshift("(noch nicht verÃ¶ffentlicht)"),n[i.dateTime.day].push({range:i.dateTime,component:()=>r(kt,{get title(){return l.join(" ")},get range(){return i.dateTime},get kind(){return i.status==="published"?"master":"master-draft"},onClick:()=>t({kind:"EDIT_GAMEROUND",uuid:i.uuid})})})}),e.help.forEach(i=>{n[i.dateTime.day].push({range:i.dateTime,component:()=>r(kt,{get title(){return i.title},get range(){return i.dateTime},kind:"help"})})}),n}var ir=g("<p>Diese Seite ist leider noch nicht bereit. Komm bitte spÃ¤ter nochmal zurÃ¼ck.");function lr(){return r(w,{type:"danger",get children(){return u(ir)}})}var ar=g("<div class=grid><!$><!/><div>"),sr=g("<div class=boxLink>");function Ne(e){const t=e.type??"special";return(()=>{var n=u(sr);return s(n,r(w,{type:t,get onClick(){return e.onClick},get children(){var i=u(ar),l=i.firstChild,[a,o]=d(l.nextSibling),c=a.nextSibling;return s(i,r(te,{get icon(){return e.icon}}),a,o),s(c,()=>e.children),i}})),n})()}const Dt=ot(["SATURDAY","SUNDAY"]),rn=v({uuid:f().uuid(),day:Dt,from:q(),to:q()}).refine(e=>e.from<e.to,{message:"A TimeSlot can't end before it starts."});v({name:f(),label:f(),description:f()});const ln=ot(["draft","published","archived"]),or=v({uuid:f().uuid(),kind:ln,title:f(),system:f(),description:v({short:f(),long:f()}),slots:re(rn),playerCount:v({min:q().min(1),max:q()}).transform(e=>{const[t,n]=En([e.min,e.max]);return{min:t,max:n}}),tagNames:re(f())}),an=v({uuid:f().uuid(),kind:ln,title:qe,system:qe,description:v({short:qe,long:qe}),slots:re(rn),playerCount:v({min:Mt,max:Mt}),tagNames:re(f())});function ur(){const e={uuid:crypto.randomUUID(),kind:"draft",title:"",system:"",description:{short:"",long:""},slots:[],playerCount:{min:2,max:4},tagNames:["deutsch"]},t=dr(e);if(t.success)return t.data;throw console.error(t),Error("should not happen")}function dr(e){return an.safeParse(e)}function cr(e){return{...e,title:e.title.value,system:e.system.value,description:{short:e.description.short.value,long:e.description.long.value},playerCount:{min:e.playerCount.min.value,max:e.playerCount.max.value}}}const ut=[{name:"ab6jahren",label:"Ab 6 Jahren",description:"Spannungs- und Bedrohungsmomente werden kurz gehalten. In Begleitung oder nach Absprache mit einem Elternteil. Beispiele: My Little Pony, ..."},{name:"ab12jahren",label:"Ab 12 Jahren",description:"Antisoziales und destruktives wird auf ein Minimum begrenzt. Keine Diskriminierung, keine Radikalisierung, SexualitÃ¤t wird nicht explizit dargestellt."},{name:"ab18jahren",label:"Ab 18 Jahren",description:"Keinerlei Richtlinien bezÃ¼glich Inhalt, in der Gruppe sollte aber diskutiert werden, was akzeptabel ist und was nicht. Beispiele: Vampire the Masquerade, ..."},{name:"fantasy",label:"Fantasy",description:"Spielt in einer alternativen Vergangenheit, in welcher Elemente wie: Ritterinnen, Hexenmeister, RÃ¼stungen, Magie, Goblins, Turniere usw. vorkommen kÃ¶nnen. Beispiele: Das Schwarze Auge, Dungeons & Dragons, ..."},{name:"sciencefiction",label:"Science Fiction",description:"Spielt in einer alternativen Zukunft, in welcher Elemente wie: Raumschiffe, Sternenportale, KÃ¼nstliche Intelligenzen, Laserkanonen usw. vorkommen kÃ¶nnen. Beispiele: Shadowrun, Alien, ..."},{name:"postapokalyptisch",label:"Postapokalyptisch",description:"Spielt in einer Welt mitten oder nach einem Kollaps, wo die Mehrheit ums Ãberleben kÃ¤mpft. Beispiele: Mutant Year Zero, Apocalypse World"},{name:"horror",label:"Horror",description:"Eine gruselige AtmosphÃ¤re, psychologischen Druck oder unvorhersehbare Schreckensmomente. Beispiele: Cthulhu, ..."},{name:"offenewelt",label:"Offene Welt",description:"Es gibt nur einen losen Handlungsfaden, die Rollenspiel-Gruppe muss sich ihre Ziele selber festlegen. Beispiele: Ironsworn, Blades in the Dark, ..."},{name:"gemeinsamespielleitung",label:"Gemeinsame Spielleitung",description:"Die Regeln und die Umwelt werden gemeinsam von allen Spielenden umgesetzt. Beispiele: Microscope, The Quiet Year, ..."},{name:"regelleicht",label:"Regelleicht",description:"Die kompletten Regeln haben alle auf einer Seite Platz. Beispiele: Fiasco, Everyone is John, ..."},{name:"deutsch",label:"Deutsch",description:"Bei der Spielrunde reden die Spielenden miteinander Deutsch."},{name:"englisch",label:"Englisch",description:"Bei der Spielrunde reden die Spielenden miteinander Englisch."},{name:"workshop",label:"Workshop",description:"Unter Anleitung, gemeinsam ein Rollenspiel-Thema vertiefen. Kreative Techniken stehen im Vordergrund. Beispiele: Gemeinsam ein Dungeon erschaffen, Gemeinsam ein Hintergrundgeschichte schreiben, ..."}],dt=200,sn=500,on=200;function gr(e){const t=e.title.value.trim().length===0,n=e.description.short.value.trim().length===0,i=e.description.short.value.length>dt,l=e.description.long.value.length>sn,a=e.slots.length===0;return{titleMissing:t,descriptionShortMissing:n,descriptionShortTooLong:i,descriptionLongTooLong:l,slotMissing:a,hasErrors:t||n||i||l||a}}function mr(e){const t=e.updateText.value.trim().length===0,n=e.updateText.value.length>on;return{missing:t,tooLong:n,hasErrors:t||n}}var $r=g("<h3>"),hr=g("<br>"),Sr=g("<div style=margin-top:2rem;><h3 style=margin-bottom:1rem;></h3><ul class=event-list role=list>"),_r=g('<li><h3 class=event-title></h3><div class=event-details><div class=event-tags><strong>Status:</strong><!$><!/></div><div class=event-tags><strong>System:</strong><!$><!/></div><div class=event-tags><strong>Tag, Zeit:</strong><!$><!/></div><div class=event-tags><strong>Spielende:</strong> <!$><!/> - <!$><!/></div> <div class=event-tags><strong>Kategorien:</strong> <!$><!/></div></div><div class="event-description content"><p><strong>Kurzbeschreibung:</strong><br><!$><!/></p></div><ul role=list class=event-links><li><button class=event-link><span>Bearbeiten'),He=g("<em>"),br=g("<span><!$><!/>, <!$><!/> - <!$><!/> Uhr");function fr(e){const[t,n]=D(e.store);function i(){const l=ur();n("games",t.games.length,l),e.changePage({kind:"EDIT_GAMEROUND",uuid:l.uuid})}return[r(Ne,{icon:"grid-2-plus",type:"success",onClick:i,get children(){var l=u($r);return s(l,()=>x.createNewGameRound),l}}),u(hr),r(Rt,{label:"Ich habe wenig bis keine Spielleitung-Erfahrung und mÃ¶chte gerne in der Vorbereitung und/oder wÃ¤hrend der Spielrunde unterstÃ¼tzt werden.",get checked(){return t.wantsHelp},name:"wantsHelp",value:"wantsHelp",onValueUpdate:l=>{n("wantsHelp",l)}}),r(E,{get when(){return e.store.games},children:l=>(()=>{var a=u(Sr),o=a.firstChild,c=o.nextSibling;return s(o,()=>x.myGameRounds),s(c,r(j,{get each(){return l().filter(m=>m.kind!=="archived")},children:m=>{const $=m.tagNames.map(h=>ut.find(({name:S})=>S===h)).filter(h=>h!==void 0).map(({label:h})=>h);return r(j,{get each(){return m.slots},get fallback(){return r(Pt,{game:m,slot:null,tags:$,get changePage(){return e.changePage}})},children:h=>r(Pt,{game:m,slot:h,tags:$,get changePage(){return e.changePage}})})}})),a})()})]}function Pt(e){const{game:t,slot:n,tags:i,changePage:l}=e;return(()=>{var a=u(_r),o=a.firstChild,c=o.nextSibling,m=c.firstChild,$=m.firstChild,h=$.nextSibling,[S,_]=d(h.nextSibling),b=m.nextSibling,k=b.firstChild,y=k.nextSibling,[p,C]=d(y.nextSibling),M=b.nextSibling,N=M.firstChild,P=N.nextSibling,[B,L]=d(P.nextSibling),I=M.nextSibling,J=I.firstChild,Q=J.nextSibling,X=Q.nextSibling,[W,ae]=d(X.nextSibling),Y=W.nextSibling,ie=Y.nextSibling,[le,F]=d(ie.nextSibling),ee=I.nextSibling,Z=ee.nextSibling,K=Z.firstChild,de=K.nextSibling,T=de.nextSibling,[ce,se]=d(T.nextSibling),oe=c.nextSibling,V=oe.firstChild,he=V.firstChild,be=he.nextSibling,ye=be.nextSibling,[fe,Se]=d(ye.nextSibling),ge=oe.nextSibling,xe=ge.firstChild,pe=xe.firstChild;return s(o,(()=>{var R=O(()=>t.title.value.length>0);return()=>R()?t.title.value:(()=>{var ue=u(He);return s(ue,()=>x.missingTitle),ue})()})()),s(m,()=>x.publishingSteps[t.kind],S,_),s(b,()=>t.system.value||(()=>{var R=u(He);return s(R,()=>x.missingSystem),R})(),p,C),s(M,n!==null?(()=>{var R=u(br),ue=R.firstChild,[De,Ee]=d(ue.nextSibling),Pe=De.nextSibling,Le=Pe.nextSibling,[ve,ct]=d(Le.nextSibling),gt=ve.nextSibling,Ke=gt.nextSibling,[Ve,mt]=d(Ke.nextSibling);return Ve.nextSibling,s(R,()=>x.days[n.day],De,Ee),s(R,()=>n.from,ve,ct),s(R,()=>n.to,Ve,mt),R})():(()=>{var R=u(He);return s(R,()=>x.missingSlot),R})(),B,L),s(I,()=>t.playerCount.min.value,W,ae),s(I,()=>t.playerCount.max.value,le,F),s(Z,()=>i.join(", ")||(()=>{var R=u(He);return s(R,()=>x.missingTags),R})(),ce,se),s(V,(()=>{var R=O(()=>t.description.short.value.length===0);return()=>R()?(()=>{var ue=u(He);return s(ue,()=>x.missingShortDescription),ue})():Vt(t.description.short.value,dt)})(),fe,Se),pe.$$click=()=>l({kind:"EDIT_GAMEROUND",uuid:t.uuid}),me(()=>Ae(a,["event-entry",t.kind==="draft"?"gray":""].join(" "))),at(),a})()}lt(["click"]);var vr=g("<div class=game-dialog><ul role=list style=display:grid;gap:0.5rem;><li><strong style=color:var(--clr-accent-1);>Spielleitung:</strong><br> <!$><!/></li><li><strong style=color:var(--clr-accent-1);>System:</strong><br><!$><!/></li><li><strong style=color:var(--clr-accent-1);>Tag, Zeit:</strong> <br><!$><!/>, <!$><!/> - <!$><!/> Uhr</li><li><strong style=color:var(--clr-accent-1);>Freie PlÃ¤tze:</strong><br><!$><!/> (von <!$><!/>)</li><li><strong style=color:var(--clr-accent-1);>Kategorien:</strong><br><!$><!/></li><li><strong style=color:var(--clr-accent-1);>Kurze Beschreibung:</strong><br><!$><!/></li><li><strong style=color:var(--clr-accent-1);>Lange Beschreibung:</strong><br><!$><!/></li></ul><div class=reservations><h5 style=margin-block-start:0>PlÃ¤tze reservieren</h5><div class=reservation-table>"),kr=g("<em>kein System angegeben"),yr=g("<em>keine Kategorien"),xr=g("<em>Keine lange Beschreibung angegeben."),pr=g("<div class=count>"),Er=g("<div class=reservation-table-entry><p>Reserviert fÃ¼r mich </p><!$><!/>"),Cr=g('<div class=reservation-table-entry><p>Reserviert fÃ¼r "<!$><!/>"</p><!$><!/>'),wr=g('<div style="display:grid;gap:1rem;grid-template-columns:max-content 1fr;"><!$><!/><!$><!/>'),Rr=g('<form style="display:grid;gap:0rem;grid-template-columns:1fr max-content"class=input-button><input type=text style=border-color:var(--clr-special-9);><!$><!/>');function Ar(e){const t=()=>e.reservations.filter(c=>c.gameRound===e.entry.uuid),n=Math.max(e.entry.playerCount.reserved+1-t.length,1),i=e.entry.tags.map(c=>ut.find(({name:m})=>m===c)).filter(c=>c!==void 0).map(({label:c})=>c),l=e.entry.playerCount.max,a=()=>en(l).map(c=>{const m=t()[c];return m!==void 0?m:c+1===l?{kind:"RESERVED_SPONTANIOUS"}:l-n<=c?{kind:"RESERVED_OTHER"}:{kind:"FREE"}}),o=()=>t().find(c=>c.kind==="SELF")!==void 0;return(()=>{var c=u(vr),m=c.firstChild,$=m.firstChild,h=$.firstChild,S=h.nextSibling,_=S.nextSibling,b=_.nextSibling,[k,y]=d(b.nextSibling),p=$.nextSibling,C=p.firstChild,M=C.nextSibling,N=M.nextSibling,[P,B]=d(N.nextSibling),L=p.nextSibling,I=L.firstChild,J=I.nextSibling,Q=J.nextSibling,X=Q.nextSibling,[W,ae]=d(X.nextSibling),Y=W.nextSibling,ie=Y.nextSibling,[le,F]=d(ie.nextSibling),ee=le.nextSibling,Z=ee.nextSibling,[K,de]=d(Z.nextSibling);K.nextSibling;var T=L.nextSibling,ce=T.firstChild,se=ce.nextSibling,oe=se.nextSibling,[V,he]=d(oe.nextSibling),be=V.nextSibling,ye=be.nextSibling,[fe,Se]=d(ye.nextSibling);fe.nextSibling;var ge=T.nextSibling,xe=ge.firstChild,pe=xe.nextSibling,R=pe.nextSibling,[ue,De]=d(R.nextSibling),Ee=ge.nextSibling,Pe=Ee.firstChild,Le=Pe.nextSibling,ve=Le.nextSibling,[ct,gt]=d(ve.nextSibling),Ke=Ee.nextSibling,Ve=Ke.firstChild,mt=Ve.nextSibling,hn=mt.nextSibling,[Sn,_n]=d(hn.nextSibling),bn=m.nextSibling,fn=bn.firstChild,vn=fn.nextSibling;return s($,()=>e.entry.gamemaster,k,y),s(p,(()=>{var G=O(()=>e.entry.system.trim().length>0);return()=>G()?e.entry.system:u(kr)})(),P,B),s(L,()=>x.days[e.entry.slot.day],W,ae),s(L,()=>e.entry.slot.from,le,F),s(L,()=>e.entry.slot.to,K,de),s(T,()=>Math.max(e.entry.playerCount.max-1-e.entry.playerCount.reserved,0),V,he),s(T,()=>e.entry.playerCount.max-1,fe,Se),s(ge,(()=>{var G=O(()=>i.length>0);return()=>G()?i.join(", "):u(yr)})(),ue,De),s(Ee,()=>e.entry.description.short,ct,gt),s(Ke,(()=>{var G=O(()=>e.entry.description.long.trim().length>0);return()=>G()?O(()=>e.entry.description.long):u(xr)})(),Sn,_n),s(vn,r(j,{get each(){return a()},children:(G,kn)=>[(()=>{var H=u(pr);return s(H,()=>kn()+1),H})(),r($e,{get children(){return[r(A,{get when(){return G.kind==="SELF"},get children(){return r(Ut,{type:"success",get children(){var H=u(Er),Ce=H.firstChild,Ue=Ce.nextSibling,[Fe,Oe]=d(Ue.nextSibling);return s(H,r(et,{icon:"trash",onClick:()=>e.removeReservation(G.kind==="SELF"?G.uuid:"should not happen")}),Fe,Oe),H}})}}),r(A,{get when(){return G.kind==="FRIEND"},get children(){return r(Ut,{type:"success",get children(){var H=u(Cr),Ce=H.firstChild,Ue=Ce.firstChild,Fe=Ue.nextSibling,[Oe,$t]=d(Fe.nextSibling);Oe.nextSibling;var ht=Ce.nextSibling,[St,yn]=d(ht.nextSibling);return s(Ce,()=>G.kind==="FRIEND"?G.name:"[Fehler beim Laden]",Oe,$t),s(H,r(et,{icon:"trash",onClick:()=>e.removeReservation(G.kind==="FRIEND"?G.uuid:"should not happen")}),St,yn),H}})}}),r(A,{get when(){return G.kind==="RESERVED_OTHER"},get children(){return r(w,{children:"Bereits reserviert"})}}),r(A,{get when(){return G.kind==="RESERVED_SPONTANIOUS"},get children(){return r(w,{children:"Reserviert fÃ¼r spontane Spieler:innen"})}}),r(A,{get when(){return G.kind==="FREE"},get children(){return r(E,{get when(){return o()},get fallback(){return(()=>{var H=u(wr),Ce=H.firstChild,[Ue,Fe]=d(Ce.nextSibling),Oe=Ue.nextSibling,[$t,ht]=d(Oe.nextSibling);return s(H,r(z,{icon:"person-to-portal",label:"Mich anmelden",kind:"success",onClick:()=>e.addReservation({kind:"SELF",gameRound:e.entry.uuid})}),Ue,Fe),s(H,r(Lt,{addFriend:St=>e.addReservation({kind:"FRIEND",gameRound:e.entry.uuid,name:St})}),$t,ht),H})()},get children(){return r(Lt,{addFriend:H=>e.addReservation({kind:"FRIEND",gameRound:e.entry.uuid,name:H})})}})}})]}})]})),c})()}function Lt(e){const[t,n]=wt("");return(()=>{var i=u(Rr),l=i.firstChild,a=l.nextSibling,[o,c]=d(a.nextSibling);return i.addEventListener("submit",m=>{m.preventDefault();const $=t();$.trim().length>0&&e.addFriend($)}),nt(i,"novalidate",!0),l.$$input=m=>n(m.target.value),s(i,r(z,{icon:"arrow-right",type:"submit",label:"Begleitperson anmelden",kind:"special"}),o,c),me(()=>nt(l,"value",t())),at(),i})()}lt(["input"]);var Tr=g("<p>WIP"),ze=g("<br>"),Dr=g("<p>Diese Seite ist leider noch nicht bereit. Komm bitte spÃ¤ter nochmal zurÃ¼ck."),Ur=g("<p>Programm konnte nicht geladen werden."),Or=g("<h3>"),Mr=g("<h4 style=margin-block-start:2rem;margin-block-end:1rem;>Start: <!$><!/> Uhr"),Nr=g('<ul class="event-list max"role=list>'),Ir=g("<small><!$><!/> - <!$><!/> Uhr"),Pr=g("<h4 style=margin-block-end:0.5rem;>"),Lr=g("<p>Wir kochen: <span>"),Fr=g("<div style=margin-block-start:2rem;>"),Gr=g('<li><h3 class=event-title></h3><div class=event-details><div class=event-tags><strong>Spielleitung:</strong><!$><!/></div><div class=event-tags><strong>System:</strong><!$><!/></div><div class=event-tags><strong>Tag, Zeit:</strong><span><!$><!/>, <!$><!/> - <!$><!/> Uhr</span></div><div class=event-tags><strong>Freie PlÃ¤tze:</strong> <!$><!/> (von <!$><!/>)</div> <div class=event-tags><strong>Kategorien:</strong> <!$><!/></div></div><div class="event-description content"><p><strong>Kurzbeschreibung:</strong><br><!$><!/></p></div><ul role=list class=event-links><li><button class=event-link><span>Details & Teilnehmen'),Hr=g("<em>kein System angegeben"),Br=g("<em>keine Kategorien");function Yr(e){const[t,n]=D(e.store);return r($e,{get fallback(){return r(w,{type:"danger",get children(){return u(Dr)}})},get children(){return r(A,{get when(){return e.isDebugging},get children(){return[r(w,{type:"danger",get children(){return u(Tr)}}),u(ze),r(Rt,{label:"Schickt mir bitte E-Mails, wenn neue Spielrunden verÃ¶ffentlicht werden.",get checked(){return t.wantsUpdates},name:"wantsUpdates",value:"wantsUpdates",onValueUpdate:i=>{n("wantsUpdates",i)}}),u(ze),r(st,{get fallback(){return r(w,{get children(){return x.loading.program}})},get children(){return r(E,{get when(){return e.program()},get fallback(){return r(w,{type:"danger",get children(){return x.error.program}})},children:i=>r(E,{get when(){return i().kind==="SUCCESS"},get fallback(){return r(w,{type:"danger",get children(){return u(Ur)}})},get children(){return r(zr,{get program(){return i().data},get reservations(){return t.reservations},addReservation:l=>n("reservations",t.reservations.length,{...l,uuid:crypto.randomUUID()}),removeReservation:l=>{n("reservations",t.reservations.filter(a=>a.uuid!==l))},get uuid(){return e.uuid},get changePage(){return e.changePage}})}})})}})]}})}})}function zr(e){const[t,n]=D(we(e.uuid!==void 0));Jt(()=>{n("open",e.uuid!==null)});const i=()=>e.program.find(a=>a.uuid===e.uuid),l=Zr(Wr(e.program));return[r(E,{get when(){return i()},children:a=>r(Te,{store:t,get title(){return a().title},onClose:()=>e.changePage({kind:"PLAYER"},{disableScroll:!0}),size:"large",get children(){return r(Ar,{get entry(){return a()},get reservations(){return e.reservations},get addReservation(){return e.addReservation},get removeReservation(){return e.removeReservation}})}})}),u(ze),r(Ft,{day:"SATURDAY",get programOfDay(){return l.SATURDAY},get changePage(){return e.changePage}}),u(ze),u(ze),r(Ft,{day:"SUNDAY",get programOfDay(){return l.SUNDAY},get changePage(){return e.changePage}})]}function Ft(e){const n=Re[e.day].breaks.map(l=>l.from),i=l=>n.indexOf(l)===0?"LUNCH":"DINNER";return[(()=>{var l=u(Or);return s(l,()=>x.days[e.day]),l})(),r(j,{get each(){return Object.entries(e.programOfDay)},get fallback(){return r(w,{children:"Keine Spielrunden gefunden."})},children:([l,a])=>n.includes(Number(l))?r(jr,{get type(){return i(Number(l))},get range(){return{from:Number(l),to:Number(l)-1}}}):a.length===0?null:[(()=>{var o=u(Mr),c=o.firstChild,m=c.nextSibling,[$,h]=d(m.nextSibling);return $.nextSibling,s(o,l,$,h),o})(),(()=>{var o=u(Nr);return s(o,r(j,{each:a,children:c=>r(Kr,{entry:c,get changePage(){return e.changePage}})})),o})()]})]}function jr(e){const t=e.type==="LUNCH"?"Mittagessen":"Nachtessen";return(()=>{var n=u(Fr);return s(n,r(w,{get children(){return[(()=>{var i=u(Ir),l=i.firstChild,[a,o]=d(l.nextSibling),c=a.nextSibling,m=c.nextSibling,[$,h]=d(m.nextSibling);return $.nextSibling,s(i,()=>e.range.from,a,o),s(i,()=>e.range.to,$,h),i})(),(()=>{var i=u(Pr);return s(i,t),i})(),(()=>{var i=u(Lr),l=i.firstChild,a=l.nextSibling;return nt(a,"innerHTML","Pilzrisotto (vegi&nbsp;/&nbsp;vegan), Penne All'Arrabbiata und Penne Pesto (vegi&nbsp;/&nbsp;vegan)."),i})()]}})),n})()}function Wr(e){const t=Object.groupBy(e,n=>n.slot.day);return{SATURDAY:t.SATURDAY??[],SUNDAY:t.SUNDAY??[]}}function Zr(e){function t(o,c){const{from:m,to:$}=o.slot,{from:h,to:S}=c.slot;return m===h?$-S:m-h}const n=e.SATURDAY.toSorted(t),i=e.SUNDAY.toSorted(t),l=je(Re.SATURDAY.open).reduce((o,c)=>(o[c]=n.filter(m=>m.slot.from===c),o),{}),a=je(Re.SUNDAY.open).reduce((o,c)=>(o[c]=i.filter(m=>m.slot.from===c),o),{});return{SATURDAY:l,SUNDAY:a}}function Kr(e){const t=e.entry.tags.map(n=>ut.find(({name:i})=>i===n)).filter(n=>n!==void 0).map(({label:n})=>n);return(()=>{var n=u(Gr),i=n.firstChild,l=i.nextSibling,a=l.firstChild,o=a.firstChild,c=o.nextSibling,[m,$]=d(c.nextSibling),h=a.nextSibling,S=h.firstChild,_=S.nextSibling,[b,k]=d(_.nextSibling),y=h.nextSibling,p=y.firstChild,C=p.nextSibling,M=C.firstChild,[N,P]=d(M.nextSibling),B=N.nextSibling,L=B.nextSibling,[I,J]=d(L.nextSibling),Q=I.nextSibling,X=Q.nextSibling,[W,ae]=d(X.nextSibling);W.nextSibling;var Y=y.nextSibling,ie=Y.firstChild,le=ie.nextSibling,F=le.nextSibling,[ee,Z]=d(F.nextSibling),K=ee.nextSibling,de=K.nextSibling,[T,ce]=d(de.nextSibling);T.nextSibling;var se=Y.nextSibling,oe=se.nextSibling,V=oe.firstChild,he=V.nextSibling,be=he.nextSibling,[ye,fe]=d(be.nextSibling),Se=l.nextSibling,ge=Se.firstChild,xe=ge.firstChild,pe=xe.nextSibling,R=pe.nextSibling,[ue,De]=d(R.nextSibling),Ee=Se.nextSibling,Pe=Ee.firstChild,Le=Pe.firstChild;return s(i,()=>e.entry.title),s(a,()=>e.entry.gamemaster,m,$),s(h,(()=>{var ve=O(()=>e.entry.system.trim().length>0);return()=>ve()?e.entry.system:u(Hr)})(),b,k),s(C,()=>x.days[e.entry.slot.day],N,P),s(C,()=>e.entry.slot.from,I,J),s(C,()=>e.entry.slot.to,W,ae),s(Y,()=>Math.max(e.entry.playerCount.max-1-e.entry.playerCount.reserved,0),ee,Z),s(Y,()=>e.entry.playerCount.max-1,T,ce),s(oe,(()=>{var ve=O(()=>t.length>0);return()=>ve()?t.join(", "):u(Br)})(),ye,fe),s(ge,()=>Vt(e.entry.description.short,dt),ue,De),Le.$$click=()=>e.changePage({kind:"GAME",uuid:e.entry.uuid},{disableScroll:!0}),me(()=>Ae(n,["event-entry"].join(" "))),at(),n})()}lt(["click"]);var Gt=g("<h3>Spielrunden ansehen"),Ht=g("<p>Melde dich (und deine Freunde) fÃ¼r diverse Spielrunden an."),yt=g("<br>"),Vr=g("<h3>Spielrunden erstellen"),qr=g("<p>Falls du wenig oder gar keine Erfahrung als Spielleiter:in hast, werden wir dich vor und wÃ¤hrend dem Anlass unterstÃ¼tzen."),Jr=g("<h3>Helfen"),Qr=g("<p>Beim Kiosk und der Essensausgabe kÃ¶nnen wir immer ein paar helfende HÃ¤nde gebrauchen."),Bt=g("<p><strong>Noch nicht verfÃ¼gbar."),Xr=g("<h3>Zusammenfassung"),ei=g("<p>Erhalte einen Ãberblick Ã¼ber dein gesamtes Programm.");function ti(e){return[r($e,{get fallback(){return r(Ne,{type:"gray",icon:"dice-d20",onClick:()=>e.changePage({kind:"PLAYER"}),get children(){return[u(Gt),u(Ht),u(Bt)]}})},get children(){return r(A,{get when(){return e.isDebugging},get children(){return r(Ne,{icon:"dice-d20",onClick:()=>e.changePage({kind:"PLAYER"}),get children(){return[u(Gt),u(Ht)]}})}})}}),u(yt),r(Ne,{icon:"grid-2-plus",onClick:()=>e.changePage({kind:"GAMEMASTER"}),get children(){return[u(Vr),u(qr)]}}),u(yt),r(Ne,{type:"gray",icon:"hand-heart",onClick:()=>e.changePage({kind:"HELPING"}),get children(){return[u(Jr),u(Qr),u(Bt)]}}),u(yt),r(Ne,{icon:"list",onClick:()=>e.changePage({kind:"SUMMARY"}),get children(){return[u(Xr),u(ei)]}})]}var ni=g("<fieldset><legend>Zeitslots</legend><!$><!/><!$><!/>"),Yt=g("<br>"),ri=g("<div style=margin-block-end:0.5rem;>Zeitslot: <!$><!/>, <!$><!/> -<!$><!/> Uhr"),ii=g("<ul class=event-list role=list>"),li=g("<em>werden geladen..."),ai=g("<li class=event-entry><h3 class=event-title><!$><!/>, <!$><!/> - <!$><!/> Uhr</h3><div class=event-details><div class=event-tags><strong>Dauer:</strong><!$><!/> <!$><!/></div><div class=event-tags><strong>Spielende:</strong> <!$><!/></div></div><div></div><ul role=list class=event-links>"),si=g("<em>Fehler beim Laden."),oi=g("<em>noch keine Anmeldungen"),ui=g("<li><em style=font-size:smaller;>Aktionen werden geladen..."),zt=g("<li><em style=font-size:smaller;>kann nicht gelÃ¶scht werden"),di=g("<li><button type=button class=event-link><div style=display:flex;gap:0.25rem;align-items:center;><!$><!/><span>LÃ¶schen"),ci=g("<div style=display:grid;gap:0.5rem;>"),gi=g("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/>"),mi=g("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/><!$><!/>"),$i=g("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/><!$><!/><div style=margin-block-start:1rem;>"),hi=g("<div style=display:flex;flex-wrap:wrap;gap:0.5rem;align-items:center;><!$><!/> <span>Neuen Slot erfassen"),Si=g("<em>WÃ¤hle eine Tag:"),_i=g("<div style=display:flex;flex-wrap:wrap;gap:.5rem;><!$><!/><!$><!/>"),bi=g("<em>WÃ¤hle eine Startzeit:"),un=g("<div style=display:flex;flex-wrap:wrap;gap:.5rem;>"),dn=g("<span style=white-space:nowrap;><!$><!/> Uhr"),fi=g("<em>WÃ¤hle eine Endzeit:");function vi(e){return(()=>{var t=u(ni),n=t.firstChild,i=n.nextSibling,[l,a]=d(i.nextSibling),o=l.nextSibling,[c,m]=d(o.nextSibling);return s(t,r(yi,{get store(){return e.store},get registrations(){return e.registrations}}),l,a),s(t,r(E,{get when(){return e.slotMissing},get children(){return r(w,{type:"danger",children:"WÃ¤hle mindestens einen Zeitslot aus."})}}),c,m),t})()}const jt=1;function ki(e){function t(n){const i=je(n.open,!0);return n.breaks.map(a=>je(a,!0)).reduce((a,o)=>{const c=o.at(0),m=o.at(-1);if(c===void 0||m===void 0)return a;const $=[];return a.forEach(h=>{const S=[],_=[];h.forEach(b=>{b<=c&&S.push(b),m<=b&&_.push(b)}),S.length>0&&$.push(S),_.length>0&&$.push(_)}),$},[i]).map(a=>{const o=a.slice(0,jt*-1);return Cn(o.map(c=>{const m=a.filter($=>$>=c+jt);return[c,m]}))}).reduce((a,o)=>({...a,...o}),{})}return{SATURDAY:t(e.SATURDAY),SUNDAY:t(e.SUNDAY)}}function yi(e){const[t,n]=D(e.store),[i,l]=D({dialog:we()}),a=it(()=>ki(Re));function o($){n(t.concat($))}function c($){l("dialog","open",!1),l("slot",void 0),n(t.filter(h=>h.uuid!==$))}function m($){l("dialog","open",!0),l("slot",t.find(h=>h.uuid===$))}return[r(pi,{get daySections(){return a()},chooseTimeSlot:o}),u(Yt),u(Yt),r(Te,{get store(){return i.dialog},title:"Zeitslot lÃ¶schen",onClose:()=>l("slot",void 0),get children(){return[(()=>{var $=u(ri),h=$.firstChild,S=h.nextSibling,[_,b]=d(S.nextSibling),k=_.nextSibling,y=k.nextSibling,[p,C]=d(y.nextSibling),M=p.nextSibling,N=M.nextSibling,[P,B]=d(N.nextSibling);return P.nextSibling,s($,()=>x.days[i.slot?.day],_,b),s($,()=>i.slot?.from,p,C),s($,()=>i.slot?.to,P,B),$})(),r(z,{kind:"danger",icon:"trash",label:"LÃ¶schen",onClick:()=>c(i.slot?.uuid)})]}}),r(xi,{slots:t,get registrations(){return e.registrations},confirmRemoval:m})]}function xi(e){return(()=>{var t=u(ii);return s(t,r(j,{get each(){return Ei(e.slots)},children:n=>(()=>{var i=u(ai),l=i.firstChild,a=l.firstChild,[o,c]=d(a.nextSibling),m=o.nextSibling,$=m.nextSibling,[h,S]=d($.nextSibling),_=h.nextSibling,b=_.nextSibling,[k,y]=d(b.nextSibling);k.nextSibling;var p=l.nextSibling,C=p.firstChild,M=C.firstChild,N=M.nextSibling,[P,B]=d(N.nextSibling),L=P.nextSibling,I=L.nextSibling,[J,Q]=d(I.nextSibling),X=C.nextSibling,W=X.firstChild,ae=W.nextSibling,Y=ae.nextSibling,[ie,le]=d(Y.nextSibling),F=p.nextSibling,ee=F.nextSibling;return s(l,()=>x.days[n.day],o,c),s(l,()=>n.from,h,S),s(l,()=>n.to,k,y),s(C,()=>n.to-n.from,P,B),s(C,()=>n.to-n.from>1?"Stunden":"Stunde",J,Q),s(X,r($e,{get children(){return[r(A,{get when(){return e.registrations.loading},get children(){return u(li)}}),r(A,{get when(){return e.registrations()},children:Z=>{const K=Z();if(K.kind==="FAILURE")return u(si);const de=K.data.filter(T=>T.uuid===n.uuid).map(T=>T.name);return O(()=>de.join(", ")||u(oi))}})]}}),ie,le),s(ee,r(st,{get fallback(){return u(ui)},get children(){return r(E,{get when(){return e.registrations()},children:Z=>{const K=Z();return K.kind==="FAILURE"?u(zt):K.data.filter(T=>T.uuid===n.uuid).map(T=>T.name).length>0?u(zt):(()=>{var T=u(di),ce=T.firstChild,se=ce.firstChild,oe=se.firstChild,[V,he]=d(oe.nextSibling);return V.nextSibling,ce.$$click=()=>e.confirmRemoval(n.uuid),s(se,r(te,{icon:"trash"}),V,he),at(),T})()}})}})),i})()})),t})()}function pi(e){const[t,n]=D({slot:{kind:"CHOOSE_DAY"},dialog:we()});function i(){n("slot",{kind:"CHOOSE_DAY"}),n("dialog","open",!1)}function l(a){e.chooseTimeSlot(a),i()}return[r(ne,{kind:"success",get label(){return(()=>{var a=u(hi),o=a.firstChild,[c,m]=d(o.nextSibling);return c.nextSibling,s(a,r(te,{icon:"circle-plus"}),c,m),a})()},onClick:()=>n("dialog","open",!0)}),r(Te,{title:"Zeitslot erfassen",get store(){return t.dialog},size:"medium",onClose:i,get children(){return r($e,{get children(){return[r(A,{get when(){return t.slot.kind==="CHOOSE_DAY"},get children(){var a=u(ci);return s(a,r(Qe,{changeDay:o=>n("slot",{kind:"CHOOSE_START",day:o})})),a}}),r(A,{get when(){return t.slot.kind==="CHOOSE_START"},get children(){var a=u(gi),o=a.firstChild,[c,m]=d(o.nextSibling),$=c.nextSibling,[h,S]=d($.nextSibling);return s(a,r(Qe,{get chosenDay(){return t.slot.kind==="CHOOSE_START"?t.slot.day:void 0},changeDay:_=>n("slot",{kind:"CHOOSE_START",day:_})}),c,m),s(a,r(xt,{get startTimes(){return O(()=>t.slot.kind==="CHOOSE_START")()?bt(e.daySections[t.slot.day]):[]},changeStart:_=>n("slot",{kind:"CHOOSE_END",start:_})}),h,S),a}}),r(A,{get when(){return t.slot.kind==="CHOOSE_END"},get children(){var a=u(mi),o=a.firstChild,[c,m]=d(o.nextSibling),$=c.nextSibling,[h,S]=d($.nextSibling),_=h.nextSibling,[b,k]=d(_.nextSibling);return s(a,r(Qe,{get chosenDay(){return t.slot.kind==="CHOOSE_END"?t.slot.day:void 0},changeDay:y=>n("slot",{kind:"CHOOSE_START",day:y})}),c,m),s(a,r(xt,{get chosenStart(){return t.slot.kind==="CHOOSE_END"?t.slot.start:void 0},get startTimes(){return O(()=>t.slot.kind==="CHOOSE_END")()?bt(e.daySections[t.slot.day]):[]},changeStart:y=>n("slot",{kind:"CHOOSE_END",start:y})}),h,S),s(a,r(Wt,{get endTimes(){return t.slot.kind==="CHOOSE_END"?e.daySections[t.slot.day][t.slot.start]??[]:[]},changeEnd:y=>{t.slot.kind==="CHOOSE_END"&&n("slot",{kind:"WAIT_FOR_CONFIRMATION",day:t.slot.day,start:t.slot.start,end:y})}}),b,k),a}}),r(A,{get when(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"},get children(){var a=u($i),o=a.firstChild,[c,m]=d(o.nextSibling),$=c.nextSibling,[h,S]=d($.nextSibling),_=h.nextSibling,[b,k]=d(_.nextSibling),y=b.nextSibling;return s(a,r(Qe,{get chosenDay(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?t.slot.day:void 0},changeDay:p=>n("slot",{kind:"CHOOSE_START",day:p})}),c,m),s(a,r(xt,{get chosenStart(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?t.slot.start:void 0},get startTimes(){return O(()=>t.slot.kind==="WAIT_FOR_CONFIRMATION")()?bt(e.daySections[t.slot.day]):[]},changeStart:p=>n("slot",{kind:"CHOOSE_END",start:p})}),h,S),s(a,r(Wt,{get chosenEnd(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?t.slot.end:void 0},get endTimes(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?e.daySections[t.slot.day][t.slot.start]??[]:[]},changeEnd:p=>{t.slot.kind==="WAIT_FOR_CONFIRMATION"&&n("slot",{kind:"WAIT_FOR_CONFIRMATION",day:t.slot.day,start:t.slot.start,end:p})}}),b,k),s(y,r(ne,{get label(){return`Slot "${t.slot.kind==="WAIT_FOR_CONFIRMATION"?`${x.days[t.slot.day]}, von ${t.slot.start} bis ${t.slot.end} Uhr`:""}" erstellen`},kind:"success",onClick:()=>{t.slot.kind==="WAIT_FOR_CONFIRMATION"&&l({uuid:crypto.randomUUID(),day:t.slot.day,from:t.slot.start,to:t.slot.end})}})),a}})]}})}})]}function Qe(e){return[u(Si),(()=>{var t=u(_i),n=t.firstChild,[i,l]=d(n.nextSibling),a=i.nextSibling,[o,c]=d(a.nextSibling);return s(t,r(ne,{get kind(){return e.chosenDay==="SATURDAY"?"success":"gray"},label:"Samstag",onClick:()=>e.changeDay("SATURDAY")}),i,l),s(t,r(ne,{get kind(){return e.chosenDay==="SUNDAY"?"success":"gray"},label:"Sonntag",onClick:()=>e.changeDay("SUNDAY")}),o,c),t})()]}function xt(e){return[u(bi),(()=>{var t=u(un);return s(t,r(j,{get each(){return e.startTimes},children:n=>r(ne,{get kind(){return e.chosenStart===n?"success":"gray"},get label(){return(()=>{var i=u(dn),l=i.firstChild,[a,o]=d(l.nextSibling);return a.nextSibling,s(i,n,a,o),i})()},onClick:()=>e.changeStart(n)})})),t})()]}function Wt(e){return[u(fi),(()=>{var t=u(un);return s(t,r(j,{get each(){return e.endTimes},children:n=>r(ne,{get kind(){return e.chosenEnd===n?"success":"gray"},get label(){return(()=>{var i=u(dn),l=i.firstChild,[a,o]=d(l.nextSibling);return a.nextSibling,s(i,n,a,o),i})()},onClick:()=>e.changeEnd(n)})})),t})()]}function Ei(e){return e.toSorted((t,n)=>t.day!==n.day?t.day==="SATURDAY"?-1:1:t.from-n.from)}lt(["click"]);function Ci(e){const t=new Date;return async()=>new Promise(n=>{setTimeout(()=>(console.error("NOT YET IMPLEMENTED: `publishGameround`",e,t),n()),500)})}function wi(e,t){const n=new Date;return async()=>new Promise(i=>{setTimeout(()=>(console.error("NOT YET IMPLEMENTED: `sendGameroundUpdate`",e,t.join(", "),n),i()),500)})}var We=g("<br>"),Ri=g("<div class=content><p>MÃ¶chtest du diese Spielrunde gerne verÃ¶ffentlichen?</p><!$><!/>"),Ai=g("<em>Informationen zu den Anmeldungen mÃ¼ssen geladen werden..."),Ti=g("<em>Du kannst kein Update versenden, da sich noch niemand fÃ¼r diese Spielrunde angemeldet hat."),Di=g("<p>An: <!$><!/>"),Ui=g("<em>Du kannst die Spielrunde nur lÃ¶schen, wenn du zuerst alle Zeitslots entfernt hast."),Oi=g("<div class=content><p>Bist du sicher, dass du die Spielrunde lÃ¶schen mÃ¶chtest?</p><!$><!/>"),Mi=g('<form novalidate><!$><!/><!$><!/><!$><!/><div style="display:grid;grid-template-columns:repeat(2, 1fr);gap:1rem;"><!$><!/><!$><!/></div><!$><!/><!$><!/><!$><!/><fieldset><legend>Kategorien (optional)</legend><!$><!/></fieldset><!$><!/><div style=display:flex;flex-wrap:wrap;gap:1rem;justify-content:space-between;><!$><!/><div style=display:flex;flex-wrap:wrap;gap:1rem;><!$><!/><!$><!/><!$><!/>'),Ni=g("<h4>Spielrunde inkomplett"),Ii=g("<p>Du hast noch einen oder mehre Fehler/fehlende Informationen in dieser Spielrunde:"),Pi=g("<li>Â«TitelÂ» ist ein Pflichtfeld."),Li=g("<li>Â«kurz BeschreibungÂ» ist ein Pflichtfeld."),Fi=g("<li>Â«kurz BeschreibungÂ» ist zu lang."),Gi=g("<li>Â«lange BeschreibungÂ» ist zu lang."),Hi=g("<li>Mindest einen Zeitslot muss ausgewÃ¤hlt werden."),Bi=g("<ul><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),Yi=g("<p><strong>ErklÃ¤rung:</strong> Hast du eine wichtige Ãnderung an dieser Spielrunde durchgefÃ¼hrt, wÃ¤hrend bereits Spielende angemeldet waren? Lass hiermit die Angemeldeten wissen, was du geÃ¤ndert hast. Wichtige Ãnderungen kÃ¶nnen sein: System geÃ¤ndert, Kategorien geÃ¤ndert. FÃ¼r kleine Ãnderungen, wie z.B. Rechtschreibfehler, sollte dies nicht genutzt werden."),zi=g("<p><em>Halte dich kurz und am besten Stichwortartig."),ji=g("<form><!$><!/><!$><!/>"),Wi=g("<div style=display:grid;gap:0.5rem;margin-block-end:1rem;>");function Zi(e){const t=e.allRounds.find(n=>n.uuid===e.uuid);return r(E,{get fallback(){return e.fallback},when:t,children:n=>e.children(n())})}function Ki(e){const[t,n]=D(e.store),[i,l]=D({delete:we(),publish:we(),sendUpdate:we()});function a(c){c.preventDefault(),l("publish","open",!0)}function o(){e.changePage({kind:"GAMEMASTER"})}return[r(tn,{kind:"special",get children(){return["Status: ",O(()=>x.publishingSteps[t.kind])]}}),u(We),u(We),r(Qi,{store:t,get registrations(){return e.registrations},onSubmit:a,onCancel:()=>l("delete","open",!0),onSendUpdate:()=>l("sendUpdate","open",!0),goBack:o}),r(Vi,{get store(){return i.publish},get title(){return t.title.value},onPublish:()=>{n("kind","published"),l("publish","open",!1),e.queue.enqueue(Ci(t.uuid))}}),r(qi,{get store(){return i.sendUpdate},get players(){return tl(e.registrations,t.slots.map(c=>c.uuid))},onSend:c=>{e.queue.enqueue(wi(c,t.slots.map(m=>m.uuid)))}}),r(Ji,{get store(){return i.delete},get hasSlots(){return t.slots.length!==0},get title(){return t.title.value},onDelete:()=>{n("kind","archived"),e.changePage({kind:"GAMEMASTER"})}})]}function Vi(e){return r(Te,{get store(){return e.store},title:"Spielrunde verÃ¶ffentlichen",onClose:()=>{},get children(){var t=u(Ri),n=t.firstChild,i=n.nextSibling,[l,a]=d(i.nextSibling);return s(t,r(z,{kind:"success",icon:"circle-plus",get label(){return`Ja, bitte "${e.title||"["+x.missingTitle+"]"}" verÃ¶ffentlichen.`},get onClick(){return e.onPublish}}),l,a),t}})}function qi(e){return r(Te,{get store(){return e.store},title:"Update senden",onClose:()=>{},size:"medium",get children(){return()=>e.players.kind==="LOADING"?u(Ai):e.players.kind==="ERROR"?O(()=>x.error.general):e.players.data.length===0?u(Ti):[(()=>{var t=u(Di),n=t.firstChild,i=n.nextSibling,[l,a]=d(i.nextSibling);return s(t,()=>e.players.data.map(o=>o.name).join(", "),l,a),t})(),u(We),r(Xi,{get onSend(){return e.onSend}})]}})}function Ji(e){return r(Te,{get store(){return e.store},title:"Spielrunde lÃ¶schen",onClose:()=>{},get children(){return[r(E,{get when(){return e.hasSlots},get children(){return u(Ui)}}),r(E,{get when(){return!e.hasSlots},get children(){var t=u(Oi),n=t.firstChild,i=n.nextSibling,[l,a]=d(i.nextSibling);return s(t,r(z,{kind:"danger",icon:"trash",get label(){return`Ja, bitte "${e.title||"["+x.missingTitle+"]"}" lÃ¶schen.`},get onClick(){return e.onDelete}}),l,a),t}})]}})}function Qi(e){const[t]=D(e.store),n=it(()=>gr(t));return(()=>{var i=u(Mi),l=i.firstChild,[a,o]=d(l.nextSibling),c=a.nextSibling,[m,$]=d(c.nextSibling),h=m.nextSibling,[S,_]=d(h.nextSibling),b=S.nextSibling,k=b.firstChild,[y,p]=d(k.nextSibling),C=y.nextSibling,[M,N]=d(C.nextSibling),P=b.nextSibling,[B,L]=d(P.nextSibling),I=B.nextSibling,[J,Q]=d(I.nextSibling),X=J.nextSibling,[W,ae]=d(X.nextSibling),Y=W.nextSibling,ie=Y.firstChild,le=ie.nextSibling,[F,ee]=d(le.nextSibling),Z=Y.nextSibling,[K,de]=d(Z.nextSibling),T=K.nextSibling,ce=T.firstChild,[se,oe]=d(ce.nextSibling),V=se.nextSibling,he=V.firstChild,[be,ye]=d(he.nextSibling),fe=be.nextSibling,[Se,ge]=d(fe.nextSibling),xe=Se.nextSibling,[pe,R]=d(xe.nextSibling);return s(i,r(E,{get when(){return t.kind==="published"},get children(){return r(Zt,{get errors(){return n()}})}}),a,o),s(i,r(Ye,{get store(){return t.title},label:"Titel",name:"title",get showErrors(){return t.kind==="published"?"ALWAYS":"ON_BLUR"},get errors(){return n().titleMissing?[x.mandatoryField]:[]}}),m,$),s(i,r(Ye,{get store(){return t.system},label:"System (optional)",name:"System"}),S,_),s(b,r(Ot,{get store(){return t.playerCount.min},label:"Anzahl Mitspielende (Minimum)",name:"playerCountMin",min:1,get max(){return t.playerCount.max.value}}),y,p),s(b,r(Ot,{get store(){return t.playerCount.max},label:"Anzahl Mitspielende (Maximum)",name:"playerCountMax",get min(){return t.playerCount.min.value}}),M,N),s(i,r(Et,{get store(){return t.description.short},label:"kurze Beschreibung",name:"descriptionShort",size:"small",get showErrors(){return t.kind==="published"?"ALWAYS":"ON_BLUR"},get errors(){return O(()=>!!n().descriptionShortMissing)()?[x.mandatoryField]:O(()=>!!n().descriptionShortTooLong)()?[x.charLimitBy.replace("{}",String(dt))]:[]}}),B,L),s(i,r(Et,{get store(){return t.description.long},label:"lange Beschreibung (optional)",name:"descriptionLong",get showErrors(){return t.kind==="published"?"ALWAYS":"ON_BLUR"},get errors(){return O(()=>!!n().descriptionLongTooLong)()?[x.charLimitBy.replace("{}",String(sn))]:[]}}),J,Q),s(i,r(vi,{get store(){return e.store.slots},get registrations(){return e.registrations},get slotMissing(){return n().slotMissing}}),W,ae),s(Y,r(el,{get store(){return t.tagNames}}),F,ee),s(i,r(Zt,{get errors(){return n()}}),K,de),s(T,r(z,{icon:"backward",label:"ZurÃ¼ck zu deinen Spielrunden",get onClick(){return e.goBack}}),se,oe),s(V,r(E,{get when(){return t.kind!=="archived"},get children(){return r(z,{icon:"trash",kind:"danger",label:"LÃ¶schen",onClick:()=>e.onCancel()})}}),be,ye),s(V,r(E,{get when(){return t.kind==="draft"},get children(){return r(z,{icon:"circle-plus",get kind(){return n().hasErrors?"gray":"success"},get disabled(){return n().hasErrors},label:"Spielrunde verÃ¶ffentlichen",get onClick(){return n().hasErrors?void 0:e.onSubmit}})}}),Se,ge),s(V,r(E,{get when(){return t.kind==="published"},get children(){return r(z,{icon:"circle-plus",kind:"success",label:"Update an Spielende schicken",get onClick(){return e.onSendUpdate}})}}),pe,R),i})()}function Zt(e){return r(E,{get when(){return e.errors.hasErrors},get children(){return r(w,{type:"danger",get children(){return[u(Ni),u(Ii),(()=>{var t=u(Bi),n=t.firstChild,[i,l]=d(n.nextSibling),a=i.nextSibling,[o,c]=d(a.nextSibling),m=o.nextSibling,[$,h]=d(m.nextSibling),S=$.nextSibling,[_,b]=d(S.nextSibling),k=_.nextSibling,[y,p]=d(k.nextSibling);return s(t,r(E,{get when(){return e.errors.titleMissing},get children(){return u(Pi)}}),i,l),s(t,r(E,{get when(){return e.errors.descriptionShortMissing},get children(){return u(Li)}}),o,c),s(t,r(E,{get when(){return e.errors.descriptionShortTooLong},get children(){return u(Fi)}}),$,h),s(t,r(E,{get when(){return e.errors.descriptionLongTooLong},get children(){return u(Gi)}}),_,b),s(t,r(E,{get when(){return e.errors.slotMissing},get children(){return u(Hi)}}),y,p),t})()]}})}})}function Xi(e){const[t,n]=D({updateText:{value:"",isDirty:!1},hasBeenSent:!1}),i=it(()=>mr(t));return r($e,{get fallback(){return r(w,{type:"success",children:"Nachricht wurde registriert und wird in den nÃ¤chsten 24 Stunden an die Spielenden verschickt."})},get children(){return r(A,{get when(){return!t.hasBeenSent},get children(){return[u(Yi),u(We),u(zi),u(We),(()=>{var l=u(ji),a=l.firstChild,[o,c]=d(a.nextSibling),m=o.nextSibling,[$,h]=d(m.nextSibling);return nt(l,"novalidate",!0),s(l,r(Et,{get store(){return t.updateText},label:"Zusammenfassung der Ãnderung",name:"updateText",size:"small",showErrors:"ALWAYS",get errors(){return O(()=>!!i().missing)()?[x.mandatoryField]:O(()=>!!i().tooLong)()?[x.charLimitBy.replace("{}",String(on))]:[]}}),o,c),s(l,r(z,{icon:"paper-plane",label:"Spielende informieren",get kind(){return i().hasErrors?"gray":"success"},get disabled(){return i().hasErrors},get onClick(){return i().hasErrors?void 0:()=>{e.onSend(t.updateText.value),n("hasBeenSent",!0)}}}),$,h),l})()]}})}})}function el(e){const[t,n]=D(e.store);return[(()=>{var i=u(Wi);return s(i,r(j,{each:ut,children:l=>r(Rt,{get label(){return l.label},get description(){return l.description},get checked(){return t.includes(l.name)},get name(){return l.name},get value(){return l.name},onValueUpdate:a=>{n(a?t.concat([l.name]):t.filter(o=>o!==l.name))}})})),i})(),r(w,{get children(){return x.tagIdeas}})]}const tl=(e,t)=>{if(e.loading)return{kind:"LOADING"};if(e.error)return{kind:"ERROR"};const n=e();return n===void 0||n.kind==="FAILURE"?{kind:"ERROR"}:{kind:"SUCCESS",data:n.data.filter(i=>t.includes(i.uuid))}},nl=Xt("kind",[v({kind:U("CHOOSE"),uuid:Ge()}),v({kind:U("PLAYER"),uuid:Ge()}),v({kind:U("GAME"),uuid:f().uuid()}),v({kind:U("GAMEMASTER"),uuid:Ge()}),v({kind:U("HELPING"),uuid:Ge()}),v({kind:U("SUMMARY"),uuid:Ge()}),v({kind:U("EDIT_GAMEROUND"),uuid:f().uuid()})]);Xt("kind",[v({kind:U("CHOOSE")}),v({kind:U("PLAYER")}),v({kind:U("GAME"),uuid:f().uuid()}),v({kind:U("GAMEMASTER")}),v({kind:U("HELPING")}),v({kind:U("SUMMARY")}),v({kind:U("EDIT_GAMEROUND"),uuid:f().uuid()})]);const rl=ot(["SAVING","IDLE","ERROR"]),il=v({saveState:rl,page:nl,secret:f(),showCreateMessage:Ie(),isDebugging:Ie()});function cn(e){const t=e.searchParams.get("page")??"",n=e.searchParams.get("uuid")??null,i=e.searchParams.get("secret")??"",l=e.searchParams.get("showCreateMessage")==="true",a=e.searchParams.get("debug")==="true",o=il.safeParse({saveState:"IDLE",page:{kind:t.toUpperCase(),uuid:n},secret:i,showCreateMessage:l,isDebugging:a});return o.success?o.data:{saveState:"IDLE",page:{kind:"CHOOSE",uuid:null},secret:i,showCreateMessage:l,isDebugging:a}}function ll(e,t){return e.kind!==t.kind?!1:e.kind==="EDIT_GAMEROUND"&&t.kind==="EDIT_GAMEROUND"||e.kind==="GAME"&&t.kind==="GAME"?e.uuid===t.uuid:!0}const al="2024-08-15T07:45:21.335Z",_e={game:"37831e19-29d6-40bd-b99d-fb91b78aa7f9",slot:"bfcbd156-b703-4664-9944-8936aede8476",slot2:"f58e7242-e1ff-4cfc-a992-ca18dd5207c3",program:"16f387ab-0adf-406b-ba5c-2e4eb200fda8",program2:"11b6b38a-a4d3-40ed-9d4a-d2abcab661a5",program3:"5294bc63-4857-404e-b72d-53ecbd87a27b",program4:"6e9477f1-6dd5-4cd7-b3c3-03085022d967"};function sl(e,t){const n=localStorage.getItem(e);return n===null?t:n}function ol(e,t){localStorage.setItem(e,t)}const gn="SAVE",ul={version:1,init:{name:"John Doe",email:"john@doe.ch",mobile:"+41 66 123 45 67"},lastSaved:al,playing:{wantsUpdates:!1,reservations:[]},master:{games:[{uuid:_e.game,kind:"published",title:"Grolle in der Dunkelheit",system:"Warhammer Fantasy Rollenspiel",description:{short:"Ein kurzes Abenteuer bei dem es um Fantasy, Action und einfaches Rollenspiel geht.",long:"Eine kleine Gruppe wagt sich in die dunklen SchÃ¤chten einer Mine und weiter hinab, um einen mÃ¤chtigen Gegenstand wieder zu erlangen. Wie werden die GefÃ¤hrten auf die Gefahren des Untergrundes reagieren und welche Gefahren lauern in der Finsternis?"},slots:[{uuid:_e.slot,day:"SATURDAY",from:10,to:12},{uuid:_e.slot2,day:"SUNDAY",from:14,to:17}],playerCount:{min:1,max:3},tagNames:["deutsch"]}],wantsHelp:!1},helping:{}};async function dl(){return new Promise(e=>setTimeout(()=>e({kind:"SUCCESS",data:JSON.parse(sl(gn,JSON.stringify(ul)))}),1e3))}async function cl(e,t){return new Promise(n=>setTimeout(()=>(ol(gn,JSON.stringify(e)),n({kind:"SUCCESS",data:t})),1e3))}const gl=[{uuid:_e.program,gamemaster:"Game Master",title:"Grolle in der Dunkelheit",system:"Warhammer Fantasy Rollenspiel",description:{short:"Ein kurzes Abenteuer bei dem es um Fantasy, Action und einfaches Rollenspiel geht.",long:"Eine kleine Gruppe wagt sich in die dunklen SchÃ¤chten einer Mine und weiter hinab, um einen mÃ¤chtigen Gegenstand wieder zu erlangen. Wie werden die GefÃ¤hrten auf die Gefahren des Untergrundes reagieren und welche Gefahren lauern in der Finsternis?"},slot:{day:"SATURDAY",from:10,to:13},playerCount:{min:1,max:3,reserved:0},tags:["ab12jahren"]},{uuid:_e.program2,gamemaster:"Other Game Master",title:"Acrimony",system:"D&D",description:{short:"Ein Lo-Fi Space Western Abenteuer",long:'Ein Lo-Fi Space Western Abenteuer: "Eine frisch formierte Gruppe von KopfgeldjÃ¤gern wird mit einer riskanten Mission betraut: Sie mÃ¼ssen den berÃ¼chtigten Outlaw Jeb "Rusty" Rourke in der abgeschiedenen Grenzstadt aufspÃ¼ren. Bei dieser unbarmherzigen Jagd lernen die Spieler die harte RealitÃ¤t der Kopfgeldjagd kennen, wo jeder Schuss und jede Entscheidung Ã¼ber ihr Schicksal entscheidet.'},slot:{day:"SATURDAY",from:10,to:13},playerCount:{min:2,max:8,reserved:3},tags:["ab12jahren","horror"]},{uuid:_e.program3,gamemaster:"Other Game Master",title:"Acrimony",system:"D&D",description:{short:"Ein Lo-Fi Space Western Abenteuer",long:'Ein Lo-Fi Space Western Abenteuer: "Eine frisch formierte Gruppe von KopfgeldjÃ¤gern wird mit einer riskanten Mission betraut: Sie mÃ¼ssen den berÃ¼chtigten Outlaw Jeb "Rusty" Rourke in der abgeschiedenen Grenzstadt aufspÃ¼ren. Bei dieser unbarmherzigen Jagd lernen die Spieler die harte RealitÃ¤t der Kopfgeldjagd kennen, wo jeder Schuss und jede Entscheidung Ã¼ber ihr Schicksal entscheidet.'},slot:{day:"SATURDAY",from:14,to:18},playerCount:{min:2,max:8,reserved:3},tags:["ab12jahren","horror"]},{uuid:_e.program4,gamemaster:"Some Other Game Master",title:"Solo RPGs",system:"",description:{short:"Wir spielen primÃ¤r das Solo Rollenspiel NoteQuest, werden aber kurz auch noch ein paar andere Solo Rollenspiele miteinander anschauen.",long:""},slot:{day:"SATURDAY",from:14,to:18},playerCount:{min:2,max:4,reserved:3},tags:[]}];async function ml(){return new Promise(e=>setTimeout(()=>e({kind:"SUCCESS",data:gl}),5e3))}const $l=[{uuid:_e.slot,name:"Alice"},{uuid:_e.slot,name:"Bob"}];async function hl(e){return new Promise(t=>setTimeout(()=>t({kind:"SUCCESS",data:$l.filter(n=>e.includes(n.uuid))}),5e3))}var Sl=g("<div aria-atomic=true><!$><!/><!$><!/>"),_l=g("<div class=toast-container aria-live=polite aria-atomic=true>");const[ke,Ze]=D([]);function bl(e){const t=()=>{const n=["toast"];return e.options.kind!==void 0&&n.push(`toast-${e.options.kind}`),n.join(" ")};return(()=>{var n=u(Sl),i=n.firstChild,[l,a]=d(i.nextSibling),o=l.nextSibling,[c,m]=d(o.nextSibling);return s(n,()=>e.options.message,l,a),s(n,r(E,{get when(){return e.options.dismissable},get children(){return r(ne,{kind:"ghost",get label(){return r(te,{icon:"xmark",classes:["toast-dismiss"]})},get onClick(){return e.dismiss}})}}),c,m),me($=>{var h=t(),S=e.options.kind==="danger"?"alert":"status",_=e.options.kind==="danger"?"assertive":"polite";return h!==$.e&&Ae(n,$.e=h),S!==$.t&&tt(n,"role",$.t=S),_!==$.a&&tt(n,"aria-live",$.a=_),$},{e:void 0,t:void 0,a:void 0}),n})()}function fl(){function e(t){ke.find(n=>n.uuid===t)?.cleanup(),Ze(ke.filter(n=>n.uuid!==t))}return(()=>{var t=u(_l);return s(t,r(j,{each:ke,children:n=>r(bl,{options:n,dismiss:()=>e(n.uuid)})})),t})()}function vl(e,t){if(t?.uuid!==void 0&&ke.find(c=>c.uuid===t.uuid)!==void 0)return Ct(t.uuid,e,t);const n=t?.uuid??crypto.randomUUID(),i=t?.duration??5e3,l=t?.kind??"gray",a=t?.dismissable,o=setTimeout(()=>{Ze(ke.filter(c=>c.uuid!==n))},i);return Ze(ke.length,{uuid:n,kind:l,message:e,duration:i,dismissable:a,cleanup:()=>clearTimeout(o)}),n}function Ct(e,t,n){const i=ke.find(m=>m.uuid===e);if(i===void 0)return e;i.cleanup();const l=n.duration??i.duration,a=n.kind??i.kind,o=n?.dismissable??i.dismissable,c=setTimeout(()=>{Ze(ke.filter(m=>m.uuid!==e))},l);return Ze(m=>m.uuid===e,{uuid:e,kind:a,message:t,duration:l,dismissable:o,cleanup:()=>clearTimeout(c)}),e}const kl={version:1,init:{name:"",email:"",mobile:""},lastSaved:new Date().toISOString(),playing:{wantsUpdates:!0,reservations:[]},master:{games:[],wantsHelp:!1},helping:{}};async function yl(e){const t=new URL(rt("/rst25/load"));t.searchParams.append("secret",e);const n=await fetch(t);if(!n.ok)return{kind:"FAILURE"};const i=await n.json();return typeof i=="object"&&i!==null?{kind:"SUCCESS",data:Object.assign(kl,i)}:(console.error("`last_save` not found on ",i),{kind:"FAILURE"})}async function xl(e,t){try{const n=await fetch(rt("/rst25/save"),{method:"post",body:JSON.stringify({secret:t,save:e}),headers:{"Content-Type":"application/json"}});return n.ok?{kind:"SUCCESS",data:t}:(console.error(await n.text()),{kind:"FAILURE"})}catch(n){return console.error(n),{kind:"FAILURE"}}}async function pl(){try{const e=await fetch(rt("/rst25/program"),{headers:{"Content-Type":"application/json"}});return e.ok?{kind:"SUCCESS",data:await e.json()}:(console.error(await e.text()),{kind:"FAILURE"})}catch(e){return console.error(e),{kind:"FAILURE"}}}async function El(e){try{const t=new URL(rt("/rst25/registrations"));t.searchParams.append("secret",e);const n=await fetch(t);return n.ok?{kind:"SUCCESS",data:await n.json()}:(console.error(await n.text()),{kind:"FAILURE"})}catch(t){return console.error(t),{kind:"FAILURE"}}}const Cl=v({name:f(),email:f(),mobile:f()}),wl=v({name:f(),email:f(),mobile:f()}),Rl=At([v({kind:U("SELF"),gameRound:f().uuid(),uuid:f().uuid()}),v({kind:U("FRIEND"),gameRound:f().uuid(),name:f(),uuid:f().uuid()})]),Al=v({wantsUpdates:Ie(),reservations:re(Rl)}),Tl=At([v({kind:U("SELF"),gameRound:f().uuid(),uuid:f().uuid()}),v({kind:U("FRIEND"),gameRound:f().uuid(),name:f(),uuid:f().uuid()})]);At([v({kind:U("SELF"),gameRound:f().uuid()}),v({kind:U("FRIEND"),gameRound:f().uuid(),name:f()})]);const Dl=v({wantsUpdates:Ie(),reservations:re(Tl)}),Ul=v({games:re(or),wantsHelp:Ie()}),Ol=v({games:re(an),wantsHelp:Ie()}),Ml=v({}),Nl=v({}),Il=v({version:U(1),init:Cl,lastSaved:f(),playing:Al,master:Ul,helping:Ml}),Pl=v({version:U(1),init:wl,lastSaved:Mn.date(),playing:Dl,master:Ol,helping:Nl});async function Ll(e){const t=e==="demo"?await dl():await yl(e);if(t.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE"};const n=Il.safeParse(t.data);if(!n.success)return console.error(n.error),{kind:"FAILURE"};const i=Fl(n.data);return i.success?{kind:"SUCCESS",data:i.data}:{kind:"FAILURE"}}function Fl(e){return Pl.safeParse(e)}const pt=crypto.randomUUID();async function Gl(e,t,n){const[i,l]=D(e);l("saveState","SAVING"),vl("Am Speichern...",{uuid:pt,dismissable:!1});const a=new Date;t.lastSaved=a;const o=Hl(t);try{if((n==="demo"?await cl(o,n):await xl(o,n)).kind==="FAILURE")throw Error("")}catch(c){return l("saveState","ERROR"),console.error(c),Ct(pt,"Speichern war nicht mÃ¶glich!",{kind:"danger",duration:1e4,dismissable:!0}),{kind:"FAILURE"}}return Ct(pt,`Zuletzt gespeichert um: ${qt(a)} Uhr`,{kind:"success",dismissable:!0}),l("saveState","IDLE"),{kind:"SUCCESS",data:a}}function Hl(e){return{...e,lastSaved:String(e.lastSaved),master:{...e.master,games:e.master.games.map(cr)}}}const Bl=wn(Gl,1e3);var Yl=g("<div class=tooltip-wrapper><div class=tooltip></div><!$><!/>");function Be(e){return(()=>{var t=u(Yl),n=t.firstChild,i=n.nextSibling,[l,a]=d(i.nextSibling);return s(n,()=>e.tooltip),s(t,()=>e.children,l,a),t})()}var zl=g("<div class=quickmenu-wrapper><div class=quickmenu><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),jl=g('<div class="quickmenu extended"><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>'),Wl=g("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center;><!$><!/><em>Zuletzt gespeichert um: <!$><!/> Uhr"),Zl=g("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center;><!$><!/><em>Am Speichern..."),Kl=g("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center;><!$><!/><em>Speichern war nicht mÃ¶glich!");function Vl(e){return(()=>{var t=u(zl),n=t.firstChild,i=n.firstChild,[l,a]=d(i.nextSibling),o=l.nextSibling,[c,m]=d(o.nextSibling),$=c.nextSibling,[h,S]=d($.nextSibling),_=h.nextSibling,[b,k]=d(_.nextSibling),y=b.nextSibling,[p,C]=d(y.nextSibling);return s(n,r(Be,{tooltip:"Zur Ãbersicht",get children(){return r(ne,{get label(){return r(te,{icon:"backward"})},onClick:()=>e.changePage({kind:"CHOOSE"})})}}),l,a),s(n,r(Be,{tooltip:"Zu den Spielrunden",get children(){return r(ne,{get label(){return r(te,{icon:"dice-d20"})},onClick:()=>e.changePage({kind:"PLAYER"})})}}),c,m),s(n,r(Be,{tooltip:"Zu deinen Spielrunden",get children(){return r(ne,{get label(){return r(te,{icon:"grid-2-plus"})},onClick:()=>e.changePage({kind:"GAMEMASTER"})})}}),h,S),s(n,r(Be,{tooltip:"Zum Helferplan",get children(){return r(ne,{get label(){return r(te,{icon:"hand-heart"})},onClick:()=>e.changePage({kind:"HELPING"})})}}),b,k),s(n,r(Be,{tooltip:"Zur Zusammenfassung",get children(){return r(ne,{get label(){return r(te,{icon:"list"})},onClick:()=>e.changePage({kind:"SUMMARY"})})}}),p,C),t})()}function ql(e){return[r(w,{type:"gray",get children(){var t=u(jl),n=t.firstChild,[i,l]=d(n.nextSibling),a=i.nextSibling,[o,c]=d(a.nextSibling),m=o.nextSibling,[$,h]=d(m.nextSibling),S=$.nextSibling,[_,b]=d(S.nextSibling),k=_.nextSibling,[y,p]=d(k.nextSibling);return s(t,r(z,{icon:"backward",label:"Zur Ãbersicht",onClick:()=>e.changePage({kind:"CHOOSE"})}),i,l),s(t,r(z,{icon:"dice-d20",label:"Zu den Spielrunden",onClick:()=>e.changePage({kind:"PLAYER"})}),o,c),s(t,r(z,{icon:"grid-2-plus",label:"Zu deinen Spielrunden",onClick:()=>e.changePage({kind:"GAMEMASTER"})}),$,h),s(t,r(z,{icon:"hand-heart",label:"Zum Helferplan",onClick:()=>e.changePage({kind:"HELPING"})}),_,b),s(t,r(z,{icon:"list",label:"Zur Zusammenfassung",onClick:()=>e.changePage({kind:"SUMMARY"})}),y,p),t}}),r(Jl,{get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}})]}function Jl(e){return r($e,{get children(){return[r(A,{get when(){return e.saveState==="IDLE"},get children(){var t=u(Wl),n=t.firstChild,[i,l]=d(n.nextSibling),a=i.nextSibling,o=a.firstChild,c=o.nextSibling,[m,$]=d(c.nextSibling);return m.nextSibling,s(t,r(te,{icon:"circle-check"}),i,l),s(a,()=>qt(e.lastSaved),m,$),t}}),r(A,{get when(){return e.saveState==="SAVING"},get children(){var t=u(Zl),n=t.firstChild,[i,l]=d(n.nextSibling);return i.nextSibling,s(t,r(te,{icon:"floppy-disk-circle-arrow-right"}),i,l),t}}),r(A,{get when(){return e.saveState==="ERROR"},get children(){var t=u(Kl),n=t.firstChild,[i,l]=d(n.nextSibling);return i.nextSibling,s(t,r(te,{icon:"triangle-exclamation"}),i,l),t}})]}})}var Ql=g("<div class=page><!$><!/><div class=page-content><h2></h2><br><!$><!/></div><!$><!/>"),Xl=g("<div class=extended-wrapper style=margin-block-start:1rem;>");function Me(e){return(()=>{var t=u(Ql),n=t.firstChild,[i,l]=d(n.nextSibling),a=i.nextSibling,o=a.firstChild,c=o.nextSibling,m=c.nextSibling,[$,h]=d(m.nextSibling),S=a.nextSibling,[_,b]=d(S.nextSibling);return s(t,(()=>{var k=O(()=>e.showQuickmenu!==!1);return()=>k()?r(Vl,{get changePage(){return e.changePage},get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}}):null})(),i,l),s(o,()=>e.title),s(a,()=>e.children,$,h),s(t,(()=>{var k=O(()=>e.showQuickmenu!==!1);return()=>k()?(()=>{var y=u(Xl);return s(y,r(ql,{get changePage(){return e.changePage},get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}})),y})():null})(),_,b),t})()}const ea=v({uuid:f().uuid(),name:f()}),mn=re(ea),ta=mn;async function na(e,t){const n=e==="demo"?await hl(t):await El(e);if(n.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE"};const i=mn.safeParse(n.data);if(!i.success)return{kind:"FAILURE"};const l=ra(i.data);return l.success?{kind:"SUCCESS",data:l.data}:{kind:"FAILURE"}}function ra(e){return ta.safeParse(e)}const ia=v({uuid:f().uuid(),title:f(),system:f(),gamemaster:f(),description:v({short:f(),long:f()}),slot:v({day:Dt,from:q(),to:q()}),playerCount:v({min:q(),max:q(),reserved:q()}),tags:re(f())}),la=re(ia),aa=v({uuid:f().uuid(),title:f(),system:f(),gamemaster:f(),description:v({short:f(),long:f()}),slot:v({day:Dt,from:q(),to:q()}),playerCount:v({min:q(),max:q(),reserved:q()}),tags:re(f())}),sa=re(aa);async function oa(e){const t=e==="demo"?await ml():await pl();if(t.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE"};const n=la.safeParse(t.data);if(!n.success)return{kind:"FAILURE"};const i=ua(n.data);return i.success?{kind:"SUCCESS",data:i.data}:{kind:"FAILURE"}}function ua(e){return sa.safeParse(e)}var da=g("<br>"),Kt=g("<pre>"),ca=g("<hr>"),ga=g("<div><code>Registrations (read-only)"),ma=g("<em>loading...");function $a(e){const t=new URL(location.href);t.searchParams.set("page",e.page.kind.toLowerCase()),e.page.kind==="EDIT_GAMEROUND"&&t.searchParams.set("uuid",e.page.uuid),t.searchParams.delete("showCreateMessage"),history.replaceState({page:e},"",t);const n=x.pageTitle[e.page.kind];document.title=x.metaTitle.replace("{}",n)}function ha(e){const[t,n]=D(e.page);return(i,l)=>{if(ll(i,t))return;const a=l?.backButton??!1,o=l?.disableScroll??!1;if(!a){const m=new URL(location.href);m.searchParams.set("page",i.kind.toLowerCase()),i.kind==="EDIT_GAMEROUND"||i.kind==="GAME"?(m.searchParams.set("uuid",i.uuid),n(i)):(m.searchParams.delete("uuid"),n({...i,uuid:null})),history.pushState({page:i},"",m)}const c=x.pageTitle[i.kind];document.title=x.metaTitle.replace("{}",c),o||window.scrollTo({top:0})}}function Sa(e){$a(e.meta);const[t,n]=D({meta:e.meta,save:e.save}),i=()=>t.save.master.games.flatMap(h=>h.slots.map(S=>S.uuid)),[l]=Xe(i(),h=>na(t.meta.secret,h)),[a]=Xe(()=>oa(t.meta.secret)),[o,c]=wt(!1);Xe(()=>JSON.stringify(t.save),async()=>{if(!o()){c(!0);return}const h=Un(t.save);try{const S=await Bl(t.meta,h,t.meta.secret);S.kind==="FAILURE"?console.error(S):n("save","lastSaved",S.data)}catch(S){console.error(S),n("meta","saveState","ERROR")}});const m=ha(t.meta),$=Rn();return Qt(()=>{window.addEventListener("popstate",h=>{if(typeof h=="object"&&h!==null&&"state"in h){const S=new URL(location.href),_=cn(S);m(_.page,{backButton:!0})}}),setInterval(async()=>{const h=$.dequeue();h.kind==="NEXT_ELEMENT"&&await h.data()},1e3)}),[r(E,{get when(){return t.meta.showCreateMessage},get children(){return[r(w,{type:"success",get children(){return x.registrationStarted}}),u(da)]}}),r($e,{get fallback(){return r(Me,{title:"Wo mÃ¶chtest du starten?",showQuickmenu:!1,changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(ti,{changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get isDebugging(){return t.meta.isDebugging}})}})},get children(){return[r(A,{get when(){return t.meta.page.kind==="PLAYER"||t.meta.page.kind==="GAME"},get children(){return r(Me,{title:"SpielrundenÃ¼bersicht",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(Yr,{get store(){return t.save.playing},program:a,get uuid(){return t.meta.page.kind==="GAME"?t.meta.page.uuid:null},changePage:m,get isDebugging(){return t.meta.isDebugging}})}})}}),r(A,{get when(){return t.meta.page.kind==="GAMEMASTER"},get children(){return r(Me,{title:"Meine Spielrunden",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(fr,{get store(){return t.save.master},changePage:m})}})}}),r(A,{get when(){return t.meta.page.kind==="EDIT_GAMEROUND"},get children(){return r(Me,{title:"Spielrunde editieren",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(Zi,{get allRounds(){return t.save.master.games},get uuid(){return t.meta.page.kind==="EDIT_GAMEROUND"?t.meta.page.uuid:"should never happen"},get fallback(){return r(w,{type:"danger",get children(){return x.error.gameroundUuidError}})},children:h=>r(Ki,{store:h,registrations:l,queue:$,changePage:m})})}})}}),r(A,{get when(){return t.meta.page.kind==="HELPING"},get children(){return r(Me,{title:"Helfen",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(lr,{})}})}}),r(A,{get when(){return t.meta.page.kind==="SUMMARY"},get children(){return r(Me,{title:"Zusammenfassung",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(Xn,{get store(){return t.save},program:a,changePage:m})}})}})]}}),r(E,{get when(){return t.meta.isDebugging},get children(){return[(()=>{var h=u(Kt);return s(h,()=>JSON.stringify(t,null,2)),h})(),u(ca),u(ga),r(st,{get fallback(){return u(ma)},get children(){return r(E,{get when(){return l()},children:h=>(()=>{var S=u(Kt);return s(S,()=>JSON.stringify(h(),null,2)),S})()})}})]}}),r(fl,{})]}function $n(){return r(w,{get children(){return x.loading.registration}})}function pa(){const[e,t]=wt(null);return Qt(()=>{const n=new URL(location.href);t(cn(n))}),r(E,{get fallback(){return r($n,{})},get when(){return e()},children:n=>r(_a,{get page(){return n()}})})}function _a(e){const[t]=Xe(()=>Ll(e.page.secret));return r(Dn,{fallback:n=>(console.error(n),r(w,{type:"danger",get children(){return x.error.general}})),get children(){return r(st,{get fallback(){return r($n,{})},get children(){return r($e,{get children(){return r(A,{get when(){return t()},children:n=>{const{kind:i,value:l}=An(n());return i==="SECRET_INVALID"?r(w,{type:"danger",get children(){return x.error.secretError}}):i==="FAILURE"?(console.error(l),r(w,{type:"danger",get children(){return x.error.ourMistake}})):r(Sa,{get meta(){return e.page},get save(){return l.data}})}})}})}})}})}export{pa as MeineAnmeldungWrapper};
