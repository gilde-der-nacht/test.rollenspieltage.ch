import{g as m,t as f,a as i,i as s,c as E,s as F,b as L,d as r,S as h}from"./web.DiohJL2p.js";import{I as A,a as H,B as J}from"./Button.BLEgkd9G.js";import{c as K}from"./store.CLzkyqdf.js";import{e as Q,B as u}from"./utils.BUJ3cRZp.js";import{o as X,s as x,n as Y}from"./index.BmTnCDYh.js";var Z=f("<label class=input-checkbox><input type=checkbox><!$><!/>");function ee(e){return(()=>{var t=m(Z),l=t.firstChild,p=l.nextSibling,[n,c]=i(p.nextSibling);return l.addEventListener("change",o=>e.onValueUpdate(o.target.checked)),s(t,()=>e.label,n,c),E(()=>F(l,"name",e.name)),E(()=>L(l,"value",e.value)),E(()=>L(l,"checked",e.checked)),t})()}var te=f("<form novalidate><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),V=f("<br>"),ne=f("<a href=/kontakt>kontaktiere uns direkt"),re=f("<span>Ich bestätige, dass ich den <a href=/verhaltenskodex target=_blank>Verhaltenskodex</a> gelesen habe und mich an die Regeln halten werde.");function me(){const[e,t]=K({form:{name:"",email:"",tel:"",coc:!1},showErrors:{nameMissing:!1,emailMissing:!1,emailInvalid:!1,cocMissing:!1,general:!1},state:"IDLE"});let l;async function p(n){n.preventDefault();const c=e.form.name.trim().length===0;t("showErrors","nameMissing",c);const o=e.form.email.trim().length===0;t("showErrors","emailMissing",o);const _=l.validity.typeMismatch;if(t("showErrors","emailInvalid",_),t("showErrors","cocMissing",!e.form.coc),!(e.showErrors.nameMissing||e.showErrors.emailMissing||e.showErrors.emailInvalid)){t("state","LOADING");try{const $={name:e.form.name,email:e.form.email,handynummer:e.form.tel},g=await fetch(Q("/rst25/start"),{method:"post",body:JSON.stringify($),headers:{"Content-Type":"application/json"}});if(!g.ok)t("showErrors","general",!0);else{const w=await g.json(),b=X({name:x(),email:x(),registrationId:Y(),secret:x()}).parse(w),d=new URL(location.origin+"/meine-anmeldung");d.searchParams.append("secret",b.secret),d.searchParams.append("showCreateMessage","true"),window.location.replace(d)}}catch{t("showErrors","general",!0)}finally{t("state","IDLE")}}}return[(()=>{var n=m(te),c=n.firstChild,[o,_]=i(c.nextSibling),$=o.nextSibling,[g,w]=i($.nextSibling),y=g.nextSibling,[b,d]=i(y.nextSibling),C=b.nextSibling,[S,N]=i(C.nextSibling),P=S.nextSibling,[v,U]=i(P.nextSibling),B=v.nextSibling,[k,j]=i(B.nextSibling),R=k.nextSibling,[I,T]=i(R.nextSibling),O=I.nextSibling,[M,z]=i(O.nextSibling),G=M.nextSibling,[W,q]=i(G.nextSibling);return n.addEventListener("submit",p),s(n,r(A,{label:"Name",name:"name",get value(){return e.form.name},onValueUpdate:a=>{t("form","name",a),t("showErrors","nameMissing",!1)}}),o,_),s(n,r(h,{get when(){return e.showErrors.nameMissing},get children(){return r(u,{type:"danger",children:"Dies ist ein Pflichtfeld."})}}),g,w),s(n,r(H,{label:"E-Mail",name:"email",type:"email",get value(){return e.form.email},onValueUpdate:a=>{t("form","email",a),t("showErrors","emailMissing",!1),t("showErrors","emailInvalid",!1)},ref(a){var D=l;typeof D=="function"?D(a):l=a}}),b,d),s(n,r(h,{get when(){return e.showErrors.emailMissing},get children(){return r(u,{type:"danger",children:"Dies ist ein Pflichtfeld."})}}),S,N),s(n,r(h,{get when(){return e.showErrors.emailInvalid},get children(){return r(u,{type:"danger",children:"Die Eingabe scheint keine gültige E-Mail-Adresse zu sein."})}}),v,U),s(n,r(A,{label:"Handynummer",name:"tel",type:"tel",get value(){return e.form.tel},required:!1,onValueUpdate:a=>t("form","tel",a)}),k,j),s(n,r(ee,{get label(){return m(re)},name:"coc",value:"coc",get checked(){return e.form.coc},onValueUpdate:a=>t("form","coc",a)}),I,T),s(n,r(h,{get when(){return e.showErrors.cocMissing},get children(){return r(u,{type:"danger",children:"Der Verhaltenskodex muss gelesen und akzeptiert werden."})}}),M,z),s(n,r(J,{type:"submit",get kind(){return e.state==="IDLE"?"success":"gray"},get label(){return e.state==="IDLE"?"Anmeldung starten":"Anmeldung wird gestartet"},get disabled(){return e.state==="LOADING"}}),W,q),n})(),m(V),r(h,{get when(){return e.showErrors.general},get children(){return[r(u,{type:"danger",get children(){return["Es gab ein Problem, das wir nicht erwartet haben. Bitte versuche es erneut oder ",m(ne),"."]}}),m(V)]}})]}export{me as AnmeldungWrapper};
