import{c as Rt,I as tn,B as A,d as nn,f as W,g as qe,h as B,b as j,s as rn,i as Tt,j as Je,k as ln,e as at,l as an,m as Dt,n as sn,u as on}from"./utils.DKMYu8hR.js";import{b as Ut,g as u,t as c,a as d,u as un,i as s,c as r,S as E,d as oe,e as _e,F as G,M as T,f as ue,s as Ve,h as He,j as Be,k as st,m as P,r as ot,l as Ot,n as ut,o as Ge,p as Mt,q as Pt,E as dn}from"./web.D2d_DzMH.js";/* empty css                                 */import{c as R,u as cn}from"./store.DRYHhvmG.js";import{T as gn}from"./Textarea.Bek7xwM_.js";import{s as p,n as F,e as ze,T as y,o as f,a as te,C as Nt,d as It,b as Re,l as N,c as xe,f as mn}from"./texts.SmEruyIH.js";var $n=c("<dialog><!$><!/><!$><!/><!$><!/>"),hn=c("<h4>");function he(e=!1){return{open:e}}function be(e){let t;const[n,i]=R(e.store);Ut(()=>{n.open?t.showModal():t.close()});function l(){i({open:!1}),e.onClose?.()}const a=()=>{const o=[];return e.type!==void 0&&o.push(e.type),e.size!==void 0&&o.push(e.size),e.onClose!==void 0&&o.push("dialog-with-close"),o};return(()=>{var o=u($n),g=o.firstChild,[m,h]=d(g.nextSibling),$=m.nextSibling,[S,_]=d($.nextSibling),b=S.nextSibling,[v,k]=d(b.nextSibling);o.addEventListener("close",l);var x=t;return typeof x=="function"?un(x,o):t=o,s(o,r(E,{get when(){return e.onClose},get children(){return r(Rt,{onClick:l,icon:"circle-xmark",kind:"gray"})}}),m,h),s(o,r(E,{get when(){return e.title},children:C=>(()=>{var D=u(hn);return s(D,C),D})()}),S,_),s(o,()=>e.children,v,k),oe(()=>_e(o,a().join(" "))),o})()}var dt=c("<p>");function Ue(e){const[t,n]=R(e.store),i=e.showErrors==="ALWAYS",l=()=>i||t.isDirty?e.errors??[]:[];return[r(tn,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:a=>n("value",a),onBlur:()=>n("isDirty",!0),get type(){return e.type},get required(){return e.required},get isHoneypot(){return e.isHoneypot}}),r(E,{get when(){return l().length>0},get children(){return r(A,{type:"danger",get children(){return r(G,{get each(){return l()},children:a=>(()=>{var o=u(dt);return s(o,a),o})()})}})}})]}function $t(e){const[t,n]=R(e.store),i=e.showErrors==="ALWAYS",l=()=>i||t.isDirty?e.errors??[]:[];return[r(nn,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:a=>n("value",a),onBlur:()=>n("isDirty",!0),get required(){return e.required},get isHoneypot(){return e.isHoneypot},get min(){return e.min},get max(){return e.max}}),r(E,{get when(){return l().length>0},get children(){return r(A,{type:"danger",get children(){return r(G,{get each(){return l()},children:a=>(()=>{var o=u(dt);return s(o,a),o})()})}})}})]}function it(e){const[t,n]=R(e.store),i=e.showErrors==="ALWAYS",l=()=>i||t.isDirty?e.errors??[]:[];return[r(gn,{get label(){return e.label},get name(){return e.name},get value(){return t.value},onValueUpdate:a=>n("value",a),onBlur:()=>n("isDirty",!0),get required(){return e.required},get size(){return e.size}}),r(E,{get when(){return l().length>0},get children(){return r(A,{type:"danger",get children(){return r(G,{get each(){return l()},children:a=>(()=>{var o=u(dt);return s(o,a),o})()})}})}})]}const Ie=p().transform(e=>({value:e,isDirty:!1}));function Qe(e){return{value:e,isDirty:!1}}const ht=F().transform(e=>({value:e,isDirty:!1})),Se={SATURDAY:{open:{from:10,to:24},breaks:[{from:13,to:14},{from:18,to:19}]},SUNDAY:{open:{from:10,to:18},breaks:[{from:13,to:14}]}};ze(["SATURDAY","SUNDAY"]);function Le(e,t){const{from:n,to:i}=t;return n<e&&e<i}function Sn(e,t){const{from:n,to:i}=e,{from:l,to:a}=t;return Le(n,t)||Le(i,t)||Le(l,e)||Le(a,e)||n===l&&i===a}function Oe(e,t=!1){const{from:n,to:i}=e;if(n>i)return[];const l=i-n;return[...Array(t?l+1:l)].map((a,o)=>o+n)}var _n=c("<div class=dynamic-columns style=gap:1rem;--min-width:30rem;><!$><!/><!$><!/>"),bn=c("<div><h4 style=margin-block-end:1.5rem;></h4><!$><!/>"),fn=c("<p>Konflikte gefunden! Bitte stelle sicher, dass du nicht zeitlich Ã¼berlappende Spielrunden eingetragen hast:"),vn=c('<div style="display:grid;grid-template-columns:1fr max-content 1fr;gap:1rem;margin-block:0.5rem;"><!$><!/><span style=color:var(--clr-warning-10);align-self:center;font-size:2rem;></span><!$><!/>'),kn=c("<div class=timetable><!$><!/><div class=entries></div><div class=after-hour><div class=annotation>"),pn=c("<div><div class=annotation></div><div class=background>"),yn=c("<div class=entry>");function xn(e){return(()=>{var t=u(_n),n=t.firstChild,[i,l]=d(n.nextSibling),a=i.nextSibling,[o,g]=d(a.nextSibling);return s(t,r(St,{get programEntries(){return e.programEntries.SATURDAY},get openingHours(){return Se.SATURDAY},day:"SATURDAY"}),i,l),s(t,r(St,{get programEntries(){return e.programEntries.SUNDAY},get openingHours(){return Se.SUNDAY},day:"SUNDAY"}),o,g),t})()}function St(e){const t=Cn(e.programEntries);return(()=>{var n=u(bn),i=n.firstChild,l=i.nextSibling,[a,o]=d(l.nextSibling);return s(i,()=>y.days[e.day]),s(n,r(ue,{get fallback(){return[r(A,{type:"danger",get children(){return u(fn)}}),r(G,{each:t,children:([g,m])=>(()=>{var h=u(vn),$=h.firstChild,[S,_]=d($.nextSibling),b=S.nextSibling,v=b.nextSibling,[k,x]=d(v.nextSibling);return s(h,()=>g.component(),S,_),s(b,r(W,{icon:"triangle-exclamation"})),s(h,()=>m.component(),k,x),h})()})]},get children(){return r(T,{get when(){return t.length===0},get children(){return r(En,{get programEntries(){return e.programEntries},get openingHours(){return e.openingHours},get day(){return e.day}})}})}}),a,o),n})()}function En(e){const t=Oe(e.openingHours.open),n=e.openingHours.breaks.map(({from:a})=>a),i=(t[0]??0)-1,l=t.at(-1)??0;return(()=>{var a=u(kn),o=a.firstChild,[g,m]=d(o.nextSibling),h=g.nextSibling,$=h.nextSibling,S=$.firstChild;return s(a,r(G,{each:t,children:_=>{const b=n.includes(_);return(()=>{var v=u(pn),k=v.firstChild;return _e(v,`hour ${b?"break":""}`),s(k,_),oe(x=>Ve(v,_t({from:_,to:_},i,e.day),x)),v})()}}),g,m),s(h,r(G,{get each(){return e.programEntries},children:_=>(()=>{var b=u(yn);return s(b,()=>_.component()),oe(v=>Ve(b,_t(_.range,i,e.day),v)),b})()})),s(S,l+1),oe(_=>Ve(h,`grid-row: 1 / ${l-i+1};`,_)),a})()}function _t(e,t,n){const{from:i,to:l}=e,a=i-t,o=l-t,g=Se[n].open.to;return qe(a>0,`Entry can't start at ${i}.`),qe(o>0,`Entry can't end at ${l}.`),qe(l<=g,`Entry can't end at ${l}.`),`grid-row: ${a} / ${o};`}function Cn(e){const t=[];return e.forEach((n,i)=>{e.slice(i+1).forEach(l=>{Sn(n.range,l.range)&&t.push([n,l])})}),t}var An=c("<span>");function Lt(e){const t=()=>{const n=["chip"];return n.push(e.kind??"gray"),e.inverted&&n.push("inverted"),e.size==="small"&&n.push("small"),n.join(" ")};return(()=>{var n=u(An);return s(n,()=>e.children),oe(i=>{var l=t(),a=e.title;return l!==i.e&&_e(n,i.e=l),a!==i.t&&He(n,"title",i.t=a),i},{e:void 0,t:void 0}),n})()}var Ft=c("<br>"),wn=c("<div style=display:grid;gap:1rem;><h3>Meine Kontaktdaten</h3><p><strong>Name:</strong> <!$><!/></p><p><strong>E-Mail:</strong> <!$><!/></p><p><strong>Handynummer:</strong> <!$><!/></p><div>"),Rn=c("<form novalidate><!$><!/><!$><!/><!$><!/><!$><!/>"),Tn=c("<h3>Mein Programm"),Dn=c("<div><!$><!/><!$><!/><h5></h5><p class=duration>von <!$><!/> bis <!$><!/> Uhr <em><small>(<!$><!/> <!$><!/>)");function Un(e){const t=e.store.master.games.flatMap(n=>n.slots.map(i=>({status:n.kind,uuid:n.uuid,title:n.title.value,dateTime:i})));return[r(On,{get store(){return e.store.init}}),u(Ft),r(Pn,{entries:{play:[],master:t,help:[]},get changePage(){return e.changePage}})]}function On(e){const[t,n]=R(e.store),[i,l]=R(he());return r(A,{get children(){return[r(E,{get when(){return i.open},get children(){return r(Mn,{dialogStore:i,get currentState(){return e.store},updateCurrentState:n})}}),(()=>{var a=u(wn),o=a.firstChild,g=o.nextSibling,m=g.firstChild,h=m.nextSibling,$=h.nextSibling,[S,_]=d($.nextSibling),b=g.nextSibling,v=b.firstChild,k=v.nextSibling,x=k.nextSibling,[C,D]=d(x.nextSibling),O=b.nextSibling,I=O.firstChild,H=I.nextSibling,V=H.nextSibling,[M,Z]=d(V.nextSibling),Q=O.nextSibling;return s(g,()=>e.store.name,S,_),s(b,()=>e.store.email,C,D),s(O,()=>e.store.mobile,M,Z),s(Q,r(B,{icon:"pencil",label:"Kontakdaten editieren",onClick:()=>l("open",!0)})),a})()]}})}function Mn(e){const[t]=R({name:Qe(e.currentState.name),email:Qe(e.currentState.email),mobile:Qe(e.currentState.mobile)}),n=Be(()=>{const a={name:[],email:[]};return t.name.value.trim().length===0&&a.name.push(y.mandatoryField),t.email.value.trim().length===0?a.email.push(y.mandatoryField):t.email.value.includes("@")||a.email.push(y.invalidEmail),{...a,hasErrors:a.name.length+a.email.length>0}}),[i,l]=R(e.dialogStore);return r(be,{get store(){return e.dialogStore},title:"Kontaktdaten editieren",onClose:()=>{},size:"medium",get children(){var a=u(Rn),o=a.firstChild,[g,m]=d(o.nextSibling),h=g.nextSibling,[$,S]=d(h.nextSibling),_=$.nextSibling,[b,v]=d(_.nextSibling),k=b.nextSibling,[x,C]=d(k.nextSibling);return s(a,r(Ue,{get store(){return t.name},label:"Name",name:"name",showErrors:"ON_BLUR",get errors(){return n().name}}),g,m),s(a,r(Ue,{get store(){return t.email},label:"E-Mail",name:"email",showErrors:"ON_BLUR",get errors(){return n().email}}),$,S),s(a,r(Ue,{get store(){return t.mobile},label:"Handynummer",name:"mobile"}),b,v),s(a,r(j,{label:"Speichern",get disabled(){return n().hasErrors},onClick:()=>{n().hasErrors||(e.updateCurrentState({name:t.name.value,email:t.email.value,mobile:t.mobile.value}),l("open",!1))}}),x,C),a}})}function Pn(e){const t=Nn(e.entries,e.changePage);return[u(Tn),u(Ft),r(xn,{programEntries:t})]}function Xe(e){const t=e.range.to-e.range.from,n={"master-draft":{label:"SL",help:"Spielleitung",link:{icon:"pencil",label:"Spielrunde bearbeiten"}},master:{label:"SL",help:"Spielleitung",link:{icon:"pencil",label:"Spielrunde bearbeiten"}},play:{label:"TN",help:"Teilnehmer:in",link:{icon:"link",label:"Zur Spielrunde"}},help:{label:"HL",help:"Helfen",link:{icon:"link",label:""}}}[e.kind],i=()=>{const l=["timeview-entry","box-simple"];return e.kind==="master-draft"&&l.push("gray"),e.kind==="master"&&l.push("special"),l.join(" ")};return(()=>{var l=u(Dn),a=l.firstChild,[o,g]=d(a.nextSibling),m=o.nextSibling,[h,$]=d(m.nextSibling),S=h.nextSibling,_=S.nextSibling,b=_.firstChild,v=b.nextSibling,[k,x]=d(v.nextSibling),C=k.nextSibling,D=C.nextSibling,[O,I]=d(D.nextSibling),H=O.nextSibling,V=H.nextSibling,M=V.firstChild,Z=M.firstChild,Q=Z.nextSibling,[X,K]=d(Q.nextSibling),re=X.nextSibling,Y=re.nextSibling,[ne,ie]=d(Y.nextSibling);return ne.nextSibling,s(l,r(Lt,{get title(){return n.help},inverted:!0,size:"small",get children(){return n.label}}),o,g),s(l,r(E,{get when(){return e.onClick},children:L=>r(Rt,{get icon(){return n.link.icon},kind:"ghost",get onClick(){return L()},get title(){return n.link.label}})}),h,$),s(S,()=>e.title),s(_,()=>e.range.from,k,x),s(_,()=>e.range.to,O,I),s(M,t,X,K),s(M,t===1?"Stunde":"Stunden",ne,ie),oe(L=>{var ee=i(),z=e.title;return ee!==L.e&&_e(l,L.e=ee),z!==L.t&&He(S,"title",L.t=z),L},{e:void 0,t:void 0}),l})()}function Nn(e,t){const n={SATURDAY:[],SUNDAY:[]};return e.play.forEach(i=>{n[i.dateTime.day].push({range:i.dateTime,component:()=>r(Xe,{get title(){return i.title},get range(){return i.dateTime},kind:"play"})})}),e.master.forEach(i=>{if(i.status==="deleted")return;const l=[i.title];i.status==="draft"&&l.unshift("(noch nicht verÃ¶ffentlicht)"),n[i.dateTime.day].push({range:i.dateTime,component:()=>r(Xe,{get title(){return l.join(" ")},get range(){return i.dateTime},get kind(){return i.status==="published"?"master":"master-draft"},onClick:()=>t({kind:"EDIT_GAMEROUND",uuid:i.uuid})})})}),e.help.forEach(i=>{n[i.dateTime.day].push({range:i.dateTime,component:()=>r(Xe,{get title(){return i.title},get range(){return i.dateTime},kind:"help"})})}),n}var In=c("<p>Diese Seite ist leider noch nicht bereit. Komm bitte spÃ¤ter nochmal zurÃ¼ck.");function Ln(){return r(A,{type:"danger",get children(){return u(In)}})}var Fn=c("<div class=grid><!$><!/><div>"),Gn=c("<div class=boxLink>");function ye(e){const t=e.type??"special";return(()=>{var n=u(Gn);return s(n,r(A,{type:t,get onClick(){return e.onClick},get children(){var i=u(Fn),l=i.firstChild,[a,o]=d(l.nextSibling),g=a.nextSibling;return s(i,r(W,{get icon(){return e.icon}}),a,o),s(g,()=>e.children),i}})),n})()}const ct=ze(["SATURDAY","SUNDAY"]),Gt=f({uuid:p().uuid(),day:ct,from:F(),to:F()}).refine(e=>e.from<e.to,{message:"A TimeSlot can't end before it starts."});f({name:p(),label:p(),description:p()});const Ht=ze(["draft","published","deleted"]),Hn=f({uuid:p().uuid(),kind:Ht,title:p(),system:p(),description:f({short:p(),long:p()}),slots:te(Gt),playerCount:f({min:F().min(1),max:F()}).transform(e=>{const[t,n]=rn([e.min,e.max]);return{min:t,max:n}}),tagNames:te(p())}),Yt=f({uuid:p().uuid(),kind:Ht,title:Ie,system:Ie,description:f({short:Ie,long:Ie}),slots:te(Gt),playerCount:f({min:ht,max:ht}),tagNames:te(p())});function Yn(){const e={uuid:crypto.randomUUID(),kind:"draft",title:"",system:"",description:{short:"",long:""},slots:[],playerCount:{min:2,max:4},tagNames:["deutsch"]},t=Bn(e);if(t.success)return t.data;throw console.error(t),Error("should not happen")}function Bn(e){return Yt.safeParse(e)}function zn(e){return{...e,title:e.title.value,system:e.system.value,description:{short:e.description.short.value,long:e.description.long.value},playerCount:{min:e.playerCount.min.value,max:e.playerCount.max.value}}}const gt=[{name:"ab6jahren",label:"Ab 6 Jahren",description:"Spannungs- und Bedrohungsmomente werden kurz gehalten. In Begleitung oder nach Absprache mit einem Elternteil. Beispiele: My Little Pony, ..."},{name:"ab12jahren",label:"Ab 12 Jahren",description:"Antisoziales und destruktives wird auf ein Minimum begrenzt. Keine Diskriminierung, keine Radikalisierung, SexualitÃ¤t wird nicht explizit dargestellt."},{name:"ab18jahren",label:"Ab 18 Jahren",description:"Keinerlei Richtlinien bezÃ¼glich Inhalt, in der Gruppe sollte aber diskutiert werden, was akzeptabel ist und was nicht. Beispiele: Vampire the Masquerade, ..."},{name:"fantasy",label:"Fantasy",description:"Spielt in einer alternativen Vergangenheit, in welcher Elemente wie: Ritterinnen, Hexenmeister, RÃ¼stungen, Magie, Goblins, Turniere usw. vorkommen kÃ¶nnen. Beispiele: Das Schwarze Auge, Dungeons & Dragons, ..."},{name:"sciencefiction",label:"Science Fiction",description:"Spielt in einer alternativen Zukunft, in welcher Elemente wie: Raumschiffe, Sternenportale, KÃ¼nstliche Intelligenzen, Laserkanonen usw. vorkommen kÃ¶nnen. Beispiele: Shadowrun, Alien, ..."},{name:"postapokalyptisch",label:"Postapokalyptisch",description:"Spielt in einer Welt mitten oder nach einem Kollaps, wo die Mehrheit ums Ãberleben kÃ¤mpft. Beispiele: Mutant Year Zero, Apocalypse World"},{name:"horror",label:"Horror",description:"Eine gruselige AtmosphÃ¤re, psychologischen Druck oder unvorhersehbare Schreckensmomente. Beispiele: Cthulhu, ..."},{name:"offenewelt",label:"Offene Welt",description:"Es gibt nur einen losen Handlungsfaden, die Rollenspiel-Gruppe muss sich ihre Ziele selber festlegen. Beispiele: Ironsworn, Blades in the Dark, ..."},{name:"gemeinsamespielleitung",label:"Gemeinsame Spielleitung",description:"Die Regeln und die Umwelt werden gemeinsam von allen Spielenden umgesetzt. Beispiele: Microscope, The Quiet Year, ..."},{name:"regelleicht",label:"Regelleicht",description:"Die kompletten Regeln haben alle auf einer Seite Platz. Beispiele: Fiasco, Everyone is John, ..."},{name:"deutsch",label:"Deutsch",description:"Bei der Spielrunde reden die Spielenden miteinander Deutsch."},{name:"englisch",label:"Englisch",description:"Bei der Spielrunde reden die Spielenden miteinander Englisch."},{name:"workshop",label:"Workshop",description:"Unter Anleitung, gemeinsam ein Rollenspiel-Thema vertiefen. Kreative Techniken stehen im Vordergrund. Beispiele: Gemeinsam ein Dungeon erschaffen, Gemeinsam ein Hintergrundgeschichte schreiben, ..."}],We=200,Bt=500,zt=200;function Wn(e){const t=e.title.value.trim().length===0,n=e.description.short.value.trim().length===0,i=e.description.short.value.length>We,l=e.description.long.value.length>Bt,a=e.slots.length===0;return{titleMissing:t,descriptionShortMissing:n,descriptionShortTooLong:i,descriptionLongTooLong:l,slotMissing:a,hasErrors:t||n||i||l||a}}function jn(e){const t=e.updateText.value.trim().length===0,n=e.updateText.value.length>zt;return{missing:t,tooLong:n,hasErrors:t||n}}var Zn=c("<h3>"),Kn=c("<br>"),qn=c("<div style=margin-top:2rem;><h3 style=margin-bottom:1rem;></h3><ul class=event-list role=list>"),Jn=c('<li><h3 class=event-title></h3><div class=event-details><div class=event-tags><strong>Status:</strong><!$><!/></div><div class=event-tags><strong>System:</strong><!$><!/></div><div class=event-tags><strong>Tag, Zeit:</strong><!$><!/></div><div class=event-tags><strong>Spielende:</strong> <!$><!/> - <!$><!/></div> <div class=event-tags><strong>Kategorien:</strong> <!$><!/></div></div><div class="event-description content"><p><strong>Kurzbeschreibung:</strong><br><!$><!/></p></div><ul role=list class=event-links><li><button class=event-link><span>Bearbeiten'),Te=c("<em>"),Vn=c("<span><!$><!/>, <!$><!/> - <!$><!/> Uhr");function Qn(e){const[t,n]=R(e.store);function i(){const l=Yn();n("games",t.games.length,l),e.changePage({kind:"EDIT_GAMEROUND",uuid:l.uuid})}return[r(ye,{icon:"grid-2-plus",type:"success",onClick:i,get children(){var l=u(Zn);return s(l,()=>y.createNewGameRound),l}}),u(Kn),r(Nt,{label:"Ich habe wenig bis keine Spielleitung-Erfahrung und mÃ¶chte gerne in der Vorbereitung und/oder wÃ¤hrend der Spielrunde unterstÃ¼tzt werden.",get checked(){return t.wantsHelp},name:"wantsHelp",value:"wantsHelp",onValueUpdate:l=>{n("wantsHelp",l)}}),r(E,{get when(){return e.store.games},children:l=>(()=>{var a=u(qn),o=a.firstChild,g=o.nextSibling;return s(o,()=>y.myGameRounds),s(g,r(G,{get each(){return l().filter(m=>m.kind!=="deleted")},children:m=>{const h=m.tagNames.map($=>gt.find(({name:S})=>S===$)).filter($=>$!==void 0).map(({label:$})=>$);return r(G,{get each(){return m.slots},get fallback(){return r(bt,{game:m,slot:null,tags:h,get changePage(){return e.changePage}})},children:$=>r(bt,{game:m,slot:$,tags:h,get changePage(){return e.changePage}})})}})),a})()})]}function bt(e){const{game:t,slot:n,tags:i,changePage:l}=e;return(()=>{var a=u(Jn),o=a.firstChild,g=o.nextSibling,m=g.firstChild,h=m.firstChild,$=h.nextSibling,[S,_]=d($.nextSibling),b=m.nextSibling,v=b.firstChild,k=v.nextSibling,[x,C]=d(k.nextSibling),D=b.nextSibling,O=D.firstChild,I=O.nextSibling,[H,V]=d(I.nextSibling),M=D.nextSibling,Z=M.firstChild,Q=Z.nextSibling,X=Q.nextSibling,[K,re]=d(X.nextSibling),Y=K.nextSibling,ne=Y.nextSibling,[ie,L]=d(ne.nextSibling),ee=M.nextSibling,z=ee.nextSibling,q=z.firstChild,de=q.nextSibling,U=de.nextSibling,[ce,le]=d(U.nextSibling),ae=g.nextSibling,J=ae.firstChild,me=J.firstChild,fe=me.nextSibling,Ee=fe.nextSibling,[Ce,$e]=d(Ee.nextSibling),ve=ae.nextSibling,Ae=ve.firstChild,we=Ae.firstChild;return s(o,(()=>{var w=P(()=>t.title.value.length>0);return()=>w()?t.title.value:(()=>{var se=u(Te);return s(se,()=>y.missingTitle),se})()})()),s(m,()=>y.publishingSteps[t.kind],S,_),s(b,()=>t.system.value||(()=>{var w=u(Te);return s(w,()=>y.missingSystem),w})(),x,C),s(D,n!==null?(()=>{var w=u(Vn),se=w.firstChild,[Ne,je]=d(se.nextSibling),Ze=Ne.nextSibling,Ke=Ze.nextSibling,[ke,Vt]=d(Ke.nextSibling),Qt=ke.nextSibling,Xt=Qt.nextSibling,[mt,en]=d(Xt.nextSibling);return mt.nextSibling,s(w,()=>y.days[n.day],Ne,je),s(w,()=>n.from,ke,Vt),s(w,()=>n.to,mt,en),w})():(()=>{var w=u(Te);return s(w,()=>y.missingSlot),w})(),H,V),s(M,()=>t.playerCount.min.value,K,re),s(M,()=>t.playerCount.max.value,ie,L),s(z,()=>i.join(", ")||(()=>{var w=u(Te);return s(w,()=>y.missingTags),w})(),ce,le),s(J,(()=>{var w=P(()=>t.description.short.value.length===0);return()=>w()?(()=>{var se=u(Te);return s(se,()=>y.missingShortDescription),se})():Tt(t.description.short.value,We)})(),Ce,$e),we.$$click=()=>l({kind:"EDIT_GAMEROUND",uuid:t.uuid}),oe(()=>_e(a,["event-entry",t.kind==="draft"?"gray":""].join(" "))),ot(),a})()}st(["click"]);var Xn=c("<p>WIP"),er=c("<p>Diese Seite ist leider noch nicht bereit. Komm bitte spÃ¤ter nochmal zurÃ¼ck."),tr=c("<h1>loading"),nr=c("<p>Programm konnte nicht geladen werden."),et=c("<br>"),rr=c("<p>"),ir=c("<h3>"),lr=c("<h4 style=margin-block-start:2rem;margin-block-end:1rem;>Start: <!$><!/> Uhr"),ar=c('<ul class="event-list max"role=list>'),sr=c("<small><!$><!/> - <!$><!/> Uhr"),or=c("<h4 style=margin-block-end:0.5rem;>"),ur=c("<p>Wir kochen: <span>"),dr=c("<div style=margin-block-start:2rem;>"),cr=c('<li><h3 class=event-title></h3><div class=event-details><div class=event-tags><strong>Spielleitung:</strong><!$><!/></div><div class=event-tags><strong>System:</strong><!$><!/></div><div class=event-tags><strong>Tag, Zeit:</strong><span><!$><!/>, <!$><!/> - <!$><!/> Uhr</span></div><div class=event-tags><strong>Freie PlÃ¤tze:</strong> <!$><!/> (von <!$><!/>)</div> <div class=event-tags><strong>Kategorien:</strong> <!$><!/></div></div><div class="event-description content"><p><strong>Kurzbeschreibung:</strong><br><!$><!/></p></div><ul role=list class=event-links><li><button class=event-link><span>Details & Teilnehmen'),gr=c("<em>kein System angegeben"),mr=c("<em>keine Kategorien");function $r(e){return r(ue,{get fallback(){return r(A,{type:"danger",get children(){return u(er)}})},get children(){return r(T,{get when(){return e.isDebugging},get children(){return[r(A,{type:"danger",get children(){return u(Xn)}}),r(E,{get when(){return e.program()},get fallback(){return u(tr)},children:t=>r(E,{get when(){return t().kind==="SUCCESS"},get fallback(){return r(A,{type:"danger",get children(){return u(nr)}})},get children(){return r(hr,{get program(){return t().data},get uuid(){return e.uuid},get changePage(){return e.changePage}})}})})]}})}})}function hr(e){const[t,n]=R(he(e.uuid!==void 0));Ut(()=>{n("open",e.uuid!==null)});const i=()=>e.program.find(a=>a.uuid===e.uuid),l=br(_r(e.program));return[r(E,{get when(){return i()},children:a=>r(be,{store:t,get title(){return a().title},onClose:()=>e.changePage({kind:"PLAYER"},{disableScroll:!0}),size:"medium",get children(){var o=u(rr);return s(o,()=>a().description.short),o}})}),u(et),r(ft,{day:"SATURDAY",get programOfDay(){return l.SATURDAY},get changePage(){return e.changePage}}),u(et),u(et),r(ft,{day:"SUNDAY",get programOfDay(){return l.SUNDAY},get changePage(){return e.changePage}})]}function ft(e){const n=Se[e.day].breaks.map(l=>l.from),i=l=>n.indexOf(l)===0?"LUNCH":"DINNER";return[(()=>{var l=u(ir);return s(l,()=>y.days[e.day]),l})(),r(G,{get each(){return Object.entries(e.programOfDay)},get fallback(){return r(A,{children:"Keine Spielrunden gefunden."})},children:([l,a])=>n.includes(Number(l))?r(Sr,{get type(){return i(Number(l))},get range(){return{from:Number(l),to:Number(l)-1}}}):a.length===0?null:[(()=>{var o=u(lr),g=o.firstChild,m=g.nextSibling,[h,$]=d(m.nextSibling);return h.nextSibling,s(o,l,h,$),o})(),(()=>{var o=u(ar);return s(o,r(G,{each:a,children:g=>r(fr,{entry:g,get changePage(){return e.changePage}})})),o})()]})]}function Sr(e){const t=e.type==="LUNCH"?"Mittagessen":"Nachtessen";return(()=>{var n=u(dr);return s(n,r(A,{get children(){return[(()=>{var i=u(sr),l=i.firstChild,[a,o]=d(l.nextSibling),g=a.nextSibling,m=g.nextSibling,[h,$]=d(m.nextSibling);return h.nextSibling,s(i,()=>e.range.from,a,o),s(i,()=>e.range.to,h,$),i})(),(()=>{var i=u(or);return s(i,t),i})(),(()=>{var i=u(ur),l=i.firstChild,a=l.nextSibling;return Ot(a,"innerHTML","Pilzrisotto (vegi&nbsp;/&nbsp;vegan), Penne All'Arrabbiata und Penne Pesto (vegi&nbsp;/&nbsp;vegan)."),i})()]}})),n})()}function _r(e){const t=Object.groupBy(e,n=>n.slot.day);return{SATURDAY:t.SATURDAY??[],SUNDAY:t.SUNDAY??[]}}function br(e){function t(o,g){const{from:m,to:h}=o.slot,{from:$,to:S}=g.slot;return m===$?h-S:m-$}const n=e.SATURDAY.toSorted(t),i=e.SUNDAY.toSorted(t),l=Oe(Se.SATURDAY.open).reduce((o,g)=>(o[g]=n.filter(m=>m.slot.from===g),o),{}),a=Oe(Se.SUNDAY.open).reduce((o,g)=>(o[g]=i.filter(m=>m.slot.from===g),o),{});return{SATURDAY:l,SUNDAY:a}}function fr(e){const t=e.entry.tags.map(n=>gt.find(({name:i})=>i===n)).filter(n=>n!==void 0).map(({label:n})=>n);return(()=>{var n=u(cr),i=n.firstChild,l=i.nextSibling,a=l.firstChild,o=a.firstChild,g=o.nextSibling,[m,h]=d(g.nextSibling),$=a.nextSibling,S=$.firstChild,_=S.nextSibling,[b,v]=d(_.nextSibling),k=$.nextSibling,x=k.firstChild,C=x.nextSibling,D=C.firstChild,[O,I]=d(D.nextSibling),H=O.nextSibling,V=H.nextSibling,[M,Z]=d(V.nextSibling),Q=M.nextSibling,X=Q.nextSibling,[K,re]=d(X.nextSibling);K.nextSibling;var Y=k.nextSibling,ne=Y.firstChild,ie=ne.nextSibling,L=ie.nextSibling,[ee,z]=d(L.nextSibling),q=ee.nextSibling,de=q.nextSibling,[U,ce]=d(de.nextSibling);U.nextSibling;var le=Y.nextSibling,ae=le.nextSibling,J=ae.firstChild,me=J.nextSibling,fe=me.nextSibling,[Ee,Ce]=d(fe.nextSibling),$e=l.nextSibling,ve=$e.firstChild,Ae=ve.firstChild,we=Ae.nextSibling,w=we.nextSibling,[se,Ne]=d(w.nextSibling),je=$e.nextSibling,Ze=je.firstChild,Ke=Ze.firstChild;return s(i,()=>e.entry.title),s(a,()=>e.entry.gamemaster,m,h),s($,(()=>{var ke=P(()=>e.entry.system.trim().length>0);return()=>ke()?e.entry.system:u(gr)})(),b,v),s(C,()=>y.days[e.entry.slot.day],O,I),s(C,()=>e.entry.slot.from,M,Z),s(C,()=>e.entry.slot.to,K,re),s(Y,()=>Math.max(e.entry.playerCount.max-1-e.entry.playerCount.reserved,0),ee,z),s(Y,()=>e.entry.playerCount.max-1,U,ce),s(ae,(()=>{var ke=P(()=>t.length>0);return()=>ke()?t.join(", "):u(mr)})(),Ee,Ce),s(ve,()=>Tt(e.entry.description.short,We),se,Ne),Ke.$$click=()=>e.changePage({kind:"GAME",uuid:e.entry.uuid},{disableScroll:!0}),oe(()=>_e(n,["event-entry"].join(" "))),ot(),n})()}st(["click"]);var vt=c("<h3>Spielrunden ansehen"),kt=c("<p>Melde dich (und deine Freunde) fÃ¼r diverse Spielrunden an."),tt=c("<br>"),vr=c("<h3>Spielrunden erstellen"),kr=c("<p>Falls du wenig oder gar keine Erfahrung als Spielleiter:in hast, werden wir dich vor und wÃ¤hrend dem Anlass unterstÃ¼tzen."),pr=c("<h3>Helfen"),yr=c("<p>Beim Kiosk und der Essensausgabe kÃ¶nnen wir immer ein paar helfende HÃ¤nde gebrauchen."),pt=c("<p><strong>Noch nicht verfÃ¼gbar."),xr=c("<h3>Zusammenfassung"),Er=c("<p>Erhalte einen Ãberblick Ã¼ber dein gesamtes Programm.");function Cr(e){return[r(ue,{get fallback(){return r(ye,{type:"gray",icon:"dice-d20",onClick:()=>e.changePage({kind:"PLAYER"}),get children(){return[u(vt),u(kt),u(pt)]}})},get children(){return r(T,{get when(){return e.isDebugging},get children(){return r(ye,{icon:"dice-d20",onClick:()=>e.changePage({kind:"PLAYER"}),get children(){return[u(vt),u(kt)]}})}})}}),u(tt),r(ye,{icon:"grid-2-plus",onClick:()=>e.changePage({kind:"GAMEMASTER"}),get children(){return[u(vr),u(kr)]}}),u(tt),r(ye,{type:"gray",icon:"hand-heart",onClick:()=>e.changePage({kind:"HELPING"}),get children(){return[u(pr),u(yr),u(pt)]}}),u(tt),r(ye,{icon:"list",onClick:()=>e.changePage({kind:"SUMMARY"}),get children(){return[u(xr),u(Er)]}})]}var Ar=c("<fieldset><legend>Zeitslots</legend><!$><!/><!$><!/>"),yt=c("<br>"),wr=c("<div style=margin-block-end:0.5rem;>Zeitslot: <!$><!/>, <!$><!/> -<!$><!/> Uhr"),Rr=c("<ul class=event-list role=list>"),Tr=c("<em>werden geladen..."),Dr=c("<li class=event-entry><h3 class=event-title><!$><!/>, <!$><!/> - <!$><!/> Uhr</h3><div class=event-details><div class=event-tags><strong>Dauer:</strong><!$><!/> <!$><!/></div><div class=event-tags><strong>Spielende:</strong> <!$><!/></div></div><div></div><ul role=list class=event-links>"),Ur=c("<em>Fehler beim Laden."),Or=c("<em>noch keine Anmeldungen"),Mr=c("<li><em style=font-size:smaller;>Aktionen werden geladen..."),xt=c("<li><em style=font-size:smaller;>kann nicht gelÃ¶scht werden"),Pr=c("<li><button type=button class=event-link><div style=display:flex;gap:0.25rem;align-items:center;><!$><!/><span>LÃ¶schen"),Nr=c("<div style=display:grid;gap:0.5rem;>"),Ir=c("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/>"),Lr=c("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/><!$><!/>"),Fr=c("<div style=display:grid;gap:0.5rem;><!$><!/><!$><!/><!$><!/><div style=margin-block-start:1rem;>"),Gr=c("<div style=display:flex;flex-wrap:wrap;gap:0.5rem;align-items:center;><!$><!/> <span>Neuen Slot erfassen"),Hr=c("<em>WÃ¤hle eine Tag:"),Yr=c("<div style=display:flex;flex-wrap:wrap;gap:.5rem;><!$><!/><!$><!/>"),Br=c("<em>WÃ¤hle eine Startzeit:"),Wt=c("<div style=display:flex;flex-wrap:wrap;gap:.5rem;>"),jt=c("<span style=white-space:nowrap;><!$><!/> Uhr"),zr=c("<em>WÃ¤hle eine Endzeit:");function Wr(e){return(()=>{var t=u(Ar),n=t.firstChild,i=n.nextSibling,[l,a]=d(i.nextSibling),o=l.nextSibling,[g,m]=d(o.nextSibling);return s(t,r(Zr,{get store(){return e.store},get registrations(){return e.registrations}}),l,a),s(t,r(E,{get when(){return e.slotMissing},get children(){return r(A,{type:"danger",children:"WÃ¤hle mindestens einen Zeitslot aus."})}}),g,m),t})()}const Et=1;function jr(e){function t(n){const i=Oe(n.open,!0);return n.breaks.map(a=>Oe(a,!0)).reduce((a,o)=>{const g=o.at(0),m=o.at(-1);if(g===void 0||m===void 0)return a;const h=[];return a.forEach($=>{const S=[],_=[];$.forEach(b=>{b<=g&&S.push(b),m<=b&&_.push(b)}),S.length>0&&h.push(S),_.length>0&&h.push(_)}),h},[i]).map(a=>{const o=a.slice(0,Et*-1);return ln(o.map(g=>{const m=a.filter(h=>h>=g+Et);return[g,m]}))}).reduce((a,o)=>({...a,...o}),{})}return{SATURDAY:t(e.SATURDAY),SUNDAY:t(e.SUNDAY)}}function Zr(e){const[t,n]=R(e.store),[i,l]=R({dialog:he()}),a=Be(()=>jr(Se));function o(h){n(t.concat(h))}function g(h){l("dialog","open",!1),l("slot",void 0),n(t.filter($=>$.uuid!==h))}function m(h){l("dialog","open",!0),l("slot",t.find($=>$.uuid===h))}return[r(qr,{get daySections(){return a()},chooseTimeSlot:o}),u(yt),u(yt),r(be,{get store(){return i.dialog},title:"Zeitslot lÃ¶schen",onClose:()=>l("slot",void 0),get children(){return[(()=>{var h=u(wr),$=h.firstChild,S=$.nextSibling,[_,b]=d(S.nextSibling),v=_.nextSibling,k=v.nextSibling,[x,C]=d(k.nextSibling),D=x.nextSibling,O=D.nextSibling,[I,H]=d(O.nextSibling);return I.nextSibling,s(h,()=>y.days[i.slot?.day],_,b),s(h,()=>i.slot?.from,x,C),s(h,()=>i.slot?.to,I,H),h})(),r(B,{kind:"danger",icon:"trash",label:"LÃ¶schen",onClick:()=>g(i.slot?.uuid)})]}}),r(Kr,{slots:t,get registrations(){return e.registrations},confirmRemoval:m})]}function Kr(e){return(()=>{var t=u(Rr);return s(t,r(G,{get each(){return Jr(e.slots)},children:n=>(()=>{var i=u(Dr),l=i.firstChild,a=l.firstChild,[o,g]=d(a.nextSibling),m=o.nextSibling,h=m.nextSibling,[$,S]=d(h.nextSibling),_=$.nextSibling,b=_.nextSibling,[v,k]=d(b.nextSibling);v.nextSibling;var x=l.nextSibling,C=x.firstChild,D=C.firstChild,O=D.nextSibling,[I,H]=d(O.nextSibling),V=I.nextSibling,M=V.nextSibling,[Z,Q]=d(M.nextSibling),X=C.nextSibling,K=X.firstChild,re=K.nextSibling,Y=re.nextSibling,[ne,ie]=d(Y.nextSibling),L=x.nextSibling,ee=L.nextSibling;return s(l,()=>y.days[n.day],o,g),s(l,()=>n.from,$,S),s(l,()=>n.to,v,k),s(C,()=>n.to-n.from,I,H),s(C,()=>n.to-n.from>1?"Stunden":"Stunde",Z,Q),s(X,r(ue,{get children(){return[r(T,{get when(){return e.registrations.loading},get children(){return u(Tr)}}),r(T,{get when(){return e.registrations()},children:z=>{const q=z();if(q.kind==="FAILURE")return u(Ur);const de=q.data.entries.filter(U=>U.uuid===n.uuid).map(U=>U.name);return P(()=>de.join(", ")||u(Or))}})]}}),ne,ie),s(ee,r(ut,{get fallback(){return u(Mr)},get children(){return r(E,{get when(){return e.registrations()},children:z=>{const q=z();return q.kind==="FAILURE"?u(xt):q.data.entries.filter(U=>U.uuid===n.uuid).map(U=>U.name).length>0?u(xt):(()=>{var U=u(Pr),ce=U.firstChild,le=ce.firstChild,ae=le.firstChild,[J,me]=d(ae.nextSibling);return J.nextSibling,ce.$$click=()=>e.confirmRemoval(n.uuid),s(le,r(W,{icon:"trash"}),J,me),ot(),U})()}})}})),i})()})),t})()}function qr(e){const[t,n]=R({slot:{kind:"CHOOSE_DAY"},dialog:he()});function i(){n("slot",{kind:"CHOOSE_DAY"}),n("dialog","open",!1)}function l(a){e.chooseTimeSlot(a),i()}return[r(j,{kind:"success",get label(){return(()=>{var a=u(Gr),o=a.firstChild,[g,m]=d(o.nextSibling);return g.nextSibling,s(a,r(W,{icon:"circle-plus"}),g,m),a})()},onClick:()=>n("dialog","open",!0)}),r(be,{title:"Zeitslot erfassen",get store(){return t.dialog},size:"medium",onClose:i,get children(){return r(ue,{get children(){return[r(T,{get when(){return t.slot.kind==="CHOOSE_DAY"},get children(){var a=u(Nr);return s(a,r(Fe,{changeDay:o=>n("slot",{kind:"CHOOSE_START",day:o})})),a}}),r(T,{get when(){return t.slot.kind==="CHOOSE_START"},get children(){var a=u(Ir),o=a.firstChild,[g,m]=d(o.nextSibling),h=g.nextSibling,[$,S]=d(h.nextSibling);return s(a,r(Fe,{get chosenDay(){return t.slot.kind==="CHOOSE_START"?t.slot.day:void 0},changeDay:_=>n("slot",{kind:"CHOOSE_START",day:_})}),g,m),s(a,r(nt,{get startTimes(){return P(()=>t.slot.kind==="CHOOSE_START")()?Je(e.daySections[t.slot.day]):[]},changeStart:_=>n("slot",{kind:"CHOOSE_END",start:_})}),$,S),a}}),r(T,{get when(){return t.slot.kind==="CHOOSE_END"},get children(){var a=u(Lr),o=a.firstChild,[g,m]=d(o.nextSibling),h=g.nextSibling,[$,S]=d(h.nextSibling),_=$.nextSibling,[b,v]=d(_.nextSibling);return s(a,r(Fe,{get chosenDay(){return t.slot.kind==="CHOOSE_END"?t.slot.day:void 0},changeDay:k=>n("slot",{kind:"CHOOSE_START",day:k})}),g,m),s(a,r(nt,{get chosenStart(){return t.slot.kind==="CHOOSE_END"?t.slot.start:void 0},get startTimes(){return P(()=>t.slot.kind==="CHOOSE_END")()?Je(e.daySections[t.slot.day]):[]},changeStart:k=>n("slot",{kind:"CHOOSE_END",start:k})}),$,S),s(a,r(Ct,{get endTimes(){return t.slot.kind==="CHOOSE_END"?e.daySections[t.slot.day][t.slot.start]??[]:[]},changeEnd:k=>{t.slot.kind==="CHOOSE_END"&&n("slot",{kind:"WAIT_FOR_CONFIRMATION",day:t.slot.day,start:t.slot.start,end:k})}}),b,v),a}}),r(T,{get when(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"},get children(){var a=u(Fr),o=a.firstChild,[g,m]=d(o.nextSibling),h=g.nextSibling,[$,S]=d(h.nextSibling),_=$.nextSibling,[b,v]=d(_.nextSibling),k=b.nextSibling;return s(a,r(Fe,{get chosenDay(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?t.slot.day:void 0},changeDay:x=>n("slot",{kind:"CHOOSE_START",day:x})}),g,m),s(a,r(nt,{get chosenStart(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?t.slot.start:void 0},get startTimes(){return P(()=>t.slot.kind==="WAIT_FOR_CONFIRMATION")()?Je(e.daySections[t.slot.day]):[]},changeStart:x=>n("slot",{kind:"CHOOSE_END",start:x})}),$,S),s(a,r(Ct,{get chosenEnd(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?t.slot.end:void 0},get endTimes(){return t.slot.kind==="WAIT_FOR_CONFIRMATION"?e.daySections[t.slot.day][t.slot.start]??[]:[]},changeEnd:x=>{t.slot.kind==="WAIT_FOR_CONFIRMATION"&&n("slot",{kind:"WAIT_FOR_CONFIRMATION",day:t.slot.day,start:t.slot.start,end:x})}}),b,v),s(k,r(j,{get label(){return`Slot "${t.slot.kind==="WAIT_FOR_CONFIRMATION"?`${y.days[t.slot.day]}, von ${t.slot.start} bis ${t.slot.end} Uhr`:""}" erstellen`},kind:"success",onClick:()=>{t.slot.kind==="WAIT_FOR_CONFIRMATION"&&l({uuid:crypto.randomUUID(),day:t.slot.day,from:t.slot.start,to:t.slot.end})}})),a}})]}})}})]}function Fe(e){return[u(Hr),(()=>{var t=u(Yr),n=t.firstChild,[i,l]=d(n.nextSibling),a=i.nextSibling,[o,g]=d(a.nextSibling);return s(t,r(j,{get kind(){return e.chosenDay==="SATURDAY"?"success":"gray"},label:"Samstag",onClick:()=>e.changeDay("SATURDAY")}),i,l),s(t,r(j,{get kind(){return e.chosenDay==="SUNDAY"?"success":"gray"},label:"Sonntag",onClick:()=>e.changeDay("SUNDAY")}),o,g),t})()]}function nt(e){return[u(Br),(()=>{var t=u(Wt);return s(t,r(G,{get each(){return e.startTimes},children:n=>r(j,{get kind(){return e.chosenStart===n?"success":"gray"},get label(){return(()=>{var i=u(jt),l=i.firstChild,[a,o]=d(l.nextSibling);return a.nextSibling,s(i,n,a,o),i})()},onClick:()=>e.changeStart(n)})})),t})()]}function Ct(e){return[u(zr),(()=>{var t=u(Wt);return s(t,r(G,{get each(){return e.endTimes},children:n=>r(j,{get kind(){return e.chosenEnd===n?"success":"gray"},get label(){return(()=>{var i=u(jt),l=i.firstChild,[a,o]=d(l.nextSibling);return a.nextSibling,s(i,n,a,o),i})()},onClick:()=>e.changeEnd(n)})})),t})()]}function Jr(e){return e.toSorted((t,n)=>t.day!==n.day?t.day==="SATURDAY"?-1:1:t.from-n.from)}st(["click"]);function Vr(e){const t=new Date;return async()=>new Promise(n=>{setTimeout(()=>(console.error("NOT YET IMPLEMENTED: `publishGameround`",e,t),n()),500)})}function Qr(e,t){const n=new Date;return async()=>new Promise(i=>{setTimeout(()=>(console.error("NOT YET IMPLEMENTED: `sendGameroundUpdate`",e,t.join(", "),n),i()),500)})}var Me=c("<br>"),Xr=c("<div class=content><p>MÃ¶chtest du diese Spielrunde gerne verÃ¶ffentlichen?</p><!$><!/>"),ei=c("<em>Informationen zu den Anmeldungen mÃ¼ssen geladen werden..."),ti=c("<em>Du kannst kein Update versenden, da sich noch niemand fÃ¼r diese Spielrunde angemeldet hat."),ni=c("<p>An: <!$><!/>"),ri=c("<em>Du kannst die Spielrunde nur lÃ¶schen, wenn du zuerst alle Zeitslots entfernt hast."),ii=c("<div class=content><p>Bist du sicher, dass du die Spielrunde lÃ¶schen mÃ¶chtest?</p><!$><!/>"),li=c('<form novalidate><!$><!/><!$><!/><!$><!/><div style="display:grid;grid-template-columns:repeat(2, 1fr);gap:1rem;"><!$><!/><!$><!/></div><!$><!/><!$><!/><!$><!/><fieldset><legend>Kategorien (optional)</legend><!$><!/></fieldset><!$><!/><div style=display:flex;flex-wrap:wrap;gap:1rem;justify-content:space-between;><!$><!/><div style=display:flex;flex-wrap:wrap;gap:1rem;><!$><!/><!$><!/><!$><!/>'),ai=c("<h4>Spielrunde inkomplett"),si=c("<p>Du hast noch einen oder mehre Fehler/fehlende Informationen in dieser Spielrunde:"),oi=c("<li>Â«TitelÂ» ist ein Pflichtfeld."),ui=c("<li>Â«kurz BeschreibungÂ» ist ein Pflichtfeld."),di=c("<li>Â«kurz BeschreibungÂ» ist zu lang."),ci=c("<li>Â«lange BeschreibungÂ» ist zu lang."),gi=c("<li>Mindest einen Zeitslot muss ausgewÃ¤hlt werden."),mi=c("<ul><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),$i=c("<p><strong>ErklÃ¤rung:</strong> Hast du eine wichtige Ãnderung an dieser Spielrunde durchgefÃ¼hrt, wÃ¤hrend bereits Spielende angemeldet waren? Lass hiermit die Angemeldeten wissen, was du geÃ¤ndert hast. Wichtige Ãnderungen kÃ¶nnen sein: System geÃ¤ndert, Kategorien geÃ¤ndert. FÃ¼r kleine Ãnderungen, wie z.B. Rechtschreibfehler, sollte dies nicht genutzt werden."),hi=c("<p><em>Halte dich kurz und am besten Stichwortartig."),Si=c("<form><!$><!/><!$><!/>"),_i=c("<div style=display:grid;gap:0.5rem;margin-block-end:1rem;>");function bi(e){const t=e.allRounds.find(n=>n.uuid===e.uuid);return r(E,{get fallback(){return e.fallback},when:t,children:n=>e.children(n())})}function fi(e){const[t,n]=R(e.store),[i,l]=R({delete:he(),publish:he(),sendUpdate:he()});function a(g){g.preventDefault(),l("publish","open",!0)}function o(){e.changePage({kind:"GAMEMASTER"})}return[r(Lt,{kind:"special",get children(){return["Status: ",P(()=>y.publishingSteps[t.kind])]}}),u(Me),u(Me),r(yi,{store:t,get registrations(){return e.registrations},onSubmit:a,onCancel:()=>l("delete","open",!0),onSendUpdate:()=>l("sendUpdate","open",!0),goBack:o}),r(vi,{get store(){return i.publish},get title(){return t.title.value},onPublish:()=>{n("kind","published"),l("publish","open",!1),e.queue.enqueue(Vr(t.uuid))}}),r(ki,{get store(){return i.sendUpdate},get players(){return Ci(e.registrations,t.slots.map(g=>g.uuid))},onSend:g=>{e.queue.enqueue(Qr(g,t.slots.map(m=>m.uuid)))}}),r(pi,{get store(){return i.delete},get hasSlots(){return t.slots.length!==0},get title(){return t.title.value},onDelete:()=>{n("kind","deleted"),e.changePage({kind:"GAMEMASTER"})}})]}function vi(e){return r(be,{get store(){return e.store},title:"Spielrunde verÃ¶ffentlichen",onClose:()=>{},get children(){var t=u(Xr),n=t.firstChild,i=n.nextSibling,[l,a]=d(i.nextSibling);return s(t,r(B,{kind:"success",icon:"circle-plus",get label(){return`Ja, bitte "${e.title||"["+y.missingTitle+"]"}" verÃ¶ffentlichen.`},get onClick(){return e.onPublish}}),l,a),t}})}function ki(e){return r(be,{get store(){return e.store},title:"Update senden",onClose:()=>{},size:"medium",get children(){return()=>e.players.kind==="LOADING"?u(ei):e.players.kind==="ERROR"?P(()=>y.error.general):e.players.data.length===0?u(ti):[(()=>{var t=u(ni),n=t.firstChild,i=n.nextSibling,[l,a]=d(i.nextSibling);return s(t,()=>e.players.data.map(o=>o.name).join(", "),l,a),t})(),u(Me),r(xi,{get onSend(){return e.onSend}})]}})}function pi(e){return r(be,{get store(){return e.store},title:"Spielrunde lÃ¶schen",onClose:()=>{},get children(){return[r(E,{get when(){return e.hasSlots},get children(){return u(ri)}}),r(E,{get when(){return!e.hasSlots},get children(){var t=u(ii),n=t.firstChild,i=n.nextSibling,[l,a]=d(i.nextSibling);return s(t,r(B,{kind:"danger",icon:"trash",get label(){return`Ja, bitte "${e.title||"["+y.missingTitle+"]"}" lÃ¶schen.`},get onClick(){return e.onDelete}}),l,a),t}})]}})}function yi(e){const[t]=R(e.store),n=Be(()=>Wn(t));return(()=>{var i=u(li),l=i.firstChild,[a,o]=d(l.nextSibling),g=a.nextSibling,[m,h]=d(g.nextSibling),$=m.nextSibling,[S,_]=d($.nextSibling),b=S.nextSibling,v=b.firstChild,[k,x]=d(v.nextSibling),C=k.nextSibling,[D,O]=d(C.nextSibling),I=b.nextSibling,[H,V]=d(I.nextSibling),M=H.nextSibling,[Z,Q]=d(M.nextSibling),X=Z.nextSibling,[K,re]=d(X.nextSibling),Y=K.nextSibling,ne=Y.firstChild,ie=ne.nextSibling,[L,ee]=d(ie.nextSibling),z=Y.nextSibling,[q,de]=d(z.nextSibling),U=q.nextSibling,ce=U.firstChild,[le,ae]=d(ce.nextSibling),J=le.nextSibling,me=J.firstChild,[fe,Ee]=d(me.nextSibling),Ce=fe.nextSibling,[$e,ve]=d(Ce.nextSibling),Ae=$e.nextSibling,[we,w]=d(Ae.nextSibling);return s(i,r(E,{get when(){return t.kind==="published"},get children(){return r(At,{get errors(){return n()}})}}),a,o),s(i,r(Ue,{get store(){return t.title},label:"Titel",name:"title",get showErrors(){return t.kind==="published"?"ALWAYS":"ON_BLUR"},get errors(){return n().titleMissing?[y.mandatoryField]:[]}}),m,h),s(i,r(Ue,{get store(){return t.system},label:"System (optional)",name:"System"}),S,_),s(b,r($t,{get store(){return t.playerCount.min},label:"Anzahl Mitspielende (Minimum)",name:"playerCountMin",min:1,get max(){return t.playerCount.max.value}}),k,x),s(b,r($t,{get store(){return t.playerCount.max},label:"Anzahl Mitspielende (Maximum)",name:"playerCountMax",get min(){return t.playerCount.min.value}}),D,O),s(i,r(it,{get store(){return t.description.short},label:"kurze Beschreibung",name:"descriptionShort",size:"small",get showErrors(){return t.kind==="published"?"ALWAYS":"ON_BLUR"},get errors(){return P(()=>!!n().descriptionShortMissing)()?[y.mandatoryField]:P(()=>!!n().descriptionShortTooLong)()?[y.charLimitBy.replace("{}",String(We))]:[]}}),H,V),s(i,r(it,{get store(){return t.description.long},label:"lange Beschreibung (optional)",name:"descriptionLong",get showErrors(){return t.kind==="published"?"ALWAYS":"ON_BLUR"},get errors(){return P(()=>!!n().descriptionLongTooLong)()?[y.charLimitBy.replace("{}",String(Bt))]:[]}}),Z,Q),s(i,r(Wr,{get store(){return e.store.slots},get registrations(){return e.registrations},get slotMissing(){return n().slotMissing}}),K,re),s(Y,r(Ei,{get store(){return t.tagNames}}),L,ee),s(i,r(At,{get errors(){return n()}}),q,de),s(U,r(B,{icon:"backward",label:"ZurÃ¼ck zu deinen Spielrunden",get onClick(){return e.goBack}}),le,ae),s(J,r(E,{get when(){return t.kind!=="deleted"},get children(){return r(B,{icon:"trash",kind:"danger",label:"LÃ¶schen",onClick:()=>e.onCancel()})}}),fe,Ee),s(J,r(E,{get when(){return t.kind==="draft"},get children(){return r(B,{icon:"circle-plus",get kind(){return n().hasErrors?"gray":"success"},get disabled(){return n().hasErrors},label:"Spielrunde verÃ¶ffentlichen",get onClick(){return n().hasErrors?void 0:e.onSubmit}})}}),$e,ve),s(J,r(E,{get when(){return t.kind==="published"},get children(){return r(B,{icon:"circle-plus",kind:"success",label:"Update an Spielende schicken",get onClick(){return e.onSendUpdate}})}}),we,w),i})()}function At(e){return r(E,{get when(){return e.errors.hasErrors},get children(){return r(A,{type:"danger",get children(){return[u(ai),u(si),(()=>{var t=u(mi),n=t.firstChild,[i,l]=d(n.nextSibling),a=i.nextSibling,[o,g]=d(a.nextSibling),m=o.nextSibling,[h,$]=d(m.nextSibling),S=h.nextSibling,[_,b]=d(S.nextSibling),v=_.nextSibling,[k,x]=d(v.nextSibling);return s(t,r(E,{get when(){return e.errors.titleMissing},get children(){return u(oi)}}),i,l),s(t,r(E,{get when(){return e.errors.descriptionShortMissing},get children(){return u(ui)}}),o,g),s(t,r(E,{get when(){return e.errors.descriptionShortTooLong},get children(){return u(di)}}),h,$),s(t,r(E,{get when(){return e.errors.descriptionLongTooLong},get children(){return u(ci)}}),_,b),s(t,r(E,{get when(){return e.errors.slotMissing},get children(){return u(gi)}}),k,x),t})()]}})}})}function xi(e){const[t,n]=R({updateText:{value:"",isDirty:!1},hasBeenSent:!1}),i=Be(()=>jn(t));return r(ue,{get fallback(){return r(A,{type:"success",children:"Nachricht wurde registriert und wird in den nÃ¤chsten 24 Stunden an die Spielenden verschickt."})},get children(){return r(T,{get when(){return!t.hasBeenSent},get children(){return[u($i),u(Me),u(hi),u(Me),(()=>{var l=u(Si),a=l.firstChild,[o,g]=d(a.nextSibling),m=o.nextSibling,[h,$]=d(m.nextSibling);return Ot(l,"novalidate",!0),s(l,r(it,{get store(){return t.updateText},label:"Zusammenfassung der Ãnderung",name:"updateText",size:"small",showErrors:"ALWAYS",get errors(){return P(()=>!!i().missing)()?[y.mandatoryField]:P(()=>!!i().tooLong)()?[y.charLimitBy.replace("{}",String(zt))]:[]}}),o,g),s(l,r(B,{icon:"paper-plane",label:"Spielende informieren",get kind(){return i().hasErrors?"gray":"success"},get disabled(){return i().hasErrors},get onClick(){return i().hasErrors?void 0:()=>{e.onSend(t.updateText.value),n("hasBeenSent",!0)}}}),h,$),l})()]}})}})}function Ei(e){const[t,n]=R(e.store);return[(()=>{var i=u(_i);return s(i,r(G,{each:gt,children:l=>r(Nt,{get label(){return l.label},get description(){return l.description},get checked(){return t.includes(l.name)},get name(){return l.name},get value(){return l.name},onValueUpdate:a=>{n(a?t.concat([l.name]):t.filter(o=>o!==l.name))}})})),i})(),r(A,{get children(){return y.tagIdeas}})]}const Ci=(e,t)=>{if(e.loading)return{kind:"LOADING"};if(e.error)return{kind:"ERROR"};const n=e();return n===void 0||n.kind==="FAILURE"?{kind:"ERROR"}:{kind:"SUCCESS",data:n.data.entries.filter(i=>t.includes(i.uuid))}},Ai=It("kind",[f({kind:N("CHOOSE"),uuid:Re()}),f({kind:N("PLAYER"),uuid:Re()}),f({kind:N("GAME"),uuid:p().uuid()}),f({kind:N("GAMEMASTER"),uuid:Re()}),f({kind:N("HELPING"),uuid:Re()}),f({kind:N("SUMMARY"),uuid:Re()}),f({kind:N("EDIT_GAMEROUND"),uuid:p().uuid()})]);It("kind",[f({kind:N("CHOOSE")}),f({kind:N("PLAYER")}),f({kind:N("GAME"),uuid:p().uuid()}),f({kind:N("GAMEMASTER")}),f({kind:N("HELPING")}),f({kind:N("SUMMARY")}),f({kind:N("EDIT_GAMEROUND"),uuid:p().uuid()})]);const wi=ze(["SAVING","IDLE","ERROR"]),Ri=f({saveState:wi,page:Ai,secret:p(),showCreateMessage:xe(),isDebugging:xe()});function Zt(e){const t=e.searchParams.get("page")??"",n=e.searchParams.get("uuid")??null,i=e.searchParams.get("secret")??"",l=e.searchParams.get("showCreateMessage")==="true",a=e.searchParams.get("debug")==="true",o=Ri.safeParse({saveState:"IDLE",page:{kind:t.toUpperCase(),uuid:n},secret:i,showCreateMessage:l,isDebugging:a});return o.success?o.data:{saveState:"IDLE",page:{kind:"CHOOSE",uuid:null},secret:i,showCreateMessage:l,isDebugging:a}}function Ti(e,t){return e.kind!==t.kind?!1:e.kind==="EDIT_GAMEROUND"&&t.kind==="EDIT_GAMEROUND"||e.kind==="GAME"&&t.kind==="GAME"?e.uuid===t.uuid:!0}const Di="2024-08-15T07:45:21.335Z",Ye={game:"37831e19-29d6-40bd-b99d-fb91b78aa7f9",slot:"bfcbd156-b703-4664-9944-8936aede8476"};function Ui(e,t){const n=localStorage.getItem(e);return n===null?t:n}function Oi(e,t){localStorage.setItem(e,t)}const Kt="SAVE",Mi={version:1,init:{name:"John Doe",email:"john@doe.ch",mobile:"+41 66 123 45 67"},lastSaved:Di,playing:{wantsUpdates:!1},master:{games:[{uuid:Ye.game,kind:"published",title:"Grolle in der Dunkelheit",system:"Warhammer Fantasy Rollenspiel",description:{short:"Ein kurzes Abenteuer bei dem es um Fantasy, Action und einfaches Rollenspiel geht.",long:"Eine kleine Gruppe wagt sich in die dunklen SchÃ¤chten einer Mine und weiter hinab, um einen mÃ¤chtigen Gegenstand wieder zu erlangen. Wie werden die GefÃ¤hrten auf die Gefahren des Untergrundes reagieren und welche Gefahren lauern in der Finsternis?"},slots:[{uuid:Ye.slot,day:"SATURDAY",from:10,to:12},{uuid:crypto.randomUUID(),day:"SUNDAY",from:14,to:17}],playerCount:{min:1,max:3},tagNames:["deutsch"]}],wantsHelp:!1},helping:{}};async function Pi(){return new Promise(e=>setTimeout(()=>e({kind:"SUCCESS",data:JSON.parse(Ui(Kt,JSON.stringify(Mi)))}),1e3))}async function Ni(e,t){return new Promise(n=>setTimeout(()=>(Oi(Kt,JSON.stringify(e)),n({kind:"SUCCESS",data:t})),1e3))}const Ii=[{uuid:crypto.randomUUID(),gamemaster:"Game Master",title:"Grolle in der Dunkelheit",system:"Warhammer Fantasy Rollenspiel",description:{short:"Ein kurzes Abenteuer bei dem es um Fantasy, Action und einfaches Rollenspiel geht.",long:"Eine kleine Gruppe wagt sich in die dunklen SchÃ¤chten einer Mine und weiter hinab, um einen mÃ¤chtigen Gegenstand wieder zu erlangen. Wie werden die GefÃ¤hrten auf die Gefahren des Untergrundes reagieren und welche Gefahren lauern in der Finsternis?"},slot:{day:"SATURDAY",from:10,to:13},playerCount:{min:1,max:3,reserved:0},tags:["ab12jahren"]},{uuid:crypto.randomUUID(),gamemaster:"Other Game Master",title:"Acrimony",system:"D&D",description:{short:"Ein Lo-Fi Space Western Abenteuer",long:'Ein Lo-Fi Space Western Abenteuer: "Eine frisch formierte Gruppe von KopfgeldjÃ¤gern wird mit einer riskanten Mission betraut: Sie mÃ¼ssen den berÃ¼chtigten Outlaw Jeb "Rusty" Rourke in der abgeschiedenen Grenzstadt aufspÃ¼ren. Bei dieser unbarmherzigen Jagd lernen die Spieler die harte RealitÃ¤t der Kopfgeldjagd kennen, wo jeder Schuss und jede Entscheidung Ã¼ber ihr Schicksal entscheidet.'},slot:{day:"SATURDAY",from:10,to:13},playerCount:{min:2,max:8,reserved:3},tags:["ab12jahren","horror"]},{uuid:crypto.randomUUID(),gamemaster:"Some Other Game Master",title:"Solo RPGs",system:"",description:{short:"Wir spielen primÃ¤r das Solo Rollenspiel NoteQuest, werden aber kurz auch noch ein paar andere Solo Rollenspiele miteinander anschauen.",long:""},slot:{day:"SATURDAY",from:14,to:18},playerCount:{min:2,max:4,reserved:3},tags:[]}];async function Li(){return new Promise(e=>setTimeout(()=>e({kind:"SUCCESS",data:Ii}),5e3))}const Fi={entries:[{uuid:Ye.slot,name:"Alice"},{uuid:Ye.slot,name:"Bob"}]};async function Gi(e){return new Promise(t=>setTimeout(()=>t({entries:Fi.entries.filter(n=>e.includes(n.uuid))}),5e3))}var Hi=c("<div aria-atomic=true><!$><!/><!$><!/>"),Yi=c("<div class=toast-container aria-live=polite aria-atomic=true>");const[ge,Pe]=R([]);function Bi(e){const t=()=>{const n=["toast"];return e.options.kind!==void 0&&n.push(`toast-${e.options.kind}`),n.join(" ")};return(()=>{var n=u(Hi),i=n.firstChild,[l,a]=d(i.nextSibling),o=l.nextSibling,[g,m]=d(o.nextSibling);return s(n,()=>e.options.message,l,a),s(n,r(E,{get when(){return e.options.dismissable},get children(){return r(j,{kind:"ghost",get label(){return r(W,{icon:"xmark",classes:["toast-dismiss"]})},get onClick(){return e.dismiss}})}}),g,m),oe(h=>{var $=t(),S=e.options.kind==="danger"?"alert":"status",_=e.options.kind==="danger"?"assertive":"polite";return $!==h.e&&_e(n,h.e=$),S!==h.t&&He(n,"role",h.t=S),_!==h.a&&He(n,"aria-live",h.a=_),h},{e:void 0,t:void 0,a:void 0}),n})()}function zi(){function e(t){ge.find(n=>n.uuid===t)?.cleanup(),Pe(ge.filter(n=>n.uuid!==t))}return(()=>{var t=u(Yi);return s(t,r(G,{each:ge,children:n=>r(Bi,{options:n,dismiss:()=>e(n.uuid)})})),t})()}function Wi(e,t){if(t?.uuid!==void 0&&ge.find(g=>g.uuid===t.uuid)!==void 0)return lt(t.uuid,e,t);const n=t?.uuid??crypto.randomUUID(),i=t?.duration??5e3,l=t?.kind??"gray",a=t?.dismissable,o=setTimeout(()=>{Pe(ge.filter(g=>g.uuid!==n))},i);return Pe(ge.length,{uuid:n,kind:l,message:e,duration:i,dismissable:a,cleanup:()=>clearTimeout(o)}),n}function lt(e,t,n){const i=ge.find(m=>m.uuid===e);if(i===void 0)return e;i.cleanup();const l=n.duration??i.duration,a=n.kind??i.kind,o=n?.dismissable??i.dismissable,g=setTimeout(()=>{Pe(ge.filter(m=>m.uuid!==e))},l);return Pe(m=>m.uuid===e,{uuid:e,kind:a,message:t,duration:l,dismissable:o,cleanup:()=>clearTimeout(g)}),e}const ji={version:1,init:{name:"",email:"",mobile:""},lastSaved:new Date().toISOString(),playing:{wantsUpdates:!0},master:{games:[],wantsHelp:!1},helping:{}};async function Zi(e){const t=new URL(at("/rst25/load"));t.searchParams.append("secret",e);const n=await fetch(t);if(!n.ok)return{kind:"FAILURE"};const i=await n.json();return typeof i=="object"&&i!==null?{kind:"SUCCESS",data:Object.assign(ji,i)}:(console.error("`last_save` not found on ",i),{kind:"FAILURE"})}async function Ki(e,t){try{const n=await fetch(at("/rst25/save"),{method:"post",body:JSON.stringify({secret:t,save:e}),headers:{"Content-Type":"application/json"}});return n.ok?{kind:"SUCCESS",data:t}:(console.error(await n.text()),{kind:"FAILURE"})}catch(n){return console.error(n),{kind:"FAILURE"}}}async function qi(){try{const e=await fetch(at("/rst25/program"),{headers:{"Content-Type":"application/json"}});return e.ok?{kind:"SUCCESS",data:await e.json()}:(console.error(await e.text()),{kind:"FAILURE"})}catch(e){return console.error(e),{kind:"FAILURE"}}}const Ji=f({name:p(),email:p(),mobile:p()}),Vi=f({name:p(),email:p(),mobile:p()}),Qi=f({wantsUpdates:xe()}),Xi=f({wantsUpdates:xe()}),el=f({games:te(Hn),wantsHelp:xe()}),tl=f({games:te(Yt),wantsHelp:xe()}),nl=f({}),rl=f({}),il=f({version:N(1),init:Ji,lastSaved:p(),playing:Qi,master:el,helping:nl}),ll=f({version:N(1),init:Vi,lastSaved:mn.date(),playing:Xi,master:tl,helping:rl});async function al(e){const t=e==="demo"?await Pi():await Zi(e);if(t.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE"};const n=il.safeParse(t.data);if(!n.success)return console.error(n.error),{kind:"FAILURE"};const i=sl(n.data);return i.success?{kind:"SUCCESS",data:i.data}:{kind:"FAILURE"}}function sl(e){return ll.safeParse(e)}const rt=crypto.randomUUID();async function ol(e,t,n){const[i,l]=R(e);l("saveState","SAVING"),Wi("Am Speichern...",{uuid:rt,dismissable:!1});const a=new Date;t.lastSaved=a;const o=ul(t);try{if((n==="demo"?await Ni(o,n):await Ki(o,n)).kind==="FAILURE")throw Error("")}catch(g){return l("saveState","ERROR"),console.error(g),lt(rt,"Speichern war nicht mÃ¶glich!",{kind:"danger",duration:1e4,dismissable:!0}),{kind:"FAILURE"}}return lt(rt,`Zuletzt gespeichert um: ${Dt(a)} Uhr`,{kind:"success",dismissable:!0}),l("saveState","IDLE"),{kind:"SUCCESS",data:a}}function ul(e){return{...e,lastSaved:String(e.lastSaved),master:{...e.master,games:e.master.games.map(zn)}}}const dl=an(ol,1e3);var cl=c("<div class=tooltip-wrapper><div class=tooltip></div><!$><!/>");function De(e){return(()=>{var t=u(cl),n=t.firstChild,i=n.nextSibling,[l,a]=d(i.nextSibling);return s(n,()=>e.tooltip),s(t,()=>e.children,l,a),t})()}var gl=c("<div class=quickmenu-wrapper><div class=quickmenu><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),ml=c('<div class="quickmenu extended"><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>'),$l=c("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center;><!$><!/><em>Zuletzt gespeichert um: <!$><!/> Uhr"),hl=c("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center;><!$><!/><em>Am Speichern..."),Sl=c("<div style=margin-block-start:1rem;display:flex;gap:0.5rem;align-items:center;><!$><!/><em>Speichern war nicht mÃ¶glich!");function _l(e){return(()=>{var t=u(gl),n=t.firstChild,i=n.firstChild,[l,a]=d(i.nextSibling),o=l.nextSibling,[g,m]=d(o.nextSibling),h=g.nextSibling,[$,S]=d(h.nextSibling),_=$.nextSibling,[b,v]=d(_.nextSibling),k=b.nextSibling,[x,C]=d(k.nextSibling);return s(n,r(De,{tooltip:"Zur Ãbersicht",get children(){return r(j,{get label(){return r(W,{icon:"backward"})},onClick:()=>e.changePage({kind:"CHOOSE"})})}}),l,a),s(n,r(De,{tooltip:"Zu den Spielrunden",get children(){return r(j,{get label(){return r(W,{icon:"dice-d20"})},onClick:()=>e.changePage({kind:"PLAYER"})})}}),g,m),s(n,r(De,{tooltip:"Zu deinen Spielrunden",get children(){return r(j,{get label(){return r(W,{icon:"grid-2-plus"})},onClick:()=>e.changePage({kind:"GAMEMASTER"})})}}),$,S),s(n,r(De,{tooltip:"Zum Helferplan",get children(){return r(j,{get label(){return r(W,{icon:"hand-heart"})},onClick:()=>e.changePage({kind:"HELPING"})})}}),b,v),s(n,r(De,{tooltip:"Zur Zusammenfassung",get children(){return r(j,{get label(){return r(W,{icon:"list"})},onClick:()=>e.changePage({kind:"SUMMARY"})})}}),x,C),t})()}function bl(e){return[r(A,{type:"gray",get children(){var t=u(ml),n=t.firstChild,[i,l]=d(n.nextSibling),a=i.nextSibling,[o,g]=d(a.nextSibling),m=o.nextSibling,[h,$]=d(m.nextSibling),S=h.nextSibling,[_,b]=d(S.nextSibling),v=_.nextSibling,[k,x]=d(v.nextSibling);return s(t,r(B,{icon:"backward",label:"Zur Ãbersicht",onClick:()=>e.changePage({kind:"CHOOSE"})}),i,l),s(t,r(B,{icon:"dice-d20",label:"Zu den Spielrunden",onClick:()=>e.changePage({kind:"PLAYER"})}),o,g),s(t,r(B,{icon:"grid-2-plus",label:"Zu deinen Spielrunden",onClick:()=>e.changePage({kind:"GAMEMASTER"})}),h,$),s(t,r(B,{icon:"hand-heart",label:"Zum Helferplan",onClick:()=>e.changePage({kind:"HELPING"})}),_,b),s(t,r(B,{icon:"list",label:"Zur Zusammenfassung",onClick:()=>e.changePage({kind:"SUMMARY"})}),k,x),t}}),r(fl,{get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}})]}function fl(e){return r(ue,{get children(){return[r(T,{get when(){return e.saveState==="IDLE"},get children(){var t=u($l),n=t.firstChild,[i,l]=d(n.nextSibling),a=i.nextSibling,o=a.firstChild,g=o.nextSibling,[m,h]=d(g.nextSibling);return m.nextSibling,s(t,r(W,{icon:"circle-check"}),i,l),s(a,()=>Dt(e.lastSaved),m,h),t}}),r(T,{get when(){return e.saveState==="SAVING"},get children(){var t=u(hl),n=t.firstChild,[i,l]=d(n.nextSibling);return i.nextSibling,s(t,r(W,{icon:"floppy-disk-circle-arrow-right"}),i,l),t}}),r(T,{get when(){return e.saveState==="ERROR"},get children(){var t=u(Sl),n=t.firstChild,[i,l]=d(n.nextSibling);return i.nextSibling,s(t,r(W,{icon:"triangle-exclamation"}),i,l),t}})]}})}var vl=c("<div class=page><!$><!/><div class=page-content><h2></h2><br><!$><!/></div><!$><!/>"),kl=c("<div class=extended-wrapper style=margin-block-start:1rem;>");function pe(e){return(()=>{var t=u(vl),n=t.firstChild,[i,l]=d(n.nextSibling),a=i.nextSibling,o=a.firstChild,g=o.nextSibling,m=g.nextSibling,[h,$]=d(m.nextSibling),S=a.nextSibling,[_,b]=d(S.nextSibling);return s(t,(()=>{var v=P(()=>e.showQuickmenu!==!1);return()=>v()?r(_l,{get changePage(){return e.changePage},get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}}):null})(),i,l),s(o,()=>e.title),s(a,()=>e.children,h,$),s(t,(()=>{var v=P(()=>e.showQuickmenu!==!1);return()=>v()?(()=>{var k=u(kl);return s(k,r(bl,{get changePage(){return e.changePage},get saveState(){return e.saveState},get lastSaved(){return e.lastSaved}})),k})():null})(),_,b),t})()}const pl=f({uuid:p().uuid(),name:p()}),qt=f({entries:te(pl)}),yl=qt;async function xl(e,t){console.log("loadRegistration still mocked",e.substring(0,4),"...");const n=await Gi(t),i=qt.safeParse(n);if(!i.success)return{kind:"FAILURE"};const l=El(i.data);return l.success?{kind:"SUCCESS",data:l.data}:{kind:"FAILURE"}}function El(e){return yl.safeParse(e)}const Cl=f({uuid:p().uuid(),title:p(),system:p(),gamemaster:p(),description:f({short:p(),long:p()}),slot:f({day:ct,from:F(),to:F()}),playerCount:f({min:F(),max:F(),reserved:F()}),tags:te(p())}),Al=te(Cl),wl=f({uuid:p().uuid(),title:p(),system:p(),gamemaster:p(),description:f({short:p(),long:p()}),slot:f({day:ct,from:F(),to:F()}),playerCount:f({min:F(),max:F(),reserved:F()}),tags:te(p())}),Rl=te(wl);async function Tl(e){const t=e==="demo"?await Li():await qi();if(t.kind==="FAILURE")return console.error("Unexpected error. Maybe network, maybe server error."),{kind:"FAILURE"};const n=Al.safeParse(t.data);if(!n.success)return{kind:"FAILURE"};const i=Dl(n.data);return i.success?{kind:"SUCCESS",data:i.data}:{kind:"FAILURE"}}function Dl(e){return Rl.safeParse(e)}var Ul=c("<br>"),wt=c("<pre>"),Ol=c("<hr>"),Ml=c("<div><code>Registrations (read-only)"),Pl=c("<em>loading...");function Nl(e){const t=new URL(location.href);t.searchParams.set("page",e.page.kind.toLowerCase()),e.page.kind==="EDIT_GAMEROUND"&&t.searchParams.set("uuid",e.page.uuid),t.searchParams.delete("showCreateMessage"),history.replaceState({page:e},"",t);const n=y.pageTitle[e.page.kind];document.title=y.metaTitle.replace("{}",n)}function Il(e){const[t,n]=R(e.page);return(i,l)=>{if(Ti(i,t))return;const a=l?.backButton??!1,o=l?.disableScroll??!1;if(!a){const m=new URL(location.href);m.searchParams.set("page",i.kind.toLowerCase()),i.kind==="EDIT_GAMEROUND"||i.kind==="GAME"?(m.searchParams.set("uuid",i.uuid),n(i)):(m.searchParams.delete("uuid"),n({...i,uuid:null})),history.pushState({page:i},"",m)}const g=y.pageTitle[i.kind];document.title=y.metaTitle.replace("{}",g),o||window.scrollTo({top:0})}}function Ll(e){Nl(e.meta);const[t,n]=R({meta:e.meta,save:e.save}),i=()=>t.save.master.games.flatMap($=>$.slots.map(S=>S.uuid)),[l]=Ge(i(),$=>xl(t.meta.secret,$)),[a]=Ge(()=>Tl(t.meta.secret)),[o,g]=Mt(!1);Ge(()=>JSON.stringify(t.save),async()=>{if(!o()){g(!0);return}const $=cn(t.save);try{const S=await dl(t.meta,$,t.meta.secret);S.kind==="FAILURE"?console.error(S):n("save","lastSaved",S.data)}catch(S){console.error(S),n("meta","saveState","ERROR")}});const m=Il(t.meta),h=sn();return Pt(()=>{window.addEventListener("popstate",$=>{if(typeof $=="object"&&$!==null&&"state"in $){const S=new URL(location.href),_=Zt(S);m(_.page,{backButton:!0})}}),setInterval(async()=>{const $=h.dequeue();$.kind==="NEXT_ELEMENT"&&await $.data()},1e3)}),[r(E,{get when(){return t.meta.showCreateMessage},get children(){return[r(A,{type:"success",get children(){return y.registrationStarted}}),u(Ul)]}}),r(ue,{get fallback(){return r(pe,{title:"Wo mÃ¶chtest du starten?",showQuickmenu:!1,changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(Cr,{changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get isDebugging(){return t.meta.isDebugging}})}})},get children(){return[r(T,{get when(){return t.meta.page.kind==="PLAYER"||t.meta.page.kind==="GAME"},get children(){return r(pe,{title:"SpielrundenÃ¼bersicht",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r($r,{program:a,get uuid(){return t.meta.page.kind==="GAME"?t.meta.page.uuid:null},changePage:m,get isDebugging(){return t.meta.isDebugging}})}})}}),r(T,{get when(){return t.meta.page.kind==="GAMEMASTER"},get children(){return r(pe,{title:"Meine Spielrunden",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(Qn,{get store(){return t.save.master},changePage:m})}})}}),r(T,{get when(){return t.meta.page.kind==="EDIT_GAMEROUND"},get children(){return r(pe,{title:"Spielrunde editieren",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(bi,{get allRounds(){return t.save.master.games},get uuid(){return t.meta.page.kind==="EDIT_GAMEROUND"?t.meta.page.uuid:"should never happen"},get fallback(){return r(A,{type:"danger",get children(){return y.error.gameroundUuidError}})},children:$=>r(fi,{store:$,registrations:l,queue:h,changePage:m})})}})}}),r(T,{get when(){return t.meta.page.kind==="HELPING"},get children(){return r(pe,{title:"Helfen",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(Ln,{})}})}}),r(T,{get when(){return t.meta.page.kind==="SUMMARY"},get children(){return r(pe,{title:"Zusammenfassung",changePage:m,get saveState(){return t.meta.saveState},get lastSaved(){return t.save.lastSaved},get children(){return r(Un,{get store(){return t.save},changePage:m})}})}})]}}),r(E,{get when(){return t.meta.isDebugging},get children(){return[(()=>{var $=u(wt);return s($,()=>JSON.stringify(t,null,2)),$})(),u(Ol),u(Ml),r(ut,{get fallback(){return u(Pl)},get children(){return r(E,{get when(){return l()},children:$=>(()=>{var S=u(wt);return s(S,()=>JSON.stringify($(),null,2)),S})()})}})]}}),r(zi,{})]}function Jt(){return r(A,{get children(){return y.loading}})}function jl(){const[e,t]=Mt(null);return Pt(()=>{const n=new URL(location.href);t(Zt(n))}),r(E,{get fallback(){return r(Jt,{})},get when(){return e()},children:n=>r(Fl,{get page(){return n()}})})}function Fl(e){const[t]=Ge(()=>al(e.page.secret));return r(dn,{fallback:n=>(console.error(n),r(A,{type:"danger",get children(){return y.error.general}})),get children(){return r(ut,{get fallback(){return r(Jt,{})},get children(){return r(ue,{get children(){return r(T,{get when(){return t()},children:n=>{const{kind:i,value:l}=on(n());return i==="SECRET_INVALID"?r(A,{type:"danger",get children(){return y.error.secretError}}):i==="FAILURE"?r(A,{type:"danger",get children(){return y.error.ourMistake}}):r(Ll,{get meta(){return e.page},get save(){return l.data}})}})}})}})}})}export{jl as MeineAnmeldungWrapper};
