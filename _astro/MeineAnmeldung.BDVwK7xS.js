import{g as l,t as s,i as c,d as t,a as m,m as H,e as ie,o as le,M as C,f as U,h as Y,j as se,E as ce,S as oe}from"./web.5PWvPun-.js";import{e as O,I as E,B as D,a as R}from"./utils.q22qP-MV.js";import{e as ge,a as N,o as v,s as o,b as x,n as b,c as ue,l as K,u as Q,d as q}from"./index.BmTnCDYh.js";import{c as de}from"./store.UIwYTWTH.js";/* empty css                                 */const y=1,Z="SAVE",W="PROGRAM",j={registrationId:-1,name:"Demo",email:"demo@mail.com",handynummer:"+41 12 123 12 12",wantsEmailUpdates:!0,games:[],lastSaved:"2024-08-15T07:45:21.335Z"};function he(){const e=localStorage.getItem(Z);let n;return e===null?n={version:y,data:j}:n=JSON.parse(e),n.version!==y&&(console.error("Your local storage data was outdated and has been replaced with new demo content."),n={version:y,data:j}),localStorage.setItem(Z,JSON.stringify(n)),n.data}const J={gameList:[],reservedList:[]};function me(){const e=localStorage.getItem(W);let n;return e===null?n={version:y,data:J}:n=JSON.parse(e),n.version!==y&&(console.error("Your local storage data was outdated and has been replaced with new demo content."),n={version:y,data:J}),localStorage.setItem(W,JSON.stringify(n)),n.data}const X=ge(["SATURDAY","SUNDAY"]);N(v({uuid:o(),description:x(o()),title:x(o()),system:o(),master:v({first:o(),last:x(o())}),playerCount:v({min:b(),max:b()}),slot:v({day:X,start:b(),end:b()})}));const ee=v({game:o(),self:K(!0),spielerName:ue()}),ne=v({game:o(),self:K(!1),spielerName:o()}),Se=Q([ee.extend({id:b()}),ne.extend({id:b()})]),$e=Q([ee,ne]),fe=v({registrationId:b(),name:o(),email:o(),handynummer:o(),wantsEmailUpdates:q(),games:N(Se),lastSaved:o()});v({registrationId:b(),name:o(),email:o(),handynummer:o(),wantsEmailUpdates:q(),games:N($e),lastSaved:o()});async function pe(e){if(e==="demo")return{kind:"SUCCESS",save:he()};const n=O("/rst24/load");n.searchParams.append("secret",e);const r=await fetch(n);if(!r.ok)return{kind:"FAILED"};const a=await r.json(),h=fe.safeParse(a);return h.success?{kind:"SUCCESS",save:h.data}:{kind:"FAILED"}}const _e=v({uuid:o(),title:x(o()),system:o(),description:x(o()),playerCount:v({min:b(),max:b()}),master:v({first:o(),last:x(o())}),slot:v({day:X,start:b(),end:b()})}),ve=v({id:b(),gameId:o()});async function be(e){if(e)return{kind:"SUCCESS",program:me()};const n=O("/rst24/program"),r=O("/rst24/reserved"),[a,h]=await Promise.all([fetch(n),fetch(r)]);if(!a.ok)return{kind:"FAILED"};if(!h.ok)return{kind:"FAILED"};const S=await a.json(),f=await h.json(),p=N(_e).safeParse(S);if(!p.success)return{kind:"FAILED"};const P=N(ve).safeParse(f);return P.success?{kind:"SUCCESS",program:{gameList:p.data,reservedList:P.data}}:{kind:"FAILED"}}const Ee=["CHOOSE","PLAYER","GAMEMASTER","GAMEMASTER_NEW","HELPING","SUMMARY"],V={CHOOSE:"Übersicht",PLAYER:"Spielanmeldung",GAMEMASTER:"Spielleitung",GAMEMASTER_NEW:"Neue Spielrunde",HELPING:"Helfen",SUMMARY:"Zusammenfassung"};function te(e){const n=e.searchParams.get("page");return Ee.find(r=>n?.toUpperCase()===r.toUpperCase())??"CHOOSE"}function Pe(){const e=new URL(location.href),n=e.searchParams.get("secret"),r=te(e),a=e.searchParams.get("showCreateMessage")==="true";return{secret:n,page:r,showCreateMessage:a}}async function re(e){if(e.secret===null)throw Error("SECRET_ERROR");const n=await pe(e.secret);if(n.kind==="FAILED")throw Error("SECRET_ERROR");return{state:"IDLE",secret:e.secret,page:e.page,showCreateMessage:e.showCreateMessage,currentSave:n.save,activeTab:"Contact",lastSaved:n.save.lastSaved,hasChanged:!1,tentativeReservations:[],markedForDeletionReservations:[]}}async function Re(e=!1){const n=await be(e);if(n.kind==="FAILED")throw Error("PROGRAM_ERROR");return n.program}function ke(e){const[n,r]=de(e);function a(i){r("activeTab",i),window.scrollTo({top:0})}function h(i){const g=new URL(location.href);g.searchParams.set("page",i.toLowerCase()),g.searchParams.delete("showCreateMessage"),history.replaceState({page:i},"",g);const _=V[i];document.title=`Meine Anmeldung: ${_} | Luzerner Rollenspieltage `}h(e.page);function S(i,g=!1){if(i===n.page)return;if(!g){const u=new URL(location.href);u.searchParams.set("page",i.toLowerCase()),history.pushState({page:i},"",u)}const _=V[i];document.title=`Meine Anmeldung: ${_} | Luzerner Rollenspieltage `,r("page",i),window.scrollTo({top:0})}function f(i,g){r("hasChanged",!0),r("currentSave",i,g)}async function p(){if(n.state!=="IDLE")throw Error("ASSERTION_ERROR");r("state","SAVING");const i=O("/rst24/save"),g={...n.currentSave,games:[...n.currentSave.games.filter(u=>!n.markedForDeletionReservations.includes(u.id)),...n.tentativeReservations.map(u=>u.friendsName===null?{game:u.gameUuid,self:!0,spielerName:null}:{game:u.gameUuid,self:!1,spielerName:u.friendsName})]};if((await fetch(i,{method:"post",body:JSON.stringify(g),headers:{"Content-Type":"application/json"}})).ok){const u=await re({secret:n.secret,page:n.page,showCreateMessage:!1});r({...u,activeTab:n.activeTab})}else throw Error("SAVE_ERROR")}function P(i){r("hasChanged",!0),r("tentativeReservations",g=>[...g,i])}function A(i){if(r("hasChanged",!0),i.confirmed)r("markedForDeletionReservations",g=>[...g,i.reservationId]);else{const g=n.currentSave.name;r("tentativeReservations",_=>_.filter(u=>u.gameUuid!==i.gameUuid?!0:u.friendsName===i.name?!1:i.name!==g))}}return{state:n,actions:{changeTab:a,changePage:S,updateSave:f,saveCurrentState:p,addTentativeReservation:P,deleteReservation:A}}}var B=s("<br>"),we=s("<strong>Donnerstag, 21. August 2025");const Ae=function(){const n="Donnerstag, 21. August 2025",r=["Deine Anmeldung wurde erfolgreich gestartet.",l(B),l(B),"Wir haben eine E-Mail an deine Adresse gesendet. In dieser E-Mail findest du einen persönlichen Link, um deine Anmeldung bis am"," ",l(we)," anzupassen."];return{registrationDeadline:n,registrationStarted:r}}();var Ce=s("<div class=grid><!$><!/><div>"),Me=s("<div class=boxLink>");function I(e){const n=e.type??"special";return(()=>{var r=l(Me);return c(r,t(D,{type:n,get onClick(){return e.onClick},get children(){var a=l(Ce),h=a.firstChild,[S,f]=m(h.nextSibling),p=S.nextSibling;return c(a,t(E,{get icon(){return e.icon}}),S,f),c(p,()=>e.children),a}})),r})()}var xe=s("<div class=tooltip-wrapper><div class=tooltip></div><!$><!/>");function L(e){return(()=>{var n=l(xe),r=n.firstChild,a=r.nextSibling,[h,S]=m(a.nextSibling);return c(r,()=>e.tooltip),c(n,()=>e.children,h,S),n})()}var ye=s("<div class=quickmenu-wrapper><div class=quickmenu><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),Te=s('<div class="quickmenu extended"><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>'),Le=s("<div class=grid><!$><!/><span>Zur Übersicht"),Ne=s("<div class=grid><!$><!/><span>Zu den Spielrunden"),Ie=s("<div class=grid><!$><!/><span>Zu deinen Spielrunden"),Ue=s("<div class=grid><!$><!/><span>Zum Helferplan"),Oe=s("<div class=grid><!$><!/><span>Zur Zusammenfassung");function De(e){return(()=>{var n=l(ye),r=n.firstChild,a=r.firstChild,[h,S]=m(a.nextSibling),f=h.nextSibling,[p,P]=m(f.nextSibling),A=p.nextSibling,[i,g]=m(A.nextSibling),_=i.nextSibling,[u,M]=m(_.nextSibling),G=u.nextSibling,[F,d]=m(G.nextSibling);return c(r,t(L,{tooltip:"Zur Übersicht",get children(){return t(R,{get label(){return t(E,{icon:"backward"})},onClick:()=>e.changePage("CHOOSE")})}}),h,S),c(r,t(L,{tooltip:"Zu den Spielrunden",get children(){return t(R,{get label(){return t(E,{icon:"dice-d20"})},onClick:()=>e.changePage("PLAYER")})}}),p,P),c(r,t(L,{tooltip:"Zu deinen Spielrunden",get children(){return t(R,{get label(){return t(E,{icon:"grid-2-plus"})},onClick:()=>e.changePage("GAMEMASTER")})}}),i,g),c(r,t(L,{tooltip:"Zum Helferplan",get children(){return t(R,{get label(){return t(E,{icon:"hand-heart"})},onClick:()=>e.changePage("HELPING")})}}),u,M),c(r,t(L,{tooltip:"Zur Zusammenfassung",get children(){return t(R,{get label(){return t(E,{icon:"list"})},onClick:()=>e.changePage("SUMMARY")})}}),F,d),n})()}function Ge(e){return(()=>{var n=l(Te),r=n.firstChild,[a,h]=m(r.nextSibling),S=a.nextSibling,[f,p]=m(S.nextSibling),P=f.nextSibling,[A,i]=m(P.nextSibling),g=A.nextSibling,[_,u]=m(g.nextSibling),M=_.nextSibling,[G,F]=m(M.nextSibling);return c(n,t(R,{get label(){return(()=>{var d=l(Le),k=d.firstChild,[$,w]=m(k.nextSibling);return $.nextSibling,c(d,t(E,{icon:"backward"}),$,w),d})()},onClick:()=>e.changePage("CHOOSE")}),a,h),c(n,t(R,{get label(){return(()=>{var d=l(Ne),k=d.firstChild,[$,w]=m(k.nextSibling);return $.nextSibling,c(d,t(E,{icon:"dice-d20"}),$,w),d})()},onClick:()=>e.changePage("PLAYER")}),f,p),c(n,t(R,{get label(){return(()=>{var d=l(Ie),k=d.firstChild,[$,w]=m(k.nextSibling);return $.nextSibling,c(d,t(E,{icon:"grid-2-plus"}),$,w),d})()},onClick:()=>e.changePage("GAMEMASTER")}),A,i),c(n,t(R,{get label(){return(()=>{var d=l(Ue),k=d.firstChild,[$,w]=m(k.nextSibling);return $.nextSibling,c(d,t(E,{icon:"hand-heart"}),$,w),d})()},onClick:()=>e.changePage("HELPING")}),_,u),c(n,t(R,{get label(){return(()=>{var d=l(Oe),k=d.firstChild,[$,w]=m(k.nextSibling);return $.nextSibling,c(d,t(E,{icon:"list"}),$,w),d})()},onClick:()=>e.changePage("SUMMARY")}),G,F),n})()}var Fe=s("<div class=page><!$><!/><div><h2></h2><br><!$><!/></div><!$><!/>");function T(e){return(()=>{var n=l(Fe),r=n.firstChild,[a,h]=m(r.nextSibling),S=a.nextSibling,f=S.firstChild,p=f.nextSibling,P=p.nextSibling,[A,i]=m(P.nextSibling),g=S.nextSibling,[_,u]=m(g.nextSibling);return c(n,(()=>{var M=H(()=>e.showQuickmenu!==!1);return()=>M()?t(De,{get changePage(){return e.changePage}}):null})(),a,h),c(f,()=>e.title),c(S,()=>e.children,A,i),c(n,(()=>{var M=H(()=>e.showQuickmenu!==!1);return()=>M()?t(Ge,{get changePage(){return e.changePage}}):null})(),_,u),n})()}var He=s("<h3>Spielrunden ansehen"),Ye=s("<p>Melde dich (und deine Freunde) für diverse Spielrunden an."),z=s("<br>"),Ze=s("<h3>Spielrunden erstellen"),We=s("<p>Falls du wenig oder gar keine Erfahrung als Spielleiter:in hast, werden wir dich vor und während dem Anlass unterstützen."),je=s("<h3>Helfen"),Je=s("<p>Beim Kiosk und der Essensausgabe können wir immer ein paar helfende Hände gebrauchen.");function Ve(e){return t(T,{title:"Wie möchtest du starten?",showQuickmenu:!1,get changePage(){return e.changePage},get children(){return[t(I,{icon:"dice-d20",onClick:()=>e.changePage("PLAYER"),get children(){return[l(He),l(Ye)]}}),l(z),t(I,{icon:"grid-2-plus",onClick:()=>e.changePage("GAMEMASTER"),get children(){return[l(Ze),l(We)]}}),l(z),t(I,{icon:"hand-heart",onClick:()=>e.changePage("HELPING"),get children(){return[l(je),l(Je)]}})]}})}var Be=s("<h3>Neue Spielrunde erstellen");function ze(e){return t(T,{title:"Meine Spielrunden",get changePage(){return e.changePage},get children(){return t(I,{icon:"grid-2-plus",type:"success",onClick:()=>e.changePage("GAMEMASTER_NEW"),get children(){return l(Be)}})}})}function Ke(e){return t(T,{title:"Neue Spielrunde erfassen",get changePage(){return e.changePage}})}var Qe=s("<pre><code>Noch nicht implementiert");function qe(e){return t(T,{title:"Helfen",get changePage(){return e.changePage},get children(){return l(Qe)}})}var Xe=s("<pre><code>Noch nicht implementiert");function en(e){return t(T,{title:"Spielrundenübersicht",get changePage(){return e.changePage},get children(){return l(Xe)}})}var nn=s("<pre><code>Noch nicht implementiert");function tn(e){return t(T,{title:"Zusammenfassung",get changePage(){return e.changePage},get children(){return l(nn)}})}var rn=s("<p>Deine Anmeldung wird geladen..."),an=s("<p>Wir konnten leider keine Anmeldung finden. Wenn du bereits eine Anmeldung begonnen hast, solltest du den korrekten Link per E-Mail erhalten haben.<br><br> Falls du noch keine Anmeldung begonnen hast, kannst du <a href=/anmeldung>hier</a> deine persönliche Anmeldung beginnen. <br><br>Für generelle Fragen oder Probleme, schreibe uns doch bitte über unser <a href=/kontatk>Kontaktformular</a>."),ln=s("<p>Leider ist ein unerwarteter Fehler passiert. Versuche deine Anmeldung erneut zu laden. Wiederholt sich dieser Fehler, bitte kontaktiere uns sobald als möglich über das <a href=/kontakt>Kontaktformular</a>, da dies nicht passieren sollte."),sn=s("<br>");function ae(){return t(D,{get children(){return l(rn)}})}function Sn(){const[e,n]=ie(null);return le(()=>{n(Pe())}),t(U,{get fallback(){return t(ae,{})},get children(){return t(C,{get when(){return e()},children:r=>t(cn,{get params(){return r()}})})}})}function cn(e){const[n]=Y(()=>re(e.params)),[r]=Y(()=>Re(e.params.secret==="demo"));return t(ce,{fallback:a=>t(D,{type:"danger",get children(){return t(U,{get fallback(){return l(ln)},get children(){return t(C,{get when(){return a.message==="SECRET_ERROR"},get children(){return l(an)}})}})}}),get children(){return t(se,{get fallback(){return t(ae,{})},get children(){return t(U,{get children(){return t(C,{get when(){return n()},children:a=>t(on,{get state(){return a()},programResource:r})})}})}})}})}function on(e){const{state:n,actions:r}=ke(e.state);return window.addEventListener("popstate",a=>{if(typeof a=="object"&&a!==null&&"state"in a){const h=new URL(location.href),S=te(h);r.changePage(S,!0)}}),[t(oe,{get when(){return n.showCreateMessage},get children(){return[t(D,{type:"success",get children(){return Ae.registrationStarted}}),l(sn)]}}),t(U,{get fallback(){return t(Ve,{get changePage(){return r.changePage}})},get children(){return[t(C,{get when(){return n.page==="PLAYER"},get children(){return t(en,{get changePage(){return r.changePage}})}}),t(C,{get when(){return n.page==="GAMEMASTER"},get children(){return t(ze,{get changePage(){return r.changePage}})}}),t(C,{get when(){return n.page==="GAMEMASTER_NEW"},get children(){return t(Ke,{get changePage(){return r.changePage}})}}),t(C,{get when(){return n.page==="HELPING"},get children(){return t(qe,{get changePage(){return r.changePage}})}}),t(C,{get when(){return n.page==="SUMMARY"},get children(){return t(tn,{get changePage(){return r.changePage}})}})]}})]}export{Sn as MeineAnmeldungWrapper};
