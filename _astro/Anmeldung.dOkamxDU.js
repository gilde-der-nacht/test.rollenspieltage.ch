import{g as m,c as r,t as f,a as s,i,S as c}from"./web.CWkhEVI3.js";import{e as W,I as k,B as g,a as q,b as F}from"./utils.D0BOsESk.js";import{c as H}from"./store.tvcWmGwL.js";import{o as J,s as _,n as K,C as Q}from"./Checkbox.qI5vp2xV.js";var X=f("<form novalidate><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>"),D=f("<br>"),Y=f("<a href=/kontakt>kontaktiere uns direkt"),Z=f("<span>Ich bestätige, dass ich den <a href=/verhaltenskodex target=_blank>Verhaltenskodex</a> gelesen habe und mich an die Regeln halten werde.");function ae(){const[e,n]=H({form:{name:"",email:"",tel:"",coc:!1},showErrors:{nameMissing:!1,emailMissing:!1,emailInvalid:!1,cocMissing:!1,general:!1},state:"IDLE"});let p;async function L(t){t.preventDefault();const $=e.form.name.trim().length===0;n("showErrors","nameMissing",$);const d=e.form.email.trim().length===0;n("showErrors","emailMissing",d);const b=p.validity.typeMismatch;if(n("showErrors","emailInvalid",b),n("showErrors","cocMissing",!e.form.coc),!(e.showErrors.nameMissing||e.showErrors.emailMissing||e.showErrors.emailInvalid)){n("state","LOADING");try{const h={name:e.form.name,email:e.form.email,handynummer:e.form.tel},l=await fetch(W("/rst25/start"),{method:"post",body:JSON.stringify(h),headers:{"Content-Type":"application/json"}});if(!l.ok)n("showErrors","general",!0);else{const w=await l.json(),u=J({name:_(),email:_(),registrationId:K(),secret:_()}).parse(w),o=new URL(location.origin+"/meine-anmeldung");o.searchParams.append("secret",u.secret),o.searchParams.append("showCreateMessage","true"),window.location.replace(o)}}catch{n("showErrors","general",!0)}finally{n("state","IDLE")}}}return[(()=>{var t=m(X),$=t.firstChild,[d,b]=s($.nextSibling),h=d.nextSibling,[l,w]=s(h.nextSibling),E=l.nextSibling,[u,o]=s(E.nextSibling),A=u.nextSibling,[x,C]=s(A.nextSibling),N=x.nextSibling,[y,V]=s(N.nextSibling),P=y.nextSibling,[S,U]=s(P.nextSibling),j=S.nextSibling,[I,B]=s(j.nextSibling),T=I.nextSibling,[M,O]=s(T.nextSibling),R=M.nextSibling,[z,G]=s(R.nextSibling);return t.addEventListener("submit",L),i(t,r(k,{label:"Name",name:"name",get value(){return e.form.name},onValueUpdate:a=>{n("form","name",a),n("showErrors","nameMissing",!1)}}),d,b),i(t,r(c,{get when(){return e.showErrors.nameMissing},get children(){return r(g,{type:"danger",children:"Dies ist ein Pflichtfeld."})}}),l,w),i(t,r(q,{label:"E-Mail",name:"email",type:"email",get value(){return e.form.email},onValueUpdate:a=>{n("form","email",a),n("showErrors","emailMissing",!1),n("showErrors","emailInvalid",!1)},ref(a){var v=p;typeof v=="function"?v(a):p=a}}),u,o),i(t,r(c,{get when(){return e.showErrors.emailMissing},get children(){return r(g,{type:"danger",children:"Dies ist ein Pflichtfeld."})}}),x,C),i(t,r(c,{get when(){return e.showErrors.emailInvalid},get children(){return r(g,{type:"danger",children:"Die Eingabe scheint keine gültige E-Mail-Adresse zu sein."})}}),y,V),i(t,r(k,{label:"Handynummer",name:"tel",type:"tel",get value(){return e.form.tel},required:!1,onValueUpdate:a=>n("form","tel",a)}),S,U),i(t,r(Q,{get label(){return m(Z)},name:"coc",value:"coc",get checked(){return e.form.coc},onValueUpdate:a=>n("form","coc",a)}),I,B),i(t,r(c,{get when(){return e.showErrors.cocMissing},get children(){return r(g,{type:"danger",children:"Der Verhaltenskodex muss gelesen und akzeptiert werden."})}}),M,O),i(t,r(F,{type:"submit",get kind(){return e.state==="IDLE"?"success":"gray"},get label(){return e.state==="IDLE"?"Anmeldung starten":"Anmeldung wird gestartet"},get disabled(){return e.state==="LOADING"}}),z,G),t})(),m(D),r(c,{get when(){return e.showErrors.general},get children(){return[r(g,{type:"danger",get children(){return["Es gab ein Problem, das wir nicht erwartet haben. Bitte versuche es erneut oder ",m(Y),"."]}}),m(D)]}})]}export{ae as AnmeldungWrapper};
